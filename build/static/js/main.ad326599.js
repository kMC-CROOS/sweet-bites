/*! For license information please see main.ad326599.js.LICENSE.txt */
(()=>{var e={579:(e,t,n)=>{"use strict";e.exports=n(1153)},1153:(e,t,n)=>{"use strict";var r=n(5043),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:d,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},2016:(e,t,n)=>{"use strict";e.exports=n(6958)},2284:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{A:()=>r})},2730:(e,t,n)=>{"use strict";var r=n(5043),i=n(7067);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,r,i,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,v);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,v);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,v);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),M=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var F,O=Object.assign;function D(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||i[a]!==s[o]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?D(e):""}function B(e){switch(e.tag){case 5:return D(e.type);case 16:return D("Lazy");case 13:return D("Suspense");case 19:return D("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case _:return"Portal";case j:return"Profiler";case N:return"StrictMode";case C:return"Suspense";case k:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case M:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Q(e,t){K(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach(function(e){me.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var xe=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Se=null,Ne=null;function je(e){if(e=yi(e)){if("function"!==typeof _e)throw Error(s(280));var t=e.stateNode;t&&(t=wi(t),_e(e.stateNode,e.type,t))}}function Ae(e){Se?Ne?Ne.push(e):Ne=[e]:Se=e}function Me(){if(Se){var e=Se,t=Ne;if(Ne=Se=null,je(e),t)for(e=0;e<t.length;e++)je(t[e])}}function Ee(e,t){return e(t)}function Ce(){}var ke=!1;function Te(e,t,n){if(ke)return e(t,n);ke=!0;try{return Ee(e,t,n)}finally{ke=!1,(null!==Se||null!==Ne)&&(Ce(),Me())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Le=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Le=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Le=!1}function Ie(e,t,n,r,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Fe=!1,Oe=null,De=!1,Ue=null,ze={onError:function(e){Fe=!0,Oe=e}};function Be(e,t,n,r,i,s,a,o,l){Fe=!1,Oe=null,Ie.apply(ze,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ve(e)!==e)throw Error(s(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return We(i),e;if(a===r)return We(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Xe=i.unstable_scheduleCallback,Ye=i.unstable_cancelCallback,Ze=i.unstable_shouldYield,Je=i.unstable_requestPaint,Ke=i.unstable_now,Qe=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~i;0!==o?r=ut(o):0!==(s&=a)&&(r=ut(s))}else 0!==(a=n&~i)?r=ut(a):0!==s&&(r=ut(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var yt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,St,Nt,jt,At=!1,Mt=[],Et=null,Ct=null,kt=null,Tt=new Map,Pt=new Map,Lt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":kt=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Ft(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&_t(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ot(e){var t=vi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void jt(e.priority,function(){St(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Dt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&_t(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){Dt(e)&&n.delete(t)}function zt(){At=!1,null!==Et&&Dt(Et)&&(Et=null),null!==Ct&&Dt(Ct)&&(Ct=null),null!==kt&&Dt(kt)&&(kt=null),Tt.forEach(Ut),Pt.forEach(Ut)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function Vt(e){function t(t){return Bt(t,e)}if(0<Mt.length){Bt(Mt[0],e);for(var n=1;n<Mt.length;n++){var r=Mt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Bt(Et,e),null!==Ct&&Bt(Ct,e),null!==kt&&Bt(kt,e),Tt.forEach(t),Pt.forEach(t),n=0;n<Lt.length;n++)(r=Lt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Lt.length&&null===(n=Lt[0]).blockedOn;)Ot(n),null===n.blockedOn&&Lt.shift()}var Ht=b.ReactCurrentBatchConfig,Wt=!0;function Gt(e,t,n,r){var i=yt,s=Ht.transition;Ht.transition=null;try{yt=1,Xt(e,t,n,r)}finally{yt=i,Ht.transition=s}}function qt(e,t,n,r){var i=yt,s=Ht.transition;Ht.transition=null;try{yt=4,Xt(e,t,n,r)}finally{yt=i,Ht.transition=s}}function Xt(e,t,n,r){if(Wt){var i=Zt(e,t,n,r);if(null===i)Wr(e,t,r,Yt,n),It(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Et=Ft(Et,e,t,n,r,i),!0;case"dragenter":return Ct=Ft(Ct,e,t,n,r,i),!0;case"mouseover":return kt=Ft(kt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Tt.set(s,Ft(Tt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Pt.set(s,Ft(Pt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(It(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==i;){var s=yi(i);if(null!==s&&wt(s),null===(s=Zt(e,t,n,r))&&Wr(e,t,r,Yt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Yt=null;function Zt(e,t,n,r){if(Yt=null,null!==(e=vi(e=we(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Kt=null,Qt=null,$t=null;function en(){if($t)return $t;var e,t,n=Qt,r=n.length,i="value"in Kt?Kt.value:Kt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[s-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=sn(cn),un=O({},cn,{view:0,detail:0}),hn=sn(un),pn=O({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),mn=sn(pn),fn=sn(O({},pn,{dataTransfer:0})),gn=sn(O({},un,{relatedTarget:0})),xn=sn(O({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=O({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=sn(vn),bn=sn(O({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function jn(){return Nn}var An=O({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Mn=sn(An),En=sn(O({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=sn(O({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jn})),kn=sn(O({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=O({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=sn(Tn),Ln=[9,13,27,32],Rn=d&&"CompositionEvent"in window,In=null;d&&"documentMode"in document&&(In=document.documentMode);var Fn=d&&"TextEvent"in window&&!In,On=d&&(!Rn||In&&8<In&&11>=In),Dn=String.fromCharCode(32),Un=!1;function zn(e,t){switch(e){case"keyup":return-1!==Ln.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ae(r),0<(t=qr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Xn=null;function Yn(e){Dr(e,0)}function Zn(e){if(X(bi(e)))return e}function Jn(e,t){if("change"===e)return t}var Kn=!1;if(d){var Qn;if(d){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Qn=$n}else Qn=!1;Kn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Xn=qn=null)}function nr(e){if("value"===e.propertyName&&Zn(Xn)){var t=[];Gn(t,Xn,e,we(e)),Te(Yn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Zn(Xn)}function sr(e,t){if("click"===e)return Zn(t)}function ar(e,t){if("input"===e||"change"===e)return Zn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!u.call(t,i)||!or(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=dr(n,s);var a=dr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=d&&"documentMode"in document&&11>=document.documentMode,gr=null,xr=null,vr=null,yr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==gr||gr!==Y(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=qr(xr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Nr={};function jr(e){if(Sr[e])return Sr[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in Nr)return Sr[e]=n[t];return e}d&&(Nr=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var Ar=jr("animationend"),Mr=jr("animationiteration"),Er=jr("animationstart"),Cr=jr("transitionend"),kr=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){kr.set(e,t),l(t,[e])}for(var Lr=0;Lr<Tr.length;Lr++){var Rr=Tr[Lr];Pr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Pr(Ar,"onAnimationEnd"),Pr(Mr,"onAnimationIteration"),Pr(Er,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Cr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ir="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ir));function Or(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,c){if(Be.apply(this,arguments),Fe){if(!Fe)throw Error(s(198));var d=Oe;Fe=!1,Oe=null,De||(De=!0,Ue=d)}}(r,t,void 0,e),e.currentTarget=null}function Dr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Or(i,o,c),s=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Or(i,o,c),s=l}}}if(De)throw e=Ue,De=!1,Ue=null,e}function Ur(e,t){var n=t[fi];void 0===n&&(n=t[fi]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Br]){e[Br]=!0,a.forEach(function(t){"selectionchange"!==t&&(Fr.has(t)||zr(t,!1,e),zr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,zr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Jt(t)){case 1:var i=Gt;break;case 4:i=qt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==o;){if(null===(a=vi(o)))return;if(5===(l=a.tag)||6===l){r=s=a;continue e}o=o.parentNode}}r=r.return}Te(function(){var r=s,i=we(n),a=[];e:{var o=kr.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Mn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case Ar:case Mr:case Er:l=xn;break;case Cr:l=kn;break;case"scroll":l=hn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=r;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Pe(m,h))&&d.push(Gr(m,f,p)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,n,i),a.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[mi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(u=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=mn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=En,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:bi(l),p=null==c?o:bi(c),(o=new d(f,m+"leave",l,n,i)).target=u,o.relatedTarget=p,f=null,vi(i)===r&&((d=new d(h,m+"enter",c,n,i)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=Xr(p))m++;for(p=0,f=h;f;f=Xr(f))p++;for(;0<m-p;)d=Xr(d),m--;for(;0<p-m;)h=Xr(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Xr(d),h=Xr(h)}d=null}else d=null;null!==l&&Yr(a,o,l,d,!1),null!==c&&null!==u&&Yr(a,u,c,d,!0)}if("select"===(l=(o=r?bi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Jn;else if(Wn(o))if(Kn)g=ar;else{g=ir;var x=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=sr);switch(g&&(g=g(e,r))?Gn(a,g,n,i):(x&&x(e,o,r),"focusout"===e&&(x=o._wrapperState)&&x.controlled&&"number"===o.type&&ee(o,"number",o.value)),x=r?bi(r):window,e){case"focusin":(Wn(x)||"true"===x.contentEditable)&&(gr=x,xr=r,vr=null);break;case"focusout":vr=xr=gr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,br(a,n,i);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":br(a,n,i)}var v;if(Rn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Vn?zn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(On&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Vn&&(v=en()):(Qt="value"in(Kt=i)?Kt.value:Kt.textContent,Vn=!0)),0<(x=qr(r,y)).length&&(y=new bn(y,e,null,n,i),a.push({event:y,listeners:x}),v?y.data=v:null!==(v=Bn(n))&&(y.data=v))),(v=Fn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,Dn);case"textInput":return(e=t.data)===Dn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Rn&&zn(e,t)?(e=en(),$t=Qt=Kt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return On&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}Dr(a,t)})}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Pe(e,n))&&r.unshift(Gr(e,s,i)),null!=(s=Pe(e,t))&&r.push(Gr(e,s,i))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,i){for(var s=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Pe(n,s))&&a.unshift(Gr(n,l,o)):i||null!=(l=Pe(n,s))&&a.push(Gr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Zr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Kr(e){return("string"===typeof e?e:""+e).replace(Zr,"\n").replace(Jr,"")}function Qr(e,t,n){if(t=Kr(t),Kr(e)!==t&&n)throw Error(s(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout(function(){throw e})}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function di(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ui=Math.random().toString(36).slice(2),hi="__reactFiber$"+ui,pi="__reactProps$"+ui,mi="__reactContainer$"+ui,fi="__reactEvents$"+ui,gi="__reactListeners$"+ui,xi="__reactHandles$"+ui;function vi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=di(e);null!==e;){if(n=e[hi])return n;e=di(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[hi]||e[mi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wi(e){return e[pi]||null}var _i=[],Si=-1;function Ni(e){return{current:e}}function ji(e){0>Si||(e.current=_i[Si],_i[Si]=null,Si--)}function Ai(e,t){Si++,_i[Si]=e.current,e.current=t}var Mi={},Ei=Ni(Mi),Ci=Ni(!1),ki=Mi;function Ti(e,t){var n=e.type.contextTypes;if(!n)return Mi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Li(){ji(Ci),ji(Ei)}function Ri(e,t,n){if(Ei.current!==Mi)throw Error(s(168));Ai(Ei,t),Ai(Ci,n)}function Ii(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,H(e)||"Unknown",i));return O({},n,r)}function Fi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Mi,ki=Ei.current,Ai(Ei,e),Ai(Ci,Ci.current),!0}function Oi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Ii(e,t,ki),r.__reactInternalMemoizedMergedChildContext=e,ji(Ci),ji(Ei),Ai(Ei,e)):ji(Ci),Ai(Ci,n)}var Di=null,Ui=!1,zi=!1;function Bi(e){null===Di?Di=[e]:Di.push(e)}function Vi(){if(!zi&&null!==Di){zi=!0;var e=0,t=yt;try{var n=Di;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Di=null,Ui=!1}catch(i){throw null!==Di&&(Di=Di.slice(e+1)),Xe($e,Vi),i}finally{yt=t,zi=!1}}return null}var Hi=[],Wi=0,Gi=null,qi=0,Xi=[],Yi=0,Zi=null,Ji=1,Ki="";function Qi(e,t){Hi[Wi++]=qi,Hi[Wi++]=Gi,Gi=e,qi=t}function $i(e,t,n){Xi[Yi++]=Ji,Xi[Yi++]=Ki,Xi[Yi++]=Zi,Zi=e;var r=Ji;e=Ki;var i=32-at(r)-1;r&=~(1<<i),n+=1;var s=32-at(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Ji=1<<32-at(t)+i|n<<i|r,Ki=s+e}else Ji=1<<s|n<<i|r,Ki=e}function es(e){null!==e.return&&(Qi(e,1),$i(e,1,0))}function ts(e){for(;e===Gi;)Gi=Hi[--Wi],Hi[Wi]=null,qi=Hi[--Wi],Hi[Wi]=null;for(;e===Zi;)Zi=Xi[--Yi],Xi[Yi]=null,Ki=Xi[--Yi],Xi[Yi]=null,Ji=Xi[--Yi],Xi[Yi]=null}var ns=null,rs=null,is=!1,ss=null;function as(e,t){var n=Tc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Zi?{id:Ji,overflow:Ki}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&os(e,t)?as(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function us(e){if(e!==ns)return!1;if(!is)return ds(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw hs(),Error(s(418));for(;t;)as(e,t),t=ci(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=rs;e;)e=ci(e.nextSibling)}function ps(){rs=ns=null,is=!1}function ms(e){null===ss?ss=[e]:ss.push(e)}var fs=b.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function xs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function ys(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Oc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===S?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===P&&vs(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Rc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Dc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function u(e,t,n,r,s){return null===t||7!==t.tag?((t=Ic(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case _:return(t=Dc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||I(t))return(t=Ic(t,e.mode,n,null)).return=e,t;xs(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case _:return n.key===i?d(e,t,n,r):null;case P:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||I(n))return null!==i?null:u(e,t,n,r,null);xs(e,n)}return null}function m(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return d(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return m(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||I(r))return u(t,e=e.get(n)||null,r,i,null);xs(t,r)}return null}function f(i,s,o,l){for(var c=null,d=null,u=s,f=s=0,g=null;null!==u&&f<o.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var x=p(i,u,o[f],l);if(null===x){null===u&&(u=g);break}e&&u&&null===x.alternate&&t(i,u),s=a(x,s,f),null===d?c=x:d.sibling=x,d=x,u=g}if(f===o.length)return n(i,u),is&&Qi(i,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(i,o[f],l))&&(s=a(u,s,f),null===d?c=u:d.sibling=u,d=u);return is&&Qi(i,f),c}for(u=r(i,u);f<o.length;f++)null!==(g=m(u,i,f,o[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),s=a(g,s,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(i,e)}),is&&Qi(i,f),c}function g(i,o,l,c){var d=I(l);if("function"!==typeof d)throw Error(s(150));if(null==(l=d.call(l)))throw Error(s(151));for(var u=d=null,f=o,g=o=0,x=null,v=l.next();null!==f&&!v.done;g++,v=l.next()){f.index>g?(x=f,f=null):x=f.sibling;var y=p(i,f,v.value,c);if(null===y){null===f&&(f=x);break}e&&f&&null===y.alternate&&t(i,f),o=a(y,o,g),null===u?d=y:u.sibling=y,u=y,f=x}if(v.done)return n(i,f),is&&Qi(i,g),d;if(null===f){for(;!v.done;g++,v=l.next())null!==(v=h(i,v.value,c))&&(o=a(v,o,g),null===u?d=v:u.sibling=v,u=v);return is&&Qi(i,g),d}for(f=r(i,f);!v.done;g++,v=l.next())null!==(v=m(f,i,g,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?g:v.key),o=a(v,o,g),null===u?d=v:u.sibling=v,u=v);return e&&f.forEach(function(e){return t(i,e)}),is&&Qi(i,g),d}return function e(r,s,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,d=s;null!==d;){if(d.key===c){if((c=a.type)===S){if(7===d.tag){n(r,d.sibling),(s=i(d,a.props.children)).return=r,r=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&vs(c)===d.type){n(r,d.sibling),(s=i(d,a.props)).ref=gs(r,d,a),s.return=r,r=s;break e}n(r,d);break}t(r,d),d=d.sibling}a.type===S?((s=Ic(a.props.children,r.mode,l,a.key)).return=r,r=s):((l=Rc(a.type,a.key,a.props,null,r.mode,l)).ref=gs(r,s,a),l.return=r,r=l)}return o(r);case _:e:{for(d=a.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Dc(a,r.mode,l)).return=r,r=s}return o(r);case P:return e(r,s,(d=a._init)(a._payload),l)}if(te(a))return f(r,s,a,l);if(I(a))return g(r,s,a,l);xs(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=Oc(a,r.mode,l)).return=r,r=s),o(r)):n(r,s)}}var bs=ys(!0),ws=ys(!1),_s=Ni(null),Ss=null,Ns=null,js=null;function As(){js=Ns=Ss=null}function Ms(e){var t=_s.current;ji(_s),e._currentValue=t}function Es(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Cs(e,t){Ss=e,js=Ns=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yo=!0),e.firstContext=null)}function ks(e){var t=e._currentValue;if(js!==e)if(e={context:e,memoizedValue:t,next:null},null===Ns){if(null===Ss)throw Error(s(308));Ns=e,Ss.dependencies={lanes:0,firstContext:e}}else Ns=Ns.next=e;return t}var Ts=null;function Ps(e){null===Ts?Ts=[e]:Ts.push(e)}function Ls(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ps(t)):(n.next=i.next,i.next=n),t.interleaved=n,Rs(e,r)}function Rs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Is=!1;function Fs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Os(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ds(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&El)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Rs(e,n)}return null===(i=r.interleaved)?(t.next=t,Ps(r)):(t.next=i.next,i.next=t),r.interleaved=t,Rs(e,n)}function zs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Bs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Vs(e,t,n,r){var i=e.updateQueue;Is=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==a&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=i.baseState;for(a=0,d=c=l=null,o=s;;){var h=o.lane,p=o.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=O({},u,h);break e;case 2:Is=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,a|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===d&&(l=u),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Fl|=a,e.lanes=a,e.memoizedState=u}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Ws={},Gs=Ni(Ws),qs=Ni(Ws),Xs=Ni(Ws);function Ys(e){if(e===Ws)throw Error(s(174));return e}function Zs(e,t){switch(Ai(Xs,t),Ai(qs,e),Ai(Gs,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ji(Gs),Ai(Gs,t)}function Js(){ji(Gs),ji(qs),ji(Xs)}function Ks(e){Ys(Xs.current);var t=Ys(Gs.current),n=le(t,e.type);t!==n&&(Ai(qs,e),Ai(Gs,n))}function Qs(e){qs.current===e&&(ji(Gs),ji(qs))}var $s=Ni(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ra=b.ReactCurrentDispatcher,ia=b.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ca=!1,da=!1,ua=0,ha=0;function pa(){throw Error(s(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function fa(e,t,n,r,i,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ra.current=null===e||null===e.memoizedState?Qa:$a,e=n(r,i),da){a=0;do{if(da=!1,ua=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ra.current=eo,e=n(r,i)}while(da)}if(ra.current=Ka,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ca=!1,t)throw Error(s(300));return e}function ga(){var e=0!==ua;return ua=0,e}function xa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function va(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function ya(e,t){return"function"===typeof t?t(e):t}function ba(e){var t=va(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=oa,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=o=null,c=null,d=a;do{var u=d.lane;if((sa&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,aa.lanes|=u,Fl|=u}d=d.next}while(null!==d&&d!==a);null===c?o=r:c.next=l,or(r,t.memoizedState)||(yo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,aa.lanes|=a,Fl|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wa(e){var t=va(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);or(a,t.memoizedState)||(yo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function _a(){}function Sa(e,t){var n=aa,r=va(),i=t(),a=!or(r.memoizedState,i);if(a&&(r.memoizedState=i,yo=!0),r=r.queue,Ia(Aa.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,ka(9,ja.bind(null,n,r,i,t),void 0,null),null===Cl)throw Error(s(349));0!==(30&sa)||Na(n,t,i)}return i}function Na(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ja(e,t,n,r){t.value=n,t.getSnapshot=r,Ma(t)&&Ea(e)}function Aa(e,t,n){return n(function(){Ma(t)&&Ea(e)})}function Ma(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ea(e){var t=Rs(e,1);null!==t&&nc(t,e,1,-1)}function Ca(e){var t=xa();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:e},t.queue=e,e=e.dispatch=Xa.bind(null,aa,e),[t.memoizedState,e]}function ka(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ta(){return va().memoizedState}function Pa(e,t,n,r){var i=xa();aa.flags|=e,i.memoizedState=ka(1|t,n,void 0,void 0===r?null:r)}function La(e,t,n,r){var i=va();r=void 0===r?null:r;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=ka(t,n,s,r))}aa.flags|=e,i.memoizedState=ka(1|t,n,s,r)}function Ra(e,t){return Pa(8390656,8,e,t)}function Ia(e,t){return La(2048,8,e,t)}function Fa(e,t){return La(4,2,e,t)}function Oa(e,t){return La(4,4,e,t)}function Da(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ua(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,La(4,4,Da.bind(null,t,e),n)}function za(){}function Ba(e,t){var n=va();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Va(e,t){var n=va();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ha(e,t,n){return 0===(21&sa)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=n):(or(n,t)||(n=ft(),aa.lanes|=n,Fl|=n,e.baseState=!0),t)}function Wa(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=ia.transition;ia.transition={};try{e(!1),t()}finally{yt=n,ia.transition=r}}function Ga(){return va().memoizedState}function qa(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ya(e))Za(t,n);else if(null!==(n=Ls(e,t,n,r))){nc(n,e,r,ec()),Ja(n,t,r)}}function Xa(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Za(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(i.next=i,Ps(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ls(e,t,i,r))&&(nc(n,e,r,i=ec()),Ja(n,t,r))}}function Ya(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Za(e,t){da=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ja(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Ka={readContext:ks,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Qa={readContext:ks,useCallback:function(e,t){return xa().memoizedState=[e,void 0===t?null:t],e},useContext:ks,useEffect:Ra,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pa(4194308,4,Da.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pa(4,2,e,t)},useMemo:function(e,t){var n=xa();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=xa();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=qa.bind(null,aa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},xa().memoizedState=e},useState:Ca,useDebugValue:za,useDeferredValue:function(e){return xa().memoizedState=e},useTransition:function(){var e=Ca(!1),t=e[0];return e=Wa.bind(null,e[1]),xa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=aa,i=xa();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Cl)throw Error(s(349));0!==(30&sa)||Na(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Ra(Aa.bind(null,r,a,e),[e]),r.flags|=2048,ka(9,ja.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=xa(),t=Cl.identifierPrefix;if(is){var n=Ki;t=":"+t+"R"+(n=(Ji&~(1<<32-at(Ji)-1)).toString(32)+n),0<(n=ua++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ha++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$a={readContext:ks,useCallback:Ba,useContext:ks,useEffect:Ia,useImperativeHandle:Ua,useInsertionEffect:Fa,useLayoutEffect:Oa,useMemo:Va,useReducer:ba,useRef:Ta,useState:function(){return ba(ya)},useDebugValue:za,useDeferredValue:function(e){return Ha(va(),oa.memoizedState,e)},useTransition:function(){return[ba(ya)[0],va().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Ga,unstable_isNewReconciler:!1},eo={readContext:ks,useCallback:Ba,useContext:ks,useEffect:Ia,useImperativeHandle:Ua,useInsertionEffect:Fa,useLayoutEffect:Oa,useMemo:Va,useReducer:wa,useRef:Ta,useState:function(){return wa(ya)},useDebugValue:za,useDeferredValue:function(e){var t=va();return null===oa?t.memoizedState=e:Ha(t,oa.memoizedState,e)},useTransition:function(){return[wa(ya)[0],va().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Ga,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=O({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:O({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Ds(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(nc(t,e,i,r),zs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Ds(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(nc(t,e,i,r),zs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=Ds(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Us(e,i,r))&&(nc(t,e,r,n),zs(t,e,r))}};function io(e,t,n,r,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function so(e,t,n){var r=!1,i=Mi,s=t.contextType;return"object"===typeof s&&null!==s?s=ks(s):(i=Pi(t)?ki:Ei.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ti(e,i):Mi),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function ao(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Fs(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=ks(s):(s=Pi(t)?ki:Ei.current,i.context=Ti(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(no(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ro.enqueueReplaceState(i,i.state,null),Vs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ho="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Ds(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Gl=r),uo(0,t)},n}function mo(e,t,n){(n=Ds(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=jc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xo(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ds(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vo=b.ReactCurrentOwner,yo=!1;function bo(e,t,n,r){t.child=null===e?ws(t,null,n,r):bs(t,e.child,n,r)}function wo(e,t,n,r,i){n=n.render;var s=t.ref;return Cs(t,i),r=fa(e,t,n,r,s,i),n=ga(),null===e||yo?(is&&n&&es(t),t.flags|=1,bo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wo(e,t,i))}function _o(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Pc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,So(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Wo(e,t,i)}return t.flags|=1,(e=Lc(s,r)).ref=t.ref,e.return=t,t.child=e}function So(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(yo=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Wo(e,t,i);0!==(131072&e.flags)&&(yo=!0)}}return Ao(e,t,n,r,i)}function No(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ai(Ll,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ai(Ll,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ai(Ll,Pl),Pl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ai(Ll,Pl),Pl|=r;return bo(e,t,i,n),t.child}function jo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ao(e,t,n,r,i){var s=Pi(n)?ki:Ei.current;return s=Ti(t,s),Cs(t,i),n=fa(e,t,n,r,s,i),r=ga(),null===e||yo?(is&&r&&es(t),t.flags|=1,bo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wo(e,t,i))}function Mo(e,t,n,r,i){if(Pi(n)){var s=!0;Fi(t)}else s=!1;if(Cs(t,i),null===t.stateNode)Ho(e,t),so(t,n,r),oo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=ks(c):c=Ti(t,c=Pi(n)?ki:Ei.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate;u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&ao(t,a,r,c),Is=!1;var h=t.memoizedState;a.state=h,Vs(t,r,a,i),l=t.memoizedState,o!==r||h!==l||Ci.current||Is?("function"===typeof d&&(no(t,n,d,r),l=t.memoizedState),(o=Is||io(t,n,o,r,h,l,c))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Os(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),a.props=c,u=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=ks(l):l=Ti(t,l=Pi(n)?ki:Ei.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==u||h!==l)&&ao(t,a,r,l),Is=!1,h=t.memoizedState,a.state=h,Vs(t,r,a,i);var m=t.memoizedState;o!==u||h!==m||Ci.current||Is?("function"===typeof p&&(no(t,n,p,r),m=t.memoizedState),(c=Is||io(t,n,c,r,h,m,l)||!1)?(d||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,m,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),a.props=r,a.state=m,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Eo(e,t,n,r,s,i)}function Eo(e,t,n,r,i,s){jo(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Oi(t,n,!1),Wo(e,t,s);r=t.stateNode,vo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=bs(t,e.child,null,s),t.child=bs(t,null,o,s)):bo(e,t,o,s),t.memoizedState=r.state,i&&Oi(t,n,!0),t.child}function Co(e){var t=e.stateNode;t.pendingContext?Ri(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ri(0,t.context,!1),Zs(e,t.containerInfo)}function ko(e,t,n,r,i){return ps(),ms(i),t.flags|=256,bo(e,t,n,r),t.child}var To,Po,Lo,Ro,Io={dehydrated:null,treeContext:null,retryLane:0};function Fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oo(e,t,n){var r,i=t.pendingProps,a=$s.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ai($s,1&a),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Fc(l,i,0,null),e=Ic(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Fo(n),t.memoizedState=Io,e):Do(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,r=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Fc({mode:"visible",children:r.children},i,0,null),(a=Ic(a,i,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&bs(t,e.child,null,o),t.child.memoizedState=Fo(o),t.memoizedState=Io,a);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Uo(e,t,o,r=co(a=Error(s(419)),r,void 0))}if(l=0!==(o&e.childLanes),yo||l){if(null!==(r=Cl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Rs(e,i),nc(r,e,i,-1))}return fc(),Uo(e,t,o,r=co(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Mc.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Xi[Yi++]=Ji,Xi[Yi++]=Ki,Xi[Yi++]=Zi,Ji=e.id,Ki=e.overflow,Zi=t),t=Do(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(o){o=i.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Lc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Lc(r,o):(o=Ic(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Fo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Io,i}return e=(o=e.child).sibling,i=Lc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Do(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,r){return null!==r&&ms(r),bs(t,e.child,null,n),(e=Do(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Es(e.return,t,n)}function Bo(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Vo(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(bo(e,t,r.children,n),0!==(2&(r=$s.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ai($s,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Bo(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ea(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Bo(t,!0,n,null,s);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Lc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xo(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Pi(t.type)&&Li(),qo(t),null;case 3:return r=t.stateNode,Js(),ji(Ci),ji(Ei),na(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(us(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),Po(e,t),qo(t),null;case 5:Qs(t);var i=Ys(Xs.current);if(n=t.type,null!==e&&null!=t.stateNode)Lo(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return qo(t),null}if(e=Ys(Gs.current),us(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[pi]=a,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Ir.length;i++)Ur(Ir[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":J(r,a),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ur("invalid",r);break;case"textarea":ie(r,a),Ur("invalid",r)}for(var l in ve(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":q(r),$(r,a,!0);break;case"textarea":q(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[pi]=r,To(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Ir.length;i++)Ur(Ir[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":J(e,r),i=Z(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=O({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(a in ve(n,i),c=i)if(c.hasOwnProperty(a)){var d=c[a];"style"===a?ge(e,d):"dangerouslySetInnerHTML"===a?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===a?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=d&&"onScroll"===a&&Ur("scroll",e):null!=d&&y(e,a,d,l))}switch(n){case"input":q(e),$(e,r,!1);break;case"textarea":q(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)Ro(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Ys(Xs.current),Ys(Gs.current),us(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return qo(t),null;case 13:if(ji($s),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ps(),t.flags|=98560,a=!1;else if(a=us(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hi]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),a=!1}else null!==ss&&(ac(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$s.current)?0===Rl&&(Rl=3):fc())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return Js(),Po(e,t),null===e&&Vr(t.stateNode.containerInfo),qo(t),null;case 10:return Ms(t.type._context),qo(t),null;case 19:if(ji($s),null===(a=t.memoizedState))return qo(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Go(a,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Go(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ai($s,1&$s.current|2),t.child}e=e.sibling}null!==a.tail&&Ke()>Vl&&(t.flags|=128,r=!0,Go(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ea(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!is)return qo(t),null}else 2*Ke()-a.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,r=!0,Go(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ke(),t.sibling=null,n=$s.current,Ai($s,r?1&n|2:1&n),t):(qo(t),null);case 22:case 23:return uc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Yo(e,t){switch(ts(t),t.tag){case 1:return Pi(t.type)&&Li(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Js(),ji(Ci),ji(Ei),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qs(t),null;case 13:if(ji($s),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ji($s),null;case 4:return Js(),null;case 10:return Ms(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}To=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(){},Lo=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ys(Gs.current);var s,a=null;switch(n){case"input":i=Z(e,i),r=Z(e,r),a=[];break;case"select":i=O({},i,{value:void 0}),r=O({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(d in ve(n,r),n=null,i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&null!=i[d])if("style"===d){var l=i[d];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=i?i[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(d,c))}n&&(a=a||[]).push("style",n);var d=a;(t.updateQueue=d)&&(t.flags|=4)}},Ro=function(e,t,n,r){n!==r&&(t.flags|=4)};var Zo=!1,Jo=!1,Ko="function"===typeof WeakSet?WeakSet:Set,Qo=null;function $o(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Nc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Nc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[fi],delete t[gi],delete t[xi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Jo||$o(n,t);case 6:var r=dl,i=ul;dl=null,hl(e,t,n),ul=i,null!==(dl=r)&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Vt(e)):li(dl,n.stateNode));break;case 4:r=dl,i=ul,dl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),dl=r,ul=i;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&el(n,t,a),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Jo&&($o(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Nc(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Jo=(r=Jo)||null!==n.memoizedState,hl(e,t,n),Jo=r):hl(e,t,n);break;default:hl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ko),t.forEach(function(t){var r=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function fl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(s(160));pl(a,o,i),dl=null,ul=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(d){Nc(i,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),xl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Nc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Nc(e,e.return,g)}}break;case 1:fl(t,e),xl(e),512&r&&null!==n&&$o(n,n.return);break;case 5:if(fl(t,e),xl(e),512&r&&null!==n&&$o(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Nc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&K(i,a),ye(l,o);var d=ye(l,a);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?ge(i,h):"dangerouslySetInnerHTML"===u?ue(i,h):"children"===u?he(i,h):y(i,u,h,d)}switch(l){case"input":Q(i,a);break;case"textarea":se(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var m=a.value;null!=m?ne(i,!!a.multiple,m,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(g){Nc(e,e.return,g)}}break;case 6:if(fl(t,e),xl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Nc(e,e.return,g)}}break;case 3:if(fl(t,e),xl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Nc(e,e.return,g)}break;case 4:default:fl(t,e),xl(e);break;case 13:fl(t,e),xl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Bl=Ke())),4&r&&ml(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Jo=(d=Jo)||u,fl(t,e),Jo=d):fl(t,e),xl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Qo=e,u=e.child;null!==u;){for(h=Qo=u;null!==Qo;){switch(m=(p=Qo).child,p.tag){case 0:case 11:case 14:case 15:nl(4,p,p.return);break;case 1:$o(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){Nc(r,n,g)}}break;case 5:$o(p,p.return);break;case 22:if(null!==p.memoizedState){wl(h);continue}}null!==m?(m.return=p,Qo=m):wl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{i=h.stateNode,d?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",o))}catch(g){Nc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Nc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:fl(t,e),xl(e),4&r&&ml(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,ol(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(o){Nc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Qo=e,yl(e,t,n)}function yl(e,t,n){for(var r=0!==(1&e.mode);null!==Qo;){var i=Qo,s=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Zo;if(!a){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Jo;o=Zo;var c=Jo;if(Zo=a,(Jo=l)&&!c)for(Qo=i;null!==Qo;)l=(a=Qo).child,22===a.tag&&null!==a.memoizedState?_l(i):null!==l?(l.return=a,Qo=l):_l(i);for(;null!==s;)Qo=s,yl(s,t,n),s=s.sibling;Qo=i,Zo=o,Jo=c}bl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Qo=s):bl(e)}}function bl(e){for(;null!==Qo;){var t=Qo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Jo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Hs(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(s(163))}Jo||512&t.flags&&il(t)}catch(p){Nc(t,t.return,p)}}if(t===e){Qo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qo=n;break}Qo=t.return}}function wl(e){for(;null!==Qo;){var t=Qo;if(t===e){Qo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qo=n;break}Qo=t.return}}function _l(e){for(;null!==Qo;){var t=Qo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Nc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Nc(t,i,l)}}var s=t.return;try{il(t)}catch(l){Nc(t,s,l)}break;case 5:var a=t.return;try{il(t)}catch(l){Nc(t,a,l)}}}catch(l){Nc(t,t.return,l)}if(t===e){Qo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Qo=o;break}Qo=t.return}}var Sl,Nl=Math.ceil,jl=b.ReactCurrentDispatcher,Al=b.ReactCurrentOwner,Ml=b.ReactCurrentBatchConfig,El=0,Cl=null,kl=null,Tl=0,Pl=0,Ll=Ni(0),Rl=0,Il=null,Fl=0,Ol=0,Dl=0,Ul=null,zl=null,Bl=0,Vl=1/0,Hl=null,Wl=!1,Gl=null,ql=null,Xl=!1,Yl=null,Zl=0,Jl=0,Kl=null,Ql=-1,$l=0;function ec(){return 0!==(6&El)?Ke():-1!==Ql?Ql:Ql=Ke()}function tc(e){return 0===(1&e.mode)?1:0!==(2&El)&&0!==Tl?Tl&-Tl:null!==fs.transition?(0===$l&&($l=ft()),$l):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,r){if(50<Jl)throw Jl=0,Kl=null,Error(s(185));xt(e,n,r),0!==(2&El)&&e===Cl||(e===Cl&&(0===(2&El)&&(Ol|=n),4===Rl&&oc(e,Tl)),rc(e,r),1===n&&0===El&&0===(1&t.mode)&&(Vl=Ke()+500,Ui&&Vi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=i[a];-1===l?0!==(o&n)&&0===(o&r)||(i[a]=pt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var r=ht(e,e===Cl?Tl:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Ui=!0,Bi(e)}(lc.bind(null,e)):Bi(lc.bind(null,e)),ai(function(){0===(6&El)&&Vi()}),n=null;else{switch(bt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Cc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Ql=-1,$l=0,0!==(6&El))throw Error(s(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var r=ht(e,e===Cl?Tl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=El;El|=2;var a=mc();for(Cl===e&&Tl===t||(Hl=null,Vl=Ke()+500,hc(e,t));;)try{vc();break}catch(l){pc(e,l)}As(),jl.current=a,El=i,null!==kl?t=0:(Cl=null,Tl=0,t=Rl)}if(0!==t){if(2===t&&(0!==(i=mt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Il,hc(e,0),oc(e,r),rc(e,Ke()),n;if(6===t)oc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!or(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(a=mt(e))&&(r=a,t=sc(e,a))),1===t))throw n=Il,hc(e,0),oc(e,r),rc(e,Ke()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:wc(e,zl,Hl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Bl+500-Ke())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(wc.bind(null,e,zl,Hl),t);break}wc(e,zl,Hl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>i&&(i=o),r&=~a}if(r=i,10<(r=(120>(r=Ke()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Nl(r/1960))-r)){e.timeoutHandle=ri(wc.bind(null,e,zl,Hl),r);break}wc(e,zl,Hl);break;default:throw Error(s(329))}}}return rc(e,Ke()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&ac(t)),e}function ac(e){null===zl?zl=e:zl.push.apply(zl,e)}function oc(e,t){for(t&=~Dl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&El))throw Error(s(327));_c();var t=ht(e,0);if(0===(1&t))return rc(e,Ke()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=mt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Il,hc(e,0),oc(e,t),rc(e,Ke()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Hl),rc(e,Ke()),null}function cc(e,t){var n=El;El|=1;try{return e(t)}finally{0===(El=n)&&(Vl=Ke()+500,Ui&&Vi())}}function dc(e){null!==Yl&&0===Yl.tag&&0===(6&El)&&_c();var t=El;El|=1;var n=Ml.transition,r=yt;try{if(Ml.transition=null,yt=1,e)return e()}finally{yt=r,Ml.transition=n,0===(6&(El=t))&&Vi()}}function uc(){Pl=Ll.current,ji(Ll)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==kl)for(n=kl.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Li();break;case 3:Js(),ji(Ci),ji(Ei),na();break;case 5:Qs(r);break;case 4:Js();break;case 13:case 19:ji($s);break;case 10:Ms(r.type._context);break;case 22:case 23:uc()}n=n.return}if(Cl=e,kl=e=Lc(e.current,null),Tl=Pl=t,Rl=0,Il=null,Dl=Ol=Fl=0,zl=Ul=null,null!==Ts){for(t=0;t<Ts.length;t++)if(null!==(r=(n=Ts[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var a=s.next;s.next=i,r.next=a}n.pending=r}Ts=null}return e}function pc(e,t){for(;;){var n=kl;try{if(As(),ra.current=Ka,ca){for(var r=aa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ca=!1}if(sa=0,la=oa=aa=null,da=!1,ua=0,Al.current=null,null===n||null===n.return){Rl=1,Il=t,kl=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Tl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=go(o);if(null!==m){m.flags&=-257,xo(m,o,l,0,t),1&m.mode&&fo(a,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){fo(a,d,t),fc();break e}c=Error(s(426))}else if(is&&1&l.mode){var x=go(o);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xo(x,o,l,0,t),ms(lo(c,l));break e}}a=c=lo(c,l),4!==Rl&&(Rl=2),null===Ul?Ul=[a]:Ul.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Bs(a,po(0,c,t));break e;case 1:l=c;var v=a.type,y=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===ql||!ql.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t,Bs(a,mo(a,l,t));break e}}a=a.return}while(null!==a)}bc(n)}catch(b){t=b,kl===n&&null!==n&&(kl=n=n.return);continue}break}}function mc(){var e=jl.current;return jl.current=Ka,null===e?Ka:e}function fc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Cl||0===(268435455&Fl)&&0===(268435455&Ol)||oc(Cl,Tl)}function gc(e,t){var n=El;El|=2;var r=mc();for(Cl===e&&Tl===t||(Hl=null,hc(e,t));;)try{xc();break}catch(i){pc(e,i)}if(As(),El=n,jl.current=r,null!==kl)throw Error(s(261));return Cl=null,Tl=0,Rl}function xc(){for(;null!==kl;)yc(kl)}function vc(){for(;null!==kl&&!Ze();)yc(kl)}function yc(e){var t=Sl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?bc(e):kl=t,Al.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xo(n,t,Pl)))return void(kl=n)}else{if(null!==(n=Yo(n,t)))return n.flags&=32767,void(kl=n);if(null===e)return Rl=6,void(kl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(kl=t);kl=t=e}while(null!==t);0===Rl&&(Rl=5)}function wc(e,t,n){var r=yt,i=Ml.transition;try{Ml.transition=null,yt=1,function(e,t,n,r){do{_c()}while(null!==Yl);if(0!==(6&El))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,a),e===Cl&&(kl=Cl=null,Tl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,Cc(tt,function(){return _c(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Ml.transition,Ml.transition=null;var o=yt;yt=1;var l=El;El|=4,Al.current=null,function(e,t){if(ei=Wt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===i&&(l=o),p===a&&++u===r&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,Qo=t;null!==Qo;)if(e=(t=Qo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qo=e;else for(;null!==Qo;){t=Qo;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,x=f.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(w){Nc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qo=e;break}Qo=t.return}f=tl,tl=!1}(e,n),gl(n,e),mr(ti),Wt=!!ei,ti=ei=null,e.current=n,vl(n,e,i),Je(),El=l,yt=o,Ml.transition=a}else e.current=n;if(Xl&&(Xl=!1,Yl=e,Zl=i),a=e.pendingLanes,0===a&&(ql=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ke()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&Zl)&&0!==e.tag&&_c(),a=e.pendingLanes,0!==(1&a)?e===Kl?Jl++:(Jl=0,Kl=e):Jl=0,Vi()}(e,t,n,r)}finally{Ml.transition=i,yt=r}return null}function _c(){if(null!==Yl){var e=bt(Zl),t=Ml.transition,n=yt;try{if(Ml.transition=null,yt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Zl=0,0!==(6&El))throw Error(s(331));var i=El;for(El|=4,Qo=e.current;null!==Qo;){var a=Qo,o=a.child;if(0!==(16&Qo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Qo=d;null!==Qo;){var u=Qo;switch(u.tag){case 0:case 11:case 15:nl(8,u,a)}var h=u.child;if(null!==h)h.return=u,Qo=h;else for(;null!==Qo;){var p=(u=Qo).sibling,m=u.return;if(sl(u),u===d){Qo=null;break}if(null!==p){p.return=m,Qo=p;break}Qo=m}}}var f=a.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}Qo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Qo=o;else e:for(;null!==Qo;){if(0!==(2048&(a=Qo).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Qo=v;break e}Qo=a.return}}var y=e.current;for(Qo=y;null!==Qo;){var b=(o=Qo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Qo=b;else e:for(o=y;null!==Qo;){if(0!==(2048&(l=Qo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(_){Nc(l,l.return,_)}if(l===o){Qo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qo=w;break e}Qo=l.return}}if(El=i,Vi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(_){}r=!0}return r}finally{yt=n,Ml.transition=t}}return!1}function Sc(e,t,n){e=Us(e,t=po(0,t=lo(n,t),1),1),t=ec(),null!==e&&(xt(e,1,t),rc(e,t))}function Nc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ql||!ql.has(r))){t=Us(t,e=mo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(xt(t,1,e),rc(t,e));break}}t=t.return}}function jc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Cl===e&&(Tl&n)===n&&(4===Rl||3===Rl&&(130023424&Tl)===Tl&&500>Ke()-Bl?hc(e,0):Dl|=n),rc(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=Rs(e,t))&&(xt(e,t,n),rc(e,n))}function Mc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Ac(e,n)}function Cc(e,t){return Xe(e,t)}function kc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,n,r){return new kc(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var n=e.alternate;return null===n?((n=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)Pc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Ic(n.children,i,a,t);case N:o=8,i|=8;break;case j:return(e=Tc(12,n,t,2|i)).elementType=j,e.lanes=a,e;case C:return(e=Tc(13,n,t,i)).elementType=C,e.lanes=a,e;case k:return(e=Tc(19,n,t,i)).elementType=k,e.lanes=a,e;case L:return Fc(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:o=10;break e;case M:o=9;break e;case E:o=11;break e;case T:o=14;break e;case P:o=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Tc(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Ic(e,t,n,r){return(e=Tc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Tc(22,e,r,t)).elementType=L,e.lanes=n,e.stateNode={isHidden:!1},e}function Oc(e,t,n){return(e=Tc(6,e,null,t)).lanes=n,e}function Dc(e,t,n){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,i,s,a,o,l){return e=new Uc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Tc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fs(s),e}function Bc(e){if(!e)return Mi;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Ii(e,n,t)}return t}function Vc(e,t,n,r,i,s,a,o,l){return(e=zc(n,r,!0,e,0,s,0,o,l)).context=Bc(null),n=e.current,(s=Ds(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,i),e.current.lanes=i,xt(e,i,r),rc(e,r),e}function Hc(e,t,n,r){var i=t.current,s=ec(),a=tc(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ds(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Us(i,t,a))&&(nc(e,i,a,s),zs(e,i,a)),a}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)yo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return yo=!1,function(e,t,n){switch(t.tag){case 3:Co(t),ps();break;case 5:Ks(t);break;case 1:Pi(t.type)&&Fi(t);break;case 4:Zs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ai(_s,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ai($s,1&$s.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Oo(e,t,n):(Ai($s,1&$s.current),null!==(e=Wo(e,t,n))?e.sibling:null);Ai($s,1&$s.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ai($s,$s.current),r)break;return null;case 22:case 23:return t.lanes=0,No(e,t,n)}return Wo(e,t,n)}(e,t,n);yo=0!==(131072&e.flags)}else yo=!1,is&&0!==(1048576&t.flags)&&$i(t,qi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var i=Ti(t,Ei.current);Cs(t,n),i=fa(null,t,r,e,i,n);var a=ga();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(a=!0,Fi(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Fs(t),i.updater=ro,t.stateNode=i,i._reactInternals=t,oo(t,r,e,n),t=Eo(null,t,r,!0,a,n)):(t.tag=0,is&&a&&es(t),bo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===T)return 14}return 2}(r),e=to(r,e),i){case 0:t=Ao(null,t,r,e,n);break e;case 1:t=Mo(null,t,r,e,n);break e;case 11:t=wo(null,t,r,e,n);break e;case 14:t=_o(null,t,r,to(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ao(e,t,r,i=t.elementType===r?i:to(r,i),n);case 1:return r=t.type,i=t.pendingProps,Mo(e,t,r,i=t.elementType===r?i:to(r,i),n);case 3:e:{if(Co(t),null===e)throw Error(s(387));r=t.pendingProps,i=(a=t.memoizedState).element,Os(e,t),Vs(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=ko(e,t,r,n,i=lo(Error(s(423)),t));break e}if(r!==i){t=ko(e,t,r,n,i=lo(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=ws(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),r===i){t=Wo(e,t,n);break e}bo(e,t,r,n)}t=t.child}return t;case 5:return Ks(t),null===e&&cs(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==a&&ni(r,a)&&(t.flags|=32),jo(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Oo(e,t,n);case 4:return Zs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=bs(t,null,r,n):bo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,wo(e,t,r,i=t.elementType===r?i:to(r,i),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Ai(_s,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===i.children&&!Ci.current){t=Wo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Ds(-1,n&-n)).tag=2;var d=a.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Es(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Es(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}bo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Cs(t,n),r=r(i=ks(i)),t.flags|=1,bo(e,t,r,n),t.child;case 14:return i=to(r=t.type,t.pendingProps),_o(e,t,r,i=to(r.type,i),n);case 15:return So(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:to(r,i),Ho(e,t),t.tag=1,Pi(r)?(e=!0,Fi(t)):e=!1,Cs(t,n),so(t,r,i),oo(t,r,i,n),Eo(null,t,r,!0,e,n);case 19:return Vo(e,t,n);case 22:return No(e,t,n)}throw Error(s(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Zc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function $c(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof i){var o=i;i=function(){var e=Wc(a);o.call(e)}}Hc(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Wc(a);s.call(e)}}var a=Vc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=a,e[mi]=a.current,Vr(8===e.nodeType?e.parentNode:e),dc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=Wc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[mi]=l.current,Vr(8===e.nodeType?e.parentNode:e),dc(function(){Hc(t,l,n,r)}),l}(n,t,e,i,r);return Wc(a)}Zc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hc(e,t,null,null)},Zc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Hc(null,e,null,null)}),t[mi]=null}},Zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Lt.length&&0!==t&&t<Lt[n].priority;n++);Lt.splice(n,0,e),0===n&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Ke()),0===(6&El)&&(Vl=Ke()+500,Vi()))}break;case 13:dc(function(){var t=Rs(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}}),qc(e,1)}},_t=function(e){if(13===e.tag){var t=Rs(e,134217728);if(null!==t)nc(t,e,134217728,ec());qc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Rs(e,t);if(null!==n)nc(n,e,t,ec());qc(e,t)}},Nt=function(){return yt},jt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},_e=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(s(90));X(r),Q(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=cc,Ce=dc;var ed={usingClientEntryPoint:!1,Events:[yi,bi,wi,Ae,Me,cc]},td={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{it=rd.inject(nd),st=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,r="",i=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,i),e[mi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Kc(t))throw Error(s(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",o=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,i,0,a,o),e[mi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Zc(t)},t.render=function(e,t,n){if(!Kc(t))throw Error(s(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Kc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[mi]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Kc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return $c(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function v(){}function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=x.prototype;var b=y.prototype=new v;b.constructor=y,f(b,x.prototype),b.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,S={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,r){var i,s={},a=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)_.call(t,i)&&!N.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:S.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var M=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function C(e,t,i,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===s?"."+E(l,0):s,w(a)?(i="",null!=e&&(i=e.replace(M,"$&/")+"/"),C(a,t,i,"",function(e){return e})):null!=a&&(A(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(M,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var d=s+E(o=e[c],c);l+=C(o,t,i,d,a)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,i,d=s+E(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function k(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",function(e){return t.call(n,e,i++)}),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},L={transition:null},R={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:L,ReactCurrentOwner:S};function I(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:k,forEach:function(e,t,n){k(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return k(e,function(){t++}),t},toArray:function(e){return k(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=i,t.Profiler=a,t.PureComponent=y,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=I,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=f({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!N.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=j,t.createFactory=function(e){var t=j.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=I,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4612:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,n))c<i&&0>s(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>s(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(d);null!==t;){if(null===t.callback)i(d);else{if(!(t.startTime<=e))break;i(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function w(e){if(g=!1,b(e),!f)if(null!==r(c))f=!0,L(_);else{var t=r(d);null!==t&&R(w,t.startTime-e)}}function _(e,n){f=!1,g&&(g=!1,v(A),A=-1),m=!0;var s=p;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!C());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&i(c),b(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&R(w,u.startTime-n),l=!1}return l}finally{h=null,p=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,N=!1,j=null,A=-1,M=5,E=-1;function C(){return!(t.unstable_now()-E<M)}function k(){if(null!==j){var e=t.unstable_now();E=e;var n=!0;try{n=j(!0,e)}finally{n?S():(N=!1,j=null)}}else N=!1}if("function"===typeof y)S=function(){y(k)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,P=T.port2;T.port1.onmessage=k,S=function(){P.postMessage(null)}}else S=function(){x(k,0)};function L(e){j=e,N||(N=!0,S())}function R(e,n){A=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,L(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(d,e),null===r(c)&&e===r(d)&&(g?(v(A),A=-1):g=!0,R(w,s-a))):(e.sortIndex=o,n(c,e),f||m||(f=!0,L(_))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},4980:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(2284);function i(e){var t=function(e,t){if("object"!=(0,r.A)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=(0,r.A)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,r.A)(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},6958:(e,t,n)=>{e.exports=function(e){var t={},r=n(5043),i=n(8853),s=Object.assign;function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),m=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),v=Symbol.for("react.memo"),y=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var b=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var w=Symbol.iterator;function _(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=w&&e[w]||e["@@iterator"])?e:null}function S(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case d:return"Fragment";case c:return"Portal";case h:return"Profiler";case u:return"StrictMode";case g:return"Suspense";case x:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case m:return(e.displayName||"Context")+".Consumer";case p:return(e._context.displayName||"Context")+".Provider";case f:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case v:return null!==(t=e.displayName||null)?t:S(e.type)||"Memo";case y:t=e._payload,e=e._init;try{return S(e(t))}catch(n){}}return null}function N(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return S(t);case 8:return t===u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function j(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function A(e){if(j(e)!==e)throw Error(a(188))}function M(e){var t=e.alternate;if(!t){if(null===(t=j(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return A(i),e;if(s===r)return A(i),t;s=s.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}function E(e){return null!==(e=M(e))?C(e):null}function C(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=C(e);if(null!==t)return t;e=e.sibling}return null}function k(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=k(e);if(null!==t)return t}e=e.sibling}return null}var T,P=Array.isArray,L=e.getPublicInstance,R=e.getRootHostContext,I=e.getChildHostContext,F=e.prepareForCommit,O=e.resetAfterCommit,D=e.createInstance,U=e.appendInitialChild,z=e.finalizeInitialChildren,B=e.prepareUpdate,V=e.shouldSetTextContent,H=e.createTextInstance,W=e.scheduleTimeout,G=e.cancelTimeout,q=e.noTimeout,X=e.isPrimaryRenderer,Y=e.supportsMutation,Z=e.supportsPersistence,J=e.supportsHydration,K=e.getInstanceFromNode,Q=e.preparePortalMount,$=e.getCurrentEventPriority,ee=e.detachDeletedInstance,te=e.supportsMicrotasks,ne=e.scheduleMicrotask,re=e.supportsTestSelectors,ie=e.findFiberRoot,se=e.getBoundingRect,ae=e.getTextContent,oe=e.isHiddenSubtree,le=e.matchAccessibilityRole,ce=e.setFocusIfFocusable,de=e.setupIntersectionObserver,ue=e.appendChild,he=e.appendChildToContainer,pe=e.commitTextUpdate,me=e.commitMount,fe=e.commitUpdate,ge=e.insertBefore,xe=e.insertInContainerBefore,ve=e.removeChild,ye=e.removeChildFromContainer,be=e.resetTextContent,we=e.hideInstance,_e=e.hideTextInstance,Se=e.unhideInstance,Ne=e.unhideTextInstance,je=e.clearContainer,Ae=e.cloneInstance,Me=e.createContainerChildSet,Ee=e.appendChildToContainerChildSet,Ce=e.finalizeContainerChildren,ke=e.replaceContainerChildren,Te=e.cloneHiddenInstance,Pe=e.cloneHiddenTextInstance,Le=e.canHydrateInstance,Re=e.canHydrateTextInstance,Ie=e.canHydrateSuspenseInstance,Fe=e.isSuspenseInstancePending,Oe=e.isSuspenseInstanceFallback,De=e.registerSuspenseInstanceRetry,Ue=e.getNextHydratableSibling,ze=e.getFirstHydratableChild,Be=e.getFirstHydratableChildWithinContainer,Ve=e.getFirstHydratableChildWithinSuspenseInstance,He=e.hydrateInstance,We=e.hydrateTextInstance,Ge=e.hydrateSuspenseInstance,qe=e.getNextHydratableInstanceAfterSuspenseInstance,Xe=e.commitHydratedContainer,Ye=e.commitHydratedSuspenseInstance,Ze=e.clearSuspenseBoundary,Je=e.clearSuspenseBoundaryFromContainer,Ke=e.shouldDeleteUnhydratedTailInstances,Qe=e.didNotMatchHydratedContainerTextInstance,$e=e.didNotMatchHydratedTextInstance;function et(e){if(void 0===T)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);T=t&&t[1]||""}return"\n"+T+e}var tt=!1;function nt(e,t){if(!e||tt)return"";tt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||i[a]!==s[o]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{tt=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?et(e):""}var rt=Object.prototype.hasOwnProperty,it=[],st=-1;function at(e){return{current:e}}function ot(e){0>st||(e.current=it[st],it[st]=null,st--)}function lt(e,t){st++,it[st]=e.current,e.current=t}var ct={},dt=at(ct),ut=at(!1),ht=ct;function pt(e,t){var n=e.type.contextTypes;if(!n)return ct;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function mt(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ft(){ot(ut),ot(dt)}function gt(e,t,n){if(dt.current!==ct)throw Error(a(168));lt(dt,t),lt(ut,n)}function xt(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,N(e)||"Unknown",i));return s({},n,r)}function vt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ct,ht=dt.current,lt(dt,e),lt(ut,ut.current),!0}function yt(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=xt(e,t,ht),r.__reactInternalMemoizedMergedChildContext=e,ot(ut),ot(dt),lt(dt,e)):ot(ut),lt(ut,n)}var bt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(wt(e)/_t|0)|0},wt=Math.log,_t=Math.LN2;var St=64,Nt=4194304;function jt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function At(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~i;0!==o?r=jt(o):0!==(s&=a)&&(r=jt(s))}else 0!==(a=n&~i)?r=jt(a):0!==s&&(r=jt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-bt(t)),r|=e[n],t&=~i;return r}function Mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Et(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Ct(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function kt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-bt(t)]=n}function Tt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-bt(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Pt=0;function Lt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Rt=i.unstable_scheduleCallback,It=i.unstable_cancelCallback,Ft=i.unstable_shouldYield,Ot=i.unstable_requestPaint,Dt=i.unstable_now,Ut=i.unstable_ImmediatePriority,zt=i.unstable_UserBlockingPriority,Bt=i.unstable_NormalPriority,Vt=i.unstable_IdlePriority,Ht=null,Wt=null;var Gt="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},qt=null,Xt=!1,Yt=!1;function Zt(e){null===qt?qt=[e]:qt.push(e)}function Jt(){if(!Yt&&null!==qt){Yt=!0;var e=0,t=Pt;try{var n=qt;for(Pt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}qt=null,Xt=!1}catch(i){throw null!==qt&&(qt=qt.slice(e+1)),Rt(Ut,Jt),i}finally{Pt=t,Yt=!1}}return null}var Kt=o.ReactCurrentBatchConfig;function Qt(e,t){if(Gt(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!rt.call(t,i)||!Gt(e[i],t[i]))return!1}return!0}function $t(e){switch(e.tag){case 5:return et(e.type);case 16:return et("Lazy");case 13:return et("Suspense");case 19:return et("SuspenseList");case 0:case 2:case 15:return e=nt(e.type,!1);case 11:return e=nt(e.type.render,!1);case 1:return e=nt(e.type,!0);default:return""}}function en(e,t){if(e&&e.defaultProps){for(var n in t=s({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var tn=at(null),nn=null,rn=null,sn=null;function an(){sn=rn=nn=null}function on(e,t,n){X?(lt(tn,t._currentValue),t._currentValue=n):(lt(tn,t._currentValue2),t._currentValue2=n)}function ln(e){var t=tn.current;ot(tn),X?e._currentValue=t:e._currentValue2=t}function cn(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function dn(e,t){nn=e,sn=rn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Fi=!0),e.firstContext=null)}function un(e){var t=X?e._currentValue:e._currentValue2;if(sn!==e)if(e={context:e,memoizedValue:t,next:null},null===rn){if(null===nn)throw Error(a(308));rn=e,nn.dependencies={lanes:0,firstContext:e}}else rn=rn.next=e;return t}var hn=null,pn=!1;function mn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xn(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,null!==Ys&&0!==(1&e.mode)&&0===(2&Xs)?(null===(e=n.interleaved)?(t.next=t,null===hn?hn=[n]:hn.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function vn(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Tt(e,n)}}function yn(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function bn(e,t,n,r){var i=e.updateQueue;pn=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(null!==l){i.shared.pending=null;var c=l,d=c.next;c.next=null,null===o?a=d:o.next=d,o=c;var u=e.alternate;null!==u&&((l=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===l?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(null!==a){var h=i.baseState;for(o=0,u=d=c=null,l=a;;){var p=l.lane,m=l.eventTime;if((r&p)===p){null!==u&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var f=e,g=l;switch(p=t,m=n,g.tag){case 1:if("function"===typeof(f=g.payload)){h=f.call(m,h,p);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=g.payload)?f.call(m,h,p):f)||void 0===p)break e;h=s({},h,p);break e;case 2:pn=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(p=i.effects)?i.effects=[l]:p.push(l))}else m={eventTime:m,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===u?(d=u=m,c=h):u=u.next=m,o|=p;if(null===(l=l.next)){if(null===(l=i.shared.pending))break;l=(p=l).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}if(null===u&&(c=h),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);ta|=o,e.lanes=o,e.memoizedState=h}}function wn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var _n=(new r.Component).refs;function Sn(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:s({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Nn={isMounted:function(e){return!!(e=e._reactInternals)&&j(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ba(),i=wa(e),s=gn(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),xn(e,s),null!==(t=_a(e,i,r))&&vn(t,e,i)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ba(),i=wa(e),s=gn(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),xn(e,s),null!==(t=_a(e,i,r))&&vn(t,e,i)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ba(),r=wa(e),i=gn(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),xn(e,i),null!==(t=_a(e,r,n))&&vn(t,e,r)}};function jn(e,t,n,r,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!Qt(n,r)||!Qt(i,s))}function An(e,t,n){var r=!1,i=ct,s=t.contextType;return"object"===typeof s&&null!==s?s=un(s):(i=mt(t)?ht:dt.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?pt(e,i):ct),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Nn,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Mn(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Nn.enqueueReplaceState(t,t.state,null)}function En(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=_n,mn(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=un(s):(s=mt(t)?ht:dt.current,i.context=pt(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(Sn(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Nn.enqueueReplaceState(i,i.state,null),bn(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}var Cn=[],kn=0,Tn=null,Pn=0,Ln=[],Rn=0,In=null,Fn=1,On="";function Dn(e,t){Cn[kn++]=Pn,Cn[kn++]=Tn,Tn=e,Pn=t}function Un(e,t,n){Ln[Rn++]=Fn,Ln[Rn++]=On,Ln[Rn++]=In,In=e;var r=Fn;e=On;var i=32-bt(r)-1;r&=~(1<<i),n+=1;var s=32-bt(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Fn=1<<32-bt(t)+i|n<<i|r,On=s+e}else Fn=1<<s|n<<i|r,On=e}function zn(e){null!==e.return&&(Dn(e,1),Un(e,1,0))}function Bn(e){for(;e===Tn;)Tn=Cn[--kn],Cn[kn]=null,Pn=Cn[--kn],Cn[kn]=null;for(;e===In;)In=Ln[--Rn],Ln[Rn]=null,On=Ln[--Rn],Ln[Rn]=null,Fn=Ln[--Rn],Ln[Rn]=null}var Vn=null,Hn=null,Wn=!1,Gn=!1,qn=null;function Xn(e,t){var n=Ka(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Yn(e,t){switch(e.tag){case 5:return null!==(t=Le(t,e.type,e.pendingProps))&&(e.stateNode=t,Vn=e,Hn=ze(t),!0);case 6:return null!==(t=Re(t,e.pendingProps))&&(e.stateNode=t,Vn=e,Hn=null,!0);case 13:if(null!==(t=Ie(t))){var n=null!==In?{id:Fn,overflow:On}:null;return e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ka(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Vn=e,Hn=null,!0}return!1;default:return!1}}function Zn(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Jn(e){if(Wn){var t=Hn;if(t){var n=t;if(!Yn(e,t)){if(Zn(e))throw Error(a(418));t=Ue(n);var r=Vn;t&&Yn(e,t)?Xn(r,n):(e.flags=-4097&e.flags|2,Wn=!1,Vn=e)}}else{if(Zn(e))throw Error(a(418));e.flags=-4097&e.flags|2,Wn=!1,Vn=e}}}function Kn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Vn=e}function Qn(e){if(!J||e!==Vn)return!1;if(!Wn)return Kn(e),Wn=!0,!1;if(3!==e.tag&&(5!==e.tag||Ke(e.type)&&!V(e.type,e.memoizedProps))){var t=Hn;if(t){if(Zn(e)){for(e=Hn;e;)e=Ue(e);throw Error(a(418))}for(;t;)Xn(e,t),t=Ue(t)}}if(Kn(e),13===e.tag){if(!J)throw Error(a(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));Hn=qe(e)}else Hn=Vn?Ue(e.stateNode):null;return!0}function $n(){J&&(Hn=Vn=null,Gn=Wn=!1)}function er(e){null===qn?qn=[e]:qn.push(e)}function tr(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===_n&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function nr(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rr(e){return(0,e._init)(e._payload)}function ir(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=$a(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=ro(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n,r){var s=n.type;return s===d?m(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===y&&rr(s)===t.type)?((r=i(t,n.props)).ref=tr(e,t,n),r.return=e,r):((r=eo(n.type,n.key,n.props,null,e.mode,r)).ref=tr(e,t,n),r.return=e,r)}function p(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=io(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function m(e,t,n,r,s){return null===t||7!==t.tag?((t=to(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=ro(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case l:return(n=eo(t.type,t.key,t.props,null,e.mode,n)).ref=tr(e,null,t),n.return=e,n;case c:return(t=io(t,e.mode,n)).return=e,t;case y:return f(e,(0,t._init)(t._payload),n)}if(P(t)||_(t))return(t=to(t,e.mode,n,null)).return=e,t;nr(e,t)}return null}function g(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===i?h(e,t,n,r):null;case c:return n.key===i?p(e,t,n,r):null;case y:return g(e,t,(i=n._init)(n._payload),r)}if(P(n)||_(n))return null!==i?null:m(e,t,n,r,null);nr(e,n)}return null}function x(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case l:return h(t,e=e.get(null===r.key?n:r.key)||null,r,i);case c:return p(t,e=e.get(null===r.key?n:r.key)||null,r,i);case y:return x(e,t,n,(0,r._init)(r._payload),i)}if(P(r)||_(r))return m(t,e=e.get(n)||null,r,i,null);nr(t,r)}return null}function v(i,a,o,l){for(var c=null,d=null,u=a,h=a=0,p=null;null!==u&&h<o.length;h++){u.index>h?(p=u,u=null):p=u.sibling;var m=g(i,u,o[h],l);if(null===m){null===u&&(u=p);break}e&&u&&null===m.alternate&&t(i,u),a=s(m,a,h),null===d?c=m:d.sibling=m,d=m,u=p}if(h===o.length)return n(i,u),Wn&&Dn(i,h),c;if(null===u){for(;h<o.length;h++)null!==(u=f(i,o[h],l))&&(a=s(u,a,h),null===d?c=u:d.sibling=u,d=u);return Wn&&Dn(i,h),c}for(u=r(i,u);h<o.length;h++)null!==(p=x(u,i,h,o[h],l))&&(e&&null!==p.alternate&&u.delete(null===p.key?h:p.key),a=s(p,a,h),null===d?c=p:d.sibling=p,d=p);return e&&u.forEach(function(e){return t(i,e)}),Wn&&Dn(i,h),c}function b(i,o,l,c){var d=_(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var u=d=null,h=o,p=o=0,m=null,v=l.next();null!==h&&!v.done;p++,v=l.next()){h.index>p?(m=h,h=null):m=h.sibling;var y=g(i,h,v.value,c);if(null===y){null===h&&(h=m);break}e&&h&&null===y.alternate&&t(i,h),o=s(y,o,p),null===u?d=y:u.sibling=y,u=y,h=m}if(v.done)return n(i,h),Wn&&Dn(i,p),d;if(null===h){for(;!v.done;p++,v=l.next())null!==(v=f(i,v.value,c))&&(o=s(v,o,p),null===u?d=v:u.sibling=v,u=v);return Wn&&Dn(i,p),d}for(h=r(i,h);!v.done;p++,v=l.next())null!==(v=x(h,i,p,v.value,c))&&(e&&null!==v.alternate&&h.delete(null===v.key?p:v.key),o=s(v,o,p),null===u?d=v:u.sibling=v,u=v);return e&&h.forEach(function(e){return t(i,e)}),Wn&&Dn(i,p),d}return function e(r,s,a,u){if("object"===typeof a&&null!==a&&a.type===d&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case l:e:{for(var h=a.key,p=s;null!==p;){if(p.key===h){if((h=a.type)===d){if(7===p.tag){n(r,p.sibling),(s=i(p,a.props.children)).return=r,r=s;break e}}else if(p.elementType===h||"object"===typeof h&&null!==h&&h.$$typeof===y&&rr(h)===p.type){n(r,p.sibling),(s=i(p,a.props)).ref=tr(r,p,a),s.return=r,r=s;break e}n(r,p);break}t(r,p),p=p.sibling}a.type===d?((s=to(a.props.children,r.mode,u,a.key)).return=r,r=s):((u=eo(a.type,a.key,a.props,null,r.mode,u)).ref=tr(r,s,a),u.return=r,r=u)}return o(r);case c:e:{for(p=a.key;null!==s;){if(s.key===p){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=io(a,r.mode,u)).return=r,r=s}return o(r);case y:return e(r,s,(p=a._init)(a._payload),u)}if(P(a))return v(r,s,a,u);if(_(a))return b(r,s,a,u);nr(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=ro(a,r.mode,u)).return=r,r=s),o(r)):n(r,s)}}var sr=ir(!0),ar=ir(!1),or={},lr=at(or),cr=at(or),dr=at(or);function ur(e){if(e===or)throw Error(a(174));return e}function hr(e,t){lt(dr,t),lt(cr,e),lt(lr,or),e=R(t),ot(lr),lt(lr,e)}function pr(){ot(lr),ot(cr),ot(dr)}function mr(e){var t=ur(dr.current),n=ur(lr.current);n!==(t=I(n,e.type,t))&&(lt(cr,e),lt(lr,t))}function fr(e){cr.current===e&&(ot(lr),ot(cr))}var gr=at(0);function xr(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Fe(n)||Oe(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vr=[];function yr(){for(var e=0;e<vr.length;e++){var t=vr[e];X?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}vr.length=0}var br=o.ReactCurrentDispatcher,wr=o.ReactCurrentBatchConfig,_r=0,Sr=null,Nr=null,jr=null,Ar=!1,Mr=!1,Er=0,Cr=0;function kr(){throw Error(a(321))}function Tr(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Gt(e[n],t[n]))return!1;return!0}function Pr(e,t,n,r,i,s){if(_r=s,Sr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,br.current=null===e||null===e.memoizedState?mi:fi,e=n(r,i),Mr){s=0;do{if(Mr=!1,Er=0,25<=s)throw Error(a(301));s+=1,jr=Nr=null,t.updateQueue=null,br.current=gi,e=n(r,i)}while(Mr)}if(br.current=pi,t=null!==Nr&&null!==Nr.next,_r=0,jr=Nr=Sr=null,Ar=!1,t)throw Error(a(300));return e}function Lr(){var e=0!==Er;return Er=0,e}function Rr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===jr?Sr.memoizedState=jr=e:jr=jr.next=e,jr}function Ir(){if(null===Nr){var e=Sr.alternate;e=null!==e?e.memoizedState:null}else e=Nr.next;var t=null===jr?Sr.memoizedState:jr.next;if(null!==t)jr=t,Nr=e;else{if(null===e)throw Error(a(310));e={memoizedState:(Nr=e).memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},null===jr?Sr.memoizedState=jr=e:jr=jr.next=e}return jr}function Fr(e,t){return"function"===typeof t?t(e):t}function Or(e){var t=Ir(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=Nr,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var l=o=null,c=null,d=s;do{var u=d.lane;if((_r&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,Sr.lanes|=u,ta|=u}d=d.next}while(null!==d&&d!==s);null===c?o=r:c.next=l,Gt(r,t.memoizedState)||(Fi=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,Sr.lanes|=s,ta|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Dr(e){var t=Ir(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);Gt(s,t.memoizedState)||(Fi=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ur(){}function zr(e,t){var n=Sr,r=Ir(),i=t(),s=!Gt(r.memoizedState,i);if(s&&(r.memoizedState=i,Fi=!0),r=r.queue,Kr(Hr.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==jr&&1&jr.memoizedState.tag){if(n.flags|=2048,qr(9,Vr.bind(null,n,r,i,t),void 0,null),null===Ys)throw Error(a(349));0!==(30&_r)||Br(n,t,i)}return i}function Br(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Sr.updateQueue)?(t={lastEffect:null,stores:null},Sr.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Vr(e,t,n,r){t.value=n,t.getSnapshot=r,Wr(t)&&_a(e,1,-1)}function Hr(e,t,n){return n(function(){Wr(t)&&_a(e,1,-1)})}function Wr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Gt(e,n)}catch(r){return!0}}function Gr(e){var t=Rr();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fr,lastRenderedState:e},t.queue=e,e=e.dispatch=li.bind(null,Sr,e),[t.memoizedState,e]}function qr(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Sr.updateQueue)?(t={lastEffect:null,stores:null},Sr.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Xr(){return Ir().memoizedState}function Yr(e,t,n,r){var i=Rr();Sr.flags|=e,i.memoizedState=qr(1|t,n,void 0,void 0===r?null:r)}function Zr(e,t,n,r){var i=Ir();r=void 0===r?null:r;var s=void 0;if(null!==Nr){var a=Nr.memoizedState;if(s=a.destroy,null!==r&&Tr(r,a.deps))return void(i.memoizedState=qr(t,n,s,r))}Sr.flags|=e,i.memoizedState=qr(1|t,n,s,r)}function Jr(e,t){return Yr(8390656,8,e,t)}function Kr(e,t){return Zr(2048,8,e,t)}function Qr(e,t){return Zr(4,2,e,t)}function $r(e,t){return Zr(4,4,e,t)}function ei(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ti(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Zr(4,4,ei.bind(null,t,e),n)}function ni(){}function ri(e,t){var n=Ir();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Tr(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ii(e,t){var n=Ir();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Tr(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function si(e,t){var n=Pt;Pt=0!==n&&4>n?n:4,e(!0);var r=wr.transition;wr.transition={};try{e(!1),t()}finally{Pt=n,wr.transition=r}}function ai(){return Ir().memoizedState}function oi(e,t,n){var r=wa(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ci(e)?di(t,n):(ui(e,t,n),null!==(e=_a(e,r,n=ba()))&&hi(e,t,r))}function li(e,t,n){var r=wa(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ci(e))di(t,i);else{ui(e,t,i);var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,Gt(o,a))return}catch(l){}null!==(e=_a(e,r,n=ba()))&&hi(e,t,r)}}function ci(e){var t=e.alternate;return e===Sr||null!==t&&t===Sr}function di(e,t){Mr=Ar=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ui(e,t,n){null!==Ys&&0!==(1&e.mode)&&0===(2&Xs)?(null===(e=t.interleaved)?(n.next=n,null===hn?hn=[t]:hn.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function hi(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Tt(e,n)}}var pi={readContext:un,useCallback:kr,useContext:kr,useEffect:kr,useImperativeHandle:kr,useInsertionEffect:kr,useLayoutEffect:kr,useMemo:kr,useReducer:kr,useRef:kr,useState:kr,useDebugValue:kr,useDeferredValue:kr,useTransition:kr,useMutableSource:kr,useSyncExternalStore:kr,useId:kr,unstable_isNewReconciler:!1},mi={readContext:un,useCallback:function(e,t){return Rr().memoizedState=[e,void 0===t?null:t],e},useContext:un,useEffect:Jr,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Yr(4194308,4,ei.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Yr(4194308,4,e,t)},useInsertionEffect:function(e,t){return Yr(4,2,e,t)},useMemo:function(e,t){var n=Rr();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Rr();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=oi.bind(null,Sr,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Rr().memoizedState=e},useState:Gr,useDebugValue:ni,useDeferredValue:function(e){var t=Gr(e),n=t[0],r=t[1];return Jr(function(){var t=wr.transition;wr.transition={};try{r(e)}finally{wr.transition=t}},[e]),n},useTransition:function(){var e=Gr(!1),t=e[0];return e=si.bind(null,e[1]),Rr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Sr,i=Rr();if(Wn){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Ys)throw Error(a(349));0!==(30&_r)||Br(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Jr(Hr.bind(null,r,s,e),[e]),r.flags|=2048,qr(9,Vr.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Rr(),t=Ys.identifierPrefix;if(Wn){var n=On;t=":"+t+"R"+(n=(Fn&~(1<<32-bt(Fn)-1)).toString(32)+n),0<(n=Er++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Cr++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},fi={readContext:un,useCallback:ri,useContext:un,useEffect:Kr,useImperativeHandle:ti,useInsertionEffect:Qr,useLayoutEffect:$r,useMemo:ii,useReducer:Or,useRef:Xr,useState:function(){return Or(Fr)},useDebugValue:ni,useDeferredValue:function(e){var t=Or(Fr),n=t[0],r=t[1];return Kr(function(){var t=wr.transition;wr.transition={};try{r(e)}finally{wr.transition=t}},[e]),n},useTransition:function(){return[Or(Fr)[0],Ir().memoizedState]},useMutableSource:Ur,useSyncExternalStore:zr,useId:ai,unstable_isNewReconciler:!1},gi={readContext:un,useCallback:ri,useContext:un,useEffect:Kr,useImperativeHandle:ti,useInsertionEffect:Qr,useLayoutEffect:$r,useMemo:ii,useReducer:Dr,useRef:Xr,useState:function(){return Dr(Fr)},useDebugValue:ni,useDeferredValue:function(e){var t=Dr(Fr),n=t[0],r=t[1];return Kr(function(){var t=wr.transition;wr.transition={};try{r(e)}finally{wr.transition=t}},[e]),n},useTransition:function(){return[Dr(Fr)[0],Ir().memoizedState]},useMutableSource:Ur,useSyncExternalStore:zr,useId:ai,unstable_isNewReconciler:!1};function xi(e,t){try{var n="",r=t;do{n+=$t(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i}}function vi(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var yi,bi,wi,_i,Si="function"===typeof WeakMap?WeakMap:Map;function Ni(e,t,n){(n=gn(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){da||(da=!0,ua=r),vi(0,t)},n}function ji(e,t,n){(n=gn(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){vi(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){vi(0,t),"function"!==typeof r&&(null===ha?ha=new Set([this]):ha.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Ai(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Si;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Ga.bind(null,e,t,n),t.then(e,e))}function Mi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Ei(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=gn(-1,1)).tag=2,xn(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}function Ci(e){e.flags|=4}function ki(e,t){if(null!==e&&e.child===t.child)return!0;if(0!==(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!==(12854&e.flags)||0!==(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(Y)yi=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)U(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},bi=function(){},wi=function(e,t,n,r,i){if((e=e.memoizedProps)!==r){var s=t.stateNode,a=ur(lr.current);n=B(s,n,e,r,i,a),(t.updateQueue=n)&&Ci(t)}},_i=function(e,t,n,r){n!==r&&Ci(t)};else if(Z){yi=function(e,t,n,r){for(var i=t.child;null!==i;){if(5===i.tag){var s=i.stateNode;n&&r&&(s=Te(s,i.type,i.memoizedProps,i)),U(e,s)}else if(6===i.tag)s=i.stateNode,n&&r&&(s=Pe(s,i.memoizedProps,i)),U(e,s);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(s=i.child)&&(s.return=i),yi(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};var Ti=function(e,t,n,r){for(var i=t.child;null!==i;){if(5===i.tag){var s=i.stateNode;n&&r&&(s=Te(s,i.type,i.memoizedProps,i)),Ee(e,s)}else if(6===i.tag)s=i.stateNode,n&&r&&(s=Pe(s,i.memoizedProps,i)),Ee(e,s);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(s=i.child)&&(s.return=i),Ti(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};bi=function(e,t){var n=t.stateNode;if(!ki(e,t)){e=n.containerInfo;var r=Me(e);Ti(r,t,!1,!1),n.pendingChildren=r,Ci(t),Ce(e,r)}},wi=function(e,t,n,r,i){var s=e.stateNode,a=e.memoizedProps;if((e=ki(e,t))&&a===r)t.stateNode=s;else{var o=t.stateNode,l=ur(lr.current),c=null;a!==r&&(c=B(o,n,a,r,i,l)),e&&null===c?t.stateNode=s:(s=Ae(s,c,n,a,r,t,e,o),z(s,n,r,i,l)&&Ci(t),t.stateNode=s,e?Ci(t):yi(s,t,!1,!1))}},_i=function(e,t,n,r){n!==r?(e=ur(dr.current),n=ur(lr.current),t.stateNode=H(r,e,n,t),Ci(t)):t.stateNode=e.stateNode}}else bi=function(){},wi=function(){},_i=function(){};function Pi(e,t){if(!Wn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Li(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ri(e,t,n){var r=t.pendingProps;switch(Bn(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Li(t),null;case 1:case 17:return mt(t.type)&&ft(),Li(t),null;case 3:return r=t.stateNode,pr(),ot(ut),ot(dt),yr(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Qn(t)?Ci(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==qn&&(Ma(qn),qn=null))),bi(e,t),Li(t),null;case 5:fr(t),n=ur(dr.current);var i=t.type;if(null!==e&&null!=t.stateNode)wi(e,t,i,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Li(t),null}if(e=ur(lr.current),Qn(t)){if(!J)throw Error(a(175));e=He(t.stateNode,t.type,t.memoizedProps,n,e,t,!Gn),t.updateQueue=e,null!==e&&Ci(t)}else{var s=D(i,r,n,e,t);yi(s,t,!1,!1),t.stateNode=s,z(s,i,r,n,e)&&Ci(t)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Li(t),null;case 6:if(e&&null!=t.stateNode)_i(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(e=ur(dr.current),n=ur(lr.current),Qn(t)){if(!J)throw Error(a(176));if(e=t.stateNode,r=t.memoizedProps,(n=We(e,r,t,!Gn))&&null!==(i=Vn))switch(s=0!==(1&i.mode),i.tag){case 3:Qe(i.stateNode.containerInfo,e,r,s);break;case 5:$e(i.type,i.memoizedProps,i.stateNode,e,r,s)}n&&Ci(t)}else t.stateNode=H(r,e,n,t)}return Li(t),null;case 13:if(ot(gr),r=t.memoizedState,Wn&&null!==Hn&&0!==(1&t.mode)&&0===(128&t.flags)){for(e=Hn;e;)e=Ue(e);return $n(),t.flags|=98560,t}if(null!==r&&null!==r.dehydrated){if(r=Qn(t),null===e){if(!r)throw Error(a(318));if(!J)throw Error(a(344));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(317));Ge(e,t)}else $n(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return Li(t),null}return null!==qn&&(Ma(qn),qn=null),0!==(128&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?Qn(t):n=null!==e.memoizedState,r&&!n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&gr.current)?0===$s&&($s=3):Ia())),null!==t.updateQueue&&(t.flags|=4),Li(t),null);case 4:return pr(),bi(e,t),null===e&&Q(t.stateNode.containerInfo),Li(t),null;case 10:return ln(t.type._context),Li(t),null;case 19:if(ot(gr),null===(i=t.memoizedState))return Li(t),null;if(r=0!==(128&t.flags),null===(s=i.rendering))if(r)Pi(i,!1);else{if(0!==$s||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=xr(e))){for(t.flags|=128,Pi(i,!1),null!==(e=s.updateQueue)&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=n,r=t.child;null!==r;)i=e,(n=r).flags&=14680066,null===(s=n.alternate)?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,n.type=s.type,i=s.dependencies,n.dependencies=null===i?null:{lanes:i.lanes,firstContext:i.firstContext}),r=r.sibling;return lt(gr,1&gr.current|2),t.child}e=e.sibling}null!==i.tail&&Dt()>oa&&(t.flags|=128,r=!0,Pi(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=xr(s))){if(t.flags|=128,r=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),Pi(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!Wn)return Li(t),null}else 2*Dt()-i.renderingStartTime>oa&&1073741824!==n&&(t.flags|=128,r=!0,Pi(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Dt(),t.sibling=null,e=gr.current,lt(gr,r?1&e|2:1&e),t):(Li(t),null);case 22:case 23:return Ta(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ks)&&(Li(t),Y&&6&t.subtreeFlags&&(t.flags|=8192)):Li(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}var Ii=o.ReactCurrentOwner,Fi=!1;function Oi(e,t,n,r){t.child=null===e?ar(t,null,n,r):sr(t,e.child,n,r)}function Di(e,t,n,r,i){n=n.render;var s=t.ref;return dn(t,i),r=Pr(e,t,n,r,s,i),n=Lr(),null===e||Fi?(Wn&&n&&zn(t),t.flags|=1,Oi(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,is(e,t,i))}function Ui(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Qa(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=eo(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,zi(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:Qt)(a,r)&&e.ref===t.ref)return is(e,t,i)}return t.flags|=1,(e=$a(s,r)).ref=t.ref,e.return=t,t.child=e}function zi(e,t,n,r,i){if(null!==e&&Qt(e.memoizedProps,r)&&e.ref===t.ref){if(Fi=!1,0===(e.lanes&i))return t.lanes=e.lanes,is(e,t,i);0!==(131072&e.flags)&&(Fi=!0)}return Hi(e,t,n,r,i)}function Bi(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},lt(Qs,Ks),Ks|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,lt(Qs,Ks),Ks|=e,null;t.memoizedState={baseLanes:0,cachePool:null},r=null!==s?s.baseLanes:n,lt(Qs,Ks),Ks|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,lt(Qs,Ks),Ks|=r;return Oi(e,t,i,n),t.child}function Vi(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Hi(e,t,n,r,i){var s=mt(n)?ht:dt.current;return s=pt(t,s),dn(t,i),n=Pr(e,t,n,r,s,i),r=Lr(),null===e||Fi?(Wn&&r&&zn(t),t.flags|=1,Oi(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,is(e,t,i))}function Wi(e,t,n,r,i){if(mt(n)){var s=!0;vt(t)}else s=!1;if(dn(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),An(t,n,r),En(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=un(c):c=pt(t,c=mt(n)?ht:dt.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate;u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&Mn(t,a,r,c),pn=!1;var h=t.memoizedState;a.state=h,bn(t,r,a,i),l=t.memoizedState,o!==r||h!==l||ut.current||pn?("function"===typeof d&&(Sn(t,n,d,r),l=t.memoizedState),(o=pn||jn(t,n,o,r,h,l,c))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,fn(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:en(t.type,o),a.props=c,u=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=un(l):l=pt(t,l=mt(n)?ht:dt.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==u||h!==l)&&Mn(t,a,r,l),pn=!1,h=t.memoizedState,a.state=h,bn(t,r,a,i);var m=t.memoizedState;o!==u||h!==m||ut.current||pn?("function"===typeof p&&(Sn(t,n,p,r),m=t.memoizedState),(c=pn||jn(t,n,c,r,h,m,l)||!1)?(d||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,m,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),a.props=r,a.state=m,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Gi(e,t,n,r,s,i)}function Gi(e,t,n,r,i,s){Vi(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&yt(t,n,!1),is(e,t,s);r=t.stateNode,Ii.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=sr(t,e.child,null,s),t.child=sr(t,null,o,s)):Oi(e,t,o,s),t.memoizedState=r.state,i&&yt(t,n,!0),t.child}function qi(e){var t=e.stateNode;t.pendingContext?gt(0,t.pendingContext,t.pendingContext!==t.context):t.context&&gt(0,t.context,!1),hr(e,t.containerInfo)}function Xi(e,t,n,r,i){return $n(),er(i),t.flags|=256,Oi(e,t,n,r),t.child}var Yi={dehydrated:null,treeContext:null,retryLane:0};function Zi(e){return{baseLanes:e,cachePool:null}}function Ji(e,t,n){var r,i=t.pendingProps,s=gr.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),lt(gr,1&s),null===e)return Jn(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:Oe(e)?t.lanes=8:t.lanes=1073741824,null):(s=i.children,e=i.fallback,o?(i=t.mode,o=t.child,s={mode:"hidden",children:s},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=s):o=no(s,i,0,null),e=to(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Zi(n),t.memoizedState=Yi,e):Ki(t,s));if(null!==(s=e.memoizedState)){if(null!==(r=s.dehydrated)){if(l)return 256&t.flags?(t.flags&=-257,es(e,t,n,Error(a(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,s=t.mode,i=no({mode:"visible",children:i.children},s,0,null),(o=to(o,s,n,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&sr(t,e.child,null,n),t.child.memoizedState=Zi(n),t.memoizedState=Yi,o);if(0===(1&t.mode))t=es(e,t,n,null);else if(Oe(r))t=es(e,t,n,Error(a(419)));else if(i=0!==(n&e.childLanes),Fi||i){if(null!==(i=Ys)){switch(n&-n){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(i=0!==(o&(i.suspendedLanes|n))?0:o)&&i!==s.retryLane&&(s.retryLane=i,_a(e,i,-1))}Ia(),t=es(e,t,n,Error(a(421)))}else Fe(r)?(t.flags|=128,t.child=e.child,t=Xa.bind(null,e),De(r,t),t=null):(n=s.treeContext,J&&(Hn=Ve(r),Vn=t,Wn=!0,qn=null,Gn=!1,null!==n&&(Ln[Rn++]=Fn,Ln[Rn++]=On,Ln[Rn++]=In,Fn=n.id,On=n.overflow,In=t)),(t=Ki(t,t.pendingProps.children)).flags|=4096);return t}return o?(i=$i(e,t,i.children,i.fallback,n),o=t.child,s=e.child.memoizedState,o.memoizedState=null===s?Zi(n):{baseLanes:s.baseLanes|n,cachePool:null},o.childLanes=e.childLanes&~n,t.memoizedState=Yi,i):(n=Qi(e,t,i.children,n),t.memoizedState=null,n)}return o?(i=$i(e,t,i.children,i.fallback,n),o=t.child,s=e.child.memoizedState,o.memoizedState=null===s?Zi(n):{baseLanes:s.baseLanes|n,cachePool:null},o.childLanes=e.childLanes&~n,t.memoizedState=Yi,i):(n=Qi(e,t,i.children,n),t.memoizedState=null,n)}function Ki(e,t){return(t=no({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Qi(e,t,n,r){var i=e.child;return e=i.sibling,n=$a(i,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n}function $i(e,t,n,r,i){var s=t.mode,a=(e=e.child).sibling,o={mode:"hidden",children:n};return 0===(1&s)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=o,t.deletions=null):(n=$a(e,o)).subtreeFlags=14680064&e.subtreeFlags,null!==a?r=$a(a,r):(r=to(r,s,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function es(e,t,n,r){return null!==r&&er(r),sr(t,e.child,null,n),(e=Ki(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ts(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),cn(e.return,t,n)}function ns(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function rs(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Oi(e,t,r.children,n),0!==(2&(r=gr.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ts(e,n,t);else if(19===e.tag)ts(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(lt(gr,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===xr(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),ns(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===xr(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}ns(t,!0,n,null,s);break;case"together":ns(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function is(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),ta|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=$a(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=$a(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ss(e,t){switch(Bn(t),t.tag){case 1:return mt(t.type)&&ft(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return pr(),ot(ut),ot(dt),yr(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return fr(t),null;case 13:if(ot(gr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));$n()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ot(gr),null;case 4:return pr(),null;case 10:return ln(t.type._context),null;case 22:case 23:return Ta(),null;default:return null}}var as=!1,os=!1,ls="function"===typeof WeakSet?WeakSet:Set,cs=null;function ds(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Wa(e,t,r)}else n.current=null}function us(e,t,n){try{n()}catch(r){Wa(e,t,r)}}var hs=!1;function ps(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&us(t,n,s)}i=i.next}while(i!==r)}}function ms(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function fs(e){var t=e.ref;if(null!==t){var n=e.stateNode;if(5===e.tag)e=L(n);else e=n;"function"===typeof t?t(e):t.current=e}}function gs(e,t,n){if(Wt&&"function"===typeof Wt.onCommitFiberUnmount)try{Wt.onCommitFiberUnmount(Ht,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e=e.next;do{var i=r,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&us(t,n,s),r=r.next}while(r!==e)}break;case 1:if(ds(t,n),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){Wa(t,n,a)}break;case 5:ds(t,n);break;case 4:Y?Ns(e,t,n):Z&&Z&&(t=t.stateNode.containerInfo,n=Me(t),ke(t,n))}}function xs(e,t,n){for(var r=t;;)if(gs(e,r,n),null===r.child||Y&&4===r.tag){if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}else r.child.return=r,r=r.child}function vs(e){var t=e.alternate;null!==t&&(e.alternate=null,vs(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ee(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ys(e){return 5===e.tag||3===e.tag||4===e.tag}function bs(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ys(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ws(e){if(Y){e:{for(var t=e.return;null!==t;){if(ys(t))break e;t=t.return}throw Error(a(160))}var n=t;switch(n.tag){case 5:t=n.stateNode,32&n.flags&&(be(t),n.flags&=-33),Ss(e,n=bs(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,_s(e,n=bs(e),t);break;default:throw Error(a(161))}}}function _s(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?xe(n,e,t):he(n,e);else if(4!==r&&null!==(e=e.child))for(_s(e,t,n),e=e.sibling;null!==e;)_s(e,t,n),e=e.sibling}function Ss(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?ge(n,e,t):ue(n,e);else if(4!==r&&null!==(e=e.child))for(Ss(e,t,n),e=e.sibling;null!==e;)Ss(e,t,n),e=e.sibling}function Ns(e,t,n){for(var r,i,s=t,o=!1;;){if(!o){o=s.return;e:for(;;){if(null===o)throw Error(a(160));switch(r=o.stateNode,o.tag){case 5:i=!1;break e;case 3:case 4:r=r.containerInfo,i=!0;break e}o=o.return}o=!0}if(5===s.tag||6===s.tag)xs(e,s,n),i?ye(r,s.stateNode):ve(r,s.stateNode);else if(18===s.tag)i?Je(r,s.stateNode):Ze(r,s.stateNode);else if(4===s.tag){if(null!==s.child){r=s.stateNode.containerInfo,i=!0,s.child.return=s,s=s.child;continue}}else if(gs(e,s,n),null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;4===(s=s.return).tag&&(o=!1)}s.sibling.return=s.return,s=s.sibling}}function js(e,t){if(Y){switch(t.tag){case 0:case 11:case 14:case 15:return ps(3,t,t.return),ms(3,t),void ps(5,t,t.return);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps;e=null!==e?e.memoizedProps:r;var i=t.type,s=t.updateQueue;t.updateQueue=null,null!==s&&fe(n,s,i,e,r,t)}return;case 6:if(null===t.stateNode)throw Error(a(162));return n=t.memoizedProps,void pe(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(J&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo));case 13:case 19:return void As(t)}throw Error(a(163))}switch(t.tag){case 0:case 11:case 14:case 15:return ps(3,t,t.return),ms(3,t),void ps(5,t,t.return);case 12:case 22:case 23:return;case 13:case 19:return void As(t);case 3:J&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo)}e:if(Z){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:t=t.stateNode,ke(t.containerInfo,t.pendingChildren);break e}throw Error(a(163))}}function As(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ls),t.forEach(function(t){var r=Ya.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function Ms(e,t,n){cs=e,Es(e,t,n)}function Es(e,t,n){for(var r=0!==(1&e.mode);null!==cs;){var i=cs,s=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||as;if(!a){var o=i.alternate,l=null!==o&&null!==o.memoizedState||os;o=as;var c=os;if(as=a,(os=l)&&!c)for(cs=i;null!==cs;)l=(a=cs).child,22===a.tag&&null!==a.memoizedState?Ts(i):null!==l?(l.return=a,cs=l):Ts(i);for(;null!==s;)cs=s,Es(s,t,n),s=s.sibling;cs=i,as=o,os=c}Cs(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,cs=s):Cs(e)}}function Cs(e){for(;null!==cs;){var t=cs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:os||ms(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!os)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:en(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&wn(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:n=L(t.child.stateNode);break;case 1:n=t.child.stateNode}wn(t,o,n)}break;case 5:var l=t.stateNode;null===n&&4&t.flags&&me(l,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(J&&null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var u=d.dehydrated;null!==u&&Ye(u)}}}break;default:throw Error(a(163))}os||512&t.flags&&fs(t)}catch(h){Wa(t,t.return,h)}}if(t===e){cs=null;break}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}function ks(e){for(;null!==cs;){var t=cs;if(t===e){cs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,cs=n;break}cs=t.return}}function Ts(e){for(;null!==cs;){var t=cs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ms(4,t)}catch(l){Wa(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Wa(t,i,l)}}var s=t.return;try{fs(t)}catch(l){Wa(t,s,l)}break;case 5:var a=t.return;try{fs(t)}catch(l){Wa(t,a,l)}}}catch(l){Wa(t,t.return,l)}if(t===e){cs=null;break}var o=t.sibling;if(null!==o){o.return=t.return,cs=o;break}cs=t.return}}var Ps=0,Ls=1,Rs=2,Is=3,Fs=4;if("function"===typeof Symbol&&Symbol.for){var Os=Symbol.for;Ps=Os("selector.component"),Ls=Os("selector.has_pseudo_class"),Rs=Os("selector.role"),Is=Os("selector.test_id"),Fs=Os("selector.text")}function Ds(e){var t=K(e);if(null!=t){if("string"!==typeof t.memoizedProps["data-testname"])throw Error(a(364));return t}if(null===(e=ie(e)))throw Error(a(362));return e.stateNode.current}function Us(e,t){switch(t.$$typeof){case Ps:if(e.type===t.value)return!0;break;case Ls:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var r=e[n++],i=e[n++],s=t[i];if(5!==r.tag||!oe(r)){for(;null!=s&&Us(r,s);)s=t[++i];if(i===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,i),r=r.sibling}}t=!1}return t;case Rs:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case Fs:if((5===e.tag||6===e.tag)&&(null!==(e=ae(e))&&0<=e.indexOf(t.value)))return!0;break;case Is:if(5===e.tag&&("string"===typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function zs(e){switch(e.$$typeof){case Ps:return"<"+(S(e.value)||"Unknown")+">";case Ls:return":has("+(zs(e)||"")+")";case Rs:return'[role="'+e.value+'"]';case Fs:return'"'+e.value+'"';case Is:return'[data-testname="'+e.value+'"]';default:throw Error(a(365))}}function Bs(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var i=e[r++],s=e[r++],a=t[s];if(5!==i.tag||!oe(i)){for(;null!=a&&Us(i,a);)a=t[++s];if(s===t.length)n.push(i);else for(i=i.child;null!==i;)e.push(i,s),i=i.sibling}}return n}function Vs(e,t){if(!re)throw Error(a(363));e=Bs(e=Ds(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++];if(5===r.tag)oe(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}var Hs=Math.ceil,Ws=o.ReactCurrentDispatcher,Gs=o.ReactCurrentOwner,qs=o.ReactCurrentBatchConfig,Xs=0,Ys=null,Zs=null,Js=0,Ks=0,Qs=at(0),$s=0,ea=null,ta=0,na=0,ra=0,ia=null,sa=null,aa=0,oa=1/0;function la(){oa=Dt()+500}var ca,da=!1,ua=null,ha=null,pa=!1,ma=null,fa=0,ga=0,xa=null,va=-1,ya=0;function ba(){return 0!==(6&Xs)?Dt():-1!==va?va:va=Dt()}function wa(e){return 0===(1&e.mode)?1:0!==(2&Xs)&&0!==Js?Js&-Js:null!==Kt.transition?(0===ya&&(e=St,0===(4194240&(St<<=1))&&(St=64),ya=e),ya):0!==(e=Pt)?e:$()}function _a(e,t,n){if(50<ga)throw ga=0,xa=null,Error(a(185));var r=Sa(e,t);return null===r?null:(kt(r,t,n),0!==(2&Xs)&&r===Ys||(r===Ys&&(0===(2&Xs)&&(na|=t),4===$s&&Ea(r,Js)),Na(r,n),1===t&&0===Xs&&0===(1&e.mode)&&(la(),Xt&&Jt())),r)}function Sa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Na(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-bt(s),o=1<<a,l=i[a];-1===l?0!==(o&n)&&0===(o&r)||(i[a]=Mt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var r=At(e,e===Ys?Js:0);if(0===r)null!==n&&It(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&It(n),1===t)0===e.tag?function(e){Xt=!0,Zt(e)}(Ca.bind(null,e)):Zt(Ca.bind(null,e)),te?ne(function(){0===Xs&&Jt()}):Rt(Ut,Jt),n=null;else{switch(Lt(r)){case 1:n=Ut;break;case 4:n=zt;break;case 16:default:n=Bt;break;case 536870912:n=Vt}n=Za(n,ja.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ja(e,t){if(va=-1,ya=0,0!==(6&Xs))throw Error(a(327));var n=e.callbackNode;if(Va()&&e.callbackNode!==n)return null;var r=At(e,e===Ys?Js:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=Fa(e,r);else{t=r;var i=Xs;Xs|=2;var s=Ra();for(Ys===e&&Js===t||(la(),Pa(e,t));;)try{Da();break}catch(l){La(e,l)}an(),Ws.current=s,Xs=i,null!==Zs?t=0:(Ys=null,Js=0,t=$s)}if(0!==t){if(2===t&&(0!==(i=Et(e))&&(r=i,t=Aa(e,i))),1===t)throw n=ea,Pa(e,0),Ea(e,r),Na(e,Dt()),n;if(6===t)Ea(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Gt(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=Fa(e,r))&&(0!==(s=Et(e))&&(r=s,t=Aa(e,s))),1===t))throw n=ea,Pa(e,0),Ea(e,r),Na(e,Dt()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:Ba(e,sa);break;case 3:if(Ea(e,r),(130023424&r)===r&&10<(t=aa+500-Dt())){if(0!==At(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ba(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=W(Ba.bind(null,e,sa),t);break}Ba(e,sa);break;case 4:if(Ea(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-bt(r);s=1<<o,(o=t[o])>i&&(i=o),r&=~s}if(r=i,10<(r=(120>(r=Dt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Hs(r/1960))-r)){e.timeoutHandle=W(Ba.bind(null,e,sa),r);break}Ba(e,sa);break;default:throw Error(a(329))}}}return Na(e,Dt()),e.callbackNode===n?ja.bind(null,e):null}function Aa(e,t){var n=ia;return e.current.memoizedState.isDehydrated&&(Pa(e,t).flags|=256),2!==(e=Fa(e,t))&&(t=sa,sa=n,null!==t&&Ma(t)),e}function Ma(e){null===sa?sa=e:sa.push.apply(sa,e)}function Ea(e,t){for(t&=~ra,t&=~na,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-bt(t),r=1<<n;e[n]=-1,t&=~r}}function Ca(e){if(0!==(6&Xs))throw Error(a(327));Va();var t=At(e,0);if(0===(1&t))return Na(e,Dt()),null;var n=Fa(e,t);if(0!==e.tag&&2===n){var r=Et(e);0!==r&&(t=r,n=Aa(e,r))}if(1===n)throw n=ea,Pa(e,0),Ea(e,t),Na(e,Dt()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ba(e,sa),Na(e,Dt()),null}function ka(e){null!==ma&&0===ma.tag&&0===(6&Xs)&&Va();var t=Xs;Xs|=1;var n=qs.transition,r=Pt;try{if(qs.transition=null,Pt=1,e)return e()}finally{Pt=r,qs.transition=n,0===(6&(Xs=t))&&Jt()}}function Ta(){Ks=Qs.current,ot(Qs)}function Pa(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==q&&(e.timeoutHandle=q,G(n)),null!==Zs)for(n=Zs.return;null!==n;){var r=n;switch(Bn(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&ft();break;case 3:pr(),ot(ut),ot(dt),yr();break;case 5:fr(r);break;case 4:pr();break;case 13:case 19:ot(gr);break;case 10:ln(r.type._context);break;case 22:case 23:Ta()}n=n.return}if(Ys=e,Zs=e=$a(e.current,null),Js=Ks=t,$s=0,ea=null,ra=na=ta=0,sa=ia=null,null!==hn){for(t=0;t<hn.length;t++)if(null!==(r=(n=hn[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var a=s.next;s.next=i,r.next=a}n.pending=r}hn=null}return e}function La(e,t){for(;;){var n=Zs;try{if(an(),br.current=pi,Ar){for(var r=Sr.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}Ar=!1}if(_r=0,jr=Nr=Sr=null,Mr=!1,Er=0,Gs.current=null,null===n||null===n.return){$s=1,ea=t,Zs=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Js,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=Mi(o);if(null!==m){m.flags&=-257,Ei(m,o,l,0,t),1&m.mode&&Ai(s,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){Ai(s,d,t),Ia();break e}c=Error(a(426))}else if(Wn&&1&l.mode){var x=Mi(o);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),Ei(x,o,l,0,t),er(c);break e}}s=c,4!==$s&&($s=2),null===ia?ia=[s]:ia.push(s),c=xi(c,l),l=o;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,yn(l,Ni(0,c,t));break e;case 1:s=c;var v=l.type,y=l.stateNode;if(0===(128&l.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===ha||!ha.has(y)))){l.flags|=65536,t&=-t,l.lanes|=t,yn(l,ji(l,s,t));break e}}l=l.return}while(null!==l)}za(n)}catch(b){t=b,Zs===n&&null!==n&&(Zs=n=n.return);continue}break}}function Ra(){var e=Ws.current;return Ws.current=pi,null===e?pi:e}function Ia(){0!==$s&&3!==$s&&2!==$s||($s=4),null===Ys||0===(268435455&ta)&&0===(268435455&na)||Ea(Ys,Js)}function Fa(e,t){var n=Xs;Xs|=2;var r=Ra();for(Ys===e&&Js===t||Pa(e,t);;)try{Oa();break}catch(i){La(e,i)}if(an(),Xs=n,Ws.current=r,null!==Zs)throw Error(a(261));return Ys=null,Js=0,$s}function Oa(){for(;null!==Zs;)Ua(Zs)}function Da(){for(;null!==Zs&&!Ft();)Ua(Zs)}function Ua(e){var t=ca(e.alternate,e,Ks);e.memoizedProps=e.pendingProps,null===t?za(e):Zs=t,Gs.current=null}function za(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ri(n,t,Ks)))return void(Zs=n)}else{if(null!==(n=ss(n,t)))return n.flags&=32767,void(Zs=n);if(null===e)return $s=6,void(Zs=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Zs=t);Zs=t=e}while(null!==t);0===$s&&($s=5)}function Ba(e,t){var n=Pt,r=qs.transition;try{qs.transition=null,Pt=1,function(e,t,n){do{Va()}while(null!==ma);if(0!==(6&Xs))throw Error(a(327));var r=e.finishedWork,i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-bt(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,s),e===Ys&&(Zs=Ys=null,Js=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||pa||(pa=!0,Za(Bt,function(){return Va(),null})),s=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||s){s=qs.transition,qs.transition=null;var o=Pt;Pt=1;var l=Xs;Xs|=4,Gs.current=null,function(e,t){for(F(e.containerInfo),cs=t;null!==cs;)if(t=(e=cs).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,cs=t;else for(;null!==cs;){e=cs;try{var n=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==n){var r=n.memoizedProps,i=n.memoizedState,s=e.stateNode,o=s.getSnapshotBeforeUpdate(e.elementType===e.type?r:en(e.type,r),i);s.__reactInternalSnapshotBeforeUpdate=o}break;case 3:Y&&je(e.stateNode.containerInfo);break;default:throw Error(a(163))}}catch(l){Wa(e,e.return,l)}if(null!==(t=e.sibling)){t.return=e.return,cs=t;break}cs=e.return}n=hs,hs=!1}(e,r),function(e,t){for(cs=t;null!==cs;){var n=(t=cs).deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e;Y?Ns(s,i,t):xs(s,i,t);var a=i.alternate;null!==a&&(a.return=null),i.return=null}catch(w){Wa(i,t,w)}}if(n=t.child,0!==(12854&t.subtreeFlags)&&null!==n)n.return=t,cs=n;else for(;null!==cs;){t=cs;try{var o=t.flags;if(32&o&&Y&&be(t.stateNode),512&o){var l=t.alternate;if(null!==l){var c=l.ref;null!==c&&("function"===typeof c?c(null):c.current=null)}}if(8192&o)switch(t.tag){case 13:if(null!==t.memoizedState){var d=t.alternate;null!==d&&null!==d.memoizedState||(aa=Dt())}break;case 22:var u=null!==t.memoizedState,h=t.alternate,p=null!==h&&null!==h.memoizedState;if(n=t,Y)e:if(r=n,i=u,s=null,Y)for(var m=r;;){if(5===m.tag){if(null===s){s=m;var f=m.stateNode;i?we(f):Se(m.stateNode,m.memoizedProps)}}else if(6===m.tag){if(null===s){var g=m.stateNode;i?_e(g):Ne(g,m.memoizedProps)}}else if((22!==m.tag&&23!==m.tag||null===m.memoizedState||m===r)&&null!==m.child){m.child.return=m,m=m.child;continue}if(m===r)break;for(;null===m.sibling;){if(null===m.return||m.return===r)break e;s===m&&(s=null),m=m.return}s===m&&(s=null),m.sibling.return=m.return,m=m.sibling}if(u&&!p&&0!==(1&n.mode)){cs=n;for(var x=n.child;null!==x;){for(n=cs=x;null!==cs;){var v=(r=cs).child;switch(r.tag){case 0:case 11:case 14:case 15:ps(4,r,r.return);break;case 1:ds(r,r.return);var y=r.stateNode;if("function"===typeof y.componentWillUnmount){var b=r.return;try{y.props=r.memoizedProps,y.state=r.memoizedState,y.componentWillUnmount()}catch(w){Wa(r,b,w)}}break;case 5:ds(r,r.return);break;case 22:if(null!==r.memoizedState){ks(n);continue}}null!==v?(v.return=r,cs=v):ks(n)}x=x.sibling}}}switch(4102&o){case 2:ws(t),t.flags&=-3;break;case 6:ws(t),t.flags&=-3,js(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,js(t.alternate,t);break;case 4:js(t.alternate,t)}}catch(w){Wa(t,t.return,w)}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}}(e,r),O(e.containerInfo),e.current=r,Ms(r,e,i),Ot(),Xs=l,Pt=o,qs.transition=s}else e.current=r;if(pa&&(pa=!1,ma=e,fa=i),s=e.pendingLanes,0===s&&(ha=null),function(e){if(Wt&&"function"===typeof Wt.onCommitFiberRoot)try{Wt.onCommitFiberRoot(Ht,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),Na(e,Dt()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n(t[r]);if(da)throw da=!1,e=ua,ua=null,e;0!==(1&fa)&&0!==e.tag&&Va(),s=e.pendingLanes,0!==(1&s)?e===xa?ga++:(ga=0,xa=e):ga=0,Jt()}(e,t,n)}finally{qs.transition=r,Pt=n}return null}function Va(){if(null!==ma){var e=Lt(fa),t=qs.transition,n=Pt;try{if(qs.transition=null,Pt=16>e?16:e,null===ma)var r=!1;else{if(e=ma,ma=null,fa=0,0!==(6&Xs))throw Error(a(331));var i=Xs;for(Xs|=4,cs=e.current;null!==cs;){var s=cs,o=s.child;if(0!==(16&cs.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(cs=d;null!==cs;){var u=cs;switch(u.tag){case 0:case 11:case 15:ps(8,u,s)}var h=u.child;if(null!==h)h.return=u,cs=h;else for(;null!==cs;){var p=(u=cs).sibling,m=u.return;if(vs(u),u===d){cs=null;break}if(null!==p){p.return=m,cs=p;break}cs=m}}}var f=s.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(null!==g)}}cs=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,cs=o;else e:for(;null!==cs;){if(0!==(2048&(s=cs).flags))switch(s.tag){case 0:case 11:case 15:ps(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,cs=v;break e}cs=s.return}}var y=e.current;for(cs=y;null!==cs;){var b=(o=cs).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,cs=b;else e:for(o=y;null!==cs;){if(0!==(2048&(l=cs).flags))try{switch(l.tag){case 0:case 11:case 15:ms(9,l)}}catch(_){Wa(l,l.return,_)}if(l===o){cs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,cs=w;break e}cs=l.return}}if(Xs=i,Jt(),Wt&&"function"===typeof Wt.onPostCommitFiberRoot)try{Wt.onPostCommitFiberRoot(Ht,e)}catch(_){}r=!0}return r}finally{Pt=n,qs.transition=t}}return!1}function Ha(e,t,n){xn(e,t=Ni(0,t=xi(n,t),1)),t=ba(),null!==(e=Sa(e,1))&&(kt(e,1,t),Na(e,t))}function Wa(e,t,n){if(3===e.tag)Ha(e,e,n);else for(;null!==t;){if(3===t.tag){Ha(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===ha||!ha.has(r))){xn(t,e=ji(t,e=xi(n,e),1)),e=ba(),null!==(t=Sa(t,1))&&(kt(t,1,e),Na(t,e));break}}t=t.return}}function Ga(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ba(),e.pingedLanes|=e.suspendedLanes&n,Ys===e&&(Js&n)===n&&(4===$s||3===$s&&(130023424&Js)===Js&&500>Dt()-aa?Pa(e,0):ra|=n),Na(e,t)}function qa(e,t){0===t&&(0===(1&e.mode)?t=1:(t=Nt,0===(130023424&(Nt<<=1))&&(Nt=4194304)));var n=ba();null!==(e=Sa(e,t))&&(kt(e,t,n),Na(e,n))}function Xa(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),qa(e,n)}function Ya(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),qa(e,n)}function Za(e,t){return Rt(e,t)}function Ja(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ka(e,t,n,r){return new Ja(e,t,n,r)}function Qa(e){return!(!(e=e.prototype)||!e.isReactComponent)}function $a(e,t){var n=e.alternate;return null===n?((n=Ka(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function eo(e,t,n,r,i,s){var o=2;if(r=e,"function"===typeof e)Qa(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case d:return to(n.children,i,s,t);case u:o=8,i|=8;break;case h:return(e=Ka(12,n,t,2|i)).elementType=h,e.lanes=s,e;case g:return(e=Ka(13,n,t,i)).elementType=g,e.lanes=s,e;case x:return(e=Ka(19,n,t,i)).elementType=x,e.lanes=s,e;case b:return no(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case p:o=10;break e;case m:o=9;break e;case f:o=11;break e;case v:o=14;break e;case y:o=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ka(o,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function to(e,t,n,r){return(e=Ka(7,e,r,t)).lanes=n,e}function no(e,t,n,r){return(e=Ka(22,e,r,t)).elementType=b,e.lanes=n,e.stateNode={},e}function ro(e,t,n){return(e=Ka(6,e,null,t)).lanes=n,e}function io(e,t,n){return(t=Ka(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function so(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=q,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ct(0),this.expirationTimes=Ct(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ct(0),this.identifierPrefix=r,this.onRecoverableError=i,J&&(this.mutableSourceEagerHydrationData=null)}function ao(e,t,n,r,i,s,a,o,l){return e=new so(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ka(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null},mn(s),e}function oo(e){if(!e)return ct;e:{if(j(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(mt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(mt(n))return xt(e,n,t)}return t}function lo(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return null===(e=E(t))?null:e.stateNode}function co(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function uo(e,t){co(e,t),(e=e.alternate)&&co(e,t)}function ho(e){return null===(e=E(e))?null:e.stateNode}function po(){return null}return ca=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ut.current)Fi=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Fi=!1,function(e,t,n){switch(t.tag){case 3:qi(t),$n();break;case 5:mr(t);break;case 1:mt(t.type)&&vt(t);break;case 4:hr(t,t.stateNode.containerInfo);break;case 10:on(0,t.type._context,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(lt(gr,1&gr.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ji(e,t,n):(lt(gr,1&gr.current),null!==(e=is(e,t,n))?e.sibling:null);lt(gr,1&gr.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return rs(e,t,n);t.flags|=128}var i=t.memoizedState;if(null!==i&&(i.rendering=null,i.tail=null,i.lastEffect=null),lt(gr,gr.current),r)break;return null;case 22:case 23:return t.lanes=0,Bi(e,t,n)}return is(e,t,n)}(e,t,n);Fi=0!==(131072&e.flags)}else Fi=!1,Wn&&0!==(1048576&t.flags)&&Un(t,Pn,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var i=pt(t,dt.current);dn(t,n),i=Pr(null,t,r,e,i,n);var s=Lr();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,mt(r)?(s=!0,vt(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,mn(t),i.updater=Nn,t.stateNode=i,i._reactInternals=t,En(t,r,e,n),t=Gi(null,t,r,!0,s,n)):(t.tag=0,Wn&&s&&zn(t),Oi(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Qa(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===f)return 11;if(e===v)return 14}return 2}(r),e=en(r,e),i){case 0:t=Hi(null,t,r,e,n);break e;case 1:t=Wi(null,t,r,e,n);break e;case 11:t=Di(null,t,r,e,n);break e;case 14:t=Ui(null,t,r,en(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Hi(e,t,r,i=t.elementType===r?i:en(r,i),n);case 1:return r=t.type,i=t.pendingProps,Wi(e,t,r,i=t.elementType===r?i:en(r,i),n);case 3:e:{if(qi(t),null===e)throw Error(a(387));r=t.pendingProps,i=(s=t.memoizedState).element,fn(e,t),bn(t,r,null,n);var o=t.memoizedState;if(r=o.element,J&&s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Xi(e,t,r,n,i=Error(a(423)));break e}if(r!==i){t=Xi(e,t,r,n,i=Error(a(424)));break e}for(J&&(Hn=Be(t.stateNode.containerInfo),Vn=t,Wn=!0,qn=null,Gn=!1),n=ar(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if($n(),r===i){t=is(e,t,n);break e}Oi(e,t,r,n)}t=t.child}return t;case 5:return mr(t),null===e&&Jn(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,V(r,i)?o=null:null!==s&&V(r,s)&&(t.flags|=32),Vi(e,t),Oi(e,t,o,n),t.child;case 6:return null===e&&Jn(t),null;case 13:return Ji(e,t,n);case 4:return hr(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=sr(t,null,r,n):Oi(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Di(e,t,r,i=t.elementType===r?i:en(r,i),n);case 7:return Oi(e,t,t.pendingProps,n),t.child;case 8:case 12:return Oi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,on(0,r,o=i.value),null!==s)if(Gt(s.value,o)){if(s.children===i.children&&!ut.current){t=is(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=gn(-1,n&-n)).tag=2;var d=s.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),cn(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),cn(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}Oi(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,dn(t,n),r=r(i=un(i)),t.flags|=1,Oi(e,t,r,n),t.child;case 14:return i=en(r=t.type,t.pendingProps),Ui(e,t,r,i=en(r.type,i),n);case 15:return zi(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:en(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,mt(r)?(e=!0,vt(t)):e=!1,dn(t,n),An(t,r,i),En(t,r,i,n),Gi(null,t,r,!0,e,n);case 19:return rs(e,t,n);case 22:return Bi(e,t,n)}throw Error(a(156,t.tag))},t.attemptContinuousHydration=function(e){13===e.tag&&(_a(e,134217728,ba()),uo(e,134217728))},t.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=ba(),n=wa(e);_a(e,n,t),uo(e,n)}},t.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=jt(t.pendingLanes);0!==n&&(Tt(t,1|n),Na(t,Dt()),0===(6&Xs)&&(la(),Jt()))}break;case 13:var r=ba();ka(function(){return _a(e,1,r)}),uo(e,1)}},t.batchedUpdates=function(e,t){var n=Xs;Xs|=1;try{return e(t)}finally{0===(Xs=n)&&(la(),Xt&&Jt())}},t.createComponentSelector=function(e){return{$$typeof:Ps,value:e}},t.createContainer=function(e,t,n,r,i,s,a){return ao(e,t,!1,null,0,r,0,s,a)},t.createHasPseudoClassSelector=function(e){return{$$typeof:Ls,value:e}},t.createHydrationContainer=function(e,t,n,r,i,s,a,o,l){return(e=ao(n,r,!0,e,0,s,0,o,l)).context=oo(null),n=e.current,(s=gn(r=ba(),i=wa(n))).callback=void 0!==t&&null!==t?t:null,xn(n,s),e.current.lanes=i,kt(e,i,r),Na(e,r),e},t.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},t.createRoleSelector=function(e){return{$$typeof:Rs,value:e}},t.createTestNameSelector=function(e){return{$$typeof:Is,value:e}},t.createTextSelector=function(e){return{$$typeof:Fs,value:e}},t.deferredUpdates=function(e){var t=Pt,n=qs.transition;try{return qs.transition=null,Pt=16,e()}finally{Pt=t,qs.transition=n}},t.discreteUpdates=function(e,t,n,r,i){var s=Pt,a=qs.transition;try{return qs.transition=null,Pt=1,e(t,n,r,i)}finally{Pt=s,qs.transition=a,0===Xs&&la()}},t.findAllNodes=Vs,t.findBoundingRects=function(e,t){if(!re)throw Error(a(363));t=Vs(e,t),e=[];for(var n=0;n<t.length;n++)e.push(se(t[n]));for(t=e.length-1;0<t;t--)for(var r=(n=e[t]).x,i=r+n.width,s=n.y,o=s+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],d=c.x,u=d+c.width,h=c.y,p=h+c.height;if(r>=d&&s>=h&&i<=u&&o<=p){e.splice(t,1);break}if(!(r!==d||n.width!==c.width||p<s||h>o)){h>s&&(c.height+=h-s,c.y=s),p<o&&(c.height=o-h),e.splice(t,1);break}if(!(s!==h||n.height!==c.height||u<r||d>i)){d>r&&(c.width+=d-r,c.x=r),u<i&&(c.width=i-d),e.splice(t,1);break}}return e},t.findHostInstance=lo,t.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=M(e))?k(e):null)?null:e.stateNode},t.findHostInstanceWithWarning=function(e){return lo(e)},t.flushControlled=function(e){var t=Xs;Xs|=1;var n=qs.transition,r=Pt;try{qs.transition=null,Pt=1,e()}finally{Pt=r,qs.transition=n,0===(Xs=t)&&(la(),Jt())}},t.flushPassiveEffects=Va,t.flushSync=ka,t.focusWithin=function(e,t){if(!re)throw Error(a(363));for(t=Bs(e=Ds(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!oe(n)){if(5===n.tag&&ce(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Pt},t.getFindAllNodesFailureDescription=function(e,t){if(!re)throw Error(a(363));var n=0,r=[];e=[Ds(e),0];for(var i=0;i<e.length;){var s=e[i++],o=e[i++],l=t[o];if((5!==s.tag||!oe(s))&&(Us(s,l)&&(r.push(zs(l)),++o>n&&(n=o)),o<t.length))for(s=s.child;null!==s;)e.push(s,o),s=s.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(zs(t[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},t.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?L(e.child.stateNode):e.child.stateNode:null},t.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:ho,findFiberByHostInstance:e.findFiberByHostInstance||po,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Ht=t.inject(e),Wt=t}catch(n){}e=!!t.checkDCE}}return e},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(e,t,n,r){if(!re)throw Error(a(363));e=Vs(e,t);var i=de(e,n,r).disconnect;return{disconnect:function(){i()}}},t.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},t.runWithPriority=function(e,t){var n=Pt;try{return Pt=e,t()}finally{Pt=n}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(e,t,n,r){var i=t.current,s=ba(),a=wa(i);return n=oo(n),null===t.context?t.context=n:t.pendingContext=n,(t=gn(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),xn(i,t),null!==(e=_a(i,a,s))&&vn(e,i,a),a},t}},7067:(e,t,n)=>{"use strict";e.exports=n(4612)},7205:(e,t,n)=>{"use strict";e.exports=n(7302)},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,n))c<i&&0>s(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>s(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,x="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(d);null!==t;){if(null===t.callback)i(d);else{if(!(t.startTime<=e))break;i(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function w(e){if(g=!1,b(e),!f)if(null!==r(c))f=!0,L(_);else{var t=r(d);null!==t&&R(w,t.startTime-e)}}function _(e,n){f=!1,g&&(g=!1,v(A),A=-1),m=!0;var s=p;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!C());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&i(c),b(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&R(w,u.startTime-n),l=!1}return l}finally{h=null,p=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,N=!1,j=null,A=-1,M=5,E=-1;function C(){return!(t.unstable_now()-E<M)}function k(){if(null!==j){var e=t.unstable_now();E=e;var n=!0;try{n=j(!0,e)}finally{n?S():(N=!1,j=null)}}else N=!1}if("function"===typeof y)S=function(){y(k)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,P=T.port2;T.port1.onmessage=k,S=function(){P.postMessage(null)}}else S=function(){x(k,0)};function L(e){j=e,N||(N=!0,S())}function R(e,n){A=x(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,L(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(d,e),null===r(c)&&e===r(d)&&(g?(v(A),A=-1):g=!0,R(w,s-a))):(e.sortIndex=o,n(c,e),f||m||(f=!0,L(_))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},7302:(e,t)=>{"use strict";t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8853:(e,t,n)=>{"use strict";e.exports=n(7234)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&r;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>a[e]=()=>r[e]);return a.default=()=>r,n.d(s,a),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+"."+{239:"02295ba3",455:"97a802c8",879:"808c09ab",977:"8088b1b9"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="sweetbite-frontend:";n.l=(r,i,s,a)=>{if(e[r])e[r].push(i);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=r),e[r]=[i];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise((n,r)=>i=e[t]=[n,r]);r.push(i[2]=s);var a=n.p+n.u(t),o=new Error;n.l(a,r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,i[1](o)}},"chunk-"+t,t)}};var t=(t,r)=>{var i,s,a=r[0],o=r[1],l=r[2],c=0;if(a.some(t=>0!==e[t])){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(l)l(n)}for(t&&t(r);c<a.length;c++)s=a[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunksweetbite_frontend=self.webpackChunksweetbite_frontend||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{hasBrowserEnv:()=>Wy,hasStandardBrowserEnv:()=>qy,hasStandardBrowserWebWorkerEnv:()=>Xy,navigator:()=>Gy,origin:()=>Yy});var t={};n.r(t),n.d(t,{ACESFilmicToneMapping:()=>d_,AddEquation:()=>Cw,AddOperation:()=>s_,AdditiveAnimationBlendMode:()=>XS,AdditiveBlending:()=>jw,AgXToneMapping:()=>h_,AlphaFormat:()=>X_,AlwaysCompare:()=>LN,AlwaysDepth:()=>Jw,AlwaysStencilFunc:()=>jN,AmbientLight:()=>xI,AnimationAction:()=>aF,AnimationClip:()=>BR,AnimationLoader:()=>JR,AnimationMixer:()=>lF,AnimationObjectGroup:()=>sF,AnimationUtils:()=>ER,ArcCurve:()=>qP,ArrayCamera:()=>Yk,ArrowHelper:()=>eO,AttachedBindMode:()=>m_,Audio:()=>WI,AudioAnalyser:()=>JI,AudioContext:()=>TI,AudioListener:()=>HI,AudioLoader:()=>PI,AxesHelper:()=>tO,BackSide:()=>ww,BasicDepthPacking:()=>KS,BasicShadowMap:()=>gw,BatchedMesh:()=>gP,Bone:()=>zT,BooleanKeyframeTrack:()=>RR,Box2:()=>wF,Box3:()=>zj,Box3Helper:()=>ZF,BoxGeometry:()=>KM,BoxHelper:()=>YF,BufferAttribute:()=>mM,BufferGeometry:()=>TM,BufferGeometryLoader:()=>NI,ByteType:()=>F_,Cache:()=>HR,Camera:()=>rE,CameraHelper:()=>GF,CanvasTexture:()=>HP,CapsuleGeometry:()=>pL,CatmullRomCurve3:()=>QP,CineonToneMapping:()=>c_,CircleGeometry:()=>mL,ClampToEdgeWrapping:()=>S_,Clock:()=>OI,Color:()=>nM,ColorKeyframeTrack:()=>IR,ColorManagement:()=>yj,CompressedArrayTexture:()=>BP,CompressedCubeTexture:()=>VP,CompressedTexture:()=>zP,CompressedTextureLoader:()=>KR,ConeGeometry:()=>gL,ConstantAlphaFactor:()=>Xw,ConstantColorFactor:()=>Gw,CubeCamera:()=>cE,CubeReflectionMapping:()=>x_,CubeRefractionMapping:()=>v_,CubeTexture:()=>dE,CubeTextureLoader:()=>$R,CubeUVReflectionMapping:()=>w_,CubicBezierCurve:()=>nL,CubicBezierCurve3:()=>rL,CubicInterpolant:()=>kR,CullFaceBack:()=>pw,CullFaceFront:()=>mw,CullFaceFrontBack:()=>fw,CullFaceNone:()=>hw,Curve:()=>WP,CurvePath:()=>dL,CustomBlending:()=>Ew,CustomToneMapping:()=>u_,CylinderGeometry:()=>fL,Cylindrical:()=>yF,Data3DTexture:()=>Rj,DataArrayTexture:()=>Pj,DataTexture:()=>BT,DataTextureLoader:()=>eI,DataUtils:()=>uM,DecrementStencilOp:()=>mN,DecrementWrapStencilOp:()=>gN,DefaultLoadingManager:()=>GR,DepthFormat:()=>Q_,DepthStencilFormat:()=>$_,DepthTexture:()=>iC,DetachedBindMode:()=>f_,DirectionalLight:()=>gI,DirectionalLightHelper:()=>VF,DiscreteInterpolant:()=>PR,DisplayP3ColorSpace:()=>iN,DodecahedronGeometry:()=>vL,DoubleSide:()=>_w,DstAlphaFactor:()=>zw,DstColorFactor:()=>Vw,DynamicCopyUsage:()=>BN,DynamicDrawUsage:()=>IN,DynamicReadUsage:()=>DN,EdgesGeometry:()=>SL,EllipseCurve:()=>GP,EqualCompare:()=>EN,EqualDepth:()=>$w,EqualStencilFunc:()=>bN,EquirectangularReflectionMapping:()=>y_,EquirectangularRefractionMapping:()=>b_,Euler:()=>SA,EventDispatcher:()=>XN,ExtrudeGeometry:()=>$L,FileLoader:()=>ZR,Float16BufferAttribute:()=>_M,Float32BufferAttribute:()=>SM,FloatType:()=>B_,Fog:()=>aT,FogExp2:()=>sT,FramebufferTexture:()=>UP,FrontSide:()=>bw,Frustum:()=>vE,GLBufferAttribute:()=>pF,GLSL1:()=>HN,GLSL3:()=>WN,GreaterCompare:()=>kN,GreaterDepth:()=>t_,GreaterEqualCompare:()=>PN,GreaterEqualDepth:()=>e_,GreaterEqualStencilFunc:()=>NN,GreaterStencilFunc:()=>_N,GridHelper:()=>OF,Group:()=>Zk,HalfFloatType:()=>V_,HemisphereLight:()=>rI,HemisphereLightHelper:()=>FF,IcosahedronGeometry:()=>tR,ImageBitmapLoader:()=>CI,ImageLoader:()=>QR,ImageUtils:()=>Sj,IncrementStencilOp:()=>pN,IncrementWrapStencilOp:()=>fN,InstancedBufferAttribute:()=>GT,InstancedBufferGeometry:()=>SI,InstancedInterleavedBuffer:()=>hF,InstancedMesh:()=>$T,Int16BufferAttribute:()=>vM,Int32BufferAttribute:()=>bM,Int8BufferAttribute:()=>fM,IntType:()=>U_,InterleavedBuffer:()=>lT,InterleavedBufferAttribute:()=>dT,Interpolant:()=>CR,InterpolateDiscrete:()=>zS,InterpolateLinear:()=>BS,InterpolateSmooth:()=>VS,InvertStencilOp:()=>xN,KeepStencilOp:()=>uN,KeyframeTrack:()=>LR,LOD:()=>CT,LatheGeometry:()=>hL,Layers:()=>NA,LessCompare:()=>MN,LessDepth:()=>Kw,LessEqualCompare:()=>CN,LessEqualDepth:()=>Qw,LessEqualStencilFunc:()=>wN,LessStencilFunc:()=>yN,Light:()=>nI,LightProbe:()=>bI,Line:()=>jP,Line3:()=>NF,LineBasicMaterial:()=>xP,LineCurve:()=>iL,LineCurve3:()=>sL,LineDashedMaterial:()=>_R,LineLoop:()=>kP,LineSegments:()=>CP,LinearDisplayP3ColorSpace:()=>sN,LinearFilter:()=>k_,LinearInterpolant:()=>TR,LinearMipMapLinearFilter:()=>R_,LinearMipMapNearestFilter:()=>P_,LinearMipmapLinearFilter:()=>L_,LinearMipmapNearestFilter:()=>T_,LinearSRGBColorSpace:()=>rN,LinearToneMapping:()=>o_,LinearTransfer:()=>aN,Loader:()=>qR,LoaderUtils:()=>_I,LoadingManager:()=>WR,LoopOnce:()=>OS,LoopPingPong:()=>US,LoopRepeat:()=>DS,LuminanceAlphaFormat:()=>K_,LuminanceFormat:()=>J_,MOUSE:()=>dw,Material:()=>sM,MaterialLoader:()=>wI,MathUtils:()=>ij,Matrix3:()=>aj,Matrix4:()=>pA,MaxEquation:()=>Lw,Mesh:()=>ZM,MeshBasicMaterial:()=>aM,MeshDepthMaterial:()=>Vk,MeshDistanceMaterial:()=>Hk,MeshLambertMaterial:()=>bR,MeshMatcapMaterial:()=>wR,MeshNormalMaterial:()=>yR,MeshPhongMaterial:()=>xR,MeshPhysicalMaterial:()=>gR,MeshStandardMaterial:()=>fR,MeshToonMaterial:()=>vR,MinEquation:()=>Pw,MirroredRepeatWrapping:()=>N_,MixOperation:()=>i_,MultiplyBlending:()=>Mw,MultiplyOperation:()=>r_,NearestFilter:()=>j_,NearestMipMapLinearFilter:()=>C_,NearestMipMapNearestFilter:()=>M_,NearestMipmapLinearFilter:()=>E_,NearestMipmapNearestFilter:()=>A_,NeutralToneMapping:()=>p_,NeverCompare:()=>AN,NeverDepth:()=>Zw,NeverStencilFunc:()=>vN,NoBlending:()=>Sw,NoColorSpace:()=>tN,NoToneMapping:()=>a_,NormalAnimationBlendMode:()=>qS,NormalBlending:()=>Nw,NotEqualCompare:()=>TN,NotEqualDepth:()=>n_,NotEqualStencilFunc:()=>SN,NumberKeyframeTrack:()=>FR,Object3D:()=>zA,ObjectLoader:()=>jI,ObjectSpaceNormalMap:()=>eN,OctahedronGeometry:()=>nR,OneFactor:()=>Iw,OneMinusConstantAlphaFactor:()=>Yw,OneMinusConstantColorFactor:()=>qw,OneMinusDstAlphaFactor:()=>Bw,OneMinusDstColorFactor:()=>Hw,OneMinusSrcAlphaFactor:()=>Uw,OneMinusSrcColorFactor:()=>Ow,OrthographicCamera:()=>RE,P3Primaries:()=>cN,PCFShadowMap:()=>xw,PCFSoftShadowMap:()=>vw,PMREMGenerator:()=>qE,Path:()=>uL,PerspectiveCamera:()=>oE,Plane:()=>fE,PlaneGeometry:()=>wE,PlaneHelper:()=>JF,PointLight:()=>mI,PointLightHelper:()=>PF,Points:()=>FP,PointsMaterial:()=>TP,PolarGridHelper:()=>DF,PolyhedronGeometry:()=>xL,PositionalAudio:()=>ZI,PropertyBinding:()=>iF,PropertyMixer:()=>KI,QuadraticBezierCurve:()=>aL,QuadraticBezierCurve3:()=>oL,Quaternion:()=>Fj,QuaternionKeyframeTrack:()=>DR,QuaternionLinearInterpolant:()=>OR,RED_GREEN_RGTC2_Format:()=>IS,RED_RGTC1_Format:()=>LS,REVISION:()=>cw,RGBADepthPacking:()=>QS,RGBAFormat:()=>Z_,RGBAIntegerFormat:()=>iS,RGBA_ASTC_10x10_Format:()=>MS,RGBA_ASTC_10x5_Format:()=>NS,RGBA_ASTC_10x6_Format:()=>jS,RGBA_ASTC_10x8_Format:()=>AS,RGBA_ASTC_12x10_Format:()=>ES,RGBA_ASTC_12x12_Format:()=>CS,RGBA_ASTC_4x4_Format:()=>gS,RGBA_ASTC_5x4_Format:()=>xS,RGBA_ASTC_5x5_Format:()=>vS,RGBA_ASTC_6x5_Format:()=>yS,RGBA_ASTC_6x6_Format:()=>bS,RGBA_ASTC_8x5_Format:()=>wS,RGBA_ASTC_8x6_Format:()=>_S,RGBA_ASTC_8x8_Format:()=>SS,RGBA_BPTC_Format:()=>kS,RGBA_ETC2_EAC_Format:()=>fS,RGBA_PVRTC_2BPPV1_Format:()=>hS,RGBA_PVRTC_4BPPV1_Format:()=>uS,RGBA_S3TC_DXT1_Format:()=>aS,RGBA_S3TC_DXT3_Format:()=>oS,RGBA_S3TC_DXT5_Format:()=>lS,RGBFormat:()=>Y_,RGB_BPTC_SIGNED_Format:()=>TS,RGB_BPTC_UNSIGNED_Format:()=>PS,RGB_ETC1_Format:()=>pS,RGB_ETC2_Format:()=>mS,RGB_PVRTC_2BPPV1_Format:()=>dS,RGB_PVRTC_4BPPV1_Format:()=>cS,RGB_S3TC_DXT1_Format:()=>sS,RGFormat:()=>nS,RGIntegerFormat:()=>rS,RawShaderMaterial:()=>mR,Ray:()=>hA,Raycaster:()=>fF,Rec709Primaries:()=>lN,RectAreaLight:()=>vI,RedFormat:()=>eS,RedIntegerFormat:()=>tS,ReinhardToneMapping:()=>l_,RenderTarget:()=>kj,RepeatWrapping:()=>__,ReplaceStencilOp:()=>hN,ReverseSubtractEquation:()=>Tw,RingGeometry:()=>rR,SIGNED_RED_GREEN_RGTC2_Format:()=>FS,SIGNED_RED_RGTC1_Format:()=>RS,SRGBColorSpace:()=>nN,SRGBTransfer:()=>oN,Scene:()=>oT,ShaderChunk:()=>_E,ShaderLib:()=>NE,ShaderMaterial:()=>nE,ShadowMaterial:()=>pR,Shape:()=>NL,ShapeGeometry:()=>iR,ShapePath:()=>nO,ShapeUtils:()=>JL,ShortType:()=>O_,Skeleton:()=>WT,SkeletonHelper:()=>kF,SkinnedMesh:()=>UT,Source:()=>jj,Sphere:()=>iA,SphereGeometry:()=>sR,Spherical:()=>vF,SphericalHarmonics3:()=>yI,SplineCurve:()=>lL,SpotLight:()=>cI,SpotLightHelper:()=>AF,Sprite:()=>jT,SpriteMaterial:()=>uT,SrcAlphaFactor:()=>Dw,SrcAlphaSaturateFactor:()=>Ww,SrcColorFactor:()=>Fw,StaticCopyUsage:()=>zN,StaticDrawUsage:()=>RN,StaticReadUsage:()=>ON,StereoCamera:()=>FI,StreamCopyUsage:()=>VN,StreamDrawUsage:()=>FN,StreamReadUsage:()=>UN,StringKeyframeTrack:()=>UR,SubtractEquation:()=>kw,SubtractiveBlending:()=>Aw,TOUCH:()=>uw,TangentSpaceNormalMap:()=>$S,TetrahedronGeometry:()=>aR,Texture:()=>Ej,TextureLoader:()=>tI,TorusGeometry:()=>oR,TorusKnotGeometry:()=>lR,Triangle:()=>KA,TriangleFanDrawMode:()=>JS,TriangleStripDrawMode:()=>ZS,TrianglesDrawMode:()=>YS,TubeGeometry:()=>cR,UVMapping:()=>g_,Uint16BufferAttribute:()=>yM,Uint32BufferAttribute:()=>wM,Uint8BufferAttribute:()=>gM,Uint8ClampedBufferAttribute:()=>xM,Uniform:()=>cF,UniformsGroup:()=>uF,UniformsLib:()=>SE,UniformsUtils:()=>tE,UnsignedByteType:()=>I_,UnsignedInt248Type:()=>G_,UnsignedInt5999Type:()=>q_,UnsignedIntType:()=>z_,UnsignedShort4444Type:()=>H_,UnsignedShort5551Type:()=>W_,UnsignedShortType:()=>D_,VSMShadowMap:()=>yw,Vector2:()=>sj,Vector3:()=>Oj,Vector4:()=>Cj,VectorKeyframeTrack:()=>zR,VideoTexture:()=>DP,WebGL3DRenderTarget:()=>Ij,WebGLArrayRenderTarget:()=>Lj,WebGLCoordinateSystem:()=>GN,WebGLCubeRenderTarget:()=>uE,WebGLMultipleRenderTargets:()=>rO,WebGLRenderTarget:()=>Tj,WebGLRenderer:()=>iT,WebGLUtils:()=>Xk,WebGPUCoordinateSystem:()=>qN,WireframeGeometry:()=>dR,WrapAroundEnding:()=>GS,ZeroCurvatureEnding:()=>HS,ZeroFactor:()=>Rw,ZeroSlopeEnding:()=>WS,ZeroStencilOp:()=>dN,createCanvasElement:()=>hj});var r,i=n(5043),s=n.t(i,2),a=n(4391),o=n(7950),l=n.t(o,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const d="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function p(e,t){return{usr:e.state,key:e.key,idx:t}}function m(e,t,n,r){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function f(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function g(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function x(e,t,n,i){void 0===i&&(i={});let{window:s=document.defaultView,v5Compat:a=!1}=i,o=s.history,l=r.Pop,h=null,g=x();function x(){return(o.state||{idx:null}).idx}function v(){l=r.Pop;let e=x(),t=null==e?null:e-g;g=e,h&&h({action:l,location:b.location,delta:t})}function y(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:f(e);return n=n.replace(/ $/,"%20"),u(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,o.replaceState(c({},o.state,{idx:g}),""));let b={get action(){return l},get location(){return e(s,o)},listen(e){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(d,v),h=e,()=>{s.removeEventListener(d,v),h=null}},createHref:e=>t(s,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=r.Push;let i=m(b.location,e,t);n&&n(i,e),g=x()+1;let c=p(i,g),d=b.createHref(i);try{o.pushState(c,"",d)}catch(nU){if(nU instanceof DOMException&&"DataCloneError"===nU.name)throw nU;s.location.assign(d)}a&&h&&h({action:l,location:b.location,delta:1})},replace:function(e,t){l=r.Replace;let i=m(b.location,e,t);n&&n(i,e),g=x();let s=p(i,g),c=b.createHref(i);o.replaceState(s,"",c),a&&h&&h({action:l,location:b.location,delta:0})},go:e=>o.go(e)};return b}var v;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(v||(v={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function y(e,t,n){return void 0===n&&(n="/"),b(e,t,n,!1)}function b(e,t,n,r){let i=R(("string"===typeof t?g(t):t).pathname||"/",n);if(null==i)return null;let s=w(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let a=null;for(let o=0;null==a&&o<s.length;++o){let e=L(i);a=T(s[o],e,r)}return a}function w(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(u(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));let o=U([r,a.relativePath]),l=n.concat(a);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),w(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:k(o,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of _(e.path))i(e,t,r);else i(e,t)}),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let a=_(r.join("/")),o=[];return o.push(...a.map(e=>""===e?s:[s,e].join("/"))),i&&o.push(...a),o.map(t=>e.startsWith("/")&&""===t?"/":t)}const S=/^:[\w-]+$/,N=3,j=2,A=1,M=10,E=-2,C=e=>"*"===e;function k(e,t){let n=e.split("/"),r=n.length;return n.some(C)&&(r+=E),t&&(r+=j),n.filter(e=>!C(e)).reduce((e,t)=>e+(S.test(t)?N:""===t?A:M),r)}function T(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},s="/",a=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===s?t:t.slice(s.length)||"/",d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:U([s,d.pathname]),pathnameBase:z(U([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=U([s,d.pathnameBase]))}return a}function P(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1),l=r.reduce((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=o[n]||"";a=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{});return{params:l,pathname:s,pathnameBase:a,pattern:e}}function L(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(nU){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+nU+")."),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function I(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function F(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function O(e,t){let n=F(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function D(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=g(e):(i=c({},e),u(!i.pathname||!i.pathname.includes("?"),I("?","pathname","search",i)),u(!i.pathname||!i.pathname.includes("#"),I("#","pathname","hash",i)),u(!i.search||!i.search.includes("#"),I("#","search","hash",i)));let s,a=""===e||""===i.pathname,o=a?"/":i.pathname;if(null==o)s=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?g(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:B(r),hash:V(i)}}(i,s),d=o&&"/"!==o&&o.endsWith("/"),h=(a||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!d&&!h||(l.pathname+="/"),l}const U=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),B=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",V=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function H(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const W=["post","put","patch","delete"],G=(new Set(W),["get",...W]);new Set(G),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q.apply(this,arguments)}const X=i.createContext(null);const Y=i.createContext(null);const Z=i.createContext(null);const J=i.createContext(null);const K=i.createContext({outlet:null,matches:[],isDataRoute:!1});const Q=i.createContext(null);function $(){return null!=i.useContext(J)}function ee(){return $()||u(!1),i.useContext(J).location}function te(e){i.useContext(Z).static||i.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=i.useContext(K);return e?function(){let{router:e}=pe(ue.UseNavigateStable),t=fe(he.UseNavigateStable),n=i.useRef(!1);te(()=>{n.current=!0});let r=i.useCallback(function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,q({fromRouteId:t},i)))},[e,t]);return r}():function(){$()||u(!1);let e=i.useContext(X),{basename:t,future:n,navigator:r}=i.useContext(Z),{matches:s}=i.useContext(K),{pathname:a}=ee(),o=JSON.stringify(O(s,n.v7_relativeSplatPath)),l=i.useRef(!1);return te(()=>{l.current=!0}),i.useCallback(function(n,i){if(void 0===i&&(i={}),!l.current)return;if("number"===typeof n)return void r.go(n);let s=D(n,JSON.parse(o),a,"path"===i.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:U([t,s.pathname])),(i.replace?r.replace:r.push)(s,i.state,i)},[t,r,o,a,e])}()}function re(){let{matches:e}=i.useContext(K),t=e[e.length-1];return t?t.params:{}}function ie(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=i.useContext(Z),{matches:s}=i.useContext(K),{pathname:a}=ee(),o=JSON.stringify(O(s,r.v7_relativeSplatPath));return i.useMemo(()=>D(e,JSON.parse(o),a,"path"===n),[e,o,a,n])}function se(e,t,n,s){$()||u(!1);let{navigator:a}=i.useContext(Z),{matches:o}=i.useContext(K),l=o[o.length-1],c=l?l.params:{},d=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let h,p=ee();if(t){var m;let e="string"===typeof t?g(t):t;"/"===d||(null==(m=e.pathname)?void 0:m.startsWith(d))||u(!1),h=e}else h=p;let f=h.pathname||"/",x=f;if("/"!==d){let e=d.replace(/^\//,"").split("/");x="/"+f.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=y(e,{pathname:x});let b=de(v&&v.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:U([d,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:U([d,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,n,s);return t&&b?i.createElement(J.Provider,{value:{location:q({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:r.Pop}},b):b}function ae(){let e=function(){var e;let t=i.useContext(Q),n=me(he.UseRouteError),r=fe(he.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=H(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:s},n):null,null)}const oe=i.createElement(ae,null);class le extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?i.createElement(K.Provider,{value:this.props.routeContext},i.createElement(Q.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:n,children:r}=e,s=i.useContext(X);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(K.Provider,{value:t},r)}function de(e,t,n,r){var s;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var a;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(a=r)&&a.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(s=n)?void 0:s.errors;if(null!=l){let e=o.findIndex(e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id]));e>=0||u(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let i=0;i<o.length;i++){let e=o[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=i),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){c=!0,o=d>=0?o.slice(0,d+1):[o[0]];break}}}return o.reduceRight((e,r,s)=>{let a,u=!1,h=null,p=null;var m;n&&(a=l&&r.route.id?l[r.route.id]:void 0,h=r.route.errorElement||oe,c&&(d<0&&0===s?(m="route-fallback",!1||ge[m]||(ge[m]=!0),u=!0,p=null):d===s&&(u=!0,p=r.route.hydrateFallbackElement||null)));let f=t.concat(o.slice(0,s+1)),g=()=>{let t;return t=a?h:u?p:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(ce,{match:r,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?i.createElement(le,{location:n.location,revalidation:n.revalidation,component:h,error:a,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()},null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),he=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(he||{});function pe(e){let t=i.useContext(X);return t||u(!1),t}function me(e){let t=i.useContext(Y);return t||u(!1),t}function fe(e){let t=function(){let e=i.useContext(K);return e||u(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||u(!1),n.route.id}const ge={};function xe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}s.startTransition;function ve(e){let{to:t,replace:n,state:r,relative:s}=e;$()||u(!1);let{future:a,static:o}=i.useContext(Z),{matches:l}=i.useContext(K),{pathname:c}=ee(),d=ne(),h=D(t,O(l,a.v7_relativeSplatPath),c,"path"===s),p=JSON.stringify(h);return i.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:s}),[d,p,s,n,r]),null}function ye(e){u(!1)}function be(e){let{basename:t="/",children:n=null,location:s,navigationType:a=r.Pop,navigator:o,static:l=!1,future:c}=e;$()&&u(!1);let d=t.replace(/^\/*/,"/"),h=i.useMemo(()=>({basename:d,navigator:o,static:l,future:q({v7_relativeSplatPath:!1},c)}),[d,c,o,l]);"string"===typeof s&&(s=g(s));let{pathname:p="/",search:m="",hash:f="",state:x=null,key:v="default"}=s,y=i.useMemo(()=>{let e=R(p,d);return null==e?null:{location:{pathname:e,search:m,hash:f,state:x,key:v},navigationType:a}},[d,p,m,f,x,v,a]);return null==y?null:i.createElement(Z.Provider,{value:h},i.createElement(J.Provider,{children:n,value:y}))}function we(e){let{children:t,location:n}=e;return se(_e(t),n)}new Promise(()=>{});i.Component;function _e(e,t){void 0===t&&(t=[]);let n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let s=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,_e(e.props.children,s));e.type!==ye&&u(!1),e.props.index&&e.props.children&&u(!1);let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=_e(e.props.children,s)),n.push(a)}),n}function Se(){return Se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Se.apply(this,arguments)}function Ne(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function je(e){return void 0===e&&(e=""),new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(e=>[n,e]):[[n,r]])},[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Ae=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(AB){}new Map;const Me=s.startTransition;l.flushSync,s.useId;function Ee(e){let{basename:t,children:n,future:r,window:s}=e,a=i.useRef();var o;null==a.current&&(a.current=(void 0===(o={window:s,v5Compat:!0})&&(o={}),x(function(e,t){let{pathname:n,search:r,hash:i}=e.location;return m("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:f(t)},null,o)));let l=a.current,[c,d]=i.useState({action:l.action,location:l.location}),{v7_startTransition:u}=r||{},h=i.useCallback(e=>{u&&Me?Me(()=>d(e)):d(e)},[d,u]);return i.useLayoutEffect(()=>l.listen(h),[l,h]),i.useEffect(()=>xe(r),[r]),i.createElement(be,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const Ce="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,ke=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Te=i.forwardRef(function(e,t){let n,{onClick:r,relative:s,reloadDocument:a,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,m=Ne(e,Ae),{basename:g}=i.useContext(Z),x=!1;if("string"===typeof d&&ke.test(d)&&(n=d,Ce))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=R(t.pathname,g);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:x=!0}catch(AB){}let v=function(e,t){let{relative:n}=void 0===t?{}:t;$()||u(!1);let{basename:r,navigator:s}=i.useContext(Z),{hash:a,pathname:o,search:l}=ie(e,{relative:n}),c=o;return"/"!==r&&(c="/"===o?r:U([r,o])),s.createHref({pathname:c,search:l,hash:a})}(d,{relative:s}),y=function(e,t){let{target:n,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l}=void 0===t?{}:t,c=ne(),d=ee(),u=ie(e,{relative:o});return i.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:f(d)===f(u);c(e,{replace:n,state:s,preventScrollReset:a,relative:o,viewTransition:l})}},[d,c,u,r,s,n,e,a,o,l])}(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:p});return i.createElement("a",Se({},m,{href:n||v,onClick:x||a?r:function(e){r&&r(e),e.defaultPrevented||y(e)},ref:t,target:c}))});var Pe,Le;function Re(e){let t=i.useRef(je(e)),n=i.useRef(!1),r=ee(),s=i.useMemo(()=>function(e,t){let n=je(e);return t&&t.forEach((e,r)=>{n.has(r)||t.getAll(r).forEach(e=>{n.append(r,e)})}),n}(r.search,n.current?null:t.current),[r.search]),a=ne(),o=i.useCallback((e,t)=>{const r=je("function"===typeof e?e(s):e);n.current=!0,a("?"+r,t)},[a,s]);return[s,o]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pe||(Pe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Le||(Le={}));function Ie(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const Fe=["title","titleId"];function Oe(e,t){let{title:n,titleId:r}=e,s=Ie(e,Fe);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const De=i.forwardRef(Oe);var Ue=n(579);const ze=(0,i.createContext)(),Be=()=>{const e=(0,i.useContext)(ze);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},Ve=e=>{let{children:t}=e;const[n,r]=(0,i.useState)(null),[s,a]=(0,i.useState)(!0),[o,l]=(0,i.useState)(localStorage.getItem("token"));(0,i.useEffect)(()=>{o?c():a(!1)},[o]);const c=async()=>{try{console.log("Checking auth status with token:",o?"present":"missing");const e=await fetch("http://localhost:8000/api/users/profile/",{headers:{Authorization:"Token ".concat(o),"Content-Type":"application/json",Accept:"application/json"}});if(console.log("Auth status response:",e.status),e.ok){const t=await e.json();console.log("Auth status success:",t),r(t)}else console.log("Auth status failed, logging out"),d()}catch(nU){console.error("Error checking auth status:",nU),d()}finally{a(!1)}},d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;localStorage.removeItem("token"),l(null),r(null),e&&e("/")},u={user:n,loading:s,token:o,login:async(e,t)=>{try{console.log("Making login request to:","/api/users/auth/login/"),console.log("Login data:",{username:e,password:"***"});const n=await fetch("http://localhost:8000/api/users/auth/login/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:e,password:t})});if(console.log("Login response status:",n.status),console.log("Login response headers:",n.headers),n.ok){const e=await n.json();console.log("Login success data:",e);const{token:t,user:i}=e;return console.log("Setting token:",t),console.log("Setting user:",i),localStorage.setItem("token",t),l(t),r(i),console.log("Login successful, returning success"),{success:!0,user:i}}{let e="Login failed";try{const t=await n.json();console.log("Login error data:",t),e=t.message||t.detail||e,t.errors&&(t.errors.non_field_errors?e=t.errors.non_field_errors[0]:t.errors.username?e=t.errors.username[0]:t.errors.password&&(e=t.errors.password[0]))}catch(AB){console.error("Error parsing login response:",AB),e=n.statusText||e}return{success:!1,error:e}}}catch(nU){return console.error("Login network error:",nU),{success:!1,error:"Network error occurred. Please check your connection."}}},register:async e=>{try{console.log("Making registration request to:","/api/users/auth/register/"),console.log("Registration data:",{username:e.email,email:e.email,password:"***",confirmPassword:"***",first_name:e.first_name,last_name:e.last_name});const t=await fetch("http://localhost:8000/api/users/auth/register/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:e.email,email:e.email,password:e.password,confirmPassword:e.confirmPassword,first_name:e.first_name,last_name:e.last_name,phone_number:e.phoneNumber||""})});if(console.log("Registration response status:",t.status),console.log("Registration response headers:",t.headers),t.ok){const e=await t.json();console.log("Registration success data:",e);const{token:n,user:i}=e;return localStorage.setItem("token",n),l(n),r(i),{success:!0,user:i}}{let e="Registration failed";try{const n=await t.json();console.log("Registration error data:",n),e=n.message||n.detail||e,n.errors&&(n.errors.username?e=n.errors.username[0]:n.errors.email?e=n.errors.email[0]:n.errors.password?e=n.errors.password[0]:n.errors.confirmPassword?e=n.errors.confirmPassword[0]:n.errors.first_name?e=n.errors.first_name[0]:n.errors.last_name?e=n.errors.last_name[0]:n.errors.non_field_errors&&(e=n.errors.non_field_errors[0]))}catch(AB){console.error("Error parsing registration response:",AB),e=t.statusText||e}return{success:!1,error:e}}}catch(nU){return console.error("Registration network error:",nU),{success:!1,error:"Network error occurred. Please check your connection."}}},logout:d,updateProfile:async e=>{try{console.log("\ud83d\udd04 AuthContext: Updating profile with data:",e),console.log("\ud83d\udd11 AuthContext: Using token:",o?"".concat(o.substring(0,20),"..."):"No token");const t=await fetch("http://localhost:8000/api/users/profile/update/",{method:"PUT",headers:{Authorization:"Token ".concat(o),"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("\ud83d\udce1 AuthContext: Profile update response status:",t.status),t.ok){const e=await t.json();return console.log("\u2705 AuthContext: Profile updated successfully:",e),r(e),{success:!0}}{const e=await t.json();return console.log("\u274c AuthContext: Profile update error:",e),{success:!1,error:e.message||"Profile update failed"}}}catch(nU){return console.error("\ud83d\udca5 AuthContext: Profile update error:",nU),{success:!1,error:"Network error occurred"}}},isAuthenticated:!!n};return(0,Ue.jsx)(ze.Provider,{value:u,children:t})},He=()=>{const{isAuthenticated:e}=Be();return(0,Ue.jsx)("footer",{className:"bg-gray-900 text-white",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,Ue.jsxs)("div",{className:"col-span-1 md:col-span-2",children:[(0,Ue.jsx)("h3",{className:"text-xl font-bold mb-4",children:"SweetBite Bakery"}),(0,Ue.jsx)("p",{className:"text-gray-300 mb-4",children:"Creating delicious memories with every bite. We specialize in custom cakes, pastries, and baked goods made with love and the finest ingredients."}),(0,Ue.jsxs)("div",{className:"flex items-center text-gray-300",children:[(0,Ue.jsx)(De,{className:"h-5 w-5 mr-2 text-red-500"}),(0,Ue.jsx)("span",{children:"Made with love in every recipe"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"text-lg font-semibold mb-4",children:"Quick Links"}),(0,Ue.jsxs)("ul",{className:"space-y-2",children:[(0,Ue.jsx)("li",{children:(0,Ue.jsx)(Te,{to:"/",className:"text-gray-300 hover:text-white transition-colors",children:"Home"})}),(0,Ue.jsx)("li",{children:(0,Ue.jsx)(Te,{to:"/menu",className:"text-gray-300 hover:text-white transition-colors",children:"Menu"})}),(0,Ue.jsx)("li",{children:(0,Ue.jsx)(Te,{to:"/orders",className:"text-gray-300 hover:text-white transition-colors",children:"My Orders"})}),(0,Ue.jsx)("li",{children:(0,Ue.jsx)(Te,{to:"/profile",className:"text-gray-300 hover:text-white transition-colors",children:"Profile"})}),(0,Ue.jsx)("li",{children:(0,Ue.jsx)(Te,{to:"/feedback",onClick:t=>{e||(t.preventDefault(),alert("Please sign up to submit feedback!"))},className:"text-gray-300 hover:text-white transition-colors",children:"Feedback"})})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"text-lg font-semibold mb-4",children:"Contact Us"}),(0,Ue.jsxs)("ul",{className:"space-y-2",children:[(0,Ue.jsx)("li",{children:(0,Ue.jsxs)("a",{href:"mailto:manomega@gmail.com",className:"text-gray-300 hover:text-white transition-colors flex items-center",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),"manomega@gmail.com"]})}),(0,Ue.jsx)("li",{children:(0,Ue.jsxs)("div",{className:"bg-black text-white p-3 rounded-lg mt-3",children:[(0,Ue.jsx)("div",{className:"text-sm text-gray-300 mb-1",children:"Call us or WhatsApp:"}),(0,Ue.jsxs)("a",{href:"tel:+94758549382",className:"text-white font-semibold text-lg hover:text-green-400 transition-colors flex items-center",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})}),"+94 75 854 9382"]})]})})]})]})]}),(0,Ue.jsx)("div",{className:"border-t border-gray-700 mt-8 pt-6",children:(0,Ue.jsxs)("div",{className:"text-center mb-6",children:[(0,Ue.jsx)("h3",{className:"text-2xl font-bold mb-4",children:"Get in Touch"}),(0,Ue.jsx)("p",{className:"text-gray-300 mb-6",children:"Ready to order your perfect cake? Contact us today!"}),(0,Ue.jsxs)("div",{className:"flex flex-col md:flex-row justify-center items-center gap-6",children:[(0,Ue.jsxs)("a",{href:"https://www.facebook.com/profile.php?id=61575974396933",target:"_blank",rel:"noopener noreferrer",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors flex items-center",children:[(0,Ue.jsx)("svg",{className:"w-6 h-6 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Visit Our Facebook Page"]}),(0,Ue.jsxs)("div",{className:"bg-black text-white p-6 rounded-lg border-2 border-gray-600",children:[(0,Ue.jsx)("div",{className:"text-sm text-gray-300 mb-2",children:"Follow us on Instagram:"}),(0,Ue.jsxs)("a",{href:"https://www.instagram.com/meha_bakes/",target:"_blank",rel:"noopener noreferrer",className:"text-white font-bold text-2xl hover:text-pink-400 transition-colors flex items-center justify-center",children:[(0,Ue.jsx)("svg",{className:"w-8 h-8 mr-3",fill:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{d:"M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.62 5.367 11.987 11.988 11.987 6.62 0 11.987-5.367 11.987-11.987C24.014 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.448-.49-3.323-1.297C4.198 14.895 3.708 13.744 3.708 12.447s.49-2.448 1.297-3.323c.875-.807 2.026-1.297 3.323-1.297s2.448.49 3.323 1.297c.807.875 1.297 2.026 1.297 3.323s-.49 2.448-1.297 3.323c-.875.807-2.026 1.297-3.323 1.297zm7.83-9.281H7.721c-.49 0-.875.385-.875.875v8.449c0 .49.385.875.875.875h8.449c.49 0 .875-.385.875-.875V8.582c0-.49-.385-.875-.875-.875z"})}),"@meha_bakes"]})]})]})]})}),(0,Ue.jsx)("div",{className:"border-t border-gray-700 mt-8 pt-6",children:(0,Ue.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[(0,Ue.jsx)("p",{className:"text-gray-300 text-sm",children:"\xa9 2024 SweetBite Bakery. All rights reserved."}),(0,Ue.jsxs)("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[(0,Ue.jsx)("span",{className:"text-gray-300 text-sm",children:"Privacy Policy"}),(0,Ue.jsx)("span",{className:"text-gray-300 text-sm",children:"Terms of Service"})]})]})})]})})};var We=n(4980);function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach(function(t){(0,We.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const Xe=(0,i.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Ye=(0,i.createContext)({}),Ze=(0,i.createContext)(null),Je="undefined"!==typeof document,Ke=Je?i.useLayoutEffect:i.useEffect,Qe=(0,i.createContext)({strict:!1}),$e=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),et="data-"+$e("framerAppearId");function tt(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function nt(e){return"string"===typeof e||Array.isArray(e)}function rt(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}const it=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],st=["initial",...it];function at(e){return rt(e.animate)||st.some(t=>nt(e[t]))}function ot(e){return Boolean(at(e)||e.variants)}function lt(e){const{initial:t,animate:n}=function(e,t){if(at(e)){const{initial:t,animate:n}=e;return{initial:!1===t||nt(t)?t:void 0,animate:nt(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,i.useContext)(Ye));return(0,i.useMemo)(()=>({initial:t,animate:n}),[ct(t),ct(n)])}function ct(e){return Array.isArray(e)?e.join(" "):e}const dt={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ut={};for(const n in dt)ut[n]={isEnabled:e=>dt[n].some(t=>!!e[t])};const ht=(0,i.createContext)({}),pt=(0,i.createContext)({}),mt=Symbol.for("motionComponentSymbol");function ft(e){let{preloadedFeatures:t,createVisualElement:n,useRender:r,useVisualState:s,Component:a}=e;t&&function(e){for(const t in e)ut[t]=qe(qe({},ut[t]),e[t])}(t);const o=(0,i.forwardRef)(function(e,o){let l;const c=qe(qe(qe({},(0,i.useContext)(Xe)),e),{},{layoutId:gt(e)}),{isStatic:d}=c,u=lt(e),h=s(e,d);if(!d&&Je){u.visualElement=function(e,t,n,r){const{visualElement:s}=(0,i.useContext)(Ye),a=(0,i.useContext)(Qe),o=(0,i.useContext)(Ze),l=(0,i.useContext)(Xe).reducedMotion,c=(0,i.useRef)();r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:s,props:n,presenceContext:o,blockInitialAnimation:!!o&&!1===o.initial,reducedMotionConfig:l}));const d=c.current;(0,i.useInsertionEffect)(()=>{d&&d.update(n,o)});const u=(0,i.useRef)(Boolean(n[et]&&!window.HandoffComplete));return Ke(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),(0,i.useEffect)(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}(a,h,c,n);const e=(0,i.useContext)(pt),r=(0,i.useContext)(Qe).strict;u.visualElement&&(l=u.visualElement.loadFeatures(c,r,t,e))}return i.createElement(Ye.Provider,{value:u},l&&u.visualElement?i.createElement(l,qe({visualElement:u.visualElement},c)):null,r(a,e,function(e,t,n){return(0,i.useCallback)(r=>{r&&e.mount&&e.mount(r),t&&(r?t.mount(r):t.unmount()),n&&("function"===typeof n?n(r):tt(n)&&(n.current=r))},[t])}(h,u.visualElement,o),h,d,u.visualElement))});return o[mt]=a,o}function gt(e){let{layoutId:t}=e;const n=(0,i.useContext)(ht).id;return n&&void 0!==t?n+"-"+t:t}function xt(e){function t(t){return ft(e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}if("undefined"===typeof Proxy)return t;const n=new Map;return new Proxy(t,{get:(e,r)=>(n.has(r)||n.set(r,t(r)),n.get(r))})}const vt=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function yt(e){return"string"===typeof e&&!e.includes("-")&&!!(vt.indexOf(e)>-1||/[A-Z]/.test(e))}const bt={};const wt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_t=new Set(wt);function St(e,t){let{layout:n,layoutId:r}=t;return _t.has(e)||e.startsWith("origin")||(n||void 0!==r)&&(!!bt[e]||"opacity"===e)}const Nt=e=>Boolean(e&&e.getVelocity),jt={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},At=wt.length;const Mt=e=>t=>"string"===typeof t&&t.startsWith(e),Et=Mt("--"),Ct=Mt("var(--"),kt=(e,t)=>t&&"number"===typeof e?t.transform(e):e,Tt=(e,t,n)=>Math.min(Math.max(n,e),t),Pt={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},Lt=qe(qe({},Pt),{},{transform:e=>Tt(0,1,e)}),Rt=qe(qe({},Pt),{},{default:1}),It=e=>Math.round(1e5*e)/1e5,Ft=/(-)?([\d]*\.?[\d])+/g,Ot=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Dt=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Ut(e){return"string"===typeof e}const zt=e=>({test:t=>Ut(t)&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),Bt=zt("deg"),Vt=zt("%"),Ht=zt("px"),Wt=zt("vh"),Gt=zt("vw"),qt=qe(qe({},Vt),{},{parse:e=>Vt.parse(e)/100,transform:e=>Vt.transform(100*e)}),Xt=qe(qe({},Pt),{},{transform:Math.round}),Yt={borderWidth:Ht,borderTopWidth:Ht,borderRightWidth:Ht,borderBottomWidth:Ht,borderLeftWidth:Ht,borderRadius:Ht,radius:Ht,borderTopLeftRadius:Ht,borderTopRightRadius:Ht,borderBottomRightRadius:Ht,borderBottomLeftRadius:Ht,width:Ht,maxWidth:Ht,height:Ht,maxHeight:Ht,size:Ht,top:Ht,right:Ht,bottom:Ht,left:Ht,padding:Ht,paddingTop:Ht,paddingRight:Ht,paddingBottom:Ht,paddingLeft:Ht,margin:Ht,marginTop:Ht,marginRight:Ht,marginBottom:Ht,marginLeft:Ht,rotate:Bt,rotateX:Bt,rotateY:Bt,rotateZ:Bt,scale:Rt,scaleX:Rt,scaleY:Rt,scaleZ:Rt,skew:Bt,skewX:Bt,skewY:Bt,distance:Ht,translateX:Ht,translateY:Ht,translateZ:Ht,x:Ht,y:Ht,z:Ht,perspective:Ht,transformPerspective:Ht,opacity:Lt,originX:qt,originY:qt,originZ:Ht,zIndex:Xt,fillOpacity:Lt,strokeOpacity:Lt,numOctaves:Xt};function Zt(e,t,n,r){const{style:i,vars:s,transform:a,transformOrigin:o}=e;let l=!1,c=!1,d=!0;for(const u in t){const e=t[u];if(Et(u)){s[u]=e;continue}const n=Yt[u],r=kt(e,n);if(_t.has(u)){if(l=!0,a[u]=r,!d)continue;e!==(n.default||0)&&(d=!1)}else u.startsWith("origin")?(c=!0,o[u]=r):i[u]=r}if(t.transform||(l||r?i.transform=function(e,t,n,r){let{enableHardwareAcceleration:i=!0,allowTransformNone:s=!0}=t,a="";for(let o=0;o<At;o++){const t=wt[o];void 0!==e[t]&&(a+="".concat(jt[t]||t,"(").concat(e[t],") "))}return i&&!e.z&&(a+="translateZ(0)"),a=a.trim(),r?a=r(e,n?"":a):s&&n&&(a="none"),a}(e.transform,n,d,r):i.transform&&(i.transform="none")),c){const{originX:e="50%",originY:t="50%",originZ:n=0}=o;i.transformOrigin="".concat(e," ").concat(t," ").concat(n)}}const Jt=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Kt(e,t,n){for(const r in t)Nt(t[r])||St(r,n)||(e[r]=t[r])}function Qt(e,t,n){const r={};return Kt(r,e.style||{},e),Object.assign(r,function(e,t,n){let{transformTemplate:r}=e;return(0,i.useMemo)(()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return Zt(e,t,{enableHardwareAcceleration:!n},r),Object.assign({},e.vars,e.style)},[t])}(e,t,n)),e.transformValues?e.transformValues(r):r}function $t(e,t,n){const r={},i=Qt(e,t,n);return e.drag&&!1!==e.dragListener&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=i,r}const en=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function tn(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||en.has(e)}let nn=e=>!tn(e);try{(rn=require("@emotion/is-prop-valid").default)&&(nn=e=>e.startsWith("on")?!tn(e):rn(e))}catch(jc){}var rn;function sn(e,t,n){return"string"===typeof e?e:Ht.transform(t+n*e)}const an={offset:"stroke-dashoffset",array:"stroke-dasharray"},on={offset:"strokeDashoffset",array:"strokeDasharray"};const ln=["attrX","attrY","attrScale","originX","originY","pathLength","pathSpacing","pathOffset"];function cn(e,t,n,r,i){let{attrX:s,attrY:a,attrScale:o,originX:l,originY:c,pathLength:d,pathSpacing:u=1,pathOffset:h=0}=t;if(Zt(e,Ie(t,ln),n,i),r)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:p,style:m,dimensions:f}=e;p.transform&&(f&&(m.transform=p.transform),delete p.transform),f&&(void 0!==l||void 0!==c||m.transform)&&(m.transformOrigin=function(e,t,n){const r=sn(t,e.x,e.width),i=sn(n,e.y,e.height);return"".concat(r," ").concat(i)}(f,void 0!==l?l:.5,void 0!==c?c:.5)),void 0!==s&&(p.x=s),void 0!==a&&(p.y=a),void 0!==o&&(p.scale=o),void 0!==d&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const s=i?an:on;e[s.offset]=Ht.transform(-r);const a=Ht.transform(t),o=Ht.transform(n);e[s.array]="".concat(a," ").concat(o)}(p,d,u,h,!1)}const dn=()=>qe(qe({},{style:{},transform:{},transformOrigin:{},vars:{}}),{},{attrs:{}}),un=e=>"string"===typeof e&&"svg"===e.toLowerCase();function hn(e,t,n,r){const s=(0,i.useMemo)(()=>{const n=dn();return cn(n,t,{enableHardwareAcceleration:!1},un(r),e.transformTemplate),qe(qe({},n.attrs),{},{style:qe({},n.style)})},[t]);if(e.style){const t={};Kt(t,e.style,e),s.style=qe(qe({},t),s.style)}return s}function pn(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(t,n,r,s,a)=>{let{latestValues:o}=s;const l=(yt(t)?hn:$t)(n,o,a,t),c=function(e,t,n){const r={};for(const i in e)"values"===i&&"object"===typeof e.values||(nn(i)||!0===n&&tn(i)||!t&&!tn(i)||e.draggable&&i.startsWith("onDrag"))&&(r[i]=e[i]);return r}(n,"string"===typeof t,e),d=qe(qe(qe({},c),l),{},{ref:r}),{children:u}=n,h=(0,i.useMemo)(()=>Nt(u)?u.get():u,[u]);return(0,i.createElement)(t,qe(qe({},d),{},{children:h}))}}function mn(e,t,n,r){let{style:i,vars:s}=t;Object.assign(e.style,i,r&&r.getProjectionStyles(n));for(const a in s)e.style.setProperty(a,s[a])}const fn=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function gn(e,t,n,r){mn(e,t,void 0,r);for(const i in t.attrs)e.setAttribute(fn.has(i)?i:$e(i),t.attrs[i])}function xn(e,t){const{style:n}=e,r={};for(const i in n)(Nt(n[i])||t.style&&Nt(t.style[i])||St(i,e))&&(r[i]=n[i]);return r}function vn(e,t){const n=xn(e,t);for(const r in e)if(Nt(e[r])||Nt(t[r])){n[-1!==wt.indexOf(r)?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r]=e[r]}return n}function yn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return"function"===typeof t&&(t=t(void 0!==n?n:e.custom,r,i)),"string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t&&(t=t(void 0!==n?n:e.custom,r,i)),t}function bn(e){const t=(0,i.useRef)(null);return null===t.current&&(t.current=e()),t.current}const wn=e=>Array.isArray(e),_n=e=>wn(e)?e[e.length-1]||0:e;function Sn(e){const t=Nt(e)?e.get():e;return(e=>Boolean(e&&"object"===typeof e&&e.mix&&e.toValue))(t)?t.toValue():t}const Nn=["transitionEnd","transition"];const jn=e=>(t,n)=>{const r=(0,i.useContext)(Ye),s=(0,i.useContext)(Ze),a=()=>function(e,t,n,r){let{scrapeMotionValuesFromProps:i,createRenderState:s,onMount:a}=e;const o={latestValues:An(t,n,r,i),renderState:s()};return a&&(o.mount=e=>a(t,e,o)),o}(e,t,r,s);return n?a():bn(a)};function An(e,t,n,r){const i={},s=r(e,{});for(const h in s)i[h]=Sn(s[h]);let{initial:a,animate:o}=e;const l=at(e),c=ot(e);t&&c&&!l&&!1!==e.inherit&&(void 0===a&&(a=t.initial),void 0===o&&(o=t.animate));let d=!!n&&!1===n.initial;d=d||!1===a;const u=d?o:a;if(u&&"boolean"!==typeof u&&!rt(u)){(Array.isArray(u)?u:[u]).forEach(t=>{const n=yn(e,t);if(!n)return;const{transitionEnd:r,transition:s}=n,a=Ie(n,Nn);for(const e in a){let t=a[e];if(Array.isArray(t)){t=t[d?t.length-1:0]}null!==t&&(i[e]=t)}for(const e in r)i[e]=r[e]})}return i}const Mn=e=>e;class En{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const t=this.order.indexOf(e);-1!==t&&(this.order.splice(t,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}const Cn=["prepare","read","update","preRender","render","postRender"];const{schedule:kn,cancel:Tn,state:Pn,steps:Ln}=function(e,t){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=Cn.reduce((e,t)=>(e[t]=function(e){let t=new En,n=new En,r=0,i=!1,s=!1;const a=new WeakSet,o={schedule:function(e){const s=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&i,o=s?t:n;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&a.add(e),o.add(e)&&s&&i&&(r=t.order.length),e},cancel:e=>{n.remove(e),a.delete(e)},process:l=>{if(i)s=!0;else{if(i=!0,[t,n]=[n,t],n.clear(),r=t.order.length,r)for(let n=0;n<r;n++){const r=t.order[n];r(l),a.has(r)&&(o.schedule(r),e())}i=!1,s&&(s=!1,o.process(l))}}};return o}(()=>n=!0),e),{}),a=e=>s[e].process(i),o=()=>{const s=performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(s-i.timestamp,40),1),i.timestamp=s,i.isProcessing=!0,Cn.forEach(a),i.isProcessing=!1,n&&t&&(r=!1,e(o))},l=Cn.reduce((t,a)=>{const l=s[a];return t[a]=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,r=!0,i.isProcessing||e(o)),l.schedule(t,s,a)},t},{});return{schedule:l,cancel:e=>Cn.forEach(t=>s[t].cancel(e)),state:i,steps:s}}("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:Mn,!0),Rn={useVisualState:jn({scrapeMotionValuesFromProps:vn,createRenderState:dn,onMount:(e,t,n)=>{let{renderState:r,latestValues:i}=n;kn.read(()=>{try{r.dimensions="function"===typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}catch(AB){r.dimensions={x:0,y:0,width:0,height:0}}}),kn.render(()=>{cn(r,i,{enableHardwareAcceleration:!1},un(t.tagName),e.transformTemplate),gn(t,r)})}})},In={useVisualState:jn({scrapeMotionValuesFromProps:xn,createRenderState:Jt})};function Fn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const On=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function Dn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"page";return{point:{x:e[t+"X"],y:e[t+"Y"]}}}function Un(e,t,n,r){return Fn(e,t,(e=>t=>On(t)&&e(t,Dn(t)))(n),r)}const zn=(e,t)=>n=>t(e(n)),Bn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(zn)};function Vn(e){let t=null;return()=>{const n=()=>{t=null};return null===t&&(t=e,n)}}const Hn=Vn("dragHorizontal"),Wn=Vn("dragVertical");function Gn(e){let t=!1;if("y"===e)t=Wn();else if("x"===e)t=Hn();else{const e=Hn(),n=Wn();e&&n?t=()=>{e(),n()}:(e&&e(),n&&n())}return t}function qn(){const e=Gn(!0);return!e||(e(),!1)}class Xn{constructor(e){this.isMounted=!1,this.node=e}update(){}}function Yn(e,t){const n="pointer"+(t?"enter":"leave"),r="onHover"+(t?"Start":"End");return Un(e.current,n,(n,i)=>{if("touch"===n.pointerType||qn())return;const s=e.getProps();e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",t),s[r]&&kn.update(()=>s[r](n,i))},{passive:!e.getProps()[r]})}const Zn=(e,t)=>!!t&&(e===t||Zn(e,t.parentElement));function Jn(e,t){if(!t)return;const n=new PointerEvent("pointer"+e);t(n,Dn(n))}const Kn=["root"],Qn=new WeakMap,$n=new WeakMap,er=e=>{const t=Qn.get(e.target);t&&t(e)},tr=e=>{e.forEach(er)};function nr(e,t,n){const r=function(e){let{root:t}=e,n=Ie(e,Kn);const r=t||document;$n.has(r)||$n.set(r,{});const i=$n.get(r),s=JSON.stringify(n);return i[s]||(i[s]=new IntersectionObserver(tr,qe({root:t},n))),i[s]}(t);return Qn.set(e,n),r.observe(e),()=>{Qn.delete(e),r.unobserve(e)}}const rr={some:0,all:1};const ir={inView:{Feature:class extends Xn{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:r="some",once:i}=e,s={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof r?r:rr[r]};return nr(this.node.current,s,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,i&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:r}=this.node.getProps(),s=t?n:r;s&&s(e)})}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends Xn{constructor(){super(...arguments),this.removeStartListeners=Mn,this.removeEndListeners=Mn,this.removeAccessibleListeners=Mn,this.startPointerPress=(e,t)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),r=Un(window,"pointerup",(e,t)=>{if(!this.checkPressEnd())return;const{onTap:n,onTapCancel:r,globalTapTarget:i}=this.node.getProps();kn.update(()=>{i||Zn(this.node.current,e.target)?n&&n(e,t):r&&r(e,t)})},{passive:!(n.onTap||n.onPointerUp)}),i=Un(window,"pointercancel",(e,t)=>this.cancelPress(e,t),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Bn(r,i),this.startPress(e,t)},this.startAccessiblePress=()=>{const e=Fn(this.node.current,"keydown",e=>{if("Enter"!==e.key||this.isPressing)return;this.removeEndListeners(),this.removeEndListeners=Fn(this.node.current,"keyup",e=>{"Enter"===e.key&&this.checkPressEnd()&&Jn("up",(e,t)=>{const{onTap:n}=this.node.getProps();n&&kn.update(()=>n(e,t))})}),Jn("down",(e,t)=>{this.startPress(e,t)})}),t=Fn(this.node.current,"blur",()=>{this.isPressing&&Jn("cancel",(e,t)=>this.cancelPress(e,t))});this.removeAccessibleListeners=Bn(e,t)}}startPress(e,t){this.isPressing=!0;const{onTapStart:n,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&kn.update(()=>n(e,t))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;return this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!qn()}cancelPress(e,t){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&kn.update(()=>n(e,t))}mount(){const e=this.node.getProps(),t=Un(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),n=Fn(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Bn(t,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends Xn{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(AB){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Bn(Fn(this.node.current,"focus",()=>this.onFocus()),Fn(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends Xn{mount(){this.unmount=Bn(Yn(this.node,!0),Yn(this.node,!1))}unmount(){}}}};function sr(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function ar(e,t,n){const r=e.getProps();return yn(r,t,void 0!==n?n:r.custom,function(e){const t={};return e.values.forEach((e,n)=>t[n]=e.get()),t}(e),function(e){const t={};return e.values.forEach((e,n)=>t[n]=e.getVelocity()),t}(e))}let or=Mn,lr=Mn;const cr=e=>1e3*e,dr=e=>e/1e3,ur=!1,hr=e=>Array.isArray(e)&&"number"===typeof e[0];function pr(e){return Boolean(!e||"string"===typeof e&&fr[e]||hr(e)||Array.isArray(e)&&e.every(pr))}const mr=e=>{let[t,n,r,i]=e;return"cubic-bezier(".concat(t,", ").concat(n,", ").concat(r,", ").concat(i,")")},fr={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:mr([0,.65,.55,1]),circOut:mr([.55,0,1,.45]),backIn:mr([.31,.01,.66,-.59]),backOut:mr([.33,1.53,.69,.99])};function gr(e){if(e)return hr(e)?mr(e):Array.isArray(e)?e.map(gr):fr[e]}const xr=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function vr(e,t,n,r){if(e===t&&n===r)return Mn;const i=t=>function(e,t,n,r,i){let s,a,o=0;do{a=t+(n-t)/2,s=xr(a,r,i)-e,s>0?n=a:t=a}while(Math.abs(s)>1e-7&&++o<12);return a}(t,0,1,e,n);return e=>0===e||1===e?e:xr(i(e),t,r)}const yr=vr(.42,0,1,1),br=vr(0,0,.58,1),wr=vr(.42,0,.58,1),_r=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Sr=e=>t=>1-e(1-t),Nr=e=>1-Math.sin(Math.acos(e)),jr=Sr(Nr),Ar=_r(Nr),Mr=vr(.33,1.53,.69,.99),Er=Sr(Mr),Cr=_r(Er),kr={linear:Mn,easeIn:yr,easeInOut:wr,easeOut:br,circIn:Nr,circInOut:Ar,circOut:jr,backIn:Er,backInOut:Cr,backOut:Mr,anticipate:e=>(e*=2)<1?.5*Er(e):.5*(2-Math.pow(2,-10*(e-1)))},Tr=e=>{if(Array.isArray(e)){lr(4===e.length,"Cubic bezier arrays must contain four numerical values.");const[t,n,r,i]=e;return vr(t,n,r,i)}return"string"===typeof e?(lr(void 0!==kr[e],"Invalid easing type '".concat(e,"'")),kr[e]):e},Pr=(e,t)=>n=>Boolean(Ut(n)&&Dt.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t)),Lr=(e,t,n)=>r=>{if(!Ut(r))return r;const[i,s,a,o]=r.match(Ft);return{[e]:parseFloat(i),[t]:parseFloat(s),[n]:parseFloat(a),alpha:void 0!==o?parseFloat(o):1}},Rr=qe(qe({},Pt),{},{transform:e=>Math.round((e=>Tt(0,255,e))(e))}),Ir={test:Pr("rgb","red"),parse:Lr("red","green","blue"),transform:e=>{let{red:t,green:n,blue:r,alpha:i=1}=e;return"rgba("+Rr.transform(t)+", "+Rr.transform(n)+", "+Rr.transform(r)+", "+It(Lt.transform(i))+")"}};const Fr={test:Pr("#"),parse:function(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}},transform:Ir.transform},Or={test:Pr("hsl","hue"),parse:Lr("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:r,alpha:i=1}=e;return"hsla("+Math.round(t)+", "+Vt.transform(It(n))+", "+Vt.transform(It(r))+", "+It(Lt.transform(i))+")"}},Dr={test:e=>Ir.test(e)||Fr.test(e)||Or.test(e),parse:e=>Ir.test(e)?Ir.parse(e):Or.test(e)?Or.parse(e):Fr.parse(e),transform:e=>Ut(e)?e:e.hasOwnProperty("red")?Ir.transform(e):Or.transform(e)},Ur=(e,t,n)=>-n*e+n*t+e;function zr(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}const Br=(e,t,n)=>{const r=e*e;return Math.sqrt(Math.max(0,n*(t*t-r)+r))},Vr=[Fr,Ir,Or];function Hr(e){const t=(e=>Vr.find(t=>t.test(e)))(e);lr(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead."));let n=t.parse(e);return t===Or&&(n=function(e){let{hue:t,saturation:n,lightness:r,alpha:i}=e;t/=360,n/=100,r/=100;let s=0,a=0,o=0;if(n){const e=r<.5?r*(1+n):r+n-r*n,i=2*r-e;s=zr(i,e,t+1/3),a=zr(i,e,t),o=zr(i,e,t-1/3)}else s=a=o=r;return{red:Math.round(255*s),green:Math.round(255*a),blue:Math.round(255*o),alpha:i}}(n)),n}const Wr=(e,t)=>{const n=Hr(e),r=Hr(t),i=qe({},n);return e=>(i.red=Br(n.red,r.red,e),i.green=Br(n.green,r.green,e),i.blue=Br(n.blue,r.blue,e),i.alpha=Ur(n.alpha,r.alpha,e),Ir.transform(i))};const Gr={regex:/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,countKey:"Vars",token:"${v}",parse:Mn},qr={regex:Ot,countKey:"Colors",token:"${c}",parse:Dr.parse},Xr={regex:Ft,countKey:"Numbers",token:"${n}",parse:Pt.parse};function Yr(e,t){let{regex:n,countKey:r,token:i,parse:s}=t;const a=e.tokenised.match(n);a&&(e["num"+r]=a.length,e.tokenised=e.tokenised.replace(n,i),e.values.push(...a.map(s)))}function Zr(e){const t=e.toString(),n={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&Yr(n,Gr),Yr(n,qr),Yr(n,Xr),n}function Jr(e){return Zr(e).values}function Kr(e){const{values:t,numColors:n,numVars:r,tokenised:i}=Zr(e),s=t.length;return e=>{let t=i;for(let i=0;i<s;i++)t=i<r?t.replace(Gr.token,e[i]):i<r+n?t.replace(qr.token,Dr.transform(e[i])):t.replace(Xr.token,It(e[i]));return t}}const Qr=e=>"number"===typeof e?0:e;const $r={test:function(e){var t,n;return isNaN(e)&&Ut(e)&&((null===(t=e.match(Ft))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(Ot))||void 0===n?void 0:n.length)||0)>0},parse:Jr,createTransformer:Kr,getAnimatableNone:function(e){const t=Jr(e);return Kr(e)(t.map(Qr))}},ei=(e,t)=>n=>"".concat(n>0?t:e);function ti(e,t){return"number"===typeof e?n=>Ur(e,t,n):Dr.test(e)?Wr(e,t):e.startsWith("var(")?ei(e,t):ii(e,t)}const ni=(e,t)=>{const n=[...e],r=n.length,i=e.map((e,n)=>ti(e,t[n]));return e=>{for(let t=0;t<r;t++)n[t]=i[t](e);return n}},ri=(e,t)=>{const n=qe(qe({},e),t),r={};for(const i in n)void 0!==e[i]&&void 0!==t[i]&&(r[i]=ti(e[i],t[i]));return e=>{for(const t in r)n[t]=r[t](e);return n}},ii=(e,t)=>{const n=$r.createTransformer(t),r=Zr(e),i=Zr(t);return r.numVars===i.numVars&&r.numColors===i.numColors&&r.numNumbers>=i.numNumbers?Bn(ni(r.values,i.values),n):(or(!0,"Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.")),ei(e,t))},si=(e,t,n)=>{const r=t-e;return 0===r?1:(n-e)/r},ai=(e,t)=>n=>Ur(e,t,n);function oi(e,t,n){const r=[],i=n||function(e){return"number"===typeof e?ai:"string"===typeof e?Dr.test(e)?Wr:ii:Array.isArray(e)?ni:"object"===typeof e?ri:ai}(e[0]),s=e.length-1;for(let a=0;a<s;a++){let n=i(e[a],e[a+1]);if(t){const e=Array.isArray(t)?t[a]||Mn:t;n=Bn(e,n)}r.push(n)}return r}function li(e,t){let{clamp:n=!0,ease:r,mixer:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=e.length;if(lr(s===t.length,"Both input and output ranges must be the same length"),1===s)return()=>t[0];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=oi(t,r,i),o=a.length,l=t=>{let n=0;if(o>1)for(;n<e.length-2&&!(t<e[n+1]);n++);const r=si(e[n],e[n+1],t);return a[n](r)};return n?t=>l(Tt(e[0],e[s-1],t)):l}function ci(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const i=si(0,t,r);e.push(Ur(n,1,i))}}(t,e.length-1),t}function di(e){let{duration:t=300,keyframes:n,times:r,ease:i="easeInOut"}=e;const s=(e=>Array.isArray(e)&&"number"!==typeof e[0])(i)?i.map(Tr):Tr(i),a={done:!1,value:n[0]},o=function(e,t){return e.map(e=>e*t)}(r&&r.length===n.length?r:ci(n),t),l=li(o,n,{ease:Array.isArray(s)?s:(c=n,d=s,c.map(()=>d||wr).splice(0,c.length-1))});var c,d;return{calculatedDuration:t,next:e=>(a.value=l(e),a.done=e>=t,a)}}function ui(e,t){return t?e*(1e3/t):0}function hi(e,t,n){const r=Math.max(t-5,0);return ui(n-e(r),t-r)}const pi=.001;function mi(e){let t,n,{duration:r=800,bounce:i=.25,velocity:s=0,mass:a=1}=e;or(r<=cr(10),"Spring duration must be 10 seconds or less");let o=1-i;o=Tt(.05,1,o),r=Tt(.01,10,dr(r)),o<1?(t=e=>{const t=e*o,n=t*r,i=t-s,a=gi(e,o),l=Math.exp(-n);return pi-i/a*l},n=e=>{const n=e*o*r,i=n*s+s,a=Math.pow(o,2)*Math.pow(e,2)*r,l=Math.exp(-n),c=gi(Math.pow(e,2),o);return(-t(e)+pi>0?-1:1)*((i-a)*l)/c}):(t=e=>Math.exp(-e*r)*((e-s)*r+1)-.001,n=e=>Math.exp(-e*r)*(r*r*(s-e)));const l=function(e,t,n){let r=n;for(let i=1;i<fi;i++)r-=e(r)/t(r);return r}(t,n,5/r);if(r=cr(r),isNaN(l))return{stiffness:100,damping:10,duration:r};{const e=Math.pow(l,2)*a;return{stiffness:e,damping:2*o*Math.sqrt(a*e),duration:r}}}const fi=12;function gi(e,t){return e*Math.sqrt(1-t*t)}const xi=["keyframes","restDelta","restSpeed"],vi=["duration","bounce"],yi=["stiffness","damping","mass"];function bi(e,t){return t.some(t=>void 0!==e[t])}function wi(e){let{keyframes:t,restDelta:n,restSpeed:r}=e,i=Ie(e,xi);const s=t[0],a=t[t.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:d,duration:u,velocity:h,isResolvedFromDuration:p}=function(e){let t=qe({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},e);if(!bi(e,yi)&&bi(e,vi)){const n=mi(e);t=qe(qe(qe({},t),n),{},{mass:1}),t.isResolvedFromDuration=!0}return t}(qe(qe({},i),{},{velocity:-dr(i.velocity||0)})),m=h||0,f=c/(2*Math.sqrt(l*d)),g=a-s,x=dr(Math.sqrt(l/d)),v=Math.abs(g)<5;let y;if(r||(r=v?.01:2),n||(n=v?.005:.5),f<1){const e=gi(x,f);y=t=>{const n=Math.exp(-f*x*t);return a-n*((m+f*x*g)/e*Math.sin(e*t)+g*Math.cos(e*t))}}else if(1===f)y=e=>a-Math.exp(-x*e)*(g+(m+x*g)*e);else{const e=x*Math.sqrt(f*f-1);y=t=>{const n=Math.exp(-f*x*t),r=Math.min(e*t,300);return a-n*((m+f*x*g)*Math.sinh(r)+e*g*Math.cosh(r))/e}}return{calculatedDuration:p&&u||null,next:e=>{const t=y(e);if(p)o.done=e>=u;else{let i=m;0!==e&&(i=f<1?hi(y,e,t):0);const s=Math.abs(i)<=r,l=Math.abs(a-t)<=n;o.done=s&&l}return o.value=o.done?a:t,o}}}function _i(e){let{keyframes:t,velocity:n=0,power:r=.8,timeConstant:i=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:u}=e;const h=t[0],p={done:!1,value:h},m=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let f=r*n;const g=h+f,x=void 0===o?g:o(g);x!==g&&(f=x-h);const v=e=>-f*Math.exp(-e/i),y=e=>x+v(e),b=e=>{const t=v(e),n=y(e);p.done=Math.abs(t)<=d,p.value=p.done?x:n};let w,_;const S=e=>{(e=>void 0!==l&&e<l||void 0!==c&&e>c)(p.value)&&(w=e,_=wi({keyframes:[p.value,m(p.value)],velocity:hi(y,e,p.value),damping:s,stiffness:a,restDelta:d,restSpeed:u}))};return S(0),{calculatedDuration:null,next:e=>{let t=!1;return _||void 0!==w||(t=!0,b(e),S(e)),void 0!==w&&e>w?_.next(e-w):(!t&&b(e),p)}}}const Si=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:()=>kn.update(t,!0),stop:()=>Tn(t),now:()=>Pn.isProcessing?Pn.timestamp:performance.now()}};function Ni(e){let t=0;let n=e.next(t);for(;!n.done&&t<2e4;)t+=50,n=e.next(t);return t>=2e4?1/0:t}const ji=["autoplay","delay","driver","keyframes","type","repeat","repeatDelay","repeatType","onPlay","onStop","onComplete","onUpdate"],Ai={decay:_i,inertia:_i,tween:di,keyframes:di,spring:wi};function Mi(e){let t,n,{autoplay:r=!0,delay:i=0,driver:s=Si,keyframes:a,type:o="keyframes",repeat:l=0,repeatDelay:c=0,repeatType:d="loop",onPlay:u,onStop:h,onComplete:p,onUpdate:m}=e,f=Ie(e,ji),g=1,x=!1;const v=()=>{n=new Promise(e=>{t=e})};let y;v();const b=Ai[o]||di;let w;b!==di&&"number"!==typeof a[0]&&(w=li([0,100],a,{clamp:!1}),a=[0,100]);const _=b(qe(qe({},f),{},{keyframes:a}));let S;"mirror"===d&&(S=b(qe(qe({},f),{},{keyframes:[...a].reverse(),velocity:-(f.velocity||0)})));let N="idle",j=null,A=null,M=null;null===_.calculatedDuration&&l&&(_.calculatedDuration=Ni(_));const{calculatedDuration:E}=_;let C=1/0,k=1/0;null!==E&&(C=E+c,k=C*(l+1)-c);let T=0;const P=e=>{if(null===A)return;g>0&&(A=Math.min(A,e)),g<0&&(A=Math.min(e-k/g,A)),T=null!==j?j:Math.round(e-A)*g;const t=T-i*(g>=0?1:-1),n=g>=0?t<0:t>k;T=Math.max(t,0),"finished"===N&&null===j&&(T=k);let r=T,s=_;if(l){const e=Math.min(T,k)/C;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,l+1);Boolean(t%2)&&("reverse"===d?(n=1-n,c&&(n-=c/C)):"mirror"===d&&(s=S)),r=Tt(0,1,n)*C}const o=n?{done:!1,value:a[0]}:s.next(r);w&&(o.value=w(o.value));let{done:u}=o;n||null===E||(u=g>=0?T>=k:T<=0);const h=null===j&&("finished"===N||"running"===N&&u);return m&&m(o.value),h&&I(),o},L=()=>{y&&y.stop(),y=void 0},R=()=>{N="idle",L(),t(),v(),A=M=null},I=()=>{N="finished",p&&p(),L(),t()},F=()=>{if(x)return;y||(y=s(P));const e=y.now();u&&u(),null!==j?A=e-j:A&&"finished"!==N||(A=e),"finished"===N&&v(),M=A,j=null,N="running",y.start()};r&&F();const O={then:(e,t)=>n.then(e,t),get time(){return dr(T)},set time(e){e=cr(e),T=e,null===j&&y&&0!==g?A=y.now()-e/g:j=e},get duration(){const e=null===_.calculatedDuration?Ni(_):_.calculatedDuration;return dr(e)},get speed(){return g},set speed(e){e!==g&&y&&(g=e,O.time=dr(T))},get state(){return N},play:F,pause:()=>{N="paused",j=T},stop:()=>{x=!0,"idle"!==N&&(N="idle",h&&h(),R())},cancel:()=>{null!==M&&P(M),R()},complete:()=>{N="finished"},sample:e=>(A=0,P(e))};return O}const Ei=["onUpdate","onComplete"],Ci=function(e){let t;return()=>(void 0===t&&(t=e()),t)}(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),ki=new Set(["opacity","clipPath","filter","transform","backgroundColor"]);function Ti(e,t,n){let{onUpdate:r,onComplete:i}=n,s=Ie(n,Ei);if(!(Ci()&&ki.has(t)&&!s.repeatDelay&&"mirror"!==s.repeatType&&0!==s.damping&&"inertia"!==s.type))return!1;let a,o,l=!1,c=!1;const d=()=>{o=new Promise(e=>{a=e})};d();let{keyframes:u,duration:h=300,ease:p,times:m}=s;if(((e,t)=>"spring"===t.type||"backgroundColor"===e||!pr(t.ease))(t,s)){const e=Mi(qe(qe({},s),{},{repeat:0,delay:0}));let t={done:!1,value:u[0]};const n=[];let r=0;for(;!t.done&&r<2e4;)t=e.sample(r),n.push(t.value),r+=10;m=void 0,u=n,h=r-10,p="linear"}const f=function(e,t,n){let{delay:r=0,duration:i,repeat:s=0,repeatType:a="loop",ease:o,times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const c={[t]:n};l&&(c.offset=l);const d=gr(o);return Array.isArray(d)&&(c.easing=d),e.animate(c,{delay:r,duration:i,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:"reverse"===a?"alternate":"normal"})}(e.owner.current,t,u,qe(qe({},s),{},{duration:h,ease:p,times:m})),g=()=>{c=!1,f.cancel()},x=()=>{c=!0,kn.update(g),a(),d()};f.onfinish=()=>{c||(e.set(function(e,t){let{repeat:n,repeatType:r="loop"}=t;return e[n&&"loop"!==r&&n%2===1?0:e.length-1]}(u,s)),i&&i(),x())};const v={then:(e,t)=>o.then(e,t),attachTimeline:e=>(f.timeline=e,f.onfinish=null,Mn),get time(){return dr(f.currentTime||0)},set time(e){f.currentTime=cr(e)},get speed(){return f.playbackRate},set speed(e){f.playbackRate=e},get duration(){return dr(h)},play:()=>{l||(f.play(),Tn(g))},pause:()=>f.pause(),stop:()=>{if(l=!0,"idle"===f.playState)return;const{currentTime:t}=f;if(t){const n=Mi(qe(qe({},s),{},{autoplay:!1}));e.setWithVelocity(n.sample(t-10).value,n.sample(t).value,10)}x()},complete:()=>{c||f.finish()},cancel:x};return v}const Pi={type:"spring",stiffness:500,damping:25,restSpeed:10},Li={type:"keyframes",duration:.8},Ri={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Ii=(e,t)=>{let{keyframes:n}=t;return n.length>2?Li:_t.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:Pi:Ri},Fi=(e,t)=>"zIndex"!==e&&(!("number"!==typeof t&&!Array.isArray(t))||!("string"!==typeof t||!$r.test(t)&&"0"!==t||t.startsWith("url("))),Oi=new Set(["brightness","contrast","saturate","opacity"]);function Di(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[r]=n.match(Ft)||[];if(!r)return e;const i=n.replace(r,"");let s=Oi.has(t)?1:0;return r!==n&&(s*=100),t+"("+s+i+")"}const Ui=/([a-z-]*)\(.*?\)/g,zi=qe(qe({},$r),{},{getAnimatableNone:e=>{const t=e.match(Ui);return t?t.map(Di).join(" "):e}}),Bi=qe(qe({},Yt),{},{color:Dr,backgroundColor:Dr,outlineColor:Dr,fill:Dr,stroke:Dr,borderColor:Dr,borderTopColor:Dr,borderRightColor:Dr,borderBottomColor:Dr,borderLeftColor:Dr,filter:zi,WebkitFilter:zi}),Vi=e=>Bi[e];function Hi(e,t){let n=Vi(e);return n!==zi&&(n=$r),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const Wi=e=>/^0[^.\s]+$/.test(e);function Gi(e){return"number"===typeof e?0===e:null!==e?"none"===e||"0"===e||Wi(e):void 0}const qi=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];function Xi(e,t){return e[t]||e.default||e}const Yi=!1,Zi=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i=>{const s=Xi(r,e)||{},a=s.delay||r.delay||0;let{elapsed:o=0}=r;o-=cr(a);const l=function(e,t,n,r){const i=Fi(t,n);let s;s=Array.isArray(n)?[...n]:[null,n];const a=void 0!==r.from?r.from:e.get();let o;const l=[];for(let c=0;c<s.length;c++)null===s[c]&&(s[c]=0===c?a:s[c-1]),Gi(s[c])&&l.push(c),"string"===typeof s[c]&&"none"!==s[c]&&"0"!==s[c]&&(o=s[c]);if(i&&l.length&&o)for(let c=0;c<l.length;c++)s[l[c]]=Hi(t,o);return s}(t,e,n,s),c=l[0],d=l[l.length-1],u=Fi(e,c),h=Fi(e,d);or(u===h,"You are trying to animate ".concat(e,' from "').concat(c,'" to "').concat(d,'". ').concat(c," is not an animatable value - to enable this animation set ").concat(c," to a value animatable to ").concat(d," via the `style` property."));let p=qe(qe({keyframes:l,velocity:t.getVelocity(),ease:"easeOut"},s),{},{delay:-o,onUpdate:e=>{t.set(e),s.onUpdate&&s.onUpdate(e)},onComplete:()=>{i(),s.onComplete&&s.onComplete()}});if(function(e){let{when:t,delay:n,delayChildren:r,staggerChildren:i,staggerDirection:s,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:d}=e,u=Ie(e,qi);return!!Object.keys(u).length}(s)||(p=qe(qe({},p),Ii(e,p))),p.duration&&(p.duration=cr(p.duration)),p.repeatDelay&&(p.repeatDelay=cr(p.repeatDelay)),!u||!h||ur||!1===s.type||Yi)return function(e){let{keyframes:t,delay:n,onUpdate:r,onComplete:i}=e;const s=()=>(r&&r(t[t.length-1]),i&&i(),{time:0,speed:1,duration:0,play:Mn,pause:Mn,stop:Mn,then:e=>(e(),Promise.resolve()),cancel:Mn,complete:Mn});return n?Mi({keyframes:[0,1],duration:0,delay:n,onComplete:s}):s()}(ur?qe(qe({},p),{},{delay:0}):p);if(!r.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const n=Ti(t,e,p);if(n)return n}return Mi(p)}};function Ji(e){return Boolean(Nt(e)&&e.add)}const Ki=e=>/^\-?\d*\.?\d+$/.test(e);function Qi(e,t){-1===e.indexOf(t)&&e.push(t)}function $i(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class es{constructor(){this.subscriptions=[]}add(e){return Qi(this.subscriptions,e),()=>$i(this.subscriptions,e)}notify(e,t,n){const r=this.subscriptions.length;if(r)if(1===r)this.subscriptions[0](e,t,n);else for(let i=0;i<r;i++){const r=this.subscriptions[i];r&&r(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ts={current:void 0};class ns{constructor(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.prev=t.current,t.current=e;const{delta:r,timestamp:i}=Pn;t.lastUpdated!==i&&(t.timeDelta=r,t.lastUpdated=i,kn.postRender(t.scheduleVelocityCheck)),t.prev!==t.current&&t.events.change&&t.events.change.notify(t.current),t.events.velocityChange&&t.events.velocityChange.notify(t.getVelocity()),n&&t.events.renderRequest&&t.events.renderRequest.notify(t.current)},this.scheduleVelocityCheck=()=>kn.postRender(this.velocityCheck),this.velocityCheck=e=>{let{timestamp:t}=e;t!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=(r=this.current,!isNaN(parseFloat(r))),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new es);const n=this.events[e].add(t);return"change"===e?()=>{n(),kn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,n){this.set(t),this.prev=e,this.timeDelta=n}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return ts.current&&ts.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?ui(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function rs(e,t){return new ns(e,t)}const is=e=>t=>t.test(e),ss=[Pt,Ht,Vt,Bt,Gt,Wt,{test:e=>"auto"===e,parse:e=>e}],as=e=>ss.find(is(e)),os=[...ss,Dr,$r],ls=e=>os.find(is(e)),cs=["transitionEnd","transition"];function ds(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,rs(n))}function us(e,t){const n=ar(e,t);let r=n?e.makeTargetAnimatable(n,!1):{},{transitionEnd:i={},transition:s={}}=r,a=Ie(r,cs);a=qe(qe({},a),i);for(const o in a){ds(e,o,_n(a[o]))}}function hs(e,t){if(!t)return;return(t[e]||t.default||t).from}const ps=["transition","transitionEnd"];function ms(e,t){let{protectedKeys:n,needsAnimating:r}=e;const i=n.hasOwnProperty(t)&&!0!==r[t];return r[t]=!1,i}function fs(e,t){const n=e.get();if(!Array.isArray(t))return n!==t;for(let r=0;r<t.length;r++)if(t[r]!==n)return!0}function gs(e,t){let{delay:n=0,transitionOverride:r,type:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=e.makeTargetAnimatable(t),{transition:a=e.getDefaultTransition(),transitionEnd:o}=s,l=Ie(s,ps);const c=e.getValue("willChange");r&&(a=r);const d=[],u=i&&e.animationState&&e.animationState.getState()[i];for(const h in l){const t=e.getValue(h),r=l[h];if(!t||void 0===r||u&&ms(u,h))continue;const i=qe({delay:n,elapsed:0},Xi(a||{},h));if(window.HandoffAppearAnimations){const n=e.getProps()[et];if(n){const e=window.HandoffAppearAnimations(n,h,t,kn);null!==e&&(i.elapsed=e,i.isHandoff=!0)}}let s=!i.isHandoff&&!fs(t,r);if("spring"===i.type&&(t.getVelocity()||i.velocity)&&(s=!1),t.animation&&(s=!1),s)continue;t.start(Zi(h,t,r,e.shouldReduceMotion&&_t.has(h)?{type:!1}:i));const o=t.animation;Ji(c)&&(c.add(h),o.then(()=>c.remove(h))),d.push(o)}return o&&Promise.all(d).then(()=>{o&&us(e,o)}),d}function xs(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=ar(e,t,n.custom);let{transition:i=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const s=r?()=>Promise.all(gs(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:s=0,staggerChildren:a,staggerDirection:o}=i;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5?arguments[5]:void 0;const a=[],o=(e.variantChildren.size-1)*r,l=1===i?function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*r}:function(){return o-(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*r};return Array.from(e.variantChildren).sort(vs).forEach((e,r)=>{e.notify("AnimationStart",t),a.push(xs(e,t,qe(qe({},s),{},{delay:n+l(r)})).then(()=>e.notify("AnimationComplete",t)))}),Promise.all(a)}(e,t,s+r,a,o,n)}:()=>Promise.resolve(),{when:o}=i;if(o){const[e,t]="beforeChildren"===o?[s,a]:[a,s];return e().then(()=>t())}return Promise.all([s(),a(n.delay)])}function vs(e,t){return e.sortNodePosition(t)}const ys=["transition","transitionEnd"],bs=[...it].reverse(),ws=it.length;function _s(e){return t=>Promise.all(t.map(t=>{let{animation:n,options:r}=t;return function(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const i=t.map(t=>xs(e,t,r));n=Promise.all(i)}else if("string"===typeof t)n=xs(e,t,r);else{const i="function"===typeof t?ar(e,t,r.custom):t;n=Promise.all(gs(e,i,r))}return n.then(()=>e.notify("AnimationComplete",t))}(e,n,r)}))}function Ss(e){let t=_s(e);const n={animate:js(!0),whileInView:js(),whileHover:js(),whileTap:js(),whileDrag:js(),whileFocus:js(),exit:js()};let r=!0;const i=(t,n)=>{const r=ar(e,n);if(r){const{transition:e,transitionEnd:n}=r,i=Ie(r,ys);t=qe(qe(qe({},t),i),n)}return t};function s(s,a){const o=e.getProps(),l=e.getVariantContext(!0)||{},c=[],d=new Set;let u={},h=1/0;for(let t=0;t<ws;t++){const p=bs[t],m=n[p],f=void 0!==o[p]?o[p]:l[p],g=nt(f),x=p===a?m.isActive:null;!1===x&&(h=t);let v=f===l[p]&&f!==o[p]&&g;if(v&&r&&e.manuallyAnimateOnMount&&(v=!1),m.protectedKeys=qe({},u),!m.isActive&&null===x||!f&&!m.prevProp||rt(f)||"boolean"===typeof f)continue;let y=Ns(m.prevProp,f)||p===a&&m.isActive&&!v&&g||t>h&&g,b=!1;const w=Array.isArray(f)?f:[f];let _=w.reduce(i,{});!1===x&&(_={});const{prevResolvedValues:S={}}=m,N=qe(qe({},S),_),j=e=>{y=!0,d.has(e)&&(b=!0,d.delete(e)),m.needsAnimating[e]=!0};for(const e in N){const t=_[e],n=S[e];if(u.hasOwnProperty(e))continue;let r=!1;r=wn(t)&&wn(n)?!sr(t,n):t!==n,r?void 0!==t?j(e):d.add(e):void 0!==t&&d.has(e)?j(e):m.protectedKeys[e]=!0}m.prevProp=f,m.prevResolvedValues=_,m.isActive&&(u=qe(qe({},u),_)),r&&e.blockInitialAnimation&&(y=!1),!y||v&&!b||c.push(...w.map(e=>({animation:e,options:qe({type:p},s)})))}if(d.size){const t={};d.forEach(n=>{const r=e.getBaseTarget(n);void 0!==r&&(t[n]=r)}),c.push({animation:t})}let p=Boolean(c.length);return!r||!1!==o.initial&&o.initial!==o.animate||e.manuallyAnimateOnMount||(p=!1),r=!1,p?t(c):Promise.resolve()}return{animateChanges:s,setActive:function(t,r,i){var a;if(n[t].isActive===r)return Promise.resolve();null===(a=e.variantChildren)||void 0===a||a.forEach(e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,r)}),n[t].isActive=r;const o=s(i,t);for(const e in n)n[e].protectedKeys={};return o},setAnimateFunction:function(n){t=n(e)},getState:()=>n}}function Ns(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!sr(t,e)}function js(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}let As=0;const Ms={animation:{Feature:class extends Xn{constructor(e){super(e),e.animationState||(e.animationState=Ss(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),rt(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){}}},exit:{Feature:class extends Xn{constructor(){super(...arguments),this.id=As++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t,custom:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const i=this.node.animationState.setActive("exit",!e,{custom:null!==n&&void 0!==n?n:this.node.getProps().custom});t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}}},Es=(e,t)=>Math.abs(e-t);class Cs{constructor(e,t){let{transformPagePoint:n,contextWindow:r,dragSnapToOrigin:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=Ps(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=Es(e.x,t.x),r=Es(e.y,t.y);return Math.sqrt(n**2+r**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!n)return;const{point:r}=e,{timestamp:i}=Pn;this.history.push(qe(qe({},r),{},{timestamp:i}));const{onStart:s,onMove:a}=this.handlers;t||(s&&s(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),a&&a(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=ks(t,this.transformPagePoint),kn.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:r,resumeAnimation:i}=this.handlers;if(this.dragSnapToOrigin&&i&&i(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const s=Ps("pointercancel"===e.type?this.lastMoveEventInfo:ks(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,s),r&&r(e,s)},!On(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=n,this.contextWindow=r||window;const s=ks(Dn(e),this.transformPagePoint),{point:a}=s,{timestamp:o}=Pn;this.history=[qe(qe({},a),{},{timestamp:o})];const{onSessionStart:l}=t;l&&l(e,Ps(s,this.history)),this.removeListeners=Bn(Un(this.contextWindow,"pointermove",this.handlePointerMove),Un(this.contextWindow,"pointerup",this.handlePointerUp),Un(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Tn(this.updatePoint)}}function ks(e,t){return t?{point:t(e.point)}:e}function Ts(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ps(e,t){let{point:n}=e;return{point:n,delta:Ts(n,Rs(t)),offset:Ts(n,Ls(t)),velocity:Is(t,.1)}}function Ls(e){return e[0]}function Rs(e){return e[e.length-1]}function Is(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const i=Rs(e);for(;n>=0&&(r=e[n],!(i.timestamp-r.timestamp>cr(t)));)n--;if(!r)return{x:0,y:0};const s=dr(i.timestamp-r.timestamp);if(0===s)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function Fs(e){return e.max-e.min}function Os(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;return Math.abs(e-t)<=n}function Ds(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=r,e.originPoint=Ur(t.min,t.max,e.origin),e.scale=Fs(n)/Fs(t),(Os(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=Ur(n.min,n.max,e.origin)-e.originPoint,(Os(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Us(e,t,n,r){Ds(e.x,t.x,n.x,r?r.originX:void 0),Ds(e.y,t.y,n.y,r?r.originY:void 0)}function zs(e,t,n){e.min=n.min+t.min,e.max=e.min+Fs(t)}function Bs(e,t,n){e.min=t.min-n.min,e.max=e.min+Fs(t)}function Vs(e,t,n){Bs(e.x,t.x,n.x),Bs(e.y,t.y,n.y)}function Hs(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function Ws(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}const Gs=.35;function qs(e,t,n){return{min:Xs(e,t),max:Xs(e,n)}}function Xs(e,t){return"number"===typeof e?e:e[t]||0}const Ys=()=>({x:{min:0,max:0},y:{min:0,max:0}});function Zs(e){return[e("x"),e("y")]}function Js(e){let{top:t,left:n,right:r,bottom:i}=e;return{x:{min:n,max:r},y:{min:t,max:i}}}function Ks(e){return void 0===e||1===e}function Qs(e){let{scale:t,scaleX:n,scaleY:r}=e;return!Ks(t)||!Ks(n)||!Ks(r)}function $s(e){return Qs(e)||ea(e)||e.z||e.rotate||e.rotateX||e.rotateY}function ea(e){return ta(e.x)||ta(e.y)}function ta(e){return e&&"0%"!==e}function na(e,t,n){return n+t*(e-n)}function ra(e,t,n,r,i){return void 0!==i&&(e=na(e,i,r)),na(e,n,r)+t}function ia(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;e.min=ra(e.min,t,n,r,i),e.max=ra(e.max,t,n,r,i)}function sa(e,t){let{x:n,y:r}=t;ia(e.x,n.translate,n.scale,n.originPoint),ia(e.y,r.translate,r.scale,r.originPoint)}function aa(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function oa(e,t){e.min=e.min+t,e.max=e.max+t}function la(e,t,n){let[r,i,s]=n;const a=void 0!==t[s]?t[s]:.5,o=Ur(e.min,e.max,a);ia(e,t[r],t[i],o,t.scale)}const ca=["x","scaleX","originX"],da=["y","scaleY","originY"];function ua(e,t){la(e.x,t,ca),la(e.y,t,da)}function ha(e,t){return Js(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}(e.getBoundingClientRect(),t))}const pa=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},ma=new WeakMap;class fa{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.visualElement=e}start(e){let{snapToCursor:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:r}=this.getProps();this.panSession=new Cs(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Dn(e,"page").point)},onStart:(e,t)=>{const{drag:n,dragPropagation:r,onDragStart:i}=this.getProps();if(n&&!r&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=Gn(n),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Zs(e=>{let t=this.getAxisMotionValue(e).get()||0;if(Vt.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const r=n.layout.layoutBox[e];if(r){t=Fs(r)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),i&&kn.update(()=>i(e,t),!1,!0);const{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},onMove:(e,t)=>{const{dragPropagation:n,dragDirectionLock:r,onDirectionLock:i,onDrag:s}=this.getProps();if(!n&&!this.openGlobalLock)return;const{offset:a}=t;if(r&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(a),void(null!==this.currentDirection&&i&&i(this.currentDirection));this.updateAxis("x",t.point,a),this.updateAxis("y",t.point,a),this.visualElement.render(),s&&s(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>Zs(e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:r,contextWindow:pa(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:r}=t;this.startAnimation(r);const{onDragEnd:i}=this.getProps();i&&kn.update(()=>i(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:r}=this.getProps();if(!n||!ga(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let s=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(s=function(e,t,n){let{min:r,max:i}=t;return void 0!==r&&e<r?e=n?Ur(r,e,n.min):Math.max(e,r):void 0!==i&&e>i&&(e=n?Ur(i,e,n.max):Math.min(e,i)),e}(s,this.constraints[e],this.elastic[e])),i.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,i=this.constraints;t&&tt(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!r)&&function(e,t){let{top:n,left:r,bottom:i,right:s}=t;return{x:Hs(e.x,r,s),y:Hs(e.y,n,i)}}(r.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gs;return!1===e?e=0:!0===e&&(e=Gs),{x:qs(e,"left","right"),y:qs(e,"top","bottom")}}(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Zs(e=>{this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(r.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!tt(e))return!1;const n=e.current;lr(null!==n,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");const{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=function(e,t,n){const r=ha(e,n),{scroll:i}=t;return i&&(oa(r.x,i.offset.x),oa(r.y,i.offset.y)),r}(n,r.root,this.visualElement.getTransformPagePoint());let s=function(e,t){return{x:Ws(e.x,t.x),y:Ws(e.y,t.y)}}(r.layout.layoutBox,i);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=Js(e))}return s}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:r,dragTransition:i,dragSnapToOrigin:s,onDragTransitionEnd:a}=this.getProps(),o=this.constraints||{},l=Zs(a=>{if(!ga(a,t,this.currentDirection))return;let l=o&&o[a]||{};s&&(l={min:0,max:0});const c=r?200:1e6,d=r?40:1e7,u=qe(qe({type:"inertia",velocity:n?e[a]:0,bounceStiffness:c,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10},i),l);return this.startAxisValueAnimation(a,u)});return Promise.all(l).then(a)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return n.start(Zi(e,n,0,t))}stopAnimation(){Zs(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Zs(e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()})}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag"+e.toUpperCase(),n=this.visualElement.getProps(),r=n[t];return r||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Zs(t=>{const{drag:n}=this.getProps();if(!ga(t,n,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(t);if(r&&r.layout){const{min:n,max:s}=r.layout.layoutBox[t];i.set(e[t]-Ur(n,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!tt(t)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Zs(e=>{const t=this.getAxisMotionValue(e);if(t){const n=t.get();r[e]=function(e,t){let n=.5;const r=Fs(e),i=Fs(t);return i>r?n=si(t.min,t.max-r,e.min):r>i&&(n=si(e.min,e.max-i,t.min)),Tt(0,1,n)}({min:n,max:n},this.constraints[e])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Zs(t=>{if(!ga(t,e,null))return;const n=this.getAxisMotionValue(t),{min:i,max:s}=this.constraints[t];n.set(Ur(i,s,r[t]))})}addListeners(){if(!this.visualElement.current)return;ma.set(this.visualElement,this);const e=Un(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();tt(e)&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,r=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),t();const i=Fn(window,"resize",()=>this.scalePositionWithinConstraints()),s=n.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(Zs(e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))}),this.visualElement.render())});return()=>{i(),e(),r(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:s=Gs,dragMomentum:a=!0}=e;return qe(qe({},e),{},{drag:t,dragDirectionLock:n,dragPropagation:r,dragConstraints:i,dragElastic:s,dragMomentum:a})}}function ga(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const xa=e=>(t,n)=>{e&&kn.update(()=>e(t,n))};const va={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ya(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ba={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!Ht.test(e))return e;e=parseFloat(e)}const n=ya(e,t.target.x),r=ya(e,t.target.y);return"".concat(n,"% ").concat(r,"%")}},wa={correct:(e,t)=>{let{treeScale:n,projectionDelta:r}=t;const i=e,s=$r.parse(e);if(s.length>5)return i;const a=$r.createTransformer(e),o="number"!==typeof s[0]?1:0,l=r.x.scale*n.x,c=r.y.scale*n.y;s[0+o]/=l,s[1+o]/=c;const d=Ur(l,c,.5);return"number"===typeof s[2+o]&&(s[2+o]/=d),"number"===typeof s[3+o]&&(s[3+o]/=d),a(s)}};class _a extends i.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:r}=this.props,{projection:i}=e;var s;s=Na,Object.assign(bt,s),i&&(t.group&&t.group.add(i),n&&n.register&&r&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions(qe(qe({},i.options),{},{onExitComplete:()=>this.safeToRemove()}))),va.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:r,isPresent:i}=this.props,s=n.projection;return s?(s.isPresent=i,r||e.layoutDependency!==t||void 0===t?s.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?s.promote():s.relegate()||kn.postRender(()=>{const e=s.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Sa(e){const[t,n]=function(){const e=(0,i.useContext)(Ze);if(null===e)return[!0,null];const{isPresent:t,onExitComplete:n,register:r}=e,s=(0,i.useId)();return(0,i.useEffect)(()=>r(s),[]),!t&&n?[!1,()=>n&&n(s)]:[!0]}(),r=(0,i.useContext)(ht);return i.createElement(_a,qe(qe({},e),{},{layoutGroup:r,switchLayoutGroup:(0,i.useContext)(pt),isPresent:t,safeToRemove:n}))}const Na={borderRadius:qe(qe({},ba),{},{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:ba,borderTopRightRadius:ba,borderBottomLeftRadius:ba,borderBottomRightRadius:ba,boxShadow:wa},ja=["TopLeft","TopRight","BottomLeft","BottomRight"],Aa=ja.length,Ma=e=>"string"===typeof e?parseFloat(e):e,Ea=e=>"number"===typeof e||Ht.test(e);function Ca(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const ka=Pa(0,.5,jr),Ta=Pa(.5,.95,Mn);function Pa(e,t,n){return r=>r<e?0:r>t?1:n(si(e,t,r))}function La(e,t){e.min=t.min,e.max=t.max}function Ra(e,t){La(e.x,t.x),La(e.y,t.y)}function Ia(e,t,n,r,i){return e=na(e-=t,1/n,r),void 0!==i&&(e=na(e,1/i,r)),e}function Fa(e,t,n,r,i){let[s,a,o]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;Vt.test(t)&&(t=parseFloat(t),t=Ur(a.min,a.max,t/100)-a.min);if("number"!==typeof t)return;let o=Ur(s.min,s.max,r);e===s&&(o-=t),e.min=Ia(e.min,t,n,o,i),e.max=Ia(e.max,t,n,o,i)}(e,t[s],t[a],t[o],t.scale,r,i)}const Oa=["x","scaleX","originX"],Da=["y","scaleY","originY"];function Ua(e,t,n,r){Fa(e.x,t,Oa,n?n.x:void 0,r?r.x:void 0),Fa(e.y,t,Da,n?n.y:void 0,r?r.y:void 0)}function za(e){return 0===e.translate&&1===e.scale}function Ba(e){return za(e.x)&&za(e.y)}function Va(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function Ha(e){return Fs(e.x)/Fs(e.y)}class Wa{constructor(){this.members=[]}add(e){Qi(this.members,e),e.scheduleRender()}remove(e){if($i(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let n;for(let r=t;r>=0;r--){const e=this.members[r];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;!1===r&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ga(e,t,n){let r="";const i=e.x.translate/t.x,s=e.y.translate/t.y;if((i||s)&&(r="translate3d(".concat(i,"px, ").concat(s,"px, 0) ")),1===t.x&&1===t.y||(r+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),n){const{rotate:e,rotateX:t,rotateY:i}=n;e&&(r+="rotate(".concat(e,"deg) ")),t&&(r+="rotateX(".concat(t,"deg) ")),i&&(r+="rotateY(".concat(i,"deg) "))}const a=e.x.scale*t.x,o=e.y.scale*t.y;return 1===a&&1===o||(r+="scale(".concat(a,", ").concat(o,")")),r||"none"}const qa=(e,t)=>e.depth-t.depth;class Xa{constructor(){this.children=[],this.isDirty=!1}add(e){Qi(this.children,e),this.isDirty=!0}remove(e){$i(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(qa),this.isDirty=!1,this.children.forEach(e)}}const Ya=["","X","Y","Z"],Za={visibility:"hidden"};let Ja=0;const Ka={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Qa(e){let{attachResizeListener:t,defaultParent:n,measureScroll:r,checkIsScrollRoot:i,resetTransform:s}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=Ja++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ka.totalNodes=Ka.resolvedTargetDeltas=Ka.recalculatedProjection=0,this.nodes.forEach(to),this.nodes.forEach(lo),this.nodes.forEach(co),this.nodes.forEach(no),function(e){window.MotionDebug&&window.MotionDebug.record(e)}(Ka)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new Xa)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new es),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t&&t.notify(...r)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root.hasTreeAnimated;if(this.instance)return;var r;this.isSVG=(r=e)instanceof SVGElement&&"svg"!==r.tagName,this.instance=e;const{layoutId:i,layout:s,visualElement:a}=this.options;if(a&&!a.current&&a.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),n&&(s||i)&&(this.isLayoutDirty=!0),t){let n;const r=()=>this.root.updateBlockedByResize=!1;t(e,()=>{this.root.updateBlockedByResize=!0,n&&n(),n=function(e,t){const n=performance.now(),r=i=>{let{timestamp:s}=i;const a=s-n;a>=t&&(Tn(r),e(a-t))};return kn.read(r,!0),()=>Tn(r)}(r,250),va.hasAnimatedSinceResize&&(va.hasAnimatedSinceResize=!1,this.nodes.forEach(oo))})}i&&this.root.registerSharedNode(i,this),!1!==this.options.animate&&a&&(i||s)&&this.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n,hasRelativeTargetChanged:r,layout:i}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const s=this.options.transition||a.getDefaultTransition()||go,{onLayoutAnimationStart:o,onLayoutAnimationComplete:l}=a.getProps(),c=!this.targetLayout||!Va(this.targetLayout,i)||r,d=!n&&r;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||d||n&&(c||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,d);const e=qe(qe({},Xi(s,"layout")),{},{onPlay:o,onComplete:l});(a.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else n||oo(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=i})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Tn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(uo),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let i=0;i<this.path.length;i++){const e=this.path[i];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(io);this.isUpdating||this.nodes.forEach(so),this.isUpdating=!1,this.nodes.forEach(ao),this.nodes.forEach($a),this.nodes.forEach(eo),this.clearAllSnapshots();const e=performance.now();Pn.delta=Tt(0,1e3/60,e-Pn.timestamp),Pn.timestamp=e,Pn.isProcessing=!0,Ln.update.process(Pn),Ln.preRender.process(Pn),Ln.render.process(Pn),Pn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(ro),this.sharedNodes.forEach(ho)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,kn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){kn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&(this.scroll={animationId:this.root.animationId,phase:e,isRoot:i(this.instance),offset:r(this.instance)})}resetTransform(){if(!s)return;const e=this.isLayoutDirty||this.shouldResetTransform,t=this.projectionDelta&&!Ba(this.projectionDelta),n=this.getTransformTemplate(),r=n?n(this.latestValues,""):void 0,i=r!==this.prevTransformTemplateValue;e&&(t||$s(this.latestValues)||i)&&(s(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);var r;return e&&(n=this.removeTransform(n)),yo((r=n).x),yo(r.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:e}=this.options;if(!e)return{x:{min:0,max:0},y:{min:0,max:0}};const t=e.measureViewportBox(),{scroll:n}=this.root;return n&&(oa(t.x,n.offset.x),oa(t.y,n.offset.y)),t}removeElementScroll(e){const t={x:{min:0,max:0},y:{min:0,max:0}};Ra(t,e);for(let n=0;n<this.path.length;n++){const r=this.path[n],{scroll:i,options:s}=r;if(r!==this.root&&i&&s.layoutScroll){if(i.isRoot){Ra(t,e);const{scroll:n}=this.root;n&&(oa(t.x,-n.offset.x),oa(t.y,-n.offset.y))}oa(t.x,i.offset.x),oa(t.y,i.offset.y)}}return t}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};Ra(n,e);for(let r=0;r<this.path.length;r++){const e=this.path[r];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&ua(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),$s(e.latestValues)&&ua(n,e.latestValues)}return $s(this.latestValues)&&ua(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};Ra(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!$s(e.latestValues))continue;Qs(e.latestValues)&&e.updateSnapshot();const r=Ys();Ra(r,e.measurePageBox()),Ua(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,r)}return $s(this.latestValues)&&Ua(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=qe(qe(qe({},this.options),e),{},{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Pn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const r=Boolean(this.resumingFrom)||this!==n;if(!(e||r&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget))return;const{layout:i,layoutId:s}=this.options;if(this.layout&&(i||s)){if(this.resolvedRelativeTargetAt=Pn.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Vs(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),Ra(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var a,o,l;if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),a=this.target,o=this.relativeTarget,l=this.relativeParent.target,zs(a.x,o.x,l.x),zs(a.y,o.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):Ra(this.target,this.layout.layoutBox),sa(this.target,this.targetDelta)):Ra(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Vs(this.relativeTargetOrigin,this.target,e.target),Ra(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ka.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!Qs(this.parent.latestValues)&&!ea(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let r=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(r=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===Pn.timestamp&&(r=!1),r)return;const{layout:i,layoutId:s}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!i&&!s)return;Ra(this.layoutCorrected,this.layout.layoutBox);const a=this.treeScale.x,o=this.treeScale.y;!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=n.length;if(!i)return;let s,a;t.x=t.y=1;for(let o=0;o<i;o++){s=n[o],a=s.projectionDelta;const i=s.instance;i&&i.style&&"contents"===i.style.display||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&ua(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,sa(e,a)),r&&$s(s.latestValues)&&ua(e,s.latestValues))}t.x=aa(t.x),t.y=aa(t.y)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox);const{target:l}=t;if(!l)return void(this.projectionTransform&&(this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionTransform="none",this.scheduleRender()));this.projectionDelta||(this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}});const c=this.projectionTransform;Us(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.projectionTransform=Ga(this.projectionDelta,this.treeScale),this.projectionTransform===c&&this.treeScale.x===a&&this.treeScale.y===o||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),Ka.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.options.scheduleRender&&this.options.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,r=n?n.latestValues:{},i=qe({},this.latestValues),s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const a={x:{min:0,max:0},y:{min:0,max:0}},o=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,d=Boolean(o&&!c&&!0===this.options.crossfade&&!this.path.some(fo));let u;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;po(s.x,e.x,n),po(s.y,e.y,n),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Vs(a,this.layout.layoutBox,this.relativeParent.layout.layoutBox),function(e,t,n,r){mo(e.x,t.x,n.x,r),mo(e.y,t.y,n.y,r)}(this.relativeTarget,this.relativeTargetOrigin,a,n),u&&function(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}(this.relativeTarget,u)&&(this.isProjectionDirty=!1),u||(u={x:{min:0,max:0},y:{min:0,max:0}}),Ra(u,this.relativeTarget)),o&&(this.animationValues=i,function(e,t,n,r,i,s){i?(e.opacity=Ur(0,void 0!==n.opacity?n.opacity:1,ka(r)),e.opacityExit=Ur(void 0!==t.opacity?t.opacity:1,0,Ta(r))):s&&(e.opacity=Ur(void 0!==t.opacity?t.opacity:1,void 0!==n.opacity?n.opacity:1,r));for(let a=0;a<Aa;a++){const i="border".concat(ja[a],"Radius");let s=Ca(t,i),o=Ca(n,i);void 0===s&&void 0===o||(s||(s=0),o||(o=0),0===s||0===o||Ea(s)===Ea(o)?(e[i]=Math.max(Ur(Ma(s),Ma(o),r),0),(Vt.test(o)||Vt.test(s))&&(e[i]+="%")):e[i]=o)}(t.rotate||n.rotate)&&(e.rotate=Ur(t.rotate||0,n.rotate||0,r))}(i,r,this.latestValues,n,d,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Tn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=kn.update(()=>{va.hasAnimatedSinceResize=!0,this.currentAnimation=function(e,t,n){const r=Nt(e)?e:rs(e);return r.start(Zi("",r,t,n)),r.animation}(0,1e3,qe(qe({},e),{},{onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:r,latestValues:i}=e;if(t&&n&&r){if(this!==e&&this.layout&&r&&bo(this.options.animationType,this.layout.layoutBox,r.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=Fs(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const r=Fs(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+r}Ra(t,n),ua(t,i),Us(this.projectionDeltaWithTransform,this.layoutCorrected,t,i)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new Wa);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=this.getStack();r&&r.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.rotate||n.rotateX||n.rotateY||n.rotateZ)&&(t=!0),!t)return;const r={};for(let i=0;i<Ya.length;i++){const t="rotate"+Ya[i];n[t]&&(r[t]=n[t],e.setStaticValue(t,0))}e.render();for(const i in r)e.setStaticValue(i,r[i]);e.scheduleRender()}getProjectionStyles(e){var t,n;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Za;const r={visibility:""},i=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,r.opacity="",r.pointerEvents=Sn(null===e||void 0===e?void 0:e.pointerEvents)||"",r.transform=i?i(this.latestValues,""):"none",r;const s=this.getLead();if(!this.projectionDelta||!this.layout||!s.target){const t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=Sn(null===e||void 0===e?void 0:e.pointerEvents)||""),this.hasProjected&&!$s(this.latestValues)&&(t.transform=i?i({},""):"none",this.hasProjected=!1),t}const a=s.animationValues||s.latestValues;this.applyTransformsToTarget(),r.transform=Ga(this.projectionDeltaWithTransform,this.treeScale,a),i&&(r.transform=i(a,r.transform));const{x:o,y:l}=this.projectionDelta;r.transformOrigin="".concat(100*o.origin,"% ").concat(100*l.origin,"% 0"),s.animationValues?r.opacity=s===this?null!==(n=null!==(t=a.opacity)&&void 0!==t?t:this.latestValues.opacity)&&void 0!==n?n:1:this.preserveOpacity?this.latestValues.opacity:a.opacityExit:r.opacity=s===this?void 0!==a.opacity?a.opacity:"":void 0!==a.opacityExit?a.opacityExit:0;for(const c in bt){if(void 0===a[c])continue;const{correct:e,applyTo:t}=bt[c],n="none"===r.transform?a[c]:e(a[c],s);if(t){const e=t.length;for(let i=0;i<e;i++)r[t[i]]=n}else r[c]=n}return this.options.layoutId&&(r.pointerEvents=s===this?Sn(null===e||void 0===e?void 0:e.pointerEvents)||"":"none"),r}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(io),this.root.sharedNodes.clear()}}}function $a(e){e.updateLayout()}function eo(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:r}=e.layout,{animationType:i}=e.options,s=n.source!==e.layout.source;"size"===i?Zs(e=>{const r=s?n.measuredBox[e]:n.layoutBox[e],i=Fs(r);r.min=t[e].min,r.max=r.min+i}):bo(i,n.layoutBox,t)&&Zs(r=>{const i=s?n.measuredBox[r]:n.layoutBox[r],a=Fs(t[r]);i.max=i.min+a,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+a)});const a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};Us(a,t,n.layoutBox);const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};s?Us(o,e.applyTransform(r,!0),n.measuredBox):Us(o,t,n.layoutBox);const l=!Ba(a);let c=!1;if(!e.resumeFrom){const r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){const{snapshot:i,layout:s}=r;if(i&&s){const a={x:{min:0,max:0},y:{min:0,max:0}};Vs(a,n.layoutBox,i.layoutBox);const o={x:{min:0,max:0},y:{min:0,max:0}};Vs(o,t,s.layoutBox),Va(a,o)||(c=!0),r.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=a,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:o,layoutDelta:a,hasLayoutChanged:l,hasRelativeTargetChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function to(e){Ka.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function no(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function ro(e){e.clearSnapshot()}function io(e){e.clearMeasurements()}function so(e){e.isLayoutDirty=!1}function ao(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function oo(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function lo(e){e.resolveTargetDelta()}function co(e){e.calcProjection()}function uo(e){e.resetRotation()}function ho(e){e.removeLeadSnapshot()}function po(e,t,n){e.translate=Ur(t.translate,0,n),e.scale=Ur(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function mo(e,t,n,r){e.min=Ur(t.min,n.min,r),e.max=Ur(t.max,n.max,r)}function fo(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const go={duration:.45,ease:[.4,0,.1,1]},xo=e=>"undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().includes(e),vo=xo("applewebkit/")&&!xo("chrome/")?Math.round:Mn;function yo(e){e.min=vo(e.min),e.max=vo(e.max)}function bo(e,t,n){return"position"===e||"preserve-aspect"===e&&!Os(Ha(t),Ha(n),.2)}const wo=Qa({attachResizeListener:(e,t)=>Fn(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),_o={current:void 0},So=Qa({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!_o.current){const e=new wo({});e.mount(window),e.setOptions({layoutScroll:!0}),_o.current=e}return _o.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),No={pan:{Feature:class extends Xn{constructor(){super(...arguments),this.removePointerDownListener=Mn}onPointerDown(e){this.session=new Cs(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:pa(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:xa(e),onStart:xa(t),onMove:n,onEnd:(e,t)=>{delete this.session,r&&kn.update(()=>r(e,t))}}}mount(){this.removePointerDownListener=Un(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends Xn{constructor(e){super(e),this.removeGroupControls=Mn,this.removeListeners=Mn,this.controls=new fa(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Mn}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:So,MeasureLayout:Sa}};const jo=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Ao(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;lr(n<=4,'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.'));const[r,i]=function(e){const t=jo.exec(e);if(!t)return[,];const[,n,r]=t;return[n,r]}(e);if(!r)return;const s=window.getComputedStyle(t).getPropertyValue(r);if(s){const e=s.trim();return Ki(e)?parseFloat(e):e}return Ct(i)?Ao(i,t,n+1):i}function Mo(e,t,n){let r=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(t),t));const i=e.current;if(!(i instanceof Element))return{target:r,transitionEnd:n};n&&(n=qe({},n)),e.values.forEach(e=>{const t=e.get();if(!Ct(t))return;const n=Ao(t,i);n&&e.set(n)});for(const s in r){const e=r[s];if(!Ct(e))continue;const t=Ao(e,i);t&&(r[s]=t,n||(n={}),void 0===n[s]&&(n[s]=e))}return{target:r,transitionEnd:n}}const Eo=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),Co=e=>Eo.has(e),ko=e=>e===Pt||e===Ht,To=(e,t)=>parseFloat(e.split(", ")[t]),Po=(e,t)=>(n,r)=>{let{transform:i}=r;if("none"===i||!i)return 0;const s=i.match(/^matrix3d\((.+)\)$/);if(s)return To(s[1],t);{const t=i.match(/^matrix\((.+)\)$/);return t?To(t[1],e):0}},Lo=new Set(["x","y","z"]),Ro=wt.filter(e=>!Lo.has(e));const Io={width:(e,t)=>{let{x:n}=e,{paddingLeft:r="0",paddingRight:i="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(i)},height:(e,t)=>{let{y:n}=e,{paddingTop:r="0",paddingBottom:i="0"}=t;return n.max-n.min-parseFloat(r)-parseFloat(i)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:r}=t;return parseFloat(r)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:r}=t;return parseFloat(r)+(n.max-n.min)},x:Po(4,13),y:Po(5,14)};Io.translateX=Io.x,Io.translateY=Io.y;const Fo=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t=qe({},t),r=qe({},r);const i=Object.keys(t).filter(Co);let s=[],a=!1;const o=[];if(i.forEach(i=>{const l=e.getValue(i);if(!e.hasValue(i))return;let c=n[i],d=as(c);const u=t[i];let h;if(wn(u)){const e=u.length,t=null===u[0]?1:0;c=u[t],d=as(c);for(let n=t;n<e&&null!==u[n];n++)h?lr(as(u[n])===h,"All keyframes must be of the same type"):(h=as(u[n]),lr(h===d||ko(d)&&ko(h),"Keyframes must be of the same dimension as the current value"))}else h=as(u);if(d!==h)if(ko(d)&&ko(h)){const e=l.get();"string"===typeof e&&l.set(parseFloat(e)),"string"===typeof u?t[i]=parseFloat(u):Array.isArray(u)&&h===Ht&&(t[i]=u.map(parseFloat))}else(null===d||void 0===d?void 0:d.transform)&&(null===h||void 0===h?void 0:h.transform)&&(0===c||0===u)?0===c?l.set(h.transform(c)):t[i]=d.transform(u):(a||(s=function(e){const t=[];return Ro.forEach(n=>{const r=e.getValue(n);void 0!==r&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t.length&&e.render(),t}(e),a=!0),o.push(i),r[i]=void 0!==r[i]?r[i]:t[i],l.jump(u))}),o.length){const n=o.indexOf("height")>=0?window.pageYOffset:null,i=((e,t,n)=>{const r=t.measureViewportBox(),i=t.current,s=getComputedStyle(i),{display:a}=s,o={};"none"===a&&t.setStaticValue("display",e.display||"block"),n.forEach(e=>{o[e]=Io[e](r,s)}),t.render();const l=t.measureViewportBox();return n.forEach(n=>{const r=t.getValue(n);r&&r.jump(o[n]),e[n]=Io[n](l,s)}),e})(t,e,o);return s.length&&s.forEach(t=>{let[n,r]=t;e.getValue(n).set(r)}),e.render(),Je&&null!==n&&window.scrollTo({top:n}),{target:i,transitionEnd:r}}return{target:t,transitionEnd:r}};function Oo(e,t,n,r){return(e=>Object.keys(e).some(Co))(t)?Fo(e,t,n,r):{target:t,transitionEnd:r}}const Do={current:null},Uo={current:!1};const zo=new WeakMap,Bo=["willChange"],Vo=["children"],Ho=Object.keys(ut),Wo=Ho.length,Go=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],qo=st.length;class Xo{constructor(e){let{parent:t,props:n,presenceContext:r,reducedMotionConfig:i,visualState:s}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>kn.render(this.render,!1,!0);const{latestValues:o,renderState:l}=s;this.latestValues=o,this.baseTarget=qe({},o),this.initialValues=n.initial?qe({},o):{},this.renderState=l,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.isControllingVariants=at(n),this.isVariantNode=ot(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const c=this.scrapeMotionValuesFromProps(n,{}),{willChange:d}=c,u=Ie(c,Bo);for(const h in u){const e=u[h];void 0!==o[h]&&Nt(e)&&(e.set(o[h],!1),Ji(d)&&d.add(h))}}scrapeMotionValuesFromProps(e,t){return{}}mount(e){this.current=e,zo.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),Uo.current||function(){if(Uo.current=!0,Je)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Do.current=e.matches;e.addListener(t),t()}else Do.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||Do.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){zo.delete(this.current),this.projection&&this.projection.unmount(),Tn(this.notifyUpdate),Tn(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,t){const n=_t.has(e),r=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&kn.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=t.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),i()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}loadFeatures(e,t,n,r){let i,s,{children:a}=e,o=Ie(e,Vo);for(let l=0;l<Wo;l++){const e=Ho[l],{isEnabled:t,Feature:n,ProjectionNode:r,MeasureLayout:a}=ut[e];r&&(i=r),t(o)&&(!this.features[e]&&n&&(this.features[e]=new n(this)),a&&(s=a))}if(("html"===this.type||"svg"===this.type)&&!this.projection&&i){this.projection=new i(this.latestValues,this.parent&&this.parent.projection);const{layoutId:e,layout:t,drag:n,dragConstraints:s,layoutScroll:a,layoutRoot:l}=o;this.projection.setOptions({layoutId:e,layout:t,alwaysMeasureLayout:Boolean(n)||s&&tt(s),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:"string"===typeof t?t:"both",initialPromotionConfig:r,layoutScroll:a,layoutRoot:l})}return s}updateFeatures(){for(const e in this.features){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}makeTargetAnimatable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.makeTargetAnimatableFromInstance(e,this.props,t)}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<Go.length;n++){const t=Go[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const r=e["on"+t];r&&(this.propEventSubscriptions[t]=this.on(t,r))}this.prevMotionValues=function(e,t,n){const{willChange:r}=t;for(const i in t){const s=t[i],a=n[i];if(Nt(s))e.addValue(i,s),Ji(r)&&r.add(i);else if(Nt(a))e.addValue(i,rs(s,{owner:e})),Ji(r)&&r.remove(i);else if(a!==s)if(e.hasValue(i)){const t=e.getValue(i);!t.hasAnimated&&t.set(s)}else{const t=e.getStaticValue(i);e.addValue(i,rs(void 0!==t?t:s,{owner:e}))}}for(const i in n)void 0===t[i]&&e.removeValue(i);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const e=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(e.initial=this.props.initial),e}const e={};for(let t=0;t<qo;t++){const n=st[t],r=this.props[n];(nt(r)||!1===r)&&(e[n]=r)}return e}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){t!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,t)),this.values.set(e,t),this.latestValues[e]=t.get()}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=rs(t,{owner:this}),this.addValue(e,n)),n}readValue(e){var t;return void 0===this.latestValues[e]&&this.current?null!==(t=this.getBaseTargetFromProps(this.props,e))&&void 0!==t?t:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e]}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props,r="string"===typeof n||"object"===typeof n?null===(t=yn(this.props,n))||void 0===t?void 0:t[e]:void 0;if(n&&void 0!==r)return r;const i=this.getBaseTargetFromProps(this.props,e);return void 0===i||Nt(i)?void 0!==this.initialValues[e]&&void 0===r?void 0:this.baseTarget[e]:i}on(e,t){return this.events[e]||(this.events[e]=new es),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.events[e].notify(...n)}}}const Yo=["transition","transitionEnd"];class Zo extends Xo{sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:r}=t;delete n[e],delete r[e]}makeTargetAnimatableFromInstance(e,t,n){let{transition:r,transitionEnd:i}=e,s=Ie(e,Yo),{transformValues:a}=t,o=function(e,t,n){const r={};for(const i in e){const e=hs(i,t);if(void 0!==e)r[i]=e;else{const e=n.getValue(i);e&&(r[i]=e.get())}}return r}(s,r||{},this);if(a&&(i&&(i=a(i)),s&&(s=a(s)),o&&(o=a(o))),n){!function(e,t,n){var r,i;const s=Object.keys(t).filter(t=>!e.hasValue(t)),a=s.length;if(a)for(let o=0;o<a;o++){const a=s[o],l=t[a];let c=null;Array.isArray(l)&&(c=l[0]),null===c&&(c=null!==(i=null!==(r=n[a])&&void 0!==r?r:e.readValue(a))&&void 0!==i?i:t[a]),void 0!==c&&null!==c&&("string"===typeof c&&(Ki(c)||Wi(c))?c=parseFloat(c):!ls(c)&&$r.test(l)&&(c=Hi(a,l)),e.addValue(a,rs(c,{owner:e})),void 0===n[a]&&(n[a]=c),null!==c&&e.setBaseTarget(a,c))}}(this,s,o);const e=((e,t,n,r)=>{const i=Mo(e,t,r);return Oo(e,t=i.target,n,r=i.transitionEnd)})(this,s,o,i);i=e.transitionEnd,s=e.target}return qe({transition:r,transitionEnd:i},s)}}class Jo extends Zo{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,t){if(_t.has(t)){const e=Vi(t);return e&&e.default||0}{const r=(n=e,window.getComputedStyle(n)),i=(Et(t)?r.getPropertyValue(t):r[t])||0;return"string"===typeof i?i.trim():i}var n}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return ha(e,n)}build(e,t,n,r){Zt(e,t,n,r.transformTemplate)}scrapeMotionValuesFromProps(e,t){return xn(e,t)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Nt(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent="".concat(e))}))}renderInstance(e,t,n,r){mn(e,t,n,r)}}class Ko extends Zo{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(_t.has(t)){const e=Vi(t);return e&&e.default||0}return t=fn.has(t)?t:$e(t),e.getAttribute(t)}measureInstanceViewportBox(){return{x:{min:0,max:0},y:{min:0,max:0}}}scrapeMotionValuesFromProps(e,t){return vn(e,t)}build(e,t,n,r){cn(e,t,n,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,n,r){gn(e,t,0,r)}mount(e){this.isSVGTag=un(e.tagName),super.mount(e)}}const Qo=(e,t)=>yt(e)?new Ko(t,{enableHardwareAcceleration:!1}):new Jo(t,{enableHardwareAcceleration:!0}),$o={layout:{ProjectionNode:So,MeasureLayout:Sa}},el=qe(qe(qe(qe({},Ms),ir),No),$o),tl=xt((e,t)=>function(e,t,n,r){let{forwardMotionProps:i=!1}=t;return qe(qe({},yt(e)?Rn:In),{},{preloadedFeatures:n,useRender:pn(i),createVisualElement:r,Component:e})}(e,t,el,Qo));function nl(){const e=(0,i.useRef)(!1);return Ke(()=>(e.current=!0,()=>{e.current=!1}),[]),e}class rl extends i.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function il(e){let{children:t,isPresent:n}=e;const r=(0,i.useId)(),s=(0,i.useRef)(null),a=(0,i.useRef)({width:0,height:0,top:0,left:0});return(0,i.useInsertionEffect)(()=>{const{width:e,height:t,top:i,left:o}=a.current;if(n||!s.current||!e||!t)return;s.current.dataset.motionPopId=r;const l=document.createElement("style");return document.head.appendChild(l),l.sheet&&l.sheet.insertRule('\n          [data-motion-pop-id="'.concat(r,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            top: ").concat(i,"px !important;\n            left: ").concat(o,"px !important;\n          }\n        ")),()=>{document.head.removeChild(l)}},[n]),i.createElement(rl,{isPresent:n,childRef:s,sizeRef:a},i.cloneElement(t,{ref:s}))}const sl=e=>{let{children:t,initial:n,isPresent:r,onExitComplete:s,custom:a,presenceAffectsLayout:o,mode:l}=e;const c=bn(al),d=(0,i.useId)(),u=(0,i.useMemo)(()=>({id:d,initial:n,isPresent:r,custom:a,onExitComplete:e=>{c.set(e,!0);for(const t of c.values())if(!t)return;s&&s()},register:e=>(c.set(e,!1),()=>c.delete(e))}),o?void 0:[r]);return(0,i.useMemo)(()=>{c.forEach((e,t)=>c.set(t,!1))},[r]),i.useEffect(()=>{!r&&!c.size&&s&&s()},[r]),"popLayout"===l&&(t=i.createElement(il,{isPresent:r},t)),i.createElement(Ze.Provider,{value:u},t)};function al(){return new Map}const ol=e=>e.key||"";const ll=e=>{let{children:t,custom:n,initial:r=!0,onExitComplete:s,exitBeforeEnter:a,presenceAffectsLayout:o=!0,mode:l="sync"}=e;lr(!a,"Replace exitBeforeEnter with mode='wait'");const c=(0,i.useContext)(ht).forceRender||function(){const e=nl(),[t,n]=(0,i.useState)(0),r=(0,i.useCallback)(()=>{e.current&&n(t+1)},[t]);return[(0,i.useCallback)(()=>kn.postRender(r),[r]),t]}()[0],d=nl(),u=function(e){const t=[];return i.Children.forEach(e,e=>{(0,i.isValidElement)(e)&&t.push(e)}),t}(t);let h=u;const p=(0,i.useRef)(new Map).current,m=(0,i.useRef)(h),f=(0,i.useRef)(new Map).current,g=(0,i.useRef)(!0);var x;if(Ke(()=>{g.current=!1,function(e,t){e.forEach(e=>{const n=ol(e);t.set(n,e)})}(u,f),m.current=h}),x=()=>{g.current=!0,f.clear(),p.clear()},(0,i.useEffect)(()=>()=>x(),[]),g.current)return i.createElement(i.Fragment,null,h.map(e=>i.createElement(sl,{key:ol(e),isPresent:!0,initial:!!r&&void 0,presenceAffectsLayout:o,mode:l},e)));h=[...h];const v=m.current.map(ol),y=u.map(ol),b=v.length;for(let i=0;i<b;i++){const e=v[i];-1!==y.indexOf(e)||p.has(e)||p.set(e,void 0)}return"wait"===l&&p.size&&(h=[]),p.forEach((e,t)=>{if(-1!==y.indexOf(t))return;const r=f.get(t);if(!r)return;const a=v.indexOf(t);let g=e;if(!g){const e=()=>{p.delete(t);const e=Array.from(f.keys()).filter(e=>!y.includes(e));if(e.forEach(e=>f.delete(e)),m.current=u.filter(n=>{const r=ol(n);return r===t||e.includes(r)}),!p.size){if(!1===d.current)return;c(),s&&s()}};g=i.createElement(sl,{key:ol(r),isPresent:!1,onExitComplete:e,custom:n,presenceAffectsLayout:o,mode:l},r),p.set(t,g)}h.splice(a,0,g)}),h=h.map(e=>{const t=e.key;return p.has(t)?e:i.createElement(sl,{key:ol(e),isPresent:!0,presenceAffectsLayout:o,mode:l},e)}),i.createElement(i.Fragment,null,p.size?h:h.map(e=>(0,i.cloneElement)(e)))},cl=(0,i.createContext)(),dl=(e,t)=>{switch(console.log("\ud83d\udd04 cartReducer called with action:",t.type,t.payload),console.log("\ud83d\udd04 current state.items:",e.items),t.type){case"ADD_ITEM":console.log("\ud83d\udd04 ADD_ITEM processing...");const n=e.items.find(e=>e.id===t.payload.id&&JSON.stringify(e.customizations)===JSON.stringify(t.payload.customizations));if(console.log("\ud83d\udd04 existingItem found:",n),n){console.log("\ud83d\udd04 Updating existing item quantity");const n=qe(qe({},e),{},{items:e.items.map(e=>e.id===t.payload.id&&JSON.stringify(e.customizations)===JSON.stringify(t.payload.customizations)?qe(qe({},e),{},{quantity:e.quantity+t.payload.quantity}):e)});return console.log("\ud83d\udd04 New state after update:",n),n}console.log("\ud83d\udd04 Adding new item to cart");const r=qe(qe({},e),{},{items:[...e.items,qe(qe({},t.payload),{},{quantity:t.payload.quantity||1})]});return console.log("\ud83d\udd04 New state after add:",r),r;case"UPDATE_QUANTITY":return qe(qe({},e),{},{items:e.items.map(e=>e.cartItemId===t.payload.cartItemId?qe(qe({},e),{},{quantity:t.payload.quantity}):e)});case"REMOVE_ITEM":return qe(qe({},e),{},{items:e.items.filter(e=>e.cartItemId!==t.payload)});case"CLEAR_CART":return qe(qe({},e),{},{items:[]});case"LOAD_CART":return qe(qe({},e),{},{items:t.payload});default:return e}},ul=e=>{let{children:t}=e;const[n,r]=(0,i.useReducer)(dl,{items:[]});(0,i.useEffect)(()=>{const e=localStorage.getItem("sweetbite-cart");if(e)try{const t=JSON.parse(e);r({type:"LOAD_CART",payload:t})}catch(nU){console.error("Error loading cart from localStorage:",nU),localStorage.removeItem("sweetbite-cart")}},[]),(0,i.useEffect)(()=>{localStorage.setItem("sweetbite-cart",JSON.stringify(n.items))},[n.items]);const s=e=>{r({type:"REMOVE_ITEM",payload:e})};return(0,Ue.jsx)(cl.Provider,{value:{cartItems:n.items,addItem:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;console.log("\ud83d\uded2 addItem called with:",e,"quantity:",t);const n="".concat(e.id,"_").concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),i=qe(qe({},e),{},{quantity:t,cartItemId:n});console.log("\ud83d\uded2 addItem payload:",i),r({type:"ADD_ITEM",payload:i}),console.log("\ud83d\uded2 addItem dispatch completed")},updateQuantity:(e,t)=>{t>0?r({type:"UPDATE_QUANTITY",payload:{cartItemId:e,quantity:t}}):s(e)},removeItem:s,clearCart:()=>{r({type:"CLEAR_CART"})},getCartTotal:()=>n.items.reduce((e,t)=>e+t.price*t.quantity,0),getItemCount:()=>n.items.reduce((e,t)=>e+t.quantity,0),getCartItems:()=>n.items},children:t})},hl=()=>{const e=(0,i.useContext)(cl);if(!e)throw new Error("useCart must be used within a CartProvider");return e},pl=e=>{let{isOpen:t,onClose:n,forceRegistration:r=!1}=e;const s=ne(),[a,o]=(0,i.useState)(!r),[l,c]=(0,i.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phoneNumber:""}),[d,u]=(0,i.useState)(!1),[h,p]=(0,i.useState)(""),[m,f]=(0,i.useState)(""),{login:g,register:x}=Be();(0,i.useEffect)(()=>{t&&(o(!r),c({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phoneNumber:""}),p(""),f(""),u(!1))},[t,r]);const v=e=>{c(qe(qe({},l),{},{[e.target.name]:e.target.value}))};return t?(0,Ue.jsx)(ll,{children:(0,Ue.jsx)(tl.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:n,children:(0,Ue.jsxs)(tl.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:a?"Welcome Back":"Create Account"}),(0,Ue.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:h}),m&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:m}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),p(""),f(""),u(!0);try{if(!a){if(l.password!==l.confirmPassword)return p("Passwords do not match"),void u(!1);if(l.password.length<8)return p("Password must be at least 8 characters long"),void u(!1);if(!l.firstName.trim()||!l.lastName.trim())return p("First name and last name are required"),void u(!1)}let e;var t;if(a?(console.log("Attempting login with:",l.email),e=await g(l.email,l.password),console.log("Login result:",e)):(console.log("Attempting registration with:",l.email),e=await x({email:l.email,password:l.password,confirmPassword:l.confirmPassword,first_name:l.firstName,last_name:l.lastName,phoneNumber:l.phoneNumber})),console.log("Auth result:",e),e.success)f(a?"Login successful!":"Registration successful!"),n(),c({email:"",password:"",confirmPassword:"",firstName:"",lastName:""}),console.log("Login result user:",e.user),console.log("User type:",null===(t=e.user)||void 0===t?void 0:t.user_type),e.user&&"admin"===e.user.user_type?(console.log("Redirecting to admin dashboard"),s("/admin")):e.user&&"inventory_manager"===e.user.user_type?(console.log("Redirecting to inventory dashboard"),s("/admin/inventory")):(console.log("Redirecting to home page"),s("/"));else console.error("Auth error:",e.error),p(e.error||"Authentication failed")}catch(h){console.error("Unexpected error:",h),p("An unexpected error occurred. Please try again.")}finally{u(!1)}},className:"space-y-4",children:[!a&&(0,Ue.jsx)(Ue.Fragment,{children:(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),(0,Ue.jsx)("input",{type:"text",name:"firstName",value:l.firstName,onChange:v,required:!a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),(0,Ue.jsx)("input",{type:"text",name:"lastName",value:l.lastName,onChange:v,required:!a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent"})]})]})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,Ue.jsx)("input",{type:"email",name:"email",value:l.email,onChange:v,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent"})]}),!a&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,Ue.jsx)("input",{type:"tel",name:"phoneNumber",value:l.phoneNumber,onChange:v,placeholder:"Enter your phone number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),a&&(0,Ue.jsx)(Te,{to:"/forgot-password",onClick:n,className:"text-sm text-sweetbite-600 hover:text-sweetbite-700 transition-colors",children:"Forgot password?"})]}),(0,Ue.jsx)("input",{type:"password",name:"password",value:l.password,onChange:v,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent"})]}),!a&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),(0,Ue.jsx)("input",{type:"password",name:"confirmPassword",value:l.confirmPassword,onChange:v,required:!a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent"})]}),(0,Ue.jsx)("button",{type:"submit",disabled:d,className:"w-full bg-sweetbite-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-sweetbite-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Processing...":a?"Sign In":"Create Account"})]}),(0,Ue.jsxs)("div",{className:"mt-6 text-center space-y-3",children:[(0,Ue.jsx)("button",{onClick:()=>{o(!a),p(""),f(""),c({email:"",password:"",confirmPassword:"",firstName:"",lastName:""})},className:"text-sweetbite-600 hover:text-sweetbite-700 font-medium transition-colors",children:a?"Don't have an account? Sign up":"Already have an account? Sign in"}),a&&(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:["Having trouble signing in?"," ",(0,Ue.jsx)(Te,{to:"/forgot-password",onClick:n,className:"text-sweetbite-600 hover:text-sweetbite-700 font-medium transition-colors",children:"Reset your password"})]})]})]})})}):null},ml=()=>{const[e,t]=(0,i.useState)(!1),{user:n,logout:r}=Be(),s=ne(),a=(0,i.useRef)(null);(0,i.useEffect)(()=>{const e=e=>{a.current&&!a.current.contains(e.target)&&t(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);return n?(0,Ue.jsxs)("div",{className:"relative",ref:a,children:[(0,Ue.jsxs)("button",{onClick:()=>t(!e),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-sweetbite-600 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-white font-semibold text-sm",children:n.first_name?n.first_name[0].toUpperCase():n.email[0].toUpperCase()})}),(0,Ue.jsx)("span",{className:"hidden md:block text-gray-700 font-medium",children:n.first_name||n.email}),(0,Ue.jsx)("svg",{className:"w-4 h-4 text-gray-500 transition-transform ".concat(e?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,Ue.jsx)(ll,{children:e&&(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50",children:[(0,Ue.jsxs)("div",{className:"px-4 py-2 border-b border-gray-100",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-900",children:n.first_name&&n.last_name?"".concat(n.first_name," ").concat(n.last_name):n.email}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500",children:n.email})]}),(0,Ue.jsx)(Te,{to:"/profile",onClick:()=>t(!1),className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,Ue.jsx)("span",{children:"Profile"})]})}),(0,Ue.jsx)(Te,{to:"/orders",onClick:()=>t(!1),className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,Ue.jsx)("span",{children:"My Orders"})]})}),n.is_staff&&(0,Ue.jsx)(Te,{to:"/admin/orders",onClick:()=>t(!1),className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,Ue.jsx)("span",{children:"Admin Panel"})]})}),(0,Ue.jsx)("div",{className:"border-t border-gray-100 mt-2 pt-2",children:(0,Ue.jsx)("button",{onClick:()=>{r(s),t(!1)},className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,Ue.jsx)("span",{children:"Sign Out"})]})})})]})})]}):null},fl=()=>{const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(!1),{getItemCount:s}=hl(),{isAuthenticated:a,user:o}=Be(),l=ee(),c=s(),d=[{name:"Home",path:"/"},{name:"Menu",path:"/menu"},{name:"Customize",path:"/customize"},{name:"My Orders",path:"/orders"}];return(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("nav",{className:"bg-white shadow-lg sticky top-0 z-50",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,Ue.jsxs)(Te,{to:"/",className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-sweetbite-500 to-sweetbite-600 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-white font-bold text-xl",children:"S"})}),(0,Ue.jsx)("span",{className:"text-2xl font-bold text-gray-800",children:"SweetBite"})]}),(0,Ue.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[d.map(e=>(0,Ue.jsx)(Te,{to:e.path,className:"text-gray-700 hover:text-sweetbite-600 font-medium transition-colors ".concat(l.pathname===e.path?"text-sweetbite-600":""),children:e.name},e.name)),o&&"admin"===o.role&&(0,Ue.jsx)("div",{className:"flex items-center space-x-6 border-l border-gray-200 pl-6",children:[{name:"Admin Dashboard",path:"/admin"},{name:"Orders",path:"/admin/orders"},{name:"Purchase History",path:"/admin/purchase-history"},{name:"Inventory",path:"/admin/inventory"},{name:"Customers",path:"/admin/customers"}].map(e=>(0,Ue.jsx)(Te,{to:e.path,className:"text-gray-700 hover:text-sweetbite-600 font-medium transition-colors text-sm ".concat(l.pathname===e.path?"text-sweetbite-600":""),children:e.name},e.name))})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[a?(0,Ue.jsx)(ml,{}):(0,Ue.jsx)("button",{onClick:()=>r(!0),className:"bg-sweetbite-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-sweetbite-700 transition-colors",children:"Sign In"}),(0,Ue.jsx)(Te,{to:"/cart",className:"relative p-2",children:(0,Ue.jsxs)(tl.div,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"relative",children:[(0,Ue.jsx)("svg",{className:"w-6 h-6 text-gray-700 hover:text-sweetbite-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l-1 7a2 2 0 01-2 2H8a2 2 0 01-2-2L5 9z"})}),c>0&&(0,Ue.jsx)(tl.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 bg-sweetbite-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-semibold",children:c>99?"99+":c})]})}),(0,Ue.jsx)("button",{onClick:()=>t(!e),className:"md:hidden p-2 rounded-md text-gray-700 hover:text-sweetbite-600 hover:bg-gray-100 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e?(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),(0,Ue.jsx)(ll,{children:e&&(0,Ue.jsx)(tl.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden border-t border-gray-200",children:(0,Ue.jsxs)("div",{className:"py-4 space-y-2",children:[d.map(e=>(0,Ue.jsx)(Te,{to:e.path,onClick:()=>t(!1),className:"block px-4 py-2 text-gray-700 hover:text-sweetbite-600 hover:bg-gray-50 transition-colors ".concat(l.pathname===e.path?"text-sweetbite-600 bg-sweetbite-50":""),children:e.name},e.name)),!a&&(0,Ue.jsx)("button",{onClick:()=>{r(!0),t(!1)},className:"w-full text-left px-4 py-2 text-sweetbite-600 hover:bg-sweetbite-50 transition-colors",children:"Sign In"})]})})})]})}),(0,Ue.jsx)(pl,{isOpen:n,onClose:()=>r(!1)})]})},gl=e=>{let{children:t}=e;const{user:n,isAuthenticated:r,loading:i}=Be();return console.log("ProtectedAdminRoute - user:",n),console.log("ProtectedAdminRoute - isAuthenticated:",r),console.log("ProtectedAdminRoute - loading:",i),console.log("ProtectedAdminRoute - user_type:",null===n||void 0===n?void 0:n.user_type),i?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Checking access..."})]})}):r?!n||"admin"!==n.user_type&&"inventory_manager"!==n.user_type?(console.log("Not admin or inventory manager, redirecting to home. User type:",null===n||void 0===n?void 0:n.user_type),(0,Ue.jsx)(ve,{to:"/",replace:!0})):(console.log("Admin/Inventory Manager access granted"),t):(console.log("Not authenticated, redirecting to home"),(0,Ue.jsx)(ve,{to:"/",replace:!0}))},xl=["title","titleId"];function vl(e,t){let{title:n,titleId:r}=e,s=Ie(e,xl);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const yl=i.forwardRef(vl),bl=["title","titleId"];function wl(e,t){let{title:n,titleId:r}=e,s=Ie(e,bl);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const _l=i.forwardRef(wl),Sl=["title","titleId"];function Nl(e,t){let{title:n,titleId:r}=e,s=Ie(e,Sl);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const jl=i.forwardRef(Nl),Al=["title","titleId"];function Ml(e,t){let{title:n,titleId:r}=e,s=Ie(e,Al);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const El=i.forwardRef(Ml),Cl=["title","titleId"];function kl(e,t){let{title:n,titleId:r}=e,s=Ie(e,Cl);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6Z"}))}const Tl=i.forwardRef(kl),Pl=["title","titleId"];function Ll(e,t){let{title:n,titleId:r}=e,s=Ie(e,Pl);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Rl=i.forwardRef(Ll),Il=["title","titleId"];function Fl(e,t){let{title:n,titleId:r}=e,s=Ie(e,Il);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const Ol=i.forwardRef(Fl),Dl=["title","titleId"];function Ul(e,t){let{title:n,titleId:r}=e,s=Ie(e,Dl);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const zl=i.forwardRef(Ul),Bl=()=>{const e=ne(),{user:t,isAuthenticated:n}=Be(),[r,s]=(0,i.useState)(!1),[a,o]=(0,i.useState)(""),[l,c]=(0,i.useState)(""),[d,u]=(0,i.useState)([]),[h,p]=(0,i.useState)([]),[m,f]=(0,i.useState)({name:"",description:"",category:"",supplier:"",unit:"kg",current_stock:0,minimum_stock:0,unit_cost:0,expiry_date:"",storage_location:"",notes:""});(0,i.useEffect)(()=>{n?(!t||"admin"!==t.user_type&&"inventory_manager"!==t.user_type)&&e("/"):e("/")},[n,t,e]),(0,i.useEffect)(()=>{g()},[]);const g=async()=>{try{const e=await fetch("http://localhost:8000/api/inventory/categories/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(e.ok){const t=await e.json();console.log("Categories data received:",t),Array.isArray(t)?u(t):t.results&&Array.isArray(t.results)?u(t.results):u([])}else console.error("Failed to load categories:",e.status);const t=await fetch("http://localhost:8000/api/inventory/suppliers/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(t.ok){const e=await t.json();console.log("Suppliers data received:",e),Array.isArray(e)?p(e):e.results&&Array.isArray(e.results)?p(e.results):p([])}else console.error("Failed to load suppliers:",t.status)}catch(a){console.error("Error loading form data:",a)}},x=e=>{const{name:t,value:n,type:r}=e.target;f(e=>qe(qe({},e),{},{[t]:"number"===r?parseFloat(n)||0:n}))};return!n||!t||"admin"!==t.user_type&&"inventory_manager"!==t.user_type?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsx)("div",{className:"flex justify-between items-center py-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("button",{onClick:()=>e("/inventory"),className:"mr-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:(0,Ue.jsx)(yl,{className:"h-6 w-6"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Add New Ingredient"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Add a new ingredient to your inventory"})]})]})})})}),(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l&&(0,Ue.jsx)("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(_l,{className:"h-5 w-5 text-green-600 mr-2"}),(0,Ue.jsx)("p",{className:"text-green-800",children:l})]})}),a&&(0,Ue.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(jl,{className:"h-5 w-5 text-red-600 mr-2"}),(0,Ue.jsx)("p",{className:"text-red-800",children:a})]})}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Ingredient Details"})}),(0,Ue.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),s(!0),o(""),c("");try{const t=await fetch("http://localhost:8000/api/inventory/ingredients/",{method:"POST",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify(m)});if(t.ok){const n=await t.json();c("Ingredient added successfully!"),console.log("Ingredient created:",n),f({name:"",description:"",category:"",supplier:"",unit:"kg",current_stock:0,minimum_stock:0,unit_cost:0,expiry_date:"",storage_location:"",notes:""}),setTimeout(()=>{e("/inventory?refresh=true")},2e3)}else{const e=await t.json();console.error("Error creating ingredient:",e),o("Failed to create ingredient: ".concat(e.detail||"Unknown error"))}}catch(a){console.error("Error creating ingredient:",a),o("Network error: ".concat(a.message))}finally{s(!1)}},className:"p-6 space-y-6",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,Ue.jsx)(El,{className:"h-4 w-4 inline mr-1"}),"Ingredient Name *"]}),(0,Ue.jsx)("input",{type:"text",id:"name",name:"name",value:m.name,onChange:x,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., All-Purpose Flour"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"unit",className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit *"}),(0,Ue.jsxs)("select",{id:"unit",name:"unit",value:m.unit,onChange:x,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Ue.jsx)("option",{value:"kg",children:"Kilograms (kg)"}),(0,Ue.jsx)("option",{value:"g",children:"Grams (g)"}),(0,Ue.jsx)("option",{value:"l",children:"Liters (l)"}),(0,Ue.jsx)("option",{value:"ml",children:"Milliliters (ml)"}),(0,Ue.jsx)("option",{value:"pieces",children:"Pieces"}),(0,Ue.jsx)("option",{value:"boxes",children:"Boxes"}),(0,Ue.jsx)("option",{value:"bags",children:"Bags"})]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,Ue.jsx)("textarea",{id:"description",name:"description",value:m.description,onChange:x,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Brief description of the ingredient..."})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,Ue.jsx)(Tl,{className:"h-4 w-4 inline mr-1"}),"Category *"]}),(0,Ue.jsxs)("select",{id:"category",name:"category",value:m.category,onChange:x,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Ue.jsxs)("option",{value:"",children:["Select a category (",d.length," available)"]}),d.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]}),0===d.length&&(0,Ue.jsx)("p",{className:"text-sm text-red-600 mt-1",children:"No categories loaded. Check browser console for errors."})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"supplier",className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier *"}),(0,Ue.jsxs)("select",{id:"supplier",name:"supplier",value:m.supplier,onChange:x,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Ue.jsxs)("option",{value:"",children:["Select a supplier (",h.length," available)"]}),h.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]}),0===h.length&&(0,Ue.jsx)("p",{className:"text-sm text-red-600 mt-1",children:"No suppliers loaded. Check browser console for errors."})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"current_stock",className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Stock *"}),(0,Ue.jsx)("input",{type:"number",id:"current_stock",name:"current_stock",value:m.current_stock,onChange:x,min:"0",step:"0.01",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"minimum_stock",className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Stock *"}),(0,Ue.jsx)("input",{type:"number",id:"minimum_stock",name:"minimum_stock",value:m.minimum_stock,onChange:x,min:"0",step:"0.01",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"unit_cost",className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,Ue.jsx)(Rl,{className:"h-4 w-4 inline mr-1"}),"Unit Cost (RS) *"]}),(0,Ue.jsx)("input",{type:"number",id:"unit_cost",name:"unit_cost",value:m.unit_cost,onChange:x,min:"0",step:"0.01",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{htmlFor:"expiry_date",className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,Ue.jsx)(Ol,{className:"h-4 w-4 inline mr-1"}),"Expiry Date"]}),(0,Ue.jsx)("input",{type:"date",id:"expiry_date",name:"expiry_date",value:m.expiry_date,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"storage_location",className:"block text-sm font-medium text-gray-700 mb-2",children:"Storage Location"}),(0,Ue.jsx)("input",{type:"text",id:"storage_location",name:"storage_location",value:m.storage_location,onChange:x,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Refrigerator, Pantry, Freezer"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,Ue.jsx)("textarea",{id:"notes",name:"notes",value:m.notes,onChange:x,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Additional notes about this ingredient..."})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>e("/inventory"),className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:r?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Adding..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)(zl,{className:"h-4 w-4 mr-2"}),"Add Ingredient"]})})]})]})]})]})]})},Vl="http://localhost:8000/api",Hl=()=>{const{isAuthenticated:e,user:t}=Be(),[n,r]=(0,i.useState)([]),[s,a]=(0,i.useState)(!0),[o,l]=(0,i.useState)(""),[c,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(null),[p,m]=(0,i.useState)(!1),[f,g]=(0,i.useState)([]),x={name:"",description:"",price:"",category:"",is_available:!0,is_customizable:!0,preparation_time:"2-3 hours",ingredients:[],allergens:[],image:null,existingImage:null},[v,y]=(0,i.useState)(x);(0,i.useEffect)(()=>{(async()=>{try{a(!0),l("");const e=localStorage.getItem("token"),t=await fetch("".concat(Vl,"/admin/cakes/"),{headers:{Authorization:"Token ".concat(e)}});if(!t.ok)throw new Error("Load cakes failed: ".concat(t.status));const n=await t.json();r(Array.isArray(n)?n:n.results||[]);const i=await fetch("".concat(Vl,"/categories/")),s=await i.json();g(Array.isArray(s)?s:s.results||[])}catch(AB){l(AB.message)}finally{a(!1)}})()},[]);return e&&t&&"admin"===t.user_type?(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Cakes"}),(0,Ue.jsx)("button",{onClick:()=>{h(null),y(x),d(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Add Cake"})]}),o&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded",children:o}),s?(0,Ue.jsx)("div",{className:"py-12 text-center text-gray-600",children:"Loading..."}):(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full bg-white border",children:[(0,Ue.jsx)("thead",{children:(0,Ue.jsxs)("tr",{className:"bg-gray-50 text-left text-sm",children:[(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Image"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Name"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Description"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Category"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Price"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Available"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{children:(n||[]).map(e=>{var t;return(0,Ue.jsxs)("tr",{className:"text-sm hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"p-3 border-b",children:e.image&&(0,Ue.jsx)("img",{src:e.image.startsWith("/media/")?"".concat(Vl.replace("/api","")).concat(e.image):e.image,alt:e.name,className:"w-16 h-16 object-cover rounded"})}),(0,Ue.jsx)("td",{className:"p-3 border-b font-medium",children:e.name}),(0,Ue.jsx)("td",{className:"p-3 border-b max-w-xs truncate",title:e.description,children:e.description||"-"}),(0,Ue.jsx)("td",{className:"p-3 border-b",children:(null===(t=e.category)||void 0===t?void 0:t.name)||"-"}),(0,Ue.jsxs)("td",{className:"p-3 border-b",children:["RS ",e.price]}),(0,Ue.jsx)("td",{className:"p-3 border-b",children:e.is_available?"Yes":"No"}),(0,Ue.jsxs)("td",{className:"p-3 border-b space-x-2",children:[(0,Ue.jsx)("button",{onClick:()=>(e=>{var t;h(e),y({name:e.name||"",description:e.description||"",price:e.price||"",category:(null===(t=e.category)||void 0===t?void 0:t.id)||e.category||"",is_available:e.is_available,is_customizable:e.is_customizable,preparation_time:e.preparation_time||"2-3 hours",ingredients:e.ingredients||[],allergens:e.allergens||[],image:null,existingImage:e.image}),d(!0)})(e),className:"px-3 py-1 rounded bg-gray-100 hover:bg-gray-200",children:"Edit"}),(0,Ue.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Delete this cake?"))try{const t=localStorage.getItem("token"),n=await fetch("".concat(Vl,"/admin/cakes/").concat(e,"/"),{method:"DELETE",headers:{Authorization:"Token ".concat(t)}});if(204!==n.status)throw new Error("Delete failed: ".concat(n.status));r(t=>t.filter(t=>t.id!==e))}catch(AB){alert(AB.message)}})(e.id),className:"px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete"})]})]},e.id)})})]})}),c&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:[(0,Ue.jsxs)("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[(0,Ue.jsx)("h4",{className:"text-lg font-semibold",children:u?"Edit Cake":"Add Cake"}),(0,Ue.jsx)("button",{onClick:()=>{d(!1),h(null)},className:"text-gray-500 hover:text-gray-700",children:"\u2715"})]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{m(!0);const e=localStorage.getItem("token");if(u&&!v.image){const t={name:v.name,description:v.description,price:v.price,category:v.category,is_available:v.is_available,is_customizable:v.is_customizable,preparation_time:v.preparation_time,ingredients:v.ingredients||[],allergens:v.allergens||[]},n=await fetch("".concat(Vl,"/admin/cakes/").concat(u.id,"/"),{method:"PATCH",headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const e=await n.json();throw new Error("Save failed: ".concat(n.status," ").concat(JSON.stringify(e)))}const i=await fetch("".concat(Vl,"/admin/cakes/"),{headers:{Authorization:"Token ".concat(e)}}),s=await i.json();return r(Array.isArray(s)?s:s.results||[]),d(!1),h(null),void y(x)}{const t=new FormData;t.append("name",v.name),t.append("description",v.description),t.append("price",v.price),t.append("category",v.category),t.append("is_available",v.is_available),t.append("is_customizable",v.is_customizable),t.append("preparation_time",v.preparation_time),t.append("ingredients",JSON.stringify(v.ingredients||[])),t.append("allergens",JSON.stringify(v.allergens||[])),v.image&&t.append("image",v.image);const n=u?"PATCH":"POST",i=u?"".concat(Vl,"/admin/cakes/").concat(u.id,"/"):"".concat(Vl,"/admin/cakes/"),s=await fetch(i,{method:n,headers:{Authorization:"Token ".concat(e)},body:t});if(!s.ok){const e=await s.text();throw new Error("Save failed: ".concat(s.status," ").concat(e))}const a=await fetch("".concat(Vl,"/admin/cakes/"),{headers:{Authorization:"Token ".concat(e)}}),o=await a.json();r(Array.isArray(o)?o:o.results||[]),d(!1),h(null),y(x)}}catch(t){alert(t.message)}finally{m(!1)}},className:"p-6 space-y-4",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Name"}),(0,Ue.jsx)("input",{value:v.name,onChange:e=>y(qe(qe({},v),{},{name:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Price (RS)"}),(0,Ue.jsx)("input",{type:"number",step:"0.01",value:v.price,onChange:e=>y(qe(qe({},v),{},{price:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{className:"md:col-span-2",children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),(0,Ue.jsx)("textarea",{value:v.description,onChange:e=>y(qe(qe({},v),{},{description:e.target.value})),rows:3,required:!0,className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Category"}),(0,Ue.jsxs)("select",{value:v.category,onChange:e=>y(qe(qe({},v),{},{category:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2",children:[(0,Ue.jsx)("option",{value:"",disabled:!0,children:"Choose category"}),f.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Preparation Time"}),(0,Ue.jsx)("input",{value:v.preparation_time,onChange:e=>y(qe(qe({},v),{},{preparation_time:e.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Available"}),(0,Ue.jsxs)("select",{value:v.is_available?"1":"0",onChange:e=>y(qe(qe({},v),{},{is_available:"1"===e.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,Ue.jsx)("option",{value:"1",children:"Yes"}),(0,Ue.jsx)("option",{value:"0",children:"No"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Customizable"}),(0,Ue.jsxs)("select",{value:v.is_customizable?"1":"0",onChange:e=>y(qe(qe({},v),{},{is_customizable:"1"===e.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,Ue.jsx)("option",{value:"1",children:"Yes"}),(0,Ue.jsx)("option",{value:"0",children:"No"})]})]}),(0,Ue.jsxs)("div",{className:"md:col-span-2",children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Image"}),v.existingImage&&(0,Ue.jsxs)("div",{className:"mb-2",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Current image:"}),(0,Ue.jsx)("img",{src:v.existingImage.startsWith("/media/")?"".concat(Vl.replace("/api","")).concat(v.existingImage):v.existingImage,alt:"Current",className:"w-20 h-20 object-cover rounded border"})]}),(0,Ue.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return y(qe(qe({},v),{},{image:(null===(t=e.target.files)||void 0===t?void 0:t[0])||null}))},className:"w-full"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to keep current image"})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>{d(!1),h(null)},className:"px-4 py-2 rounded border",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:p,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:p?"Saving...":u?"Update":"Create"})]})]})]})})]}):null},Wl=()=>{const{isAuthenticated:e,user:t}=Be(),[n,r]=Re(),s=n.get("tab")||"cakes",[a,o]=(0,i.useState)(s);return(0,i.useEffect)(()=>{r({tab:a})},[a,r]),e&&t&&"admin"===t.user_type?(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsx)("div",{className:"flex justify-between items-center py-6",children:(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Catalog Management"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Manage cakes, categories, and offers"})]})})})}),(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("nav",{className:"flex space-x-8",children:[{id:"cakes",name:"Cakes"},{id:"categories",name:"Categories"},{id:"offers",name:"Offers"}].map(e=>(0,Ue.jsx)("button",{onClick:()=>o(e.id),className:"py-3 px-1 border-b-2 font-medium text-sm ".concat(a===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.name},e.id))})}),(0,Ue.jsxs)("div",{className:"p-6",children:["cakes"===a&&(0,Ue.jsx)(Hl,{}),"categories"===a&&(0,Ue.jsx)(Gl,{}),"offers"===a&&(0,Ue.jsx)(ql,{})]})]})})]}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsx)("p",{className:"text-gray-600",children:"Unauthorized"})})})},Gl=()=>{const{isAuthenticated:e,user:t}=Be(),[n,r]=(0,i.useState)([]),[s,a]=(0,i.useState)(!0),[o,l]=(0,i.useState)(""),[c,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(null),[p,m]=(0,i.useState)(!1),f={name:"",description:"",is_active:!0},[g,x]=(0,i.useState)(f),v=async()=>{try{a(!0),l("");const e=localStorage.getItem("token"),t=await fetch("".concat(Vl,"/admin/categories/"),{headers:{Authorization:"Token ".concat(e)}});if(!t.ok)throw new Error("Load categories failed: ".concat(t.status));const n=await t.json();r(Array.isArray(n)?n:n.results||[])}catch(AB){l(AB.message)}finally{a(!1)}};(0,i.useEffect)(()=>{v()},[]);return e&&t&&"admin"===t.user_type?(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Categories"}),(0,Ue.jsx)("button",{onClick:()=>{h(null),x(f),d(!0)},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Add Category"})]}),o&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded",children:o}),s?(0,Ue.jsx)("div",{className:"py-12 text-center text-gray-600",children:"Loading..."}):(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full bg-white border",children:[(0,Ue.jsx)("thead",{children:(0,Ue.jsxs)("tr",{className:"bg-gray-50 text-left text-sm",children:[(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Name"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Description"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Active"}),(0,Ue.jsx)("th",{className:"p-3 border-b",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{children:(n||[]).map(e=>(0,Ue.jsxs)("tr",{className:"text-sm hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"p-3 border-b font-medium",children:e.name}),(0,Ue.jsx)("td",{className:"p-3 border-b",children:e.description||"-"}),(0,Ue.jsx)("td",{className:"p-3 border-b",children:e.is_active?"Yes":"No"}),(0,Ue.jsx)("td",{className:"p-3 border-b",children:(0,Ue.jsxs)("div",{className:"flex gap-1",children:[(0,Ue.jsx)("button",{onClick:()=>(e=>{h(e),x({name:e.name||"",description:e.description||"",is_active:!!e.is_active}),d(!0)})(e),className:"px-2 py-1 text-xs rounded bg-gray-100 hover:bg-gray-200",children:"Edit"}),(0,Ue.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Delete this category?"))try{const t=localStorage.getItem("token"),n=await fetch("".concat(Vl,"/admin/categories/").concat(e,"/"),{method:"DELETE",headers:{Authorization:"Token ".concat(t)}});if(204!==n.status)throw new Error("Delete failed: ".concat(n.status));r(t=>t.filter(t=>t.id!==e))}catch(AB){alert(AB.message)}})(e.id),className:"px-2 py-1 text-xs rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete"})]})})]},e.id))})]})}),c&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-xl",children:[(0,Ue.jsxs)("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[(0,Ue.jsx)("h4",{className:"text-lg font-semibold",children:u?"Edit Category":"Add Category"}),(0,Ue.jsx)("button",{onClick:()=>{d(!1),h(null)},className:"text-gray-500 hover:text-gray-700",children:"\u2715"})]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{m(!0);const e=localStorage.getItem("token"),t={name:g.name,description:g.description,is_active:g.is_active},n=u?"PUT":"POST",r=u?"".concat(Vl,"/admin/categories/").concat(u.id,"/"):"".concat(Vl,"/admin/categories/"),i=await fetch(r,{method:n,headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){const e=await i.text();throw new Error("Save failed: ".concat(i.status," ").concat(e))}await v(),d(!1),h(null),x(f)}catch(t){alert(t.message)}finally{m(!1)}},className:"p-6 space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Name"}),(0,Ue.jsx)("input",{value:g.name,onChange:e=>x(qe(qe({},g),{},{name:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),(0,Ue.jsx)("textarea",{value:g.description,onChange:e=>x(qe(qe({},g),{},{description:e.target.value})),rows:3,className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Active"}),(0,Ue.jsxs)("select",{value:g.is_active?"1":"0",onChange:e=>x(qe(qe({},g),{},{is_active:"1"===e.target.value})),className:"w-full border rounded px-3 py-2",children:[(0,Ue.jsx)("option",{value:"1",children:"Yes"}),(0,Ue.jsx)("option",{value:"0",children:"No"})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>{d(!1),h(null)},className:"px-4 py-2 rounded border",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:p,className:"px-4 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-60",children:p?"Saving...":u?"Update":"Create"})]})]})]})})]}):null},ql=()=>{const{isAuthenticated:e,user:t}=Be(),[n,r]=(0,i.useState)([]),[s,a]=(0,i.useState)(!0),[o,l]=(0,i.useState)(""),[c,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(null),[p,m]=(0,i.useState)(!1),f=[{value:"percentage",label:"Percentage Discount"},{value:"fixed",label:"Fixed Amount Discount"},{value:"free_shipping",label:"Free Shipping"},{value:"buy_one_get_one",label:"Buy One Get One"}],g={title:"",description:"",offer_type:"percentage",status:"draft",discount_percentage:"",discount_amount:"",minimum_order_amount:"",start_date:"",end_date:"",homepage_featured:!1,popup_display:!1,background_color:"#FF6B6B",text_color:"#FFFFFF",max_usage_count:"",target_user_types:[],banner_image:null,existingBannerImage:null},[x,v]=(0,i.useState)(g);(0,i.useEffect)(()=>{y()},[]);const y=async()=>{try{a(!0),l("");const e=localStorage.getItem("token"),t=await fetch("".concat(Vl,"/offers/"),{headers:{Authorization:"Token ".concat(e)}});if(!t.ok)throw new Error("Load offers failed: ".concat(t.status));const n=await t.json();r(n.results||n)}catch(e){l(e.message)}finally{a(!1)}},b=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"draft":default:return"bg-gray-100 text-gray-800";case"expired":return"bg-red-100 text-red-800";case"paused":return"bg-yellow-100 text-yellow-800"}};return s?(0,Ue.jsx)("div",{className:"py-12 text-center text-gray-600",children:"Loading..."}):o?(0,Ue.jsxs)("div",{className:"py-12 text-center text-red-600",children:["Error: ",o]}):(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold",children:"Offers Management"}),(0,Ue.jsx)("button",{onClick:()=>{v(g),h(null),d(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Add Offer"})]}),(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Discount"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valid Until"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Display"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:(n||[]).map(e=>{var t;return(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(null===(t=f.find(t=>t.value===e.offer_type))||void 0===t?void 0:t.label)||e.offer_type}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(b(e.status)),children:e.status})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"percentage"===e.offer_type?"".concat(e.discount_percentage,"%"):"fixed"===e.offer_type?"Rs. ".concat(e.discount_amount):e.offer_type}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.end_date?new Date(e.end_date).toLocaleDateString():"No expiry"}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[e.homepage_featured&&(0,Ue.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Homepage"}),e.popup_display&&(0,Ue.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:"Popup"})]})}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,Ue.jsx)("button",{onClick:()=>(e=>{v(qe(qe({},e),{},{start_date:e.start_date?e.start_date.split("T")[0]:"",end_date:e.end_date?e.end_date.split("T")[0]:"",target_user_types:e.target_user_types||[],banner_image:null,existingBannerImage:e.banner_image})),h(e),d(!0)})(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:"Edit"}),(0,Ue.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Delete this offer?"))try{const t=localStorage.getItem("token"),n=await fetch("".concat(Vl,"/offers/").concat(e,"/"),{method:"DELETE",headers:{Authorization:"Token ".concat(t)}});if(!n.ok)throw new Error("Delete failed: ".concat(n.status));y()}catch(t){l(t.message)}})(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id)})})]})}),c&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center p-6 border-b",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold",children:u?"Edit Offer":"Create Offer"}),(0,Ue.jsx)("button",{onClick:()=>{d(!1),h(null)},className:"text-gray-500 hover:text-gray-700",children:"\u2715"})]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{m(!0),l("");const e=localStorage.getItem("token"),n=new FormData;Object.keys(x).forEach(e=>{"banner_image"===e&&x[e]?n.append(e,x[e]):"target_user_types"===e&&Array.isArray(x[e])?x[e].forEach(t=>n.append(e,t)):null!==x[e]&&""!==x[e]&&n.append(e,x[e])}),u||n.append("created_by",t.id);const r=u?"".concat(Vl,"/offers/").concat(u.id,"/"):"".concat(Vl,"/offers/"),i=u?"PATCH":"POST",s=await fetch(r,{method:i,headers:{Authorization:"Token ".concat(e)},body:n});if(!s.ok){const e=await s.json();throw new Error("Save failed: ".concat(s.status," ").concat(JSON.stringify(e)))}d(!1),h(null),y()}catch(n){l(n.message)}finally{m(!1)}},className:"p-6 space-y-4",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Title *"}),(0,Ue.jsx)("input",{value:x.title,onChange:e=>v(qe(qe({},x),{},{title:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Offer Type *"}),(0,Ue.jsx)("select",{value:x.offer_type,onChange:e=>v(qe(qe({},x),{},{offer_type:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2",children:f.map(e=>(0,Ue.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Description"}),(0,Ue.jsx)("textarea",{value:x.description,onChange:e=>v(qe(qe({},x),{},{description:e.target.value})),rows:3,className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Status *"}),(0,Ue.jsx)("select",{value:x.status,onChange:e=>v(qe(qe({},x),{},{status:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2",children:[{value:"draft",label:"Draft"},{value:"active",label:"Active"},{value:"expired",label:"Expired"},{value:"paused",label:"Paused"}].map(e=>(0,Ue.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Minimum Order Amount"}),(0,Ue.jsx)("input",{type:"number",value:x.minimum_order_amount,onChange:e=>v(qe(qe({},x),{},{minimum_order_amount:e.target.value})),className:"w-full border rounded px-3 py-2"})]})]}),"percentage"===x.offer_type&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Discount Percentage *"}),(0,Ue.jsx)("input",{type:"number",min:"0",max:"100",value:x.discount_percentage,onChange:e=>v(qe(qe({},x),{},{discount_percentage:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2"})]}),"fixed"===x.offer_type&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Discount Amount (Rs.) *"}),(0,Ue.jsx)("input",{type:"number",min:"0",value:x.discount_amount,onChange:e=>v(qe(qe({},x),{},{discount_amount:e.target.value})),required:!0,className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Start Date"}),(0,Ue.jsx)("input",{type:"date",value:x.start_date,onChange:e=>v(qe(qe({},x),{},{start_date:e.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"End Date"}),(0,Ue.jsx)("input",{type:"date",value:x.end_date,onChange:e=>v(qe(qe({},x),{},{end_date:e.target.value})),className:"w-full border rounded px-3 py-2"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Background Color"}),(0,Ue.jsx)("input",{type:"color",value:x.background_color,onChange:e=>v(qe(qe({},x),{},{background_color:e.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Text Color"}),(0,Ue.jsx)("input",{type:"color",value:x.text_color,onChange:e=>v(qe(qe({},x),{},{text_color:e.target.value})),className:"w-full border rounded px-3 py-2"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Max Usage Count"}),(0,Ue.jsx)("input",{type:"number",min:"0",value:x.max_usage_count,onChange:e=>v(qe(qe({},x),{},{max_usage_count:e.target.value})),className:"w-full border rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Banner Image"}),x.existingBannerImage&&(0,Ue.jsxs)("div",{className:"mb-2",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Current banner image:"}),(0,Ue.jsx)("img",{src:x.existingBannerImage.startsWith("/media/")?"".concat(Vl.replace("/api","")).concat(x.existingBannerImage):x.existingBannerImage,alt:"Current banner",className:"w-32 h-16 object-cover rounded border"})]}),(0,Ue.jsx)("input",{type:"file",accept:"image/*",onChange:e=>v(qe(qe({},x),{},{banner_image:e.target.files[0]})),className:"w-full border rounded px-3 py-2"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty to keep current image"})]})]}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsx)("label",{className:"block text-sm text-gray-600 mb-1",children:"Display Options"}),(0,Ue.jsxs)("div",{className:"flex space-x-4",children:[(0,Ue.jsxs)("label",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:x.homepage_featured,onChange:e=>v(qe(qe({},x),{},{homepage_featured:e.target.checked})),className:"mr-2"}),"Homepage Featured"]}),(0,Ue.jsxs)("label",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:x.popup_display,onChange:e=>v(qe(qe({},x),{},{popup_display:e.target.checked})),className:"mr-2"}),"Popup Display"]})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-end gap-3 pt-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>{d(!1),h(null)},className:"px-4 py-2 rounded border",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:p,className:"px-4 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-60",children:p?"Saving...":u?"Update":"Create"})]})]})]})})]})},Xl=["title","titleId"];function Yl(e,t){let{title:n,titleId:r}=e,s=Ie(e,Xl);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const Zl=i.forwardRef(Yl),Jl=["title","titleId"];function Kl(e,t){let{title:n,titleId:r}=e,s=Ie(e,Jl);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const Ql=i.forwardRef(Kl),$l=["title","titleId"];function ec(e,t){let{title:n,titleId:r}=e,s=Ie(e,$l);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const tc=i.forwardRef(ec),nc=["title","titleId"];function rc(e,t){let{title:n,titleId:r}=e,s=Ie(e,nc);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const ic=i.forwardRef(rc),sc=["title","titleId"];function ac(e,t){let{title:n,titleId:r}=e,s=Ie(e,sc);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const oc=i.forwardRef(ac),lc=["title","titleId"];function cc(e,t){let{title:n,titleId:r}=e,s=Ie(e,lc);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const dc=i.forwardRef(cc),uc=["title","titleId"];function hc(e,t){let{title:n,titleId:r}=e,s=Ie(e,uc);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 18.75a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 0 1-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 0 0-3.213-9.193 2.056 2.056 0 0 0-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 0 0-10.026 0 1.106 1.106 0 0 0-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"}))}const pc=i.forwardRef(hc),mc=["title","titleId"];function fc(e,t){let{title:n,titleId:r}=e,s=Ie(e,mc);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const gc=i.forwardRef(fc);var xc=n(2284),vc=Uint8Array,yc=Uint16Array,bc=Int32Array,wc=new vc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_c=new vc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Sc=new vc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Nc=function(e,t){for(var n=new yc(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new bc(n[30]);for(r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},jc=Nc(wc,2),Ac=jc.b,Mc=jc.r;Ac[28]=258,Mc[258]=28;for(var Ec=Nc(_c,0),Cc=(Ec.b,Ec.r),kc=new yc(32768),Tc=0;Tc<32768;++Tc){var Pc=(43690&Tc)>>1|(21845&Tc)<<1;Pc=(61680&(Pc=(52428&Pc)>>2|(13107&Pc)<<2))>>4|(3855&Pc)<<4,kc[Tc]=((65280&Pc)>>8|(255&Pc)<<8)>>1}var Lc=function(e,t,n){for(var r=e.length,i=0,s=new yc(t);i<r;++i)e[i]&&++s[e[i]-1];var a,o=new yc(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;if(n){a=new yc(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],d=t-e[i],u=o[e[i]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)a[kc[u]>>l]=c}else for(a=new yc(r),i=0;i<r;++i)e[i]&&(a[i]=kc[o[e[i]-1]++]>>15-e[i]);return a},Rc=new vc(288);for(Tc=0;Tc<144;++Tc)Rc[Tc]=8;for(Tc=144;Tc<256;++Tc)Rc[Tc]=9;for(Tc=256;Tc<280;++Tc)Rc[Tc]=7;for(Tc=280;Tc<288;++Tc)Rc[Tc]=8;var Ic=new vc(32);for(Tc=0;Tc<32;++Tc)Ic[Tc]=5;var Fc=Lc(Rc,9,0),Oc=Lc(Ic,5,0),Dc=function(e){return(e+7)/8|0},Uc=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new vc(e.subarray(t,n))},zc=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},Bc=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},Vc=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,s=n.slice();if(!i)return{t:Zc,l:0};if(1==i){var a=new vc(n[0].s+1);return a[n[0].s]=1,{t:a,l:1}}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var o=n[0],l=n[1],c=0,d=1,u=2;for(n[0]={s:-1,f:o.f+l.f,l:o,r:l};d!=i-1;)o=n[n[c].f<n[u].f?c++:u++],l=n[c!=d&&n[c].f<n[u].f?c++:u++],n[d++]={s:-1,f:o.f+l.f,l:o,r:l};var h=s[0].s;for(r=1;r<i;++r)s[r].s>h&&(h=s[r].s);var p=new yc(h+1),m=Hc(n[d-1],p,0);if(m>t){r=0;var f=0,g=m-t,x=1<<g;for(s.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});r<i;++r){var v=s[r].s;if(!(p[v]>t))break;f+=x-(1<<m-p[v]),p[v]=t}for(f>>=g;f>0;){var y=s[r].s;p[y]<t?f-=1<<t-p[y]++-1:++r}for(;r>=0&&f;--r){var b=s[r].s;p[b]==t&&(--p[b],++f)}m=t}return{t:new vc(p),l:m}},Hc=function(e,t,n){return-1==e.s?Math.max(Hc(e.l,t,n+1),Hc(e.r,t,n+1)):t[e.s]=n},Wc=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new yc(++t),r=0,i=e[0],s=1,a=function(e){n[r++]=e},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=e[o]}return{c:n.subarray(0,r),n:t}},Gc=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},qc=function(e,t,n){var r=n.length,i=Dc(t+2);e[i]=255&r,e[i+1]=r>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<r;++s)e[i+s+4]=n[s];return 8*(i+4+r)},Xc=function(e,t,n,r,i,s,a,o,l,c,d){zc(t,d++,n),++i[256];for(var u=Vc(i,15),h=u.t,p=u.l,m=Vc(s,15),f=m.t,g=m.l,x=Wc(h),v=x.c,y=x.n,b=Wc(f),w=b.c,_=b.n,S=new yc(19),N=0;N<v.length;++N)++S[31&v[N]];for(N=0;N<w.length;++N)++S[31&w[N]];for(var j=Vc(S,7),A=j.t,M=j.l,E=19;E>4&&!A[Sc[E-1]];--E);var C,k,T,P,L=c+5<<3,R=Gc(i,Rc)+Gc(s,Ic)+a,I=Gc(i,h)+Gc(s,f)+a+14+3*E+Gc(S,A)+2*S[16]+3*S[17]+7*S[18];if(l>=0&&L<=R&&L<=I)return qc(t,d,e.subarray(l,l+c));if(zc(t,d,1+(I<R)),d+=2,I<R){C=Lc(h,p,0),k=h,T=Lc(f,g,0),P=f;var F=Lc(A,M,0);zc(t,d,y-257),zc(t,d+5,_-1),zc(t,d+10,E-4),d+=14;for(N=0;N<E;++N)zc(t,d+3*N,A[Sc[N]]);d+=3*E;for(var O=[v,w],D=0;D<2;++D){var U=O[D];for(N=0;N<U.length;++N){var z=31&U[N];zc(t,d,F[z]),d+=A[z],z>15&&(zc(t,d,U[N]>>5&127),d+=U[N]>>12)}}}else C=Fc,k=Rc,T=Oc,P=Ic;for(N=0;N<o;++N){var B=r[N];if(B>255){Bc(t,d,C[(z=B>>18&31)+257]),d+=k[z+257],z>7&&(zc(t,d,B>>23&31),d+=wc[z]);var V=31&B;Bc(t,d,T[V]),d+=P[V],V>3&&(Bc(t,d,B>>5&8191),d+=_c[V])}else Bc(t,d,C[B]),d+=k[B]}return Bc(t,d,C[256]),d+k[256]},Yc=new bc([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Zc=new vc(0),Jc=function(e,t,n,r,i,s){var a=s.z||e.length,o=new vc(r+a+5*(1+Math.ceil(a/7e3))+i),l=o.subarray(r,o.length-i),c=s.l,d=7&(s.r||0);if(t){d&&(l[0]=s.r>>3);for(var u=Yc[t-1],h=u>>13,p=8191&u,m=(1<<n)-1,f=s.p||new yc(32768),g=s.h||new yc(m+1),x=Math.ceil(n/3),v=2*x,y=function(t){return(e[t]^e[t+1]<<x^e[t+2]<<v)&m},b=new bc(25e3),w=new yc(288),_=new yc(32),S=0,N=0,j=s.i||0,A=0,M=s.w||0,E=0;j+2<a;++j){var C=y(j),k=32767&j,T=g[C];if(f[k]=T,g[C]=k,M<=j){var P=a-j;if((S>7e3||A>24576)&&(P>423||!c)){d=Xc(e,l,0,b,w,_,N,A,E,j-E,d),A=S=N=0,E=j;for(var L=0;L<286;++L)w[L]=0;for(L=0;L<30;++L)_[L]=0}var R=2,I=0,F=p,O=k-T&32767;if(P>2&&C==y(j-O))for(var D=Math.min(h,P)-1,U=Math.min(32767,j),z=Math.min(258,P);O<=U&&--F&&k!=T;){if(e[j+R]==e[j+R-O]){for(var B=0;B<z&&e[j+B]==e[j+B-O];++B);if(B>R){if(R=B,I=O,B>D)break;var V=Math.min(O,B-2),H=0;for(L=0;L<V;++L){var W=j-O+L&32767,G=W-f[W]&32767;G>H&&(H=G,T=W)}}}O+=(k=T)-(T=f[k])&32767}if(I){b[A++]=268435456|Mc[R]<<18|Cc[I];var q=31&Mc[R],X=31&Cc[I];N+=wc[q]+_c[X],++w[257+q],++_[X],M=j+R,++S}else b[A++]=e[j],++w[e[j]]}}for(j=Math.max(j,M);j<a;++j)b[A++]=e[j],++w[e[j]];d=Xc(e,l,c,b,w,_,N,A,E,j-E,d),c||(s.r=7&d|l[d/8|0]<<3,d-=7,s.h=g,s.p=f,s.i=j,s.w=M)}else{for(j=s.w||0;j<a+c;j+=65535){var Y=j+65535;Y>=a&&(l[d/8|0]=c,Y=a),d=qc(l,d+1,e.subarray(j,Y))}s.i=a}return Uc(o,0,r+Dc(d)+i)},Kc=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,s=0|n.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=r+=n[a];r=(65535&r)+15*(r>>16),i=(65535&i)+15*(i>>16)}e=r,t=i},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},Qc=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new vc(s.length+e.length);a.set(s),a.set(e,s.length),e=a,i.w=s.length}return Jc(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,r,i)},$c=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},ed=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=Kc();i.p(t.dictionary),$c(e,2,i.d())}};function td(e,t){t||(t={});var n=Kc();n.p(e);var r=Qc(e,t,t.dictionary?6:2,4);return ed(r,t),$c(r,r.length-4,n.d()),r}var nd="undefined"!=typeof TextDecoder&&new TextDecoder;try{nd.decode(Zc,{stream:!0})}catch(AB){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;function rd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function id(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return rd(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sd(e){return new TextDecoder(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8").decode(e)}const ad=new TextEncoder;const od=(()=>{const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])})(),ld={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class cd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8192,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,We.A)(this,"buffer",void 0),(0,We.A)(this,"byteLength",void 0),(0,We.A)(this,"byteOffset",void 0),(0,We.A)(this,"length",void 0),(0,We.A)(this,"offset",void 0),(0,We.A)(this,"lastWrittenByte",void 0),(0,We.A)(this,"littleEndian",void 0),(0,We.A)(this,"_data",void 0),(0,We.A)(this,"_mark",void 0),(0,We.A)(this,"_marks",void 0);let n=!1;"number"===typeof e?e=new ArrayBuffer(e):(n=!0,this.lastWrittenByte=e.byteLength);const r=t.offset?t.offset>>>0:0,i=e.byteLength-r;let s=r;(ArrayBuffer.isView(e)||e instanceof cd)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+r),e=e.buffer),this.lastWrittenByte=n?i:0,this.buffer=e,this.length=i,this.byteLength=i,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,i),this._mark=0,this._marks=[]}available(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+=e,this}back(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.available(e)){const t=2*(this.offset+e),n=new Uint8Array(t);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=t,this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readArray(e,"uint8")}readArray(e,t){const n=ld[t].BYTES_PER_ELEMENT*e,r=this.byteOffset+this.offset,i=this.buffer.slice(r,r+n);if(this.littleEndian===od&&"uint8"!==t&&"int8"!==t){const e=new Uint8Array(this.buffer.slice(r,r+n));e.reverse();const i=new ld[t](e.buffer);return this.offset+=n,i.reverse(),i}const s=new ld[t](i);return this.offset+=n,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="";for(let n=0;n<e;n++)t+=this.readChar();return t}readUtf8(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return sd(this.readBytes(e))}decodeText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return sd(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(function(e){return ad.encode(e)}(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function dd(e){let t=e.length;for(;--t>=0;)e[t]=0}const ud=256,hd=286,pd=30,md=15,fd=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),gd=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),xd=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),vd=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yd=new Array(576);dd(yd);const bd=new Array(60);dd(bd);const wd=new Array(512);dd(wd);const _d=new Array(256);dd(_d);const Sd=new Array(29);dd(Sd);const Nd=new Array(pd);function jd(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let Ad,Md,Ed;function Cd(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}dd(Nd);const kd=e=>e<256?wd[e]:wd[256+(e>>>7)],Td=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Pd=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Td(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Ld=(e,t,n)=>{Pd(e,n[2*t],n[2*t+1])},Rd=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Id=(e,t,n)=>{const r=new Array(16);let i,s,a=0;for(i=1;i<=md;i++)a=a+n[i-1]<<1,r[i]=a;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=Rd(r[t]++,t))}},Fd=e=>{let t;for(t=0;t<hd;t++)e.dyn_ltree[2*t]=0;for(t=0;t<pd;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Od=e=>{e.bi_valid>8?Td(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Dd=(e,t,n,r)=>{const i=2*t,s=2*n;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]},Ud=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Dd(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Dd(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},zd=(e,t,n)=>{let r,i,s,a,o=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+o++],r+=(255&e.pending_buf[e.sym_buf+o++])<<8,i=e.pending_buf[e.sym_buf+o++],0===r?Ld(e,i,t):(s=_d[i],Ld(e,s+ud+1,t),a=fd[s],0!==a&&(i-=Sd[s],Pd(e,i,a)),r--,s=kd(r),Ld(e,s,n),a=gd[s],0!==a&&(r-=Nd[s],Pd(e,r,a)))}while(o<e.sym_next);Ld(e,256,t)},Bd=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let a,o,l,c=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<s;a++)0!==n[2*a]?(e.heap[++e.heap_len]=c=a,e.depth[a]=0):n[2*a+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,n[2*l]=1,e.depth[l]=0,e.opt_len--,i&&(e.static_len-=r[2*l+1]);for(t.max_code=c,a=e.heap_len>>1;a>=1;a--)Ud(e,n,a);l=s;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ud(e,n,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,n[2*l]=n[2*a]+n[2*o],e.depth[l]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,n[2*a+1]=n[2*o+1]=l,e.heap[1]=l++,Ud(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,d,u,h,p,m,f=0;for(h=0;h<=md;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)d=e.heap[c],h=n[2*n[2*d+1]+1]+1,h>l&&(h=l,f++),n[2*d+1]=h,d>r||(e.bl_count[h]++,p=0,d>=o&&(p=a[d-o]),m=n[2*d],e.opt_len+=m*(h+p),s&&(e.static_len+=m*(i[2*d+1]+p)));if(0!==f){do{for(h=l-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[l]--,f-=2}while(f>0);for(h=l;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--c],u>r||(n[2*u+1]!==h&&(e.opt_len+=(h-n[2*u+1])*n[2*u],n[2*u+1]=h),d--)}})(e,t),Id(n,c,e.bl_count)},Vd=(e,t,n)=>{let r,i,s=-1,a=t[1],o=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++o<l&&i===a||(o<c?e.bl_tree[2*i]+=o:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4))},Hd=(e,t,n)=>{let r,i,s=-1,a=t[1],o=0,l=7,c=4;for(0===a&&(l=138,c=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++o<l&&i===a)){if(o<c)do{Ld(e,i,e.bl_tree)}while(0!==--o);else 0!==i?(i!==s&&(Ld(e,i,e.bl_tree),o--),Ld(e,16,e.bl_tree),Pd(e,o-3,2)):o<=10?(Ld(e,17,e.bl_tree),Pd(e,o-3,3)):(Ld(e,18,e.bl_tree),Pd(e,o-11,7));o=0,s=i,0===a?(l=138,c=3):i===a?(l=6,c=3):(l=7,c=4)}};let Wd=!1;const Gd=(e,t,n,r)=>{Pd(e,0+(r?1:0),3),Od(e),Td(e,n),Td(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var qd=e=>{Wd||((()=>{let e,t,n,r,i;const s=new Array(16);for(n=0,r=0;r<28;r++)for(Sd[r]=n,e=0;e<1<<fd[r];e++)_d[n++]=r;for(_d[n-1]=r,i=0,r=0;r<16;r++)for(Nd[r]=i,e=0;e<1<<gd[r];e++)wd[i++]=r;for(i>>=7;r<pd;r++)for(Nd[r]=i<<7,e=0;e<1<<gd[r]-7;e++)wd[256+i++]=r;for(t=0;t<=md;t++)s[t]=0;for(e=0;e<=143;)yd[2*e+1]=8,e++,s[8]++;for(;e<=255;)yd[2*e+1]=9,e++,s[9]++;for(;e<=279;)yd[2*e+1]=7,e++,s[7]++;for(;e<=287;)yd[2*e+1]=8,e++,s[8]++;for(Id(yd,287,s),e=0;e<pd;e++)bd[2*e+1]=5,bd[2*e]=Rd(e,5);Ad=new jd(yd,fd,257,hd,md),Md=new jd(bd,gd,0,pd,md),Ed=new jd(new Array(0),xd,0,19,7)})(),Wd=!0),e.l_desc=new Cd(e.dyn_ltree,Ad),e.d_desc=new Cd(e.dyn_dtree,Md),e.bl_desc=new Cd(e.bl_tree,Ed),e.bi_buf=0,e.bi_valid=0,Fd(e)},Xd=(e,t,n,r)=>{let i,s,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<ud;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Bd(e,e.l_desc),Bd(e,e.d_desc),a=(e=>{let t;for(Vd(e,e.dyn_ltree,e.l_desc.max_code),Vd(e,e.dyn_dtree,e.d_desc.max_code),Bd(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*vd[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=i&&(i=s)):i=s=n+5,n+4<=i&&-1!==t?Gd(e,t,n,r):4===e.strategy||s===i?(Pd(e,2+(r?1:0),3),zd(e,yd,bd)):(Pd(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(Pd(e,t-257,5),Pd(e,n-1,5),Pd(e,r-4,4),i=0;i<r;i++)Pd(e,e.bl_tree[2*vd[i]+1],3);Hd(e,e.dyn_ltree,t-1),Hd(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),zd(e,e.dyn_ltree,e.dyn_dtree)),Fd(e),r&&Od(e)},Yd=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(_d[n]+ud+1)]++,e.dyn_dtree[2*kd(t)]++),e.sym_next===e.sym_end),Zd=e=>{Pd(e,2,3),Ld(e,256,yd),(e=>{16===e.bi_valid?(Td(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)},Jd={_tr_init:qd,_tr_stored_block:Gd,_tr_flush_block:Xd,_tr_tally:Yd,_tr_align:Zd};var Kd=(e,t,n,r)=>{let i=65535&e,s=e>>>16&65535,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do{i=i+t[r++]|0,s=s+i|0}while(--a);i%=65521,s%=65521}return i|s<<16};const Qd=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var $d=(e,t,n,r)=>{const i=Qd,s=r+n;e^=-1;for(let a=r;a<s;a++)e=e>>>8^i[255&(e^t[a])];return-1^e},eu={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},tu={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:nu,_tr_stored_block:ru,_tr_flush_block:iu,_tr_tally:su,_tr_align:au}=Jd,{Z_NO_FLUSH:ou,Z_PARTIAL_FLUSH:lu,Z_FULL_FLUSH:cu,Z_FINISH:du,Z_BLOCK:uu,Z_OK:hu,Z_STREAM_END:pu,Z_STREAM_ERROR:mu,Z_DATA_ERROR:fu,Z_BUF_ERROR:gu,Z_DEFAULT_COMPRESSION:xu,Z_FILTERED:vu,Z_HUFFMAN_ONLY:yu,Z_RLE:bu,Z_FIXED:wu,Z_DEFAULT_STRATEGY:_u,Z_UNKNOWN:Su,Z_DEFLATED:Nu}=tu,ju=258,Au=262,Mu=42,Eu=113,Cu=666,ku=(e,t)=>(e.msg=eu[t],t),Tu=e=>2*e-(e>4?9:0),Pu=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Lu=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let Ru=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Iu=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Fu=(e,t)=>{iu(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Iu(e.strm)},Ou=(e,t)=>{e.pending_buf[e.pending++]=t},Du=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Uu=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=Kd(e.adler,t,i,n):2===e.state.wrap&&(e.adler=$d(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},zu=(e,t)=>{let n,r,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-Au?e.strstart-(e.w_size-Au):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+ju;let p=c[s+a-1],m=c[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(n=t,c[n+a]===m&&c[n+a-1]===p&&c[n]===c[s]&&c[++n]===c[s+1]){s+=2,n++;do{}while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<h);if(r=ju-(h-s),s=h-ju,r>a){if(e.match_start=t,a=r,r>=o)break;p=c[s+a-1],m=c[s+a]}}}while((t=u[t&d])>l&&0!==--i);return a<=e.lookahead?a:e.lookahead},Bu=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Au)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Lu(e),r+=t),0===e.strm.avail_in)break;if(n=Uu(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Ru(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Ru(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Au&&0!==e.strm.avail_in)},Vu=(e,t)=>{let n,r,i,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,o=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<s&&(0===n&&t!==du||t===ou||n!==r+e.strm.avail_in))break;a=t===du&&n===r+e.strm.avail_in?1:0,ru(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Iu(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(Uu(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==ou&&t!==du&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(Uu(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,s=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=s||(r||t===du)&&t!==ou&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,a=t===du&&0===e.strm.avail_in&&n===r?1:0,ru(e,e.block_start,n,a),e.block_start+=n,Iu(e.strm)),a?3:1)},Hu=(e,t)=>{let n,r;for(;;){if(e.lookahead<Au){if(Bu(e),e.lookahead<Au&&t===ou)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Ru(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Au&&(e.match_length=zu(e,n)),e.match_length>=3)if(r=su(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Ru(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ru(e,e.ins_h,e.window[e.strstart+1]);else r=su(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Fu(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===du?(Fu(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fu(e,!1),0===e.strm.avail_out)?1:2},Wu=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<Au){if(Bu(e),e.lookahead<Au&&t===ou)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Ru(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Au&&(e.match_length=zu(e,n),e.match_length<=5&&(e.strategy===vu||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=su(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=Ru(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Fu(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=su(e,0,e.window[e.strstart-1]),r&&Fu(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=su(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===du?(Fu(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fu(e,!1),0===e.strm.avail_out)?1:2};function Gu(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const qu=[new Gu(0,0,0,0,Vu),new Gu(4,4,8,4,Hu),new Gu(4,5,16,8,Hu),new Gu(4,6,32,32,Hu),new Gu(4,4,16,16,Wu),new Gu(8,16,32,32,Wu),new Gu(8,16,128,128,Wu),new Gu(8,32,128,256,Wu),new Gu(32,128,258,1024,Wu),new Gu(32,258,258,4096,Wu)];function Xu(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Nu,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Pu(this.dyn_ltree),Pu(this.dyn_dtree),Pu(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Pu(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Pu(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Yu=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Mu&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Eu&&t.status!==Cu?1:0},Zu=e=>{if(Yu(e))return ku(e,mu);e.total_in=e.total_out=0,e.data_type=Su;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Mu:Eu,e.adler=2===t.wrap?0:1,t.last_flush=-2,nu(t),hu},Ju=e=>{const t=Zu(e);return t===hu&&(e=>{e.window_size=2*e.w_size,Pu(e.head),e.max_lazy_match=qu[e.level].max_lazy,e.good_match=qu[e.level].good_length,e.nice_match=qu[e.level].nice_length,e.max_chain_length=qu[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},Ku=(e,t,n,r,i,s)=>{if(!e)return mu;let a=1;if(t===xu&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>9||n!==Nu||r<8||r>15||t<0||t>9||s<0||s>wu||8===r&&1!==a)return ku(e,mu);8===r&&(r=9);const o=new Xu;return e.state=o,o.strm=e,o.status=Mu,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=s,o.method=n,Ju(e)};var Qu=(e,t)=>{if(Yu(e)||t>uu||t<0)return e?ku(e,mu):mu;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===Cu&&t!==du)return ku(e,0===e.avail_out?gu:mu);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Iu(e),0===e.avail_out)return n.last_flush=-1,hu}else if(0===e.avail_in&&Tu(t)<=Tu(r)&&t!==du)return ku(e,gu);if(n.status===Cu&&0!==e.avail_in)return ku(e,gu);if(n.status===Mu&&0===n.wrap&&(n.status=Eu),n.status===Mu){let t=Nu+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=yu||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Du(n,t),0!==n.strstart&&(Du(n,e.adler>>>16),Du(n,65535&e.adler)),e.adler=1,n.status=Eu,Iu(e),0!==n.pending)return n.last_flush=-1,hu}if(57===n.status)if(e.adler=0,Ou(n,31),Ou(n,139),Ou(n,8),n.gzhead)Ou(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Ou(n,255&n.gzhead.time),Ou(n,n.gzhead.time>>8&255),Ou(n,n.gzhead.time>>16&255),Ou(n,n.gzhead.time>>24&255),Ou(n,9===n.level?2:n.strategy>=yu||n.level<2?4:0),Ou(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Ou(n,255&n.gzhead.extra.length),Ou(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=$d(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Ou(n,0),Ou(n,0),Ou(n,0),Ou(n,0),Ou(n,0),Ou(n,9===n.level?2:n.strategy>=yu||n.level<2?4:0),Ou(n,3),n.status=Eu,Iu(e),0!==n.pending)return n.last_flush=-1,hu;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=$d(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,Iu(e),0!==n.pending)return n.last_flush=-1,hu;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=$d(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=$d(e.adler,n.pending_buf,n.pending-r,r)),Iu(e),0!==n.pending)return n.last_flush=-1,hu;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Ou(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=$d(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=$d(e.adler,n.pending_buf,n.pending-r,r)),Iu(e),0!==n.pending)return n.last_flush=-1,hu;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Ou(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=$d(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Iu(e),0!==n.pending))return n.last_flush=-1,hu;Ou(n,255&e.adler),Ou(n,e.adler>>8&255),e.adler=0}if(n.status=Eu,Iu(e),0!==n.pending)return n.last_flush=-1,hu}if(0!==e.avail_in||0!==n.lookahead||t!==ou&&n.status!==Cu){let r=0===n.level?Vu(n,t):n.strategy===yu?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(Bu(e),0===e.lookahead)){if(t===ou)return 1;break}if(e.match_length=0,n=su(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Fu(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===du?(Fu(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fu(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===bu?((e,t)=>{let n,r,i,s;const a=e.window;for(;;){if(e.lookahead<=ju){if(Bu(e),e.lookahead<=ju&&t===ou)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){s=e.strstart+ju;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);e.match_length=ju-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=su(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=su(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Fu(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===du?(Fu(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fu(e,!1),0===e.strm.avail_out)?1:2})(n,t):qu[n.level].func(n,t);if(3!==r&&4!==r||(n.status=Cu),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),hu;if(2===r&&(t===lu?au(n):t!==uu&&(ru(n,0,0,!1),t===cu&&(Pu(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Iu(e),0===e.avail_out))return n.last_flush=-1,hu}return t!==du?hu:n.wrap<=0?pu:(2===n.wrap?(Ou(n,255&e.adler),Ou(n,e.adler>>8&255),Ou(n,e.adler>>16&255),Ou(n,e.adler>>24&255),Ou(n,255&e.total_in),Ou(n,e.total_in>>8&255),Ou(n,e.total_in>>16&255),Ou(n,e.total_in>>24&255)):(Du(n,e.adler>>>16),Du(n,65535&e.adler)),Iu(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?hu:pu)},$u=(e,t)=>{let n=t.length;if(Yu(e))return mu;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==Mu||r.lookahead)return mu;if(1===i&&(e.adler=Kd(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(Pu(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const s=e.avail_in,a=e.next_in,o=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Bu(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Ru(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,Bu(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=o,e.avail_in=s,r.wrap=i,hu},eh={deflateInit:(e,t)=>Ku(e,t,Nu,15,8,_u),deflateInit2:Ku,deflateReset:Ju,deflateResetKeep:Zu,deflateSetHeader:(e,t)=>Yu(e)||2!==e.state.wrap?mu:(e.state.gzhead=t,hu),deflate:Qu,deflateEnd:e=>{if(Yu(e))return mu;const t=e.state.status;return e.state=null,t===Eu?ku(e,fu):hu},deflateSetDictionary:$u,deflateInfo:"pako deflate (from Nodeca project)"};const th=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var nh=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!==typeof n)throw new TypeError(n+"must be non-object");for(const t in n)th(n,t)&&(e[t]=n[t])}}return e},rh=e=>{let t=0;for(let r=0,i=e.length;r<i;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,i=0,s=e.length;r<s;r++){let t=e[r];n.set(t,i),i+=t.length}return n};let ih=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(MB){ih=!1}const sh=new Uint8Array(256);for(let n=0;n<256;n++)sh[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;sh[254]=sh[254]=1;var ah=e=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,s,a=e.length,o=0;for(i=0;i<a;i++)n=e.charCodeAt(i),55296===(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)n=e.charCodeAt(i),55296===(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},oh=(e,t)=>{const n=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const s=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){s[i++]=t;continue}let a=sh[t];if(a>4)s[i++]=65533,r+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&r<n;)t=t<<6|63&e[r++],a--;a>1?s[i++]=65533:t<65536?s[i++]=t:(t-=65536,s[i++]=55296|t>>10&1023,s[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&ih)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(s,i)},lh=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128===(192&e[n]);)n--;return n<0||0===n?t:n+sh[e[n]]>t?n:t};var ch=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const dh=Object.prototype.toString,{Z_NO_FLUSH:uh,Z_SYNC_FLUSH:hh,Z_FULL_FLUSH:ph,Z_FINISH:mh,Z_OK:fh,Z_STREAM_END:gh,Z_DEFAULT_COMPRESSION:xh,Z_DEFAULT_STRATEGY:vh,Z_DEFLATED:yh}=tu;function bh(e){this.options=nh({level:xh,method:yh,chunkSize:16384,windowBits:15,memLevel:8,strategy:vh},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ch,this.strm.avail_out=0;let n=eh.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==fh)throw new Error(eu[n]);if(t.header&&eh.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"===typeof t.dictionary?ah(t.dictionary):"[object ArrayBuffer]"===dh.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=eh.deflateSetDictionary(this.strm,e),n!==fh)throw new Error(eu[n]);this._dict_set=!0}}function wh(e,t){const n=new bh(t);if(n.push(e,!0),n.err)throw n.msg||eu[n.err];return n.result}bh.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?mh:uh,"string"===typeof e?n.input=ah(e):"[object ArrayBuffer]"===dh.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(s===hh||s===ph)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=eh.deflate(n,s),i===gh)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=eh.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===fh;if(0!==n.avail_out){if(s>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},bh.prototype.onData=function(e){this.chunks.push(e)},bh.prototype.onEnd=function(e){e===fh&&(this.result=rh(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var _h={Deflate:bh,deflate:wh,deflateRaw:function(e,t){return(t=t||{}).raw=!0,wh(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,wh(e,t)},constants:tu};const Sh=16209;var Nh=function(e,t){let n,r,i,s,a,o,l,c,d,u,h,p,m,f,g,x,v,y,b,w,_,S,N,j;const A=e.state;n=e.next_in,N=e.input,r=n+(e.avail_in-5),i=e.next_out,j=e.output,s=i-(t-e.avail_out),a=i+(e.avail_out-257),o=A.dmax,l=A.wsize,c=A.whave,d=A.wnext,u=A.window,h=A.hold,p=A.bits,m=A.lencode,f=A.distcode,g=(1<<A.lenbits)-1,x=(1<<A.distbits)-1;e:do{p<15&&(h+=N[n++]<<p,p+=8,h+=N[n++]<<p,p+=8),v=m[h&g];t:for(;;){if(y=v>>>24,h>>>=y,p-=y,y=v>>>16&255,0===y)j[i++]=65535&v;else{if(!(16&y)){if(0===(64&y)){v=m[(65535&v)+(h&(1<<y)-1)];continue t}if(32&y){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=Sh;break e}b=65535&v,y&=15,y&&(p<y&&(h+=N[n++]<<p,p+=8),b+=h&(1<<y)-1,h>>>=y,p-=y),p<15&&(h+=N[n++]<<p,p+=8,h+=N[n++]<<p,p+=8),v=f[h&x];n:for(;;){if(y=v>>>24,h>>>=y,p-=y,y=v>>>16&255,!(16&y)){if(0===(64&y)){v=f[(65535&v)+(h&(1<<y)-1)];continue n}e.msg="invalid distance code",A.mode=Sh;break e}if(w=65535&v,y&=15,p<y&&(h+=N[n++]<<p,p+=8,p<y&&(h+=N[n++]<<p,p+=8)),w+=h&(1<<y)-1,w>o){e.msg="invalid distance too far back",A.mode=Sh;break e}if(h>>>=y,p-=y,y=i-s,w>y){if(y=w-y,y>c&&A.sane){e.msg="invalid distance too far back",A.mode=Sh;break e}if(_=0,S=u,0===d){if(_+=l-y,y<b){b-=y;do{j[i++]=u[_++]}while(--y);_=i-w,S=j}}else if(d<y){if(_+=l+d-y,y-=d,y<b){b-=y;do{j[i++]=u[_++]}while(--y);if(_=0,d<b){y=d,b-=y;do{j[i++]=u[_++]}while(--y);_=i-w,S=j}}}else if(_+=d-y,y<b){b-=y;do{j[i++]=u[_++]}while(--y);_=i-w,S=j}for(;b>2;)j[i++]=S[_++],j[i++]=S[_++],j[i++]=S[_++],b-=3;b&&(j[i++]=S[_++],b>1&&(j[i++]=S[_++]))}else{_=i-w;do{j[i++]=j[_++],j[i++]=j[_++],j[i++]=j[_++],b-=3}while(b>2);b&&(j[i++]=j[_++],b>1&&(j[i++]=j[_++]))}break}}break}}while(n<r&&i<a);b=p>>3,n-=b,p-=b<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<a?a-i+257:257-(i-a),A.hold=h,A.bits=p};const jh=15,Ah=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Mh=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Eh=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ch=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var kh=(e,t,n,r,i,s,a,o)=>{const l=o.bits;let c,d,u,h,p,m,f=0,g=0,x=0,v=0,y=0,b=0,w=0,_=0,S=0,N=0,j=null;const A=new Uint16Array(16),M=new Uint16Array(16);let E,C,k,T=null;for(f=0;f<=jh;f++)A[f]=0;for(g=0;g<r;g++)A[t[n+g]]++;for(y=l,v=jh;v>=1&&0===A[v];v--);if(y>v&&(y=v),0===v)return i[s++]=20971520,i[s++]=20971520,o.bits=1,0;for(x=1;x<v&&0===A[x];x++);for(y<x&&(y=x),_=1,f=1;f<=jh;f++)if(_<<=1,_-=A[f],_<0)return-1;if(_>0&&(0===e||1!==v))return-1;for(M[1]=0,f=1;f<jh;f++)M[f+1]=M[f]+A[f];for(g=0;g<r;g++)0!==t[n+g]&&(a[M[t[n+g]]++]=g);if(0===e?(j=T=a,m=20):1===e?(j=Ah,T=Mh,m=257):(j=Eh,T=Ch,m=0),N=0,g=0,f=x,p=s,b=y,w=0,u=-1,S=1<<y,h=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){E=f-w,a[g]+1<m?(C=0,k=a[g]):a[g]>=m?(C=T[a[g]-m],k=j[a[g]-m]):(C=96,k=0),c=1<<f-w,d=1<<b,x=d;do{d-=c,i[p+(N>>w)+d]=E<<24|C<<16|k}while(0!==d);for(c=1<<f-1;N&c;)c>>=1;if(0!==c?(N&=c-1,N+=c):N=0,g++,0===--A[f]){if(f===v)break;f=t[n+a[g]]}if(f>y&&(N&h)!==u){for(0===w&&(w=y),p+=x,b=f-w,_=1<<b;b+w<v&&(_-=A[b+w],!(_<=0));)b++,_<<=1;if(S+=1<<b,1===e&&S>852||2===e&&S>592)return 1;u=N&h,i[u]=y<<24|b<<16|p-s}}return 0!==N&&(i[p+N]=f-w<<24|64<<16),o.bits=y,0};const{Z_FINISH:Th,Z_BLOCK:Ph,Z_TREES:Lh,Z_OK:Rh,Z_STREAM_END:Ih,Z_NEED_DICT:Fh,Z_STREAM_ERROR:Oh,Z_DATA_ERROR:Dh,Z_MEM_ERROR:Uh,Z_BUF_ERROR:zh,Z_DEFLATED:Bh}=tu,Vh=16180,Hh=16190,Wh=16191,Gh=16192,qh=16194,Xh=16199,Yh=16200,Zh=16206,Jh=16209,Kh=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Qh(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const $h=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Vh||t.mode>16211?1:0},ep=e=>{if($h(e))return Oh;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Vh,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Rh},tp=e=>{if($h(e))return Oh;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ep(e)},np=(e,t)=>{let n;if($h(e))return Oh;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Oh:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,tp(e))},rp=(e,t)=>{if(!e)return Oh;const n=new Qh;e.state=n,n.strm=e,n.window=null,n.mode=Vh;const r=np(e,t);return r!==Rh&&(e.state=null),r};let ip,sp,ap=!0;const op=e=>{if(ap){ip=new Int32Array(512),sp=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(kh(1,e.lens,0,288,ip,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;kh(2,e.lens,0,32,sp,0,e.work,{bits:5}),ap=!1}e.lencode=ip,e.lenbits=9,e.distcode=sp,e.distbits=5},lp=(e,t,n,r)=>{let i;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(n-r,n-r+i),s.wnext),(r-=i)?(s.window.set(t.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0};var cp=(e,t)=>{let n,r,i,s,a,o,l,c,d,u,h,p,m,f,g,x,v,y,b,w,_,S,N=0;const j=new Uint8Array(4);let A,M;const E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($h(e)||!e.output||!e.input&&0!==e.avail_in)return Oh;n=e.state,n.mode===Wh&&(n.mode=Gh),a=e.next_out,i=e.output,l=e.avail_out,s=e.next_in,r=e.input,o=e.avail_in,c=n.hold,d=n.bits,u=o,h=l,S=Rh;e:for(;;)switch(n.mode){case Vh:if(0===n.wrap){n.mode=Gh;break}for(;d<16;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(2&n.wrap&&35615===c){0===n.wbits&&(n.wbits=15),n.check=0,j[0]=255&c,j[1]=c>>>8&255,n.check=$d(n.check,j,2,0),c=0,d=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=Jh;break}if((15&c)!==Bh){e.msg="unknown compression method",n.mode=Jh;break}if(c>>>=4,d-=4,_=8+(15&c),0===n.wbits&&(n.wbits=_),_>15||_>n.wbits){e.msg="invalid window size",n.mode=Jh;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&c?16189:Wh,c=0,d=0;break;case 16181:for(;d<16;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(n.flags=c,(255&n.flags)!==Bh){e.msg="unknown compression method",n.mode=Jh;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Jh;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&4&n.wrap&&(j[0]=255&c,j[1]=c>>>8&255,n.check=$d(n.check,j,2,0)),c=0,d=0,n.mode=16182;case 16182:for(;d<32;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}n.head&&(n.head.time=c),512&n.flags&&4&n.wrap&&(j[0]=255&c,j[1]=c>>>8&255,j[2]=c>>>16&255,j[3]=c>>>24&255,n.check=$d(n.check,j,4,0)),c=0,d=0,n.mode=16183;case 16183:for(;d<16;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&4&n.wrap&&(j[0]=255&c,j[1]=c>>>8&255,n.check=$d(n.check,j,2,0)),c=0,d=0,n.mode=16184;case 16184:if(1024&n.flags){for(;d<16;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&4&n.wrap&&(j[0]=255&c,j[1]=c>>>8&255,n.check=$d(n.check,j,2,0)),c=0,d=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(p=n.length,p>o&&(p=o),p&&(n.head&&(_=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+p),_)),512&n.flags&&4&n.wrap&&(n.check=$d(n.check,r,p,s)),o-=p,s+=p,n.length-=p),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===o)break e;p=0;do{_=r[s+p++],n.head&&_&&n.length<65536&&(n.head.name+=String.fromCharCode(_))}while(_&&p<o);if(512&n.flags&&4&n.wrap&&(n.check=$d(n.check,r,p,s)),o-=p,s+=p,_)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===o)break e;p=0;do{_=r[s+p++],n.head&&_&&n.length<65536&&(n.head.comment+=String.fromCharCode(_))}while(_&&p<o);if(512&n.flags&&4&n.wrap&&(n.check=$d(n.check,r,p,s)),o-=p,s+=p,_)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;d<16;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(4&n.wrap&&c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Jh;break}c=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Wh;break;case 16189:for(;d<32;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}e.adler=n.check=Kh(c),c=0,d=0,n.mode=Hh;case Hh:if(0===n.havedict)return e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,n.hold=c,n.bits=d,Fh;e.adler=n.check=1,n.mode=Wh;case Wh:if(t===Ph||t===Lh)break e;case Gh:if(n.last){c>>>=7&d,d-=7&d,n.mode=Zh;break}for(;d<3;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}switch(n.last=1&c,c>>>=1,d-=1,3&c){case 0:n.mode=16193;break;case 1:if(op(n),n.mode=Xh,t===Lh){c>>>=2,d-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Jh}c>>>=2,d-=2;break;case 16193:for(c>>>=7&d,d-=7&d;d<32;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if((65535&c)!==(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Jh;break}if(n.length=65535&c,c=0,d=0,n.mode=qh,t===Lh)break e;case qh:n.mode=16195;case 16195:if(p=n.length,p){if(p>o&&(p=o),p>l&&(p=l),0===p)break e;i.set(r.subarray(s,s+p),a),o-=p,s+=p,l-=p,a+=p,n.length-=p;break}n.mode=Wh;break;case 16196:for(;d<14;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(n.nlen=257+(31&c),c>>>=5,d-=5,n.ndist=1+(31&c),c>>>=5,d-=5,n.ncode=4+(15&c),c>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Jh;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;d<3;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}n.lens[E[n.have++]]=7&c,c>>>=3,d-=3}for(;n.have<19;)n.lens[E[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,A={bits:n.lenbits},S=kh(0,n.lens,0,19,n.lencode,0,n.work,A),n.lenbits=A.bits,S){e.msg="invalid code lengths set",n.mode=Jh;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;N=n.lencode[c&(1<<n.lenbits)-1],g=N>>>24,x=N>>>16&255,v=65535&N,!(g<=d);){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(v<16)c>>>=g,d-=g,n.lens[n.have++]=v;else{if(16===v){for(M=g+2;d<M;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(c>>>=g,d-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=Jh;break}_=n.lens[n.have-1],p=3+(3&c),c>>>=2,d-=2}else if(17===v){for(M=g+3;d<M;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}c>>>=g,d-=g,_=0,p=3+(7&c),c>>>=3,d-=3}else{for(M=g+7;d<M;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}c>>>=g,d-=g,_=0,p=11+(127&c),c>>>=7,d-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Jh;break}for(;p--;)n.lens[n.have++]=_}}if(n.mode===Jh)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Jh;break}if(n.lenbits=9,A={bits:n.lenbits},S=kh(1,n.lens,0,n.nlen,n.lencode,0,n.work,A),n.lenbits=A.bits,S){e.msg="invalid literal/lengths set",n.mode=Jh;break}if(n.distbits=6,n.distcode=n.distdyn,A={bits:n.distbits},S=kh(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,A),n.distbits=A.bits,S){e.msg="invalid distances set",n.mode=Jh;break}if(n.mode=Xh,t===Lh)break e;case Xh:n.mode=Yh;case Yh:if(o>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,n.hold=c,n.bits=d,Nh(e,h),a=e.next_out,i=e.output,l=e.avail_out,s=e.next_in,r=e.input,o=e.avail_in,c=n.hold,d=n.bits,n.mode===Wh&&(n.back=-1);break}for(n.back=0;N=n.lencode[c&(1<<n.lenbits)-1],g=N>>>24,x=N>>>16&255,v=65535&N,!(g<=d);){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(x&&0===(240&x)){for(y=g,b=x,w=v;N=n.lencode[w+((c&(1<<y+b)-1)>>y)],g=N>>>24,x=N>>>16&255,v=65535&N,!(y+g<=d);){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}c>>>=y,d-=y,n.back+=y}if(c>>>=g,d-=g,n.back+=g,n.length=v,0===x){n.mode=16205;break}if(32&x){n.back=-1,n.mode=Wh;break}if(64&x){e.msg="invalid literal/length code",n.mode=Jh;break}n.extra=15&x,n.mode=16201;case 16201:if(n.extra){for(M=n.extra;d<M;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;N=n.distcode[c&(1<<n.distbits)-1],g=N>>>24,x=N>>>16&255,v=65535&N,!(g<=d);){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(0===(240&x)){for(y=g,b=x,w=v;N=n.distcode[w+((c&(1<<y+b)-1)>>y)],g=N>>>24,x=N>>>16&255,v=65535&N,!(y+g<=d);){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}c>>>=y,d-=y,n.back+=y}if(c>>>=g,d-=g,n.back+=g,64&x){e.msg="invalid distance code",n.mode=Jh;break}n.offset=v,n.extra=15&x,n.mode=16203;case 16203:if(n.extra){for(M=n.extra;d<M;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Jh;break}n.mode=16204;case 16204:if(0===l)break e;if(p=h-l,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Jh;break}p>n.wnext?(p-=n.wnext,m=n.wsize-p):m=n.wnext-p,p>n.length&&(p=n.length),f=n.window}else f=i,m=a-n.offset,p=n.length;p>l&&(p=l),l-=p,n.length-=p;do{i[a++]=f[m++]}while(--p);0===n.length&&(n.mode=Yh);break;case 16205:if(0===l)break e;i[a++]=n.length,l--,n.mode=Yh;break;case Zh:if(n.wrap){for(;d<32;){if(0===o)break e;o--,c|=r[s++]<<d,d+=8}if(h-=l,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?$d(n.check,i,h,a-h):Kd(n.check,i,h,a-h)),h=l,4&n.wrap&&(n.flags?c:Kh(c))!==n.check){e.msg="incorrect data check",n.mode=Jh;break}c=0,d=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;d<32;){if(0===o)break e;o--,c+=r[s++]<<d,d+=8}if(4&n.wrap&&c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Jh;break}c=0,d=0}n.mode=16208;case 16208:S=Ih;break e;case Jh:S=Dh;break e;case 16210:return Uh;default:return Oh}return e.next_out=a,e.avail_out=l,e.next_in=s,e.avail_in=o,n.hold=c,n.bits=d,(n.wsize||h!==e.avail_out&&n.mode<Jh&&(n.mode<Zh||t!==Th))&&lp(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?$d(n.check,i,h,e.next_out-h):Kd(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Wh?128:0)+(n.mode===Xh||n.mode===qh?256:0),(0===u&&0===h||t===Th)&&S===Rh&&(S=zh),S},dp={inflateReset:tp,inflateReset2:np,inflateResetKeep:ep,inflateInit:e=>rp(e,15),inflateInit2:rp,inflate:cp,inflateEnd:e=>{if($h(e))return Oh;let t=e.state;return t.window&&(t.window=null),e.state=null,Rh},inflateGetHeader:(e,t)=>{if($h(e))return Oh;const n=e.state;return 0===(2&n.wrap)?Oh:(n.head=t,t.done=!1,Rh)},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,s;return $h(e)?Oh:(r=e.state,0!==r.wrap&&r.mode!==Hh?Oh:r.mode===Hh&&(i=1,i=Kd(i,t,n,0),i!==r.check)?Dh:(s=lp(e,t,n,n),s?(r.mode=16210,Uh):(r.havedict=1,Rh)))},inflateInfo:"pako inflate (from Nodeca project)"};var up=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const hp=Object.prototype.toString,{Z_NO_FLUSH:pp,Z_FINISH:mp,Z_OK:fp,Z_STREAM_END:gp,Z_NEED_DICT:xp,Z_STREAM_ERROR:vp,Z_DATA_ERROR:yp,Z_MEM_ERROR:bp}=tu;function wp(e){this.options=nh({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ch,this.strm.avail_out=0;let n=dp.inflateInit2(this.strm,t.windowBits);if(n!==fp)throw new Error(eu[n]);if(this.header=new up,dp.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=ah(t.dictionary):"[object ArrayBuffer]"===hp.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=dp.inflateSetDictionary(this.strm,t.dictionary),n!==fp)))throw new Error(eu[n])}function _p(e,t){const n=new wp(t);if(n.push(e),n.err)throw n.msg||eu[n.err];return n.result}wp.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(a=t===~~t?t:!0===t?mp:pp,"[object ArrayBuffer]"===hp.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=dp.inflate(n,a),s===xp&&i&&(s=dp.inflateSetDictionary(n,i),s===fp?s=dp.inflate(n,a):s===yp&&(s=xp));n.avail_in>0&&s===gp&&n.state.wrap>0&&0!==e[n.next_in];)dp.inflateReset(n),s=dp.inflate(n,a);switch(s){case vp:case yp:case xp:case bp:return this.onEnd(s),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(0===n.avail_out||s===gp))if("string"===this.options.to){let e=lh(n.output,n.next_out),t=n.next_out-e,i=oh(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==fp||0!==o){if(s===gp)return s=dp.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},wp.prototype.onData=function(e){this.chunks.push(e)},wp.prototype.onEnd=function(e){e===fp&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=rh(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Sp={Inflate:wp,inflate:_p,inflateRaw:function(e,t){return(t=t||{}).raw=!0,_p(e,t)},ungzip:_p,constants:tu};const{Deflate:Np,deflate:jp,deflateRaw:Ap,gzip:Mp}=_h,{Inflate:Ep,inflate:Cp,inflateRaw:kp,ungzip:Tp}=Sp;var Pp=Ep,Lp=Cp;const Rp=[];for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;Rp[n]=e}const Ip=4294967295;function Fp(e,t){return(function(e,t,n){let r=e;for(let i=0;i<n;i++)r=Rp[255&(r^t[i])]^r>>>8;return r}(Ip,e,t)^Ip)>>>0}function Op(e,t,n){const r=e.readUint32(),i=Fp(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==r)throw new Error("CRC mismatch for chunk ".concat(n,". Expected ").concat(r,", found ").concat(i))}function Dp(e,t,n){for(let r=0;r<n;r++)t[r]=e[r]}function Up(e,t,n,r){let i=0;for(;i<r;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-r]&255}function zp(e,t,n,r){let i=0;if(0===n.length)for(;i<r;i++)t[i]=e[i];else for(;i<r;i++)t[i]=e[i]+n[i]&255}function Bp(e,t,n,r,i){let s=0;if(0===n.length){for(;s<i;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+(t[s-i]>>1)&255}else{for(;s<i;s++)t[s]=e[s]+(n[s]>>1)&255;for(;s<r;s++)t[s]=e[s]+(t[s-i]+n[s]>>1)&255}}function Vp(e,t,n,r,i){let s=0;if(0===n.length){for(;s<i;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-i]&255}else{for(;s<i;s++)t[s]=e[s]+n[s]&255;for(;s<r;s++)t[s]=e[s]+Hp(t[s-i],n[s],n[s-i])&255}}function Hp(e,t,n){const r=e+t-n,i=Math.abs(r-e),s=Math.abs(r-t),a=Math.abs(r-n);return i<=s&&i<=a?e:s<=a?t:n}function Wp(e,t,n,r,i,s){switch(e){case 0:Dp(t,n,i);break;case 1:Up(t,n,i,s);break;case 2:zp(t,n,r,i);break;case 3:Bp(t,n,r,i,s);break;case 4:Vp(t,n,r,i,s);break;default:throw new Error("Unsupported filter: ".concat(e))}}const Gp=new Uint16Array([255]),qp=255===new Uint8Array(Gp.buffer)[0];function Xp(e){return(255&e)<<8|e>>8&255}const Yp=new Uint16Array([255]),Zp=255===new Uint8Array(Yp.buffer)[0],Jp=new Uint8Array(0);function Kp(e){const{data:t,width:n,height:r,channels:i,depth:s}=e,a=Math.ceil(s/8)*i,o=Math.ceil(s/8*i*n),l=new Uint8Array(r*o);let c,d,u=Jp,h=0;for(let p=0;p<r;p++){switch(c=t.subarray(h+1,h+1+o),d=l.subarray(p*o,(p+1)*o),t[h]){case 0:Dp(c,d,o);break;case 1:Up(c,d,o,a);break;case 2:zp(c,d,u,o);break;case 3:Bp(c,d,u,o,a);break;case 4:Vp(c,d,u,o,a);break;default:throw new Error("Unsupported filter: ".concat(t[h]))}u=d,h+=o+1}if(16===s){const e=new Uint16Array(l.buffer);if(Zp)for(let t=0;t<e.length;t++)e[t]=Qp(e[t]);return e}return l}function Qp(e){return(255&e)<<8|e>>8&255}const $p=Uint8Array.of(137,80,78,71,13,10,26,10);function em(e){if(!function(e){if(e.length<$p.length)return!1;for(let t=0;t<$p.length;t++)if(e[t]!==$p[t])return!1;return!0}(e.readBytes($p.length)))throw new Error("wrong PNG signature")}const tm="tEXt",nm=new TextDecoder("latin1");function rm(e){if(sm(e),0===e.length||e.length>79)throw new Error("keyword length must be between 1 and 79")}const im=/^[\u0000-\u00FF]*$/;function sm(e){if(!im.test(e))throw new Error("invalid latin1 text")}function am(e,t,n){const r=om(t);e[r]=function(e,t){return nm.decode(e.readBytes(t))}(t,n-r.length-1)}function om(e){for(e.mark();0!==e.readByte(););const t=e.offset;e.reset();const n=nm.decode(e.readBytes(t-e.offset-1));return e.skip(1),rm(n),n}const lm=-1,cm=0,dm=2,um=3,hm=4,pm=6,mm=-1,fm=0,gm=-1,xm=0,vm=-1,ym=0,bm=1,wm=0,_m=1,Sm=2,Nm=0,jm=1;class Am extends cd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),(0,We.A)(this,"_checkCrc",void 0),(0,We.A)(this,"_inflator",void 0),(0,We.A)(this,"_png",void 0),(0,We.A)(this,"_apng",void 0),(0,We.A)(this,"_end",void 0),(0,We.A)(this,"_hasPalette",void 0),(0,We.A)(this,"_palette",void 0),(0,We.A)(this,"_hasTransparency",void 0),(0,We.A)(this,"_transparency",void 0),(0,We.A)(this,"_compressionMethod",void 0),(0,We.A)(this,"_filterMethod",void 0),(0,We.A)(this,"_interlaceMethod",void 0),(0,We.A)(this,"_colorType",void 0),(0,We.A)(this,"_isAnimated",void 0),(0,We.A)(this,"_numberOfFrames",void 0),(0,We.A)(this,"_numberOfPlays",void 0),(0,We.A)(this,"_frames",void 0),(0,We.A)(this,"_writingDataChunks",void 0);const{checkCrc:n=!1}=t;this._checkCrc=n,this._inflator=new Pp,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=mm,this._filterMethod=gm,this._interlaceMethod=vm,this._colorType=lm,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(em(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(em(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const n=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case tm:am(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e)}if(this.offset-n!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?Op(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const n=this.offset;switch("fdAT"!==t&&"IDAT"!==t&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=n+e}if(this.offset-n!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?Op(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=function(e){if(1!==e&&2!==e&&4!==e&&8!==e&&16!==e)throw new Error("invalid bit depth: ".concat(e));return e}(this.readUint8());const t=this.readUint8();let n;switch(this._colorType=t,t){case cm:n=1;break;case dm:n=3;break;case um:n=1;break;case hm:n=2;break;case pm:n=4;break;default:throw new Error("Unknown color type: ".concat(t))}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==fm)throw new Error("Unsupported compression method: ".concat(this._compressionMethod));this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError("PLTE field length must be a multiple of 3. Got ".concat(e));const t=e/3;this._hasPalette=!0;const n=[];this._palette=n;for(let r=0;r<t;r++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,n=this.offset+this.byteOffset;if(n+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,n,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodetRNS(e){switch(this._colorType){case cm:case dm:if(e%2!==0)throw new RangeError("tRNS chunk length must be a multiple of 2. Got ".concat(e));if(e/2>this._png.width*this._png.height)throw new Error("tRNS chunk contains more alpha values than there are pixels (".concat(e/2," vs ").concat(this._png.width*this._png.height,")"));this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break;case um:{if(e>this._palette.length)throw new Error("tRNS chunk contains more alpha values than there are palette colors (".concat(e," vs ").concat(this._palette.length,")"));let t=0;for(;t<e;t++){const e=this.readByte();this._palette[t].push(e)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}default:throw new Error("tRNS chunk is not supported for color type ".concat(this._colorType))}}decodeiCCP(e){const t=om(this),n=this.readUint8();if(n!==fm)throw new Error("Unsupported iCCP compression method: ".concat(n));const r=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:Lp(r)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),n=this.readByte();this._png.resolution={x:e,y:t,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:8===this._apng.depth?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(e);if(n){if(n.data=Kp({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),0===e||0===n.xOffset&&0===n.yOffset&&n.width===this._png.width&&n.height===this._png.height)t.data=n.data;else{const r=this._apng.frames.at(e-1);this.disposeFrame(n,r,t),this.addFrameDataToCanvas(t,n)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,n){switch(e.disposeOp){case wm:break;case _m:for(let t=0;t<this._png.height;t++)for(let r=0;r<this._png.width;r++){const i=(t*e.width+r)*this._png.channels;for(let e=0;e<this._png.channels;e++)n.data[i+e]=0}break;case Sm:n.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const n=1<<this._png.depth,r=(e,n)=>({index:((e+t.yOffset)*this._png.width+t.xOffset+n)*this._png.channels,frameIndex:(e*t.width+n)*this._png.channels});switch(t.blendOp){case Nm:for(let n=0;n<t.height;n++)for(let i=0;i<t.width;i++){const{index:s,frameIndex:a}=r(n,i);for(let n=0;n<this._png.channels;n++)e.data[s+n]=t.data[a+n]}break;case jm:for(let i=0;i<t.height;i++)for(let s=0;s<t.width;s++){const{index:a,frameIndex:o}=r(i,s);for(let r=0;r<this._png.channels;r++){const i=t.data[o+this._png.channels-1]/n,s=r%(this._png.channels-1)===0?1:t.data[o+r],l=Math.floor(i*s+(1-i)*e.data[a+r]);e.data[a+r]+=l}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var e;if(this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));const t=this._isAnimated?(null===(e=this._frames)||void 0===e?void 0:e.at(0)).data:this._inflator.result;if(this._filterMethod!==xm)throw new Error("Filter method ".concat(this._filterMethod," not supported"));if(this._interlaceMethod===ym)this._png.data=Kp({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else{if(this._interlaceMethod!==bm)throw new Error("Interlace method ".concat(this._interlaceMethod," not supported"));this._png.data=function(e){const{data:t,width:n,height:r,channels:i,depth:s}=e,a=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(s/8)*i,l=new Uint8Array(r*n*o);let c=0;for(let d=0;d<7;d++){const e=a[d],i=Math.ceil((n-e.x)/e.xStep),s=Math.ceil((r-e.y)/e.yStep);if(i<=0||s<=0)continue;const u=i*o,h=new Uint8Array(u);for(let a=0;a<s;a++){const s=t[c++],d=t.subarray(c,c+u);c+=u;const p=new Uint8Array(u);Wp(s,d,p,h,u,o),h.set(p);for(let t=0;t<i;t++){const i=e.x+t*e.xStep,s=e.y+a*e.yStep;if(!(i>=n||s>=r))for(let e=0;e<o;e++)l[(s*n+i)*o+e]=p[t*o+e]}}}if(16===s){const e=new Uint16Array(l.buffer);if(qp)for(let t=0;t<e.length;t++)e[t]=Xp(e[t]);return e}return l}({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth})}this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:wm,blendOp:Nm,data:e}),this._inflator=new Pp,this._writingDataChunks=!1}}var Mm;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"}(Mm||(Mm={}));var Em=function(){return"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:this}();function Cm(){Em.console&&"function"==typeof Em.console.log&&Em.console.log.apply(Em.console,arguments)}var km={log:Cm,warn:function(e){Em.console&&("function"==typeof Em.console.warn?Em.console.warn.apply(Em.console,arguments):Cm.call(null,arguments))},error:function(e){Em.console&&("function"==typeof Em.console.error?Em.console.error.apply(Em.console,arguments):Cm(e))}};function Tm(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){Rm(r.response,t,n)},r.onerror=function(){km.error("could not download file")},r.send()}function Pm(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return t.status>=200&&t.status<=299}function Lm(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Rm=Em.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,xc.A)(window))||window!==Em?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=Em.URL||Em.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener","string"==typeof e?(i.href=e,i.origin!==location.origin?Pm(i.href)?Tm(e,t,n):Lm(i,i.target="_blank"):Lm(i)):(i.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(i.href)},4e4),setTimeout(function(){Lm(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download","string"==typeof e)if(Pm(e))Tm(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){Lm(r)})}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!==(0,xc.A)(t)&&(km.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return Tm(e,t,n);var i="application/octet-stream"===e.type,s=/constructor/i.test(Em.HTMLElement)||Em.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||i&&s)&&"object"===("undefined"==typeof FileReader?"undefined":(0,xc.A)(FileReader))){var o=new FileReader;o.onloadend=function(){var e=o.result;e=a?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},o.readAsDataURL(e)}else{var l=Em.URL||Em.webkitURL,c=l.createObjectURL(e);r?r.location=c:location.href=c,r=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function Im(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,s=n[r].process,a=i.exec(e);a&&(t=s(a),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n}}var Fm=Em.atob.bind(Em),Om=Em.btoa.bind(Em);function Dm(e,t){var n=e[0],r=e[1],i=e[2],s=e[3];n=zm(n,r,i,s,t[0],7,-680876936),s=zm(s,n,r,i,t[1],12,-389564586),i=zm(i,s,n,r,t[2],17,606105819),r=zm(r,i,s,n,t[3],22,-1044525330),n=zm(n,r,i,s,t[4],7,-176418897),s=zm(s,n,r,i,t[5],12,1200080426),i=zm(i,s,n,r,t[6],17,-1473231341),r=zm(r,i,s,n,t[7],22,-45705983),n=zm(n,r,i,s,t[8],7,1770035416),s=zm(s,n,r,i,t[9],12,-1958414417),i=zm(i,s,n,r,t[10],17,-42063),r=zm(r,i,s,n,t[11],22,-1990404162),n=zm(n,r,i,s,t[12],7,1804603682),s=zm(s,n,r,i,t[13],12,-40341101),i=zm(i,s,n,r,t[14],17,-1502002290),n=Bm(n,r=zm(r,i,s,n,t[15],22,1236535329),i,s,t[1],5,-165796510),s=Bm(s,n,r,i,t[6],9,-1069501632),i=Bm(i,s,n,r,t[11],14,643717713),r=Bm(r,i,s,n,t[0],20,-373897302),n=Bm(n,r,i,s,t[5],5,-701558691),s=Bm(s,n,r,i,t[10],9,38016083),i=Bm(i,s,n,r,t[15],14,-660478335),r=Bm(r,i,s,n,t[4],20,-405537848),n=Bm(n,r,i,s,t[9],5,568446438),s=Bm(s,n,r,i,t[14],9,-1019803690),i=Bm(i,s,n,r,t[3],14,-187363961),r=Bm(r,i,s,n,t[8],20,1163531501),n=Bm(n,r,i,s,t[13],5,-1444681467),s=Bm(s,n,r,i,t[2],9,-51403784),i=Bm(i,s,n,r,t[7],14,1735328473),n=Vm(n,r=Bm(r,i,s,n,t[12],20,-1926607734),i,s,t[5],4,-378558),s=Vm(s,n,r,i,t[8],11,-2022574463),i=Vm(i,s,n,r,t[11],16,1839030562),r=Vm(r,i,s,n,t[14],23,-35309556),n=Vm(n,r,i,s,t[1],4,-1530992060),s=Vm(s,n,r,i,t[4],11,1272893353),i=Vm(i,s,n,r,t[7],16,-155497632),r=Vm(r,i,s,n,t[10],23,-1094730640),n=Vm(n,r,i,s,t[13],4,681279174),s=Vm(s,n,r,i,t[0],11,-358537222),i=Vm(i,s,n,r,t[3],16,-722521979),r=Vm(r,i,s,n,t[6],23,76029189),n=Vm(n,r,i,s,t[9],4,-640364487),s=Vm(s,n,r,i,t[12],11,-421815835),i=Vm(i,s,n,r,t[15],16,530742520),n=Hm(n,r=Vm(r,i,s,n,t[2],23,-995338651),i,s,t[0],6,-198630844),s=Hm(s,n,r,i,t[7],10,1126891415),i=Hm(i,s,n,r,t[14],15,-1416354905),r=Hm(r,i,s,n,t[5],21,-57434055),n=Hm(n,r,i,s,t[12],6,1700485571),s=Hm(s,n,r,i,t[3],10,-1894986606),i=Hm(i,s,n,r,t[10],15,-1051523),r=Hm(r,i,s,n,t[1],21,-2054922799),n=Hm(n,r,i,s,t[8],6,1873313359),s=Hm(s,n,r,i,t[15],10,-30611744),i=Hm(i,s,n,r,t[6],15,-1560198380),r=Hm(r,i,s,n,t[13],21,1309151649),n=Hm(n,r,i,s,t[4],6,-145523070),s=Hm(s,n,r,i,t[11],10,-1120210379),i=Hm(i,s,n,r,t[2],15,718787259),r=Hm(r,i,s,n,t[9],21,-343485551),e[0]=Km(n,e[0]),e[1]=Km(r,e[1]),e[2]=Km(i,e[2]),e[3]=Km(s,e[3])}function Um(e,t,n,r,i,s){return t=Km(Km(t,e),Km(r,s)),Km(t<<i|t>>>32-i,n)}function zm(e,t,n,r,i,s,a){return Um(t&n|~t&r,e,t,i,s,a)}function Bm(e,t,n,r,i,s,a){return Um(t&r|n&~r,e,t,i,s,a)}function Vm(e,t,n,r,i,s,a){return Um(t^n^r,e,t,i,s,a)}function Hm(e,t,n,r,i,s,a){return Um(n^(t|~r),e,t,i,s,a)}function Wm(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Dm(r,Gm(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(Dm(r,i),t=0;t<16;t++)i[t]=0;return i[14]=8*n,Dm(r,i),r}function Gm(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}var qm="0123456789abcdef".split("");function Xm(e){for(var t="",n=0;n<4;n++)t+=qm[e>>8*n+4&15]+qm[e>>8*n&15];return t}function Ym(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Zm(e){return Wm(e).map(Ym).join("")}var Jm="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=Xm(e[t]);return e.join("")}(Wm("hello"));function Km(e,t){if(Jm){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}function Qm(e,t){var n,r,i,s;if(e!==n){for(var a=(i=e,s=1+(256/e.length|0),new Array(s+1).join(i)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var d=o[l];c=(c+d+a.charCodeAt(l))%256,o[l]=o[c],o[c]=d}n=e,r=o}else o=r;var u=t.length,h=0,p=0,m="";for(l=0;l<u;l++)p=(p+(d=o[h=(h+1)%256]))%256,o[h]=o[p],o[p]=d,a=o[(o[h]+o[p])%256],m+=String.fromCharCode(t.charCodeAt(l)^a);return m}var $m={print:4,modify:8,copy:16,"annot-forms":32};function ef(e,t,n,r){this.v=1,this.r=2;var i=192;e.forEach(function(e){if(void 0!==$m.perm)throw new Error("Invalid permission: "+e);i+=$m[e]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var s=(t+this.padding).substr(0,32),a=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,a),this.P=-(1+(255^i)),this.encryptionKey=Zm(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Qm(this.encryptionKey,this.padding)}function tf(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var i=e.charCodeAt(r);t+=i<33||35===i||37===i||40===i||41===i||47===i||60===i||62===i||91===i||93===i||123===i||125===i||i>126?"#"+("0"+i.toString(16)).slice(-2):e[r]}return t}function nf(e){if("object"!==(0,xc.A)(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,r){if(r=r||!1,"string"!=typeof e||"function"!=typeof n||"boolean"!=typeof r)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var i=Math.random().toString(35);return t[e][i]=[n,!!r],i},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],0===Object.keys(t[n]).length&&delete t[n],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[n]){var a=t[n][s];try{a[0].apply(e,r)}catch(Lm){Em.console&&km.error("jsPDF PubSub Error",Lm.message,Lm)}a[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function rf(e){if(!(this instanceof rf))return new rf(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function sf(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function af(e,t,n,r,i){if(!(this instanceof af))return new af(e,t,n,r,i);this.type="axial"===e?2:3,this.coords=t,this.colors=n,sf.call(this,r,i)}function of(e,t,n,r,i){if(!(this instanceof of))return new of(e,t,n,r,i);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,sf.call(this,r,i)}function lf(e){var t,n="string"==typeof arguments[0]?arguments[0]:"p",r=arguments[1],i=arguments[2],s=arguments[3],a=[],o=1,l=16,c="S",d=null;"object"===(0,xc.A)(e=e||{})&&(n=e.orientation,r=e.unit||r,i=e.format||i,s=e.compress||e.compressPdf||s,null!==(d=e.encryption||null)&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),a=e.filters||(!0===s?["FlateEncode"]:a),r=r||"mm",n=(""+(n||"P")).toLowerCase();var u=e.putOnlyUsedFonts||!1,h={},p={internal:{},__private__:{}};p.__private__.PubSub=nf;var m="1.3",f=p.__private__.getPdfVersion=function(){return m};p.__private__.setPdfVersion=function(e){m=e};var g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return g};var x=p.__private__.getPageFormat=function(e){return g[e]};i=i||"a4";var v="compat",y="advanced",b=v;function w(){this.saveGraphicsState(),K(new Te(he,0,0,-he,0,pn()*he).toString()+" cm"),this.setFontSize(this.getFontSize()/he),c="n",b=y}function _(){this.restoreGraphicsState(),c="S",b=v}var S=p.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};p.advancedAPI=function(e){var t=b===v;return t&&w.call(this),"function"!=typeof e||(e(this),t&&_.call(this)),this},p.compatAPI=function(e){var t=b===y;return t&&_.call(this),"function"!=typeof e||(e(this),t&&w.call(this)),this},p.isAdvancedAPI=function(){return b===y};var N,j=function(e){if(b!==y)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},A=p.roundToPrecision=p.__private__.roundToPrecision=function(e,n){var r=t||n;if(isNaN(e)||isNaN(r))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(r).replace(/0+$/,"")};N=p.hpf=p.__private__.hpf="number"==typeof l?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,l)}:"smart"===l?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return A(e,16)};var M=p.f2=p.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return A(e,2)},E=p.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return A(e,3)},C=p.scale=p.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return b===v?e*he:b===y?e:void 0},k=function(e){return C(function(e){return b===v?pn()-e:b===y?e:void 0}(e))};p.__private__.setPrecision=p.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var T,P="00000000000000000000000000000000",L=p.__private__.getFileId=function(){return P},R=p.__private__.setFileId=function(e){return P=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():P.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==d&&(vt=new ef(d.userPermissions,d.userPassword,d.ownerPassword,P)),P};p.setFileId=function(e){return R(e),this},p.getFileId=function(){return L()};var I=p.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),n=t<0?"+":"-",r=Math.floor(Math.abs(t/60)),i=Math.abs(t%60),s=[n,z(r),"'",z(i),"'"].join("");return["D:",e.getFullYear(),z(e.getMonth()+1),z(e.getDate()),z(e.getHours()),z(e.getMinutes()),z(e.getSeconds()),s].join("")},F=p.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),n=parseInt(e.substr(6,2),10)-1,r=parseInt(e.substr(8,2),10),i=parseInt(e.substr(10,2),10),s=parseInt(e.substr(12,2),10),a=parseInt(e.substr(14,2),10);return new Date(t,n,r,i,s,a,0)},O=p.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=I(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return T=t},D=p.__private__.getCreationDate=function(e){var t=T;return"jsDate"===e&&(t=F(T)),t};p.setCreationDate=function(e){return O(e),this},p.getCreationDate=function(e){return D(e)};var U,z=p.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},B=p.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},V=0,H=[],W=[],G=0,q=[],X=[],Y=!1,Z=W;p.__private__.setCustomOutputDestination=function(e){Y=!0,Z=e};var J=function(e){Y||(Z=e)};p.__private__.resetCustomOutputDestination=function(){Y=!1,Z=W};var K=p.__private__.out=function(e){return e=e.toString(),G+=e.length+1,Z.push(e),Z},Q=p.__private__.write=function(e){return K(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},$=p.__private__.getArrayBuffer=function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n);t--;)r[t]=e.charCodeAt(t);return n},ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return ee};var te=e.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(e){return te=b===y?e/he:e,this};var ne,re=p.__private__.getFontSize=p.getFontSize=function(){return b===v?te:te*he},ie=e.R2L||!1;p.__private__.setR2L=p.setR2L=function(e){return ie=e,this},p.__private__.getR2L=p.getR2L=function(){return ie};var se,ae=p.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))ne=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');ne=e}else ne=parseInt(e,10)};p.__private__.getZoomMode=function(){return ne};var oe,le=p.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');se=e};p.__private__.getPageMode=function(){return se};var ce=p.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');oe=e};p.__private__.getLayoutMode=function(){return oe},p.__private__.setDisplayMode=p.setDisplayMode=function(e,t,n){return ae(e),ce(t),le(n),this};var de={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(e){if(-1===Object.keys(de).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return de[e]},p.__private__.getDocumentProperties=function(){return de},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(e){for(var t in de)de.hasOwnProperty(t)&&e[t]&&(de[t]=e[t]);return this},p.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(de).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return de[e]=t};var ue,he,pe,me,fe,ge={},xe={},ve=[],ye={},be={},we={},_e={},Se=null,Ne=0,je=[],Ae=new nf(p),Me=e.hotfixes||[],Ee={},Ce={},ke=[],Te=function e(t,n,r,i,s,a){if(!(this instanceof e))return new e(t,n,r,i,s,a);isNaN(t)&&(t=1),isNaN(n)&&(n=0),isNaN(r)&&(r=0),isNaN(i)&&(i=1),isNaN(s)&&(s=0),isNaN(a)&&(a=0),this._matrix=[t,n,r,i,s,a]};Object.defineProperty(Te.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Te.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Te.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Te.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Te.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Te.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Te.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Te.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Te.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Te.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Te.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Te.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Te.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Te.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Te.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Te.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),Te.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(N).join(e)},Te.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,n=e.sx*this.shy+e.shy*this.sy,r=e.shx*this.sx+e.sy*this.shx,i=e.shx*this.shy+e.sy*this.sy,s=e.tx*this.sx+e.ty*this.shx+this.tx,a=e.tx*this.shy+e.ty*this.sy+this.ty;return new Te(t,n,r,i,s,a)},Te.prototype.decompose=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,i=this.tx,s=this.ty,a=Math.sqrt(e*e+t*t),o=(e/=a)*n+(t/=a)*r;n-=e*o,r-=t*o;var l=Math.sqrt(n*n+r*r);return o/=l,e*(r/=l)<t*(n/=l)&&(e=-e,t=-t,o=-o,a=-a),{scale:new Te(a,0,0,l,0,0),translate:new Te(1,0,0,1,i,s),rotate:new Te(e,t,-t,e,0,0),skew:new Te(1,0,o,1,0,0)}},Te.prototype.toString=function(e){return this.join(" ")},Te.prototype.inversed=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,i=this.tx,s=this.ty,a=1/(e*r-t*n),o=r*a,l=-t*a,c=-n*a,d=e*a;return new Te(o,l,c,d,-o*i-c*s,-l*i-d*s)},Te.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,n=e.x*this.shy+e.y*this.sy+this.ty;return new tn(t,n)},Te.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),n=this.applyToPoint(new tn(e.x+e.w,e.y+e.h));return new nn(t.x,t.y,n.x-t.x,n.y-t.y)},Te.prototype.clone=function(){var e=this.sx,t=this.shy,n=this.shx,r=this.sy,i=this.tx,s=this.ty;return new Te(e,t,n,r,i,s)},p.Matrix=Te;var Pe=p.matrixMult=function(e,t){return t.multiply(e)},Le=new Te(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Le;var Re=function(e,t){if(!be[e]){var n=(t instanceof af?"Sh":"P")+(Object.keys(ye).length+1).toString(10);t.id=n,be[e]=n,ye[n]=t,Ae.publish("addPattern",t)}};p.ShadingPattern=af,p.TilingPattern=of,p.addShadingPattern=function(e,t){return j("addShadingPattern()"),Re(e,t),this},p.beginTilingPattern=function(e){j("beginTilingPattern()"),sn(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},p.endTilingPattern=function(e,t){j("endTilingPattern()"),t.stream=X[U].join("\n"),Re(e,t),Ae.publish("endTilingPattern",t),ke.pop().restore()};var Ie,Fe=p.__private__.newObject=function(){var e=Oe();return De(e,!0),e},Oe=p.__private__.newObjectDeferred=function(){return V++,H[V]=function(){return G},V},De=function(e,t){return t="boolean"==typeof t&&t,H[e]=G,t&&K(e+" 0 obj"),e},Ue=p.__private__.newAdditionalObject=function(){var e={objId:Oe(),content:""};return q.push(e),e},ze=Oe(),Be=Oe(),Ve=p.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var n=parseFloat(t[0]);t=[n,n,n,"r"]}for(var r="#",i=0;i<3;i++)r+=("0"+Math.floor(255*parseFloat(t[i])).toString(16)).slice(-2);return r},He=p.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var n=e.ch1,r=e.ch2,i=e.ch3,s=e.ch4,a="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof n&&"#"!==n.charAt(0)){var o=new Im(n);if(o.ok)n=o.toHex();else if(!/^\d*\.?\d*$/.test(n))throw new Error('Invalid color "'+n+'" passed to jsPDF.encodeColorString.')}if("string"==typeof n&&/^#[0-9A-Fa-f]{3}$/.test(n)&&(n="#"+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]),"string"==typeof n&&/^#[0-9A-Fa-f]{6}$/.test(n)){var l=parseInt(n.substr(1),16);n=l>>16&255,r=l>>8&255,i=255&l}if(void 0===r||void 0===s&&n===r&&r===i)t="string"==typeof n?n+" "+a[0]:2===e.precision?M(n/255)+" "+a[0]:E(n/255)+" "+a[0];else if(void 0===s||"object"===(0,xc.A)(s)){if(s&&!isNaN(s.a)&&0===s.a)return["1.","1.","1.",a[1]].join(" ");t="string"==typeof n?[n,r,i,a[1]].join(" "):2===e.precision?[M(n/255),M(r/255),M(i/255),a[1]].join(" "):[E(n/255),E(r/255),E(i/255),a[1]].join(" ")}else t="string"==typeof n?[n,r,i,s,a[2]].join(" "):2===e.precision?[M(n),M(r),M(i),M(s),a[2]].join(" "):[E(n),E(r),E(i),E(s),a[2]].join(" ");return t},We=p.__private__.getFilters=function(){return a},Ge=p.__private__.putStream=function(e){var t=(e=e||{}).data||"",n=e.filters||We(),r=e.alreadyAppliedFilters||[],i=e.addLength1||!1,s=t.length,a=e.objectId,o=function(e){return e};if(null!==d&&void 0===a)throw new Error("ObjectId must be passed to putStream for file encryption");null!==d&&(o=vt.encryptor(a,0));var l={};!0===n&&(n=["FlateEncode"]);var c=e.additionalKeyValues||[],u=(l=void 0!==lf.API.processDataByFilters?lf.API.processDataByFilters(t,n):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(r)?r.join(" "):r.toString());if(0!==l.data.length&&(c.push({key:"Length",value:l.data.length}),!0===i&&c.push({key:"Length1",value:s})),0!=u.length)if(u.split("/").length-1==1)c.push({key:"Filter",value:u});else{c.push({key:"Filter",value:"["+u+"]"});for(var h=0;h<c.length;h+=1)if("DecodeParms"===c[h].key){for(var p=[],m=0;m<l.reverseChain.split("/").length-1;m+=1)p.push("null");p.push(c[h].value),c[h].value="["+p.join(" ")+"]"}}K("<<");for(var f=0;f<c.length;f++)K("/"+c[f].key+" "+c[f].value);K(">>"),0!==l.data.length&&(K("stream"),K(o(l.data)),K("endstream"))},qe=p.__private__.putPage=function(e){var t=e.number,n=e.data,r=e.objId,i=e.contentsObjId;De(r,!0),K("<</Type /Page"),K("/Parent "+e.rootDictionaryObjId+" 0 R"),K("/Resources "+e.resourceDictionaryObjId+" 0 R"),K("/MediaBox ["+parseFloat(N(e.mediaBox.bottomLeftX))+" "+parseFloat(N(e.mediaBox.bottomLeftY))+" "+N(e.mediaBox.topRightX)+" "+N(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&K("/CropBox ["+N(e.cropBox.bottomLeftX)+" "+N(e.cropBox.bottomLeftY)+" "+N(e.cropBox.topRightX)+" "+N(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&K("/BleedBox ["+N(e.bleedBox.bottomLeftX)+" "+N(e.bleedBox.bottomLeftY)+" "+N(e.bleedBox.topRightX)+" "+N(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&K("/TrimBox ["+N(e.trimBox.bottomLeftX)+" "+N(e.trimBox.bottomLeftY)+" "+N(e.trimBox.topRightX)+" "+N(e.trimBox.topRightY)+"]"),null!==e.artBox&&K("/ArtBox ["+N(e.artBox.bottomLeftX)+" "+N(e.artBox.bottomLeftY)+" "+N(e.artBox.topRightX)+" "+N(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&K("/UserUnit "+e.userUnit),Ae.publish("putPage",{objId:r,pageContext:je[t],pageNumber:t,page:n}),K("/Contents "+i+" 0 R"),K(">>"),K("endobj");var s=n.join("\n");return b===y&&(s+="\nQ"),De(i,!0),Ge({data:s,filters:We(),objectId:i}),K("endobj"),r},Xe=p.__private__.putPages=function(){var e,t,n=[];for(e=1;e<=Ne;e++)je[e].objId=Oe(),je[e].contentsObjId=Oe();for(e=1;e<=Ne;e++)n.push(qe({number:e,data:X[e],objId:je[e].objId,contentsObjId:je[e].contentsObjId,mediaBox:je[e].mediaBox,cropBox:je[e].cropBox,bleedBox:je[e].bleedBox,trimBox:je[e].trimBox,artBox:je[e].artBox,userUnit:je[e].userUnit,rootDictionaryObjId:ze,resourceDictionaryObjId:Be}));De(ze,!0),K("<</Type /Pages");var r="/Kids [";for(t=0;t<Ne;t++)r+=n[t]+" 0 R ";K(r+"]"),K("/Count "+Ne),K(">>"),K("endobj"),Ae.publish("postPutPages")},Ye=function(e){Ae.publish("putFont",{font:e,out:K,newObject:Fe,putStream:Ge}),!0!==e.isAlreadyPutted&&(e.objectNumber=Fe(),K("<<"),K("/Type /Font"),K("/BaseFont /"+tf(e.postScriptName)),K("/Subtype /Type1"),"string"==typeof e.encoding&&K("/Encoding /"+e.encoding),K("/FirstChar 32"),K("/LastChar 255"),K(">>"),K("endobj"))},Ze=function(e){e.objectNumber=Fe();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[N(e.x),N(e.y),N(e.x+e.width),N(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var n=e.pages[1].join("\n");Ge({data:n,additionalKeyValues:t,objectId:e.objectNumber}),K("endobj")},Je=function(e,t){t||(t=21);var n=Fe(),r=function(e,t){var n,r=[],i=1/(t-1);for(n=0;n<1;n+=i)r.push(n);if(r.push(1),0!=e[0].offset){var s={offset:0,color:e[0].color};e.unshift(s)}if(1!=e[e.length-1].offset){var a={offset:1,color:e[e.length-1].color};e.push(a)}for(var o="",l=0,c=0;c<r.length;c++){for(n=r[c];n>e[l+1].offset;)l++;var d=e[l].offset,u=(n-d)/(e[l+1].offset-d),h=e[l].color,p=e[l+1].color;o+=B(Math.round((1-u)*h[0]+u*p[0]).toString(16))+B(Math.round((1-u)*h[1]+u*p[1]).toString(16))+B(Math.round((1-u)*h[2]+u*p[2]).toString(16))}return o.trim()}(e.colors,t),i=[];i.push({key:"FunctionType",value:"0"}),i.push({key:"Domain",value:"[0.0 1.0]"}),i.push({key:"Size",value:"["+t+"]"}),i.push({key:"BitsPerSample",value:"8"}),i.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),i.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ge({data:r,additionalKeyValues:i,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:n}),K("endobj"),e.objectNumber=Fe(),K("<< /ShadingType "+e.type),K("/ColorSpace /DeviceRGB");var s="/Coords ["+N(parseFloat(e.coords[0]))+" "+N(parseFloat(e.coords[1]))+" ";2===e.type?s+=N(parseFloat(e.coords[2]))+" "+N(parseFloat(e.coords[3])):s+=N(parseFloat(e.coords[2]))+" "+N(parseFloat(e.coords[3]))+" "+N(parseFloat(e.coords[4]))+" "+N(parseFloat(e.coords[5])),K(s+="]"),e.matrix&&K("/Matrix ["+e.matrix.toString()+"]"),K("/Function "+n+" 0 R"),K("/Extend [true true]"),K(">>"),K("endobj")},Ke=function(e,t){var n=Oe(),r=Fe();t.push({resourcesOid:n,objectOid:r}),e.objectNumber=r;var i=[];i.push({key:"Type",value:"/Pattern"}),i.push({key:"PatternType",value:"1"}),i.push({key:"PaintType",value:"1"}),i.push({key:"TilingType",value:"1"}),i.push({key:"BBox",value:"["+e.boundingBox.map(N).join(" ")+"]"}),i.push({key:"XStep",value:N(e.xStep)}),i.push({key:"YStep",value:N(e.yStep)}),i.push({key:"Resources",value:n+" 0 R"}),e.matrix&&i.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),Ge({data:e.stream,additionalKeyValues:i,objectId:e.objectNumber}),K("endobj")},Qe=function(e){for(var t in e.objectNumber=Fe(),K("<<"),e)switch(t){case"opacity":K("/ca "+M(e[t]));break;case"stroke-opacity":K("/CA "+M(e[t]))}K(">>"),K("endobj")},$e=function(e){De(e.resourcesOid,!0),K("<<"),K("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in K("/Font <<"),ge)ge.hasOwnProperty(e)&&(!1===u||!0===u&&h.hasOwnProperty(e))&&K("/"+e+" "+ge[e].objectNumber+" 0 R");K(">>")}(),function(){if(Object.keys(ye).length>0){for(var e in K("/Shading <<"),ye)ye.hasOwnProperty(e)&&ye[e]instanceof af&&ye[e].objectNumber>=0&&K("/"+e+" "+ye[e].objectNumber+" 0 R");Ae.publish("putShadingPatternDict"),K(">>")}}(),function(e){if(Object.keys(ye).length>0){for(var t in K("/Pattern <<"),ye)ye.hasOwnProperty(t)&&ye[t]instanceof p.TilingPattern&&ye[t].objectNumber>=0&&ye[t].objectNumber<e&&K("/"+t+" "+ye[t].objectNumber+" 0 R");Ae.publish("putTilingPatternDict"),K(">>")}}(e.objectOid),function(){if(Object.keys(we).length>0){var e;for(e in K("/ExtGState <<"),we)we.hasOwnProperty(e)&&we[e].objectNumber>=0&&K("/"+e+" "+we[e].objectNumber+" 0 R");Ae.publish("putGStateDict"),K(">>")}}(),function(){for(var e in K("/XObject <<"),Ee)Ee.hasOwnProperty(e)&&Ee[e].objectNumber>=0&&K("/"+e+" "+Ee[e].objectNumber+" 0 R");Ae.publish("putXobjectDict"),K(">>")}(),K(">>"),K("endobj")},et=function(e){xe[e.fontName]=xe[e.fontName]||{},xe[e.fontName][e.fontStyle]=e.id},tt=function(e,t,n,r,i){var s={id:"F"+(Object.keys(ge).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:n,encoding:r,isStandardFont:i||!1,metadata:{}};return Ae.publish("addFont",{font:s,instance:this}),ge[s.id]=s,et(s),s.id},nt=p.__private__.pdfEscape=p.pdfEscape=function(e,t){return function(e,t){var n,r,i,s,a,o,l,c,d;if(i=(t=t||{}).sourceEncoding||"Unicode",a=t.outputEncoding,(t.autoencode||a)&&ge[ue].metadata&&ge[ue].metadata[i]&&ge[ue].metadata[i].encoding&&(s=ge[ue].metadata[i].encoding,!a&&ge[ue].encoding&&(a=ge[ue].encoding),!a&&s.codePages&&(a=s.codePages[0]),"string"==typeof a&&(a=s[a]),a)){for(l=!1,o=[],n=0,r=e.length;n<r;n++)(c=a[e.charCodeAt(n)])?o.push(String.fromCharCode(c)):o.push(e[n]),o[n].charCodeAt(0)>>8&&(l=!0);e=o.join("")}for(n=e.length;void 0===l&&0!==n;)e.charCodeAt(n-1)>>8&&(l=!0),n--;if(!l)return e;for(o=t.noBOM?[]:[254,255],n=0,r=e.length;n<r;n++){if((d=(c=e.charCodeAt(n))>>8)>>8)throw new Error("Character at position "+n+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(d),o.push(c-(d<<8))}return String.fromCharCode.apply(void 0,o)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rt=p.__private__.beginPage=function(e){X[++Ne]=[],je[Ne]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},at(Ne),J(X[U])},it=function(e,t){var r,s,a;switch(n=t||n,"string"==typeof e&&(r=x(e.toLowerCase()),Array.isArray(r)&&(s=r[0],a=r[1])),Array.isArray(e)&&(s=e[0]*he,a=e[1]*he),isNaN(s)&&(s=i[0],a=i[1]),(s>14400||a>14400)&&(km.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),s=Math.min(14400,s),a=Math.min(14400,a)),i=[s,a],n.substr(0,1)){case"l":a>s&&(i=[a,s]);break;case"p":s>a&&(i=[a,s])}rt(i),Dt(Ft),K(qt),0!==Qt&&K(Qt+" J"),0!==$t&&K($t+" j"),Ae.publish("addPage",{pageNumber:Ne})},st=function(e){e>0&&e<=Ne&&(X.splice(e,1),je.splice(e,1),Ne--,U>Ne&&(U=Ne),this.setPage(U))},at=function(e){e>0&&e<=Ne&&(U=e)},ot=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return X.length-1},lt=function(e,t,n){var r,i=void 0;return n=n||{},e=void 0!==e?e:ge[ue].fontName,t=void 0!==t?t:ge[ue].fontStyle,r=e.toLowerCase(),void 0!==xe[r]&&void 0!==xe[r][t]?i=xe[r][t]:void 0!==xe[e]&&void 0!==xe[e][t]?i=xe[e][t]:!1===n.disableWarning&&km.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),i||n.noFallback||null==(i=xe.times[t])&&(i=xe.times.normal),i},ct=p.__private__.putInfo=function(){var e=Fe(),t=function(e){return e};for(var n in null!==d&&(t=vt.encryptor(e,0)),K("<<"),K("/Producer ("+nt(t("jsPDF "+lf.version))+")"),de)de.hasOwnProperty(n)&&de[n]&&K("/"+n.substr(0,1).toUpperCase()+n.substr(1)+" ("+nt(t(de[n]))+")");K("/CreationDate ("+nt(t(T))+")"),K(">>"),K("endobj")},dt=p.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||ze;switch(Fe(),K("<<"),K("/Type /Catalog"),K("/Pages "+t+" 0 R"),ne||(ne="fullwidth"),ne){case"fullwidth":K("/OpenAction [3 0 R /FitH null]");break;case"fullheight":K("/OpenAction [3 0 R /FitV null]");break;case"fullpage":K("/OpenAction [3 0 R /Fit]");break;case"original":K("/OpenAction [3 0 R /XYZ null null 1]");break;default:var n=""+ne;"%"===n.substr(n.length-1)&&(ne=parseInt(ne)/100),"number"==typeof ne&&K("/OpenAction [3 0 R /XYZ null null "+M(ne)+"]")}switch(oe||(oe="continuous"),oe){case"continuous":K("/PageLayout /OneColumn");break;case"single":K("/PageLayout /SinglePage");break;case"two":case"twoleft":K("/PageLayout /TwoColumnLeft");break;case"tworight":K("/PageLayout /TwoColumnRight")}se&&K("/PageMode /"+se),Ae.publish("putCatalog"),K(">>"),K("endobj")},ut=p.__private__.putTrailer=function(){K("trailer"),K("<<"),K("/Size "+(V+1)),K("/Root "+V+" 0 R"),K("/Info "+(V-1)+" 0 R"),null!==d&&K("/Encrypt "+vt.oid+" 0 R"),K("/ID [ <"+P+"> <"+P+"> ]"),K(">>")},ht=p.__private__.putHeader=function(){K("%PDF-"+m),K("%\xba\xdf\xac\xe0")},pt=p.__private__.putXRef=function(){var e="0000000000";K("xref"),K("0 "+(V+1)),K("0000000000 65535 f ");for(var t=1;t<=V;t++)"function"==typeof H[t]?K((e+H[t]()).slice(-10)+" 00000 n "):void 0!==H[t]?K((e+H[t]).slice(-10)+" 00000 n "):K("0000000000 00000 n ")},mt=p.__private__.buildDocument=function(){var e;V=0,G=0,W=[],H=[],q=[],ze=Oe(),Be=Oe(),J(W),Ae.publish("buildDocument"),ht(),Xe(),function(){Ae.publish("putAdditionalObjects");for(var e=0;e<q.length;e++){var t=q[e];De(t.objId,!0),K(t.content),K("endobj")}Ae.publish("postPutAdditionalObjects")}(),e=[],function(){for(var e in ge)ge.hasOwnProperty(e)&&(!1===u||!0===u&&h.hasOwnProperty(e))&&Ye(ge[e])}(),function(){var e;for(e in we)we.hasOwnProperty(e)&&Qe(we[e])}(),function(){for(var e in Ee)Ee.hasOwnProperty(e)&&Ze(Ee[e])}(),function(e){var t;for(t in ye)ye.hasOwnProperty(t)&&(ye[t]instanceof af?Je(ye[t]):ye[t]instanceof of&&Ke(ye[t],e))}(e),Ae.publish("putResources"),e.forEach($e),$e({resourcesOid:Be,objectOid:Number.MAX_SAFE_INTEGER}),Ae.publish("postPutResources"),null!==d&&(vt.oid=Fe(),K("<<"),K("/Filter /Standard"),K("/V "+vt.v),K("/R "+vt.r),K("/U <"+vt.toHexString(vt.U)+">"),K("/O <"+vt.toHexString(vt.O)+">"),K("/P "+vt.P),K(">>"),K("endobj")),ct(),dt();var t=G;return pt(),ut(),K("startxref"),K(""+t),K("%%EOF"),J(X[U]),W.join("\n")},ft=p.__private__.getBlob=function(e){return new Blob([$(e)],{type:"application/pdf"})},gt=p.output=p.__private__.output=(Ie=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return mt();case"save":p.save(t.filename);break;case"arraybuffer":return $(mt());case"blob":return ft(mt());case"bloburi":case"bloburl":if(void 0!==Em.URL&&"function"==typeof Em.URL.createObjectURL)return Em.URL&&Em.URL.createObjectURL(ft(mt()))||void 0;km.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var n="",r=mt();try{n=Om(r)}catch(d){n=Om(unescape(encodeURIComponent(r)))}return"data:application/pdf;filename="+t.filename+";base64,"+n;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(Em)){var i="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",s=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(i=t.pdfObjectUrl,s="");var a='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+i+'"'+s+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",o=Em.open();return null!==o&&o.document.write(a),o}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(Em)){var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',c=Em.open();if(null!==c){c.document.write(l);var u=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=t.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(u.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(Em))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',m=Em.open();if(null!==m&&(m.document.write(h),m.document.title=t.filename),m||"undefined"==typeof safari)return m;break;case"datauri":case"dataurl":return Em.document.location.href=this.output("datauristring",t);default:return null}},Ie.foo=function(){try{return Ie.apply(this,arguments)}catch(t){var e=t.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var n="Error in function "+e.split("\n")[0].split("<")[0]+": "+t.message;if(!Em.console)throw new Error(n);Em.console.error(n,t),Em.alert&&alert(n)}},Ie.foo.bar=Ie,Ie.foo),xt=function(e){return!0===Array.isArray(Me)&&Me.indexOf(e)>-1};switch(r){case"pt":he=1;break;case"mm":he=72/25.4;break;case"cm":he=72/2.54;break;case"in":he=72;break;case"px":he=1==xt("px_scaling")?.75:96/72;break;case"pc":case"em":he=12;break;case"ex":he=6;break;default:if("number"!=typeof r)throw new Error("Invalid unit: "+r);he=r}var vt=null;O(),R();var yt=p.__private__.getPageInfo=p.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:je[e].objId,pageNumber:e,pageContext:je[e]}},bt=p.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in je)if(je[t].objId===e)break;return yt(t)},wt=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:je[U].objId,pageNumber:U,pageContext:je[U]}};p.addPage=function(){return it.apply(this,arguments),this},p.setPage=function(){return at.apply(this,arguments),J.call(this,X[U]),this},p.insertPage=function(e){return this.addPage(),this.movePage(U,e),this},p.movePage=function(e,t){var n,r;if(e>t){n=X[e],r=je[e];for(var i=e;i>t;i--)X[i]=X[i-1],je[i]=je[i-1];X[t]=n,je[t]=r,this.setPage(t)}else if(e<t){n=X[e],r=je[e];for(var s=e;s<t;s++)X[s]=X[s+1],je[s]=je[s+1];X[t]=n,je[t]=r,this.setPage(t)}return this},p.deletePage=function(){return st.apply(this,arguments),this},p.__private__.text=p.text=function(e,t,n,r,i){var s,a,o,l,c,d,u,p,m,f=(r=r||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof n||Array.isArray(n))){var g=n;n=t,t=e,e=g}if(arguments[3]instanceof Te==0?(o=arguments[4],l=arguments[5],"object"===(0,xc.A)(u=arguments[3])&&null!==u||("string"==typeof o&&(l=o,o=null),"string"==typeof u&&(l=u,u=null),"number"==typeof u&&(o=u,u=null),r={flags:u,angle:o,align:l})):(j("The transform parameter of text() with a Matrix value"),m=i),isNaN(t)||isNaN(n)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return f;var x,v="",w="number"==typeof r.lineHeightFactor?r.lineHeightFactor:It,_=f.internal.scaleFactor;function S(e){return e=e.split("\t").join(Array(r.TabLen||9).join(" ")),nt(e,u)}function A(e){for(var t,n=e.concat(),r=[],i=n.length;i--;)"string"==typeof(t=n.shift())?r.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?r.push(t[0]):r.push([t[0],t[1],t[2]]);return r}function M(e,t){var n;if("string"==typeof e)n=t(e)[0];else if(Array.isArray(e)){for(var r,i,s=e.concat(),a=[],o=s.length;o--;)"string"==typeof(r=s.shift())?a.push(t(r)[0]):Array.isArray(r)&&"string"==typeof r[0]&&(i=t(r[0],r[1],r[2]),a.push([i[0],i[1],i[2]]));n=a}return n}var E=!1,k=!0;if("string"==typeof e)E=!0;else if(Array.isArray(e)){var T=e.concat();a=[];for(var P,L=T.length;L--;)("string"!=typeof(P=T.shift())||Array.isArray(P)&&"string"!=typeof P[0])&&(k=!1);E=k}if(!1===E)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var R=te/f.internal.scaleFactor,I=R*(w-1);switch(r.baseline){case"bottom":n-=I;break;case"top":n+=R-I;break;case"hanging":n+=R-2*I;break;case"middle":n+=R/2-I}if((d=r.maxWidth||0)>0&&("string"==typeof e?e=f.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(f.splitTextToSize(t,d))},[]))),s={text:e,x:t,y:n,options:r,mutex:{pdfEscape:nt,activeFontKey:ue,fonts:ge,activeFontSize:te}},Ae.publish("preProcessText",s),e=s.text,o=(r=s.options).angle,m instanceof Te==0&&o&&"number"==typeof o){o*=Math.PI/180,0===r.rotationDirection&&(o=-o),b===y&&(o=-o);var F=Math.cos(o),O=Math.sin(o);m=new Te(F,O,-O,F,0,0)}else o&&o instanceof Te&&(m=o);b!==y||m||(m=Le),void 0!==(c=r.charSpace||Jt)&&(v+=N(C(c))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(p=r.horizontalScale)&&(v+=N(100*p)+" Tz\n"),r.lang;var D=-1,U=void 0!==r.renderingMode?r.renderingMode:r.stroke,z=f.internal.getCurrentPageInfo().pageContext;switch(U){case 0:case!1:case"fill":D=0;break;case 1:case!0:case"stroke":D=1;break;case 2:case"fillThenStroke":D=2;break;case 3:case"invisible":D=3;break;case 4:case"fillAndAddForClipping":D=4;break;case 5:case"strokeAndAddPathForClipping":D=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":D=6;break;case 7:case"addToPathForClipping":D=7}var B=void 0!==z.usedRenderingMode?z.usedRenderingMode:-1;-1!==D?v+=D+" Tr\n":-1!==B&&(v+="0 Tr\n"),-1!==D&&(z.usedRenderingMode=D),l=r.align||"left";var V,H=te*w,W=f.internal.pageSize.getWidth(),G=ge[ue];c=r.charSpace||Jt,d=r.maxWidth||0,u=Object.assign({autoencode:!0,noBOM:!0},r.flags);var q=[],X=function(e){return f.getStringUnitWidth(e,{font:G,charSpace:c,fontSize:te,doKerning:!1})*te/_};if("[object Array]"===Object.prototype.toString.call(e)){var Y;a=A(e),"left"!==l&&(V=a.map(X));var Z,J=0;if("right"===l){t-=V[0],e=[],L=a.length;for(var Q=0;Q<L;Q++)0===Q?(Z=Vt(t),Y=Ht(n)):(Z=C(J-V[Q]),Y=-H),e.push([a[Q],Z,Y]),J=V[Q]}else if("center"===l){t-=V[0]/2,e=[],L=a.length;for(var $=0;$<L;$++)0===$?(Z=Vt(t),Y=Ht(n)):(Z=C((J-V[$])/2),Y=-H),e.push([a[$],Z,Y]),J=V[$]}else if("left"===l){e=[],L=a.length;for(var ee=0;ee<L;ee++)e.push(a[ee])}else if("justify"===l&&"Identity-H"===G.encoding){e=[],L=a.length,d=0!==d?d:W;for(var ne=0,re=0;re<L;re++)if(Y=0===re?Ht(n):-H,Z=0===re?Vt(t):ne,re<L-1){var se=C((d-V[re])/(a[re].split(" ").length-1)),ae=a[re].split(" ");e.push([ae[0]+" ",Z,Y]),ne=0;for(var oe=1;oe<ae.length;oe++){var le=(X(ae[oe-1]+" "+ae[oe])-X(ae[oe]))*_+se;oe==ae.length-1?e.push([ae[oe],le,0]):e.push([ae[oe]+" ",le,0]),ne-=le}}else e.push([a[re],Z,Y]);e.push(["",ne,0])}else{if("justify"!==l)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],L=a.length,d=0!==d?d:W,re=0;re<L;re++){Y=0===re?Ht(n):-H,Z=0===re?Vt(t):0;var ce=a[re].split(" ").length-1,de=ce>0?(d-V[re])/ce:0;re<L-1?q.push(N(C(de))):q.push(0),e.push([a[re],Z,Y])}}}!0===("boolean"==typeof r.R2L?r.R2L:ie)&&(e=M(e,function(e,t,n){return[e.split("").reverse().join(""),t,n]})),s={text:e,x:t,y:n,options:r,mutex:{pdfEscape:nt,activeFontKey:ue,fonts:ge,activeFontSize:te}},Ae.publish("postProcessText",s),e=s.text,x=s.mutex.isHex||!1;var he=ge[ue].encoding;"WinAnsiEncoding"!==he&&"StandardEncoding"!==he||(e=M(e,function(e,t,n){return[S(e),t,n]})),a=A(e),e=[];for(var pe,me,fe,xe=Array.isArray(a[0])?1:0,ve="",ye=function(e,t,n){var i="";return n instanceof Te?(n="number"==typeof r.angle?Pe(n,new Te(1,0,0,1,e,t)):Pe(new Te(1,0,0,1,e,t),n),b===y&&(n=Pe(new Te(1,0,0,-1,0,0),n)),i=n.join(" ")+" Tm\n"):i=N(e)+" "+N(t)+" Td\n",i},be=0;be<a.length;be++){switch(ve="",xe){case 1:fe=(x?"<":"(")+a[be][0]+(x?">":")"),pe=parseFloat(a[be][1]),me=parseFloat(a[be][2]);break;case 0:fe=(x?"<":"(")+a[be]+(x?">":")"),pe=Vt(t),me=Ht(n)}void 0!==q&&void 0!==q[be]&&(ve=q[be]+" Tw\n"),0===be?e.push(ve+ye(pe,me,m)+fe):0===xe?e.push(ve+fe):1===xe&&e.push(ve+ye(pe,me,m)+fe)}e=0===xe?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var we="BT\n/";return we+=ue+" "+te+" Tf\n",we+=N(te*w)+" TL\n",we+=Yt+"\n",we+=v,we+=e,K(we+="ET"),h[ue]=!0,f};var _t=p.__private__.clip=p.clip=function(e){return K("evenodd"===e?"W*":"W"),this};p.clipEvenOdd=function(){return _t("evenodd")},p.__private__.discardPath=p.discardPath=function(){return K("n"),this};var St=p.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(e){return St(e)&&(c=e),this};var Nt=p.__private__.getStyle=p.getStyle=function(e){var t=c;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},jt=p.close=function(){return K("h"),this};p.stroke=function(){return K("S"),this},p.fill=function(e){return At("f",e),this},p.fillEvenOdd=function(e){return At("f*",e),this},p.fillStroke=function(e){return At("B",e),this},p.fillStrokeEvenOdd=function(e){return At("B*",e),this};var At=function(e,t){"object"===(0,xc.A)(t)?Ct(t,e):K(e)},Mt=function(e){null===e||b===y&&void 0===e||(e=Nt(e),K(e))};function Et(e,t,n,r,i){var s=new of(t||this.boundingBox,n||this.xStep,r||this.yStep,this.gState,i||this.matrix);s.stream=this.stream;var a=e+"$$"+this.cloneIndex+++"$$";return Re(a,s),s}var Ct=function(e,t){var n=be[e.key],r=ye[n];if(r instanceof af)K("q"),K(kt(t)),r.gState&&p.setGState(r.gState),K(e.matrix.toString()+" cm"),K("/"+n+" sh"),K("Q");else if(r instanceof of){var i=new Te(1,0,0,-1,0,pn());e.matrix&&(i=i.multiply(e.matrix||Le),n=Et.call(r,e.key,e.boundingBox,e.xStep,e.yStep,i).id),K("q"),K("/Pattern cs"),K("/"+n+" scn"),r.gState&&p.setGState(r.gState),K(t),K("Q")}},kt=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Tt=p.moveTo=function(e,t){return K(N(C(e))+" "+N(k(t))+" m"),this},Pt=p.lineTo=function(e,t){return K(N(C(e))+" "+N(k(t))+" l"),this},Lt=p.curveTo=function(e,t,n,r,i,s){return K([N(C(e)),N(k(t)),N(C(n)),N(k(r)),N(C(i)),N(k(s)),"c"].join(" ")),this};p.__private__.line=p.line=function(e,t,n,r,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!St(i))throw new Error("Invalid arguments passed to jsPDF.line");return b===v?this.lines([[n-e,r-t]],e,t,[1,1],i||"S"):this.lines([[n-e,r-t]],e,t,[1,1]).stroke()},p.__private__.lines=p.lines=function(e,t,n,r,i,s){var a,o,l,c,d,u,h,p,m,f,g,x;if("number"==typeof e&&(x=n,n=t,t=e,e=x),r=r||[1,1],s=s||!1,isNaN(t)||isNaN(n)||!Array.isArray(e)||!Array.isArray(r)||!St(i)||"boolean"!=typeof s)throw new Error("Invalid arguments passed to jsPDF.lines");for(Tt(t,n),a=r[0],o=r[1],c=e.length,f=t,g=n,l=0;l<c;l++)2===(d=e[l]).length?(f=d[0]*a+f,g=d[1]*o+g,Pt(f,g)):(u=d[0]*a+f,h=d[1]*o+g,p=d[2]*a+f,m=d[3]*o+g,f=d[4]*a+f,g=d[5]*o+g,Lt(u,h,p,m,f,g));return s&&jt(),Mt(i),this},p.path=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n.c;switch(n.op){case"m":Tt(r[0],r[1]);break;case"l":Pt(r[0],r[1]);break;case"c":Lt.apply(this,r);break;case"h":jt()}}return this},p.__private__.rect=p.rect=function(e,t,n,r,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!St(i))throw new Error("Invalid arguments passed to jsPDF.rect");return b===v&&(r=-r),K([N(C(e)),N(k(t)),N(C(n)),N(C(r)),"re"].join(" ")),Mt(i),this},p.__private__.triangle=p.triangle=function(e,t,n,r,i,s,a){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(s)||!St(a))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[n-e,r-t],[i-n,s-r],[e-i,t-s]],e,t,[1,1],a,!0),this},p.__private__.roundedRect=p.roundedRect=function(e,t,n,r,i,s,a){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(s)||!St(a))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return i=Math.min(i,.5*n),s=Math.min(s,.5*r),this.lines([[n-2*i,0],[i*o,0,i,s-s*o,i,s],[0,r-2*s],[0,s*o,-i*o,s,-i,s],[2*i-n,0],[-i*o,0,-i,-s*o,-i,-s],[0,2*s-r],[0,-s*o,i*o,-s,i,-s]],e+i,t,[1,1],a,!0),this},p.__private__.ellipse=p.ellipse=function(e,t,n,r,i){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||!St(i))throw new Error("Invalid arguments passed to jsPDF.ellipse");var s=4/3*(Math.SQRT2-1)*n,a=4/3*(Math.SQRT2-1)*r;return Tt(e+n,t),Lt(e+n,t-a,e+s,t-r,e,t-r),Lt(e-s,t-r,e-n,t-a,e-n,t),Lt(e-n,t+a,e-s,t+r,e,t+r),Lt(e+s,t+r,e+n,t+a,e+n,t),Mt(i),this},p.__private__.circle=p.circle=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||!St(r))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,n,n,r)},p.setFont=function(e,t,n){return n&&(t=S(t,n)),ue=lt(e,t,{disableWarning:!1}),this};var Rt=p.__private__.getFont=p.getFont=function(){return ge[lt.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var e,t,n={};for(e in xe)if(xe.hasOwnProperty(e))for(t in n[e]=[],xe[e])xe[e].hasOwnProperty(t)&&n[e].push(t);return n},p.addFont=function(e,t,n,r,i){var s=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==s.indexOf(arguments[3])?i=arguments[3]:arguments[3]&&-1==s.indexOf(arguments[3])&&(n=S(n,r)),tt.call(this,e,t,n,i=i||"Identity-H")};var It,Ft=e.lineWidth||.200025,Ot=p.__private__.getLineWidth=p.getLineWidth=function(){return Ft},Dt=p.__private__.setLineWidth=p.setLineWidth=function(e){return Ft=e,K(N(C(e))+" w"),this};p.__private__.setLineDash=lf.API.setLineDash=lf.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map(function(e){return N(C(e))}).join(" "),t=N(C(t)),K("["+e+"] "+t+" d"),this};var Ut=p.__private__.getLineHeight=p.getLineHeight=function(){return te*It};p.__private__.getLineHeight=p.getLineHeight=function(){return te*It};var zt=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(It=e),this},Bt=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return It};zt(e.lineHeight);var Vt=p.__private__.getHorizontalCoordinate=function(e){return C(e)},Ht=p.__private__.getVerticalCoordinate=function(e){return b===y?e:je[U].mediaBox.topRightY-je[U].mediaBox.bottomLeftY-C(e)},Wt=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(e){return N(Vt(e))},Gt=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(e){return N(Ht(e))},qt=e.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Ve(qt)},p.__private__.setStrokeColor=p.setDrawColor=function(e,t,n,r){return qt=He({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"draw",precision:2}),K(qt),this};var Xt=e.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Ve(Xt)},p.__private__.setFillColor=p.setFillColor=function(e,t,n,r){return Xt=He({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"fill",precision:2}),K(Xt),this};var Yt=e.textColor||"0 g",Zt=p.__private__.getTextColor=p.getTextColor=function(){return Ve(Yt)};p.__private__.setTextColor=p.setTextColor=function(e,t,n,r){return Yt=He({ch1:e,ch2:t,ch3:n,ch4:r,pdfColorType:"text",precision:3}),this};var Jt=e.charSpace,Kt=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Jt||0)};p.__private__.setCharSpace=p.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Jt=e,this};var Qt=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(e){var t=p.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qt=t,K(t+" J"),this};var $t=0;p.__private__.setLineJoin=p.setLineJoin=function(e){var t=p.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $t=t,K(t+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return K(N(C(e))+" M"),this},p.GState=rf,p.setGState=function(e){(e="string"==typeof e?we[_e[e]]:en(null,e)).equals(Se)||(K("/"+e.id+" gs"),Se=e)};var en=function(e,t){if(!e||!_e[e]){var n=!1;for(var r in we)if(we.hasOwnProperty(r)&&we[r].equals(t)){n=!0;break}if(n)t=we[r];else{var i="GS"+(Object.keys(we).length+1).toString(10);we[i]=t,t.id=i}return e&&(_e[e]=t.id),Ae.publish("addGState",t),t}};p.addGState=function(e,t){return en(e,t),this},p.saveGraphicsState=function(){return K("q"),ve.push({key:ue,size:te,color:Yt}),this},p.restoreGraphicsState=function(){K("Q");var e=ve.pop();return ue=e.key,te=e.size,Yt=e.color,Se=null,this},p.setCurrentTransformationMatrix=function(e){return K(e.toString()+" cm"),this},p.comment=function(e){return K("#"+e),this};var tn=function(e,t){var n=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var r=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var i="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return i},set:function(e){i=e.toString()}}),this},nn=function(e,t,n,r){tn.call(this,e,t),this.type="rect";var i=n||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return i},set:function(e){isNaN(e)||(i=parseFloat(e))}});var s=r||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return s},set:function(e){isNaN(e)||(s=parseFloat(e))}}),this},rn=function(){this.page=Ne,this.currentPage=U,this.pages=X.slice(0),this.pagesContext=je.slice(0),this.x=pe,this.y=me,this.matrix=fe,this.width=on(U),this.height=cn(U),this.outputDestination=Z,this.id="",this.objectNumber=-1};rn.prototype.restore=function(){Ne=this.page,U=this.currentPage,je=this.pagesContext,X=this.pages,pe=this.x,me=this.y,fe=this.matrix,ln(U,this.width),dn(U,this.height),Z=this.outputDestination};var sn=function(e,t,n,r,i){ke.push(new rn),Ne=U=0,X=[],pe=e,me=t,fe=i,rt([n,r])};for(var an in p.beginFormObject=function(e,t,n,r,i){return sn(e,t,n,r,i),this},p.endFormObject=function(e){return function(e){if(Ce[e])ke.pop().restore();else{var t=new rn,n="Xo"+(Object.keys(Ee).length+1).toString(10);t.id=n,Ce[e]=n,Ee[n]=t,Ae.publish("addFormObject",t),ke.pop().restore()}}(e),this},p.doFormObject=function(e,t){var n=Ee[Ce[e]];return K("q"),K(t.toString()+" cm"),K("/"+n.id+" Do"),K("Q"),this},p.getFormObject=function(e){var t=Ee[Ce[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},p.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(Rm(ft(mt()),e),"function"==typeof Rm.unload&&Em.setTimeout&&setTimeout(Rm.unload,911),this):new Promise(function(t,n){try{var i=Rm(ft(mt()),e);"function"==typeof Rm.unload&&Em.setTimeout&&setTimeout(Rm.unload,911),t(i)}catch(r){n(r.message)}})},lf.API)lf.API.hasOwnProperty(an)&&("events"===an&&lf.API.events.length?function(e,t){var n,r,i;for(i=t.length-1;-1!==i;i--)n=t[i][0],r=t[i][1],e.subscribe.apply(e,[n].concat("function"==typeof r?[r]:r))}(Ae,lf.API.events):p[an]=lf.API[an]);function on(e){return je[e].mediaBox.topRightX-je[e].mediaBox.bottomLeftX}function ln(e,t){je[e].mediaBox.topRightX=t+je[e].mediaBox.bottomLeftX}function cn(e){return je[e].mediaBox.topRightY-je[e].mediaBox.bottomLeftY}function dn(e,t){je[e].mediaBox.topRightY=t+je[e].mediaBox.bottomLeftY}var un=p.getPageWidth=function(e){return on(e=e||U)/he},hn=p.setPageWidth=function(e,t){ln(e,t*he)},pn=p.getPageHeight=function(e){return cn(e=e||U)/he},mn=p.setPageHeight=function(e,t){dn(e,t*he)};return p.internal={pdfEscape:nt,getStyle:Nt,getFont:Rt,getFontSize:re,getCharSpace:Kt,getTextColor:Zt,getLineHeight:Ut,getLineHeightFactor:Bt,getLineWidth:Ot,write:Q,getHorizontalCoordinate:Vt,getVerticalCoordinate:Ht,getCoordinateString:Wt,getVerticalCoordinateString:Gt,collections:{},newObject:Fe,newAdditionalObject:Ue,newObjectDeferred:Oe,newObjectDeferredBegin:De,getFilters:We,putStream:Ge,events:Ae,scaleFactor:he,pageSize:{getWidth:function(){return un(U)},setWidth:function(e){hn(U,e)},getHeight:function(){return pn(U)},setHeight:function(e){mn(U,e)}},encryptionOptions:d,encryption:vt,getEncryptor:function(e){return null!==d?vt.encryptor(e,0):function(e){return e}},output:gt,getNumberOfPages:ot,pages:X,out:K,f2:M,f3:E,getPageInfo:yt,getPageInfoByObjId:bt,getCurrentPageInfo:wt,getPDFVersion:f,Point:tn,Rectangle:nn,Matrix:Te,hasHotfix:xt},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return un(U)},set:function(e){hn(U,e)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return pn(U)},set:function(e){mn(U,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,n=ee.length;t<n;t++){var r=tt.call(this,e[t][0],e[t][1],e[t][2],ee[t][3],!0);!1===u&&(h[r]=!0);var i=e[t][0].split("-");et({id:r,fontName:i[0],fontStyle:i[1]||""})}Ae.publish("addFonts",{fonts:ge,dictionary:xe})}.call(p,ee),ue="F1",it(i,n),Ae.publish("initialized"),p}ef.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},ef.prototype.toHexString=function(e){return e.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ef.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},ef.prototype.processOwnerPassword=function(e,t){return Qm(Zm(t).substr(0,5),e)},ef.prototype.encryptor=function(e,t){var n=Zm(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return Qm(n,e)}},rf.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||(0,xc.A)(e)!==(0,xc.A)(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return 0===r},lf.API={events:[]},lf.version="3.0.3";var cf=lf.API,df=1,uf=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hf=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},pf=function(e){return e.toFixed(2)},mf=function(e){return e.toFixed(5)};cf.__acroform__={};var ff=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},gf=function(e){return e*df},xf=function(e){var t=new Lf,n=Xf.internal.getHeight(e)||0,r=Xf.internal.getWidth(e)||0;return t.BBox=[0,0,Number(pf(r)),Number(pf(n))],t},vf=cf.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},yf=cf.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},bf=cf.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},wf=cf.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return bf(e,t-1)},_f=cf.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return vf(e,t-1)},Sf=cf.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return yf(e,t-1)},Nf=cf.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,i=e[0],s=e[1],a=e[2],o=e[3],l={};return l.lowerLeft_X=n(i)||0,l.lowerLeft_Y=r(s+o)||0,l.upperRight_X=n(i+a)||0,l.upperRight_Y=r(s)||0,[Number(pf(l.lowerLeft_X)),Number(pf(l.lowerLeft_Y)),Number(pf(l.upperRight_X)),Number(pf(l.upperRight_Y))]},jf=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=Af(e,n),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+pf(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=xf(e);return s.scope=e.scope,s.stream=t.join("\n"),s}},Af=function(e,t){var n=0===e.fontSize?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},i=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(e){return e.split("\n")}):i.map(function(e){return[e]});var s=n,a=Xf.internal.getHeight(e)||0;a=a<0?-a:a;var o=Xf.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(t,n,r){if(t+1<i.length){var s=n+" "+i[t+1][0];return Mf(s,e,r).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var c,d,u=Mf("3",e,s).height,h=e.multiline?a-s:(a-u)/2,p=h+=2,m=0,f=0,g=0;if(s<=0){t="(...) Tj\n",t+="% Width of Text: "+Mf(t,e,s=12).width+", FieldWidth:"+o+"\n";break}for(var x="",v=0,y=0;y<i.length;y++)if(i.hasOwnProperty(y)){var b=!1;if(1!==i[y].length&&g!==i[y].length-1){if((u+2)*(v+2)+2>a)continue e;x+=i[y][g],b=!0,f=y,y--}else{x=" "==(x+=i[y][g]+" ").substr(x.length-1)?x.substr(0,x.length-1):x;var w=parseInt(y),_=l(w,x,s),S=y>=i.length-1;if(_&&!S){x+=" ",g=0;continue}if(_||S){if(S)f=w;else if(e.multiline&&(u+2)*(v+2)+2>a)continue e}else{if(!e.multiline)continue e;if((u+2)*(v+2)+2>a)continue e;f=w}}for(var N="",j=m;j<=f;j++){var A=i[j];if(e.multiline){if(j===f){N+=A[g]+" ",g=(g+1)%A.length;continue}if(j===m){N+=A[A.length-1]+" ";continue}}N+=A[0]+" "}switch(N=" "==N.substr(N.length-1)?N.substr(0,N.length-1):N,d=Mf(N,e,s).width,e.textAlign){case"right":c=o-d-2;break;case"center":c=(o-d)/2;break;default:c=2}t+=pf(c)+" "+pf(p)+" Td\n",t+="("+uf(N)+") Tj\n",t+=-pf(c)+" 0 Td\n",p=-(s+2),d=0,m=b?f:f+1,v++,x=""}break}return r.text=t,r.fontSize=s,r},Mf=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:i}},Ef={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Cf=function(e,t){var n={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find(function(e){return e.type===n.type&&e.object===n.object})&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},kf=cf.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(e){return e};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(0!==s&&(i+=" "),(0,xc.A)(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":"/"!==e[s].substr(0,1)?(void 0!==t&&n&&(r=n.internal.getEncryptor(t)),i+="("+uf(r(e[s].toString()))+")"):i+=e[s].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Tf=function(e,t,n){var r=function(e){return e};return void 0!==t&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+uf(r(e))+")"},Pf=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Pf.prototype.toString=function(){return this.objId+" 0 R"},Pf.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Pf.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)});for(var n in t)if(!1===Object.getOwnPropertyDescriptor(this,t[n]).configurable){var r=t[n],i=this[r];i&&(Array.isArray(i)?e.push({key:r,value:kf(i,this.objId,this.scope)}):i instanceof Pf?(i.scope=this.scope,e.push({key:r,value:i.objId+" 0 R"})):"function"!=typeof i&&e.push({key:r,value:i}))}return e};var Lf=function(){Pf.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};ff(Lf,Pf);var Rf=function(){Pf.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+uf(t(e))+")"}},set:function(t){e=t}})};ff(Rf,Pf);var If=function e(){Pf.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(t,3))},set:function(e){!0===Boolean(e)?this.F=_f(t,3):this.F=Sf(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');n=e}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==r.length)return r},set:function(e){r=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(e){r[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(e){r[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(e){r[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(e){r[3]=e}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Hf)return;s="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+uf(t(s))+")"},set:function(e){s=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(e){s=e}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(e){a=e}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/df:c},set:function(e){c=e}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(e){d=e}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof Hf||this instanceof Gf))return Tf(u,this.objId,this.scope)},set:function(e){e=e.toString(),u=e}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof zf==0?Tf(h,this.objId,this.scope):h},set:function(e){e=e.toString(),h=this instanceof zf==0?"("===e.substr(0,1)?hf(e.substr(1,e.length-2)):hf(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof zf==1?hf(h.substr(1,h.length-1)):h},set:function(e){e=e.toString(),h=this instanceof zf==1?"/"+e:e}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof zf==0?Tf(p,this.objId,this.scope):p},set:function(e){e=e.toString(),p=this instanceof zf==0?"("===e.substr(0,1)?hf(e.substr(1,e.length-2)):hf(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof zf==1?hf(p.substr(1,p.length-1)):p},set:function(e){e=e.toString(),p=this instanceof zf==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,f=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return f},set:function(e){e=Boolean(e),f=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(e){m=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,1):this.Ff=Sf(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,2):this.Ff=Sf(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,3):this.Ff=Sf(this.Ff,3)}});var g=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==g)return g},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');g=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(g){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:g=2;break;case"center":case 1:g=1;break;default:g=0}}})};ff(If,Pf);var Ff=function(){If.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return kf(t,this.objId,this.scope)},set:function(e){var n,r;r=[],"string"==typeof(n=e)&&(r=function(e,t,n){n||(n=1);for(var r,i=[];r=t.exec(e);)i.push(r[n]);return i}(n,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==n););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,18):this.Ff=Sf(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=_f(this.Ff,19):this.Ff=Sf(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=_f(this.Ff,20),t.sort()):this.Ff=Sf(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,22):this.Ff=Sf(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,23):this.Ff=Sf(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,27):this.Ff=Sf(this.Ff,27)}}),this.hasAppearanceStream=!1};ff(Ff,If);var Of=function(){Ff.call(this),this.fontName="helvetica",this.combo=!1};ff(Of,Ff);var Df=function(){Of.call(this),this.combo=!0};ff(Df,Of);var Uf=function(){Df.call(this),this.edit=!0};ff(Uf,Df);var zf=function(){If.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,15):this.Ff=Sf(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,16):this.Ff=Sf(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,17):this.Ff=Sf(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,26):this.Ff=Sf(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var n,r=[];for(n in r.push("<<"),t)r.push("/"+n+" ("+uf(e(t[n]))+")");return r.push(">>"),r.join("\n")}},set:function(e){"object"===(0,xc.A)(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};ff(zf,If);var Bf=function(){zf.call(this),this.pushButton=!0};ff(Bf,zf);var Vf=function(){zf.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};ff(Vf,zf);var Hf=function(){var e,t;If.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,n=[];for(t in n.push("<<"),r)n.push("/"+t+" ("+uf(e(r[t]))+")");return n.push(">>"),n.join("\n")},set:function(e){"object"===(0,xc.A)(e)&&(r=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){"string"==typeof e&&(r.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(e){n="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Xf.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ff(Hf,If),Vf.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},Vf.prototype.createOption=function(e){var t=new Hf;return t.Parent=this,t.optionName=e,this.Kids.push(t),Yf.call(this.scope,t),t};var Wf=function(){zf.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Xf.CheckBox.createAppearanceStream()};ff(Wf,zf);var Gf=function(){If.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,13):this.Ff=Sf(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,21):this.Ff=Sf(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,23):this.Ff=Sf(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,24):this.Ff=Sf(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,25):this.Ff=Sf(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,26):this.Ff=Sf(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ff(Gf,If);var qf=function(){Gf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(wf(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=_f(this.Ff,14):this.Ff=Sf(this.Ff,14)}}),this.password=!0};ff(qf,Gf);var Xf={CheckBox:{createAppearanceStream:function(){return{N:{On:Xf.CheckBox.YesNormal},D:{On:Xf.CheckBox.YesPushDown,Off:Xf.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=xf(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=Af(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+pf(Xf.internal.getWidth(e))+" "+pf(Xf.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+pf(s.fontSize)+" Tf "+i),n.push("BT"),n.push(s.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join("\n"),t},YesNormal:function(e){var t=xf(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),i=[],s=Xf.internal.getHeight(e),a=Xf.internal.getWidth(e),o=Af(e,e.caption);return i.push("1 g"),i.push("0 0 "+pf(a)+" "+pf(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+pf(a-1)+" "+pf(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+n+" "+pf(o.fontSize)+" Tf "+r),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join("\n"),t},OffPushDown:function(e){var t=xf(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+pf(Xf.internal.getWidth(e))+" "+pf(Xf.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Xf.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Xf.RadioButton.Circle.YesNormal,t.D[e]=Xf.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=xf(e);t.scope=e.scope;var n=[],r=Xf.internal.getWidth(e)<=Xf.internal.getHeight(e)?Xf.internal.getWidth(e)/4:Xf.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Xf.internal.Bezier_C,s=Number((r*i).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+mf(Xf.internal.getWidth(e)/2)+" "+mf(Xf.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),n.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),n.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),n.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=xf(e);t.scope=e.scope;var n=[],r=Xf.internal.getWidth(e)<=Xf.internal.getHeight(e)?Xf.internal.getWidth(e)/4:Xf.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Xf.internal.Bezier_C).toFixed(5)),a=Number((r*Xf.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+mf(Xf.internal.getWidth(e)/2)+" "+mf(Xf.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+mf(Xf.internal.getWidth(e)/2)+" "+mf(Xf.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),n.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),n.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),n.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=xf(e);t.scope=e.scope;var n=[],r=Xf.internal.getWidth(e)<=Xf.internal.getHeight(e)?Xf.internal.getWidth(e)/4:Xf.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var i=Number((2*r).toFixed(5)),s=Number((i*Xf.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+mf(Xf.internal.getWidth(e)/2)+" "+mf(Xf.internal.getHeight(e)/2)+" cm"),n.push(i+" 0 m"),n.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),n.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),n.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),n.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Xf.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Xf.RadioButton.Cross.YesNormal,t.D[e]=Xf.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=xf(e);t.scope=e.scope;var n=[],r=Xf.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+pf(Xf.internal.getWidth(e)-2)+" "+pf(Xf.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(pf(r.x1.x)+" "+pf(r.x1.y)+" m"),n.push(pf(r.x2.x)+" "+pf(r.x2.y)+" l"),n.push(pf(r.x4.x)+" "+pf(r.x4.y)+" m"),n.push(pf(r.x3.x)+" "+pf(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join("\n"),t},YesPushDown:function(e){var t=xf(e);t.scope=e.scope;var n=Xf.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+pf(Xf.internal.getWidth(e))+" "+pf(Xf.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+pf(Xf.internal.getWidth(e)-2)+" "+pf(Xf.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(pf(n.x1.x)+" "+pf(n.x1.y)+" m"),r.push(pf(n.x2.x)+" "+pf(n.x2.y)+" l"),r.push(pf(n.x4.x)+" "+pf(n.x4.y)+" m"),r.push(pf(n.x3.x)+" "+pf(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=xf(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+pf(Xf.internal.getWidth(e))+" "+pf(Xf.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};Xf.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Xf.internal.getWidth(e),n=Xf.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},Xf.internal.getWidth=function(e){var t=0;return"object"===(0,xc.A)(e)&&(t=gf(e.Rect[2])),t},Xf.internal.getHeight=function(e){var t=0;return"object"===(0,xc.A)(e)&&(t=gf(e.Rect[3])),t};var Yf=cf.addField=function(e){if(function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(If.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Ef)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");df=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Rf,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),e.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];r.objId=void 0,r.hasAnnotation&&Cf(r,e)}}(e)}),e.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)}),e.internal.events.subscribe("postPutPages",function(t){!function(e,t){var n=!e;for(var r in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(r)){var i=e[r],s=[],a=i.Rect;if(i.Rect&&(i.Rect=Nf(i.Rect,t)),t.internal.newObjectDeferredBegin(i.objId,!0),i.DA=Xf.createDefaultAppearanceStream(i),"object"===(0,xc.A)(i)&&"function"==typeof i.getKeyValueListForStream&&(s=i.getKeyValueListForStream()),i.Rect=a,i.hasAppearanceStream&&!i.appearanceStreamContent){var o=jf(i);s.push({key:"AP",value:"<</N "+o+">>"}),t.internal.acroformPlugin.xForms.push(o)}if(i.appearanceStreamContent){var l="";for(var c in i.appearanceStreamContent)if(i.appearanceStreamContent.hasOwnProperty(c)){var d=i.appearanceStreamContent[c];if(l+="/"+c+" ",l+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var r in d)if(d.hasOwnProperty(r)){var u=d[r];"function"==typeof u&&(u=u.call(t,i)),l+="/"+r+" "+u+" ",t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u)}}else"function"==typeof(u=d)&&(u=u.call(t,i)),l+="/"+r+" "+u,t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u);l+=">>"}s.push({key:"AP",value:"<<\n"+l+">>"})}t.internal.putStream({additionalKeyValues:s,objectId:i.objId}),t.internal.out("endobj")}n&&function(e,t){for(var n in e)if(e.hasOwnProperty(n)){var r=n,i=e[n];t.internal.newObjectDeferredBegin(i.objId,!0),"object"===(0,xc.A)(i)&&"function"==typeof i.putStream&&i.putStream(),delete e[r]}}(t.internal.acroformPlugin.xForms,t)}(t,e)}),e.internal.acroformPlugin.isInitialized=!0}}(this,e),!(e instanceof If))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};cf.AcroFormChoiceField=Ff,cf.AcroFormListBox=Of,cf.AcroFormComboBox=Df,cf.AcroFormEditBox=Uf,cf.AcroFormButton=zf,cf.AcroFormPushButton=Bf,cf.AcroFormRadioButton=Vf,cf.AcroFormCheckBox=Wf,cf.AcroFormTextField=Gf,cf.AcroFormPasswordField=qf,cf.AcroFormAppearance=Xf,cf.AcroForm={ChoiceField:Ff,ListBox:Of,ComboBox:Df,EditBox:Uf,Button:zf,PushButton:Bf,RadioButton:Vf,CheckBox:Wf,TextField:Gf,PasswordField:qf,Appearance:Xf},lf.AcroForm={ChoiceField:Ff,ListBox:Of,ComboBox:Df,EditBox:Uf,Button:zf,PushButton:Bf,RadioButton:Vf,CheckBox:Wf,TextField:Gf,PasswordField:qf,Appearance:Xf};lf.AcroForm;function Zf(e){return e.reduce(function(e,t,n){return e[t]=n,e},{})}!function(e){var t="addImage_";e.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(e,t){var i,s,a,o,l,c=n;if("RGBA"===(t=t||n)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(_(e))for(l in r)for(a=r[l],i=0;i<a.length;i+=1){for(o=!0,s=0;s<a[i].length;s+=1)if(void 0!==a[i][s]&&a[i][s]!==e[s]){o=!1;break}if(!0===o){c=l;break}}else for(l in r)for(a=r[l],i=0;i<a.length;i+=1){for(o=!0,s=0;s<a[i].length;s+=1)if(void 0!==a[i][s]&&a[i][s]!==e.charCodeAt(s)){o=!1;break}if(!0===o){c=l;break}}return c===n&&t!==n&&(c=t),c},s=function e(t){for(var n=this.internal.write,r=this.internal.putStream,i=(0,this.internal.getFilters)();-1!==i.indexOf("FlateEncode");)i.splice(i.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var s=[];if(s.push({key:"Type",value:"/XObject"}),s.push({key:"Subtype",value:"/Image"}),s.push({key:"Width",value:t.width}),s.push({key:"Height",value:t.height}),t.colorSpace===x.INDEXED?s.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(s.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===x.DEVICE_CMYK&&s.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),s.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&s.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)&&t.transparency.length>0){for(var a="",o=0,l=t.transparency.length;o<l;o++)a+=t.transparency[o]+" "+t.transparency[o]+" ";s.push({key:"Mask",value:"["+a+"]"})}void 0!==t.sMask&&s.push({key:"SMask",value:t.objectId+1+" 0 R"});var c=void 0!==t.filter?["/"+t.filter]:void 0;if(r({data:t.data,additionalKeyValues:s,alreadyAppliedFilters:c,objectId:t.objectId}),n("endobj"),"sMask"in t&&void 0!==t.sMask){var d,u=null!==(d=t.sMaskBitsPerComponent)&&void 0!==d?d:t.bitsPerComponent,h={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:u,data:t.sMask};"filter"in t&&(h.decodeParameters="/Predictor ".concat(t.predictor," /Colors 1 /BitsPerComponent ").concat(u," /Columns ").concat(t.width),h.filter=t.filter),e.call(this,h)}if(t.colorSpace===x.INDEXED){var p=this.internal.newObject();r({data:N(new Uint8Array(t.palette)),objectId:p}),n("endobj")}},a=function(){var e=this.internal.collections[t+"images"];for(var n in e)s.call(this,e[n])},o=function(){var e,n=this.internal.collections[t+"images"],r=this.internal.write;for(var i in n)r("/I"+(e=n[i]).index,e.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var e=this.internal.collections[t+"images"];return l.call(this),e},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},u=function(t){return"function"==typeof e["process"+t.toUpperCase()]},h=function(e){return"object"===(0,xc.A)(e)&&1===e.nodeType},p=function(t,n){if("IMG"===t.nodeName&&t.hasAttribute("src")){var r=""+t.getAttribute("src");if(0===r.indexOf("data:image/"))return Fm(unescape(r).split("base64,").pop());var i=e.loadFile(r,!0);if(void 0!==i)return i}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var s;switch(n){case"PNG":s="image/png";break;case"WEBP":s="image/webp";break;default:s="image/jpeg"}return Fm(t.toDataURL(s,1).split("base64,").pop())}},m=function(e){var n=this.internal.collections[t+"images"];if(n)for(var r in n)if(e===n[r].alias)return n[r]},f=function(e,t,n){return e||t||(e=-96,t=-96),e<0&&(e=-1*n.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*n.height*72/t/this.internal.scaleFactor),0===e&&(e=t*n.width/n.height),0===t&&(t=e*n.height/n.width),[e,t]},g=function(e,t,n,r,i,s){var a=f.call(this,n,r,i),o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,d=c.call(this);if(n=a[0],r=a[1],d[i.index]=i,s){s*=Math.PI/180;var u=Math.cos(s),h=Math.sin(s),p=function(e){return e.toFixed(4)},m=[p(u),p(h),p(-1*h),p(u),0,0,"cm"]}this.internal.write("q"),s?(this.internal.write([1,"0","0",1,o(e),l(t+r),"cm"].join(" ")),this.internal.write(m.join(" ")),this.internal.write([o(n),"0","0",o(r),"0","0","cm"].join(" "))):this.internal.write([o(n),"0","0",o(r),o(e),l(t+r),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+i.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=e.__addimage__.sHashCode=function(e){var t,n,r=0;if("string"==typeof e)for(n=e.length,t=0;t<n;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;else if(_(e))for(n=e.byteLength/2,t=0;t<n;t++)r=(r<<5)-r+e[t],r|=0;return r},b=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},w=e.__addimage__.extractImageFromDataUrl=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("data:"))return null;var t=e.indexOf(",");return t<0?null:e.substring(0,t).trim().endsWith("base64")?e.substring(t+1):null};e.__addimage__.isArrayBuffer=function(e){return e instanceof ArrayBuffer};var _=e.__addimage__.isArrayBufferView=function(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array},S=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n},N=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",n=_(e)?e:new Uint8Array(e),r=0;r<n.length;r+=8192)t+=String.fromCharCode.apply(null,n.subarray(r,r+8192));return t};e.addImage=function(){var e,t,r,i,s,a,o,c,d;if("number"==typeof arguments[1]?(t=n,r=arguments[1],i=arguments[2],s=arguments[3],a=arguments[4],o=arguments[5],c=arguments[6],d=arguments[7]):(t=arguments[1],r=arguments[2],i=arguments[3],s=arguments[4],a=arguments[5],o=arguments[6],c=arguments[7],d=arguments[8]),"object"===(0,xc.A)(e=arguments[0])&&!h(e)&&"imageData"in e){var u=e;e=u.imageData,t=u.format||t||n,r=u.x||r||0,i=u.y||i||0,s=u.w||u.width||s,a=u.h||u.height||a,o=u.alias||o,c=u.compression||c,d=u.rotation||u.angle||d}var p=this.internal.getFilters();if(void 0===c&&-1!==p.indexOf("FlateEncode")&&(c="SLOW"),isNaN(r)||isNaN(i))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var m=j.call(this,e,t,o,c);return g.call(this,r,i,s,a,m,d),this};var j=function(t,r,s,a){var o,l,c;if("string"==typeof t&&i(t)===n){t=unescape(t);var f=A(t,!1);(""!==f||void 0!==(f=e.loadFile(t,!0)))&&(t=f)}if(h(t)&&(t=p(t,r)),r=i(t,r),!u(r))throw new Error("addImage does not support files of type '"+r+"', please ensure that a plugin for '"+r+"' support is added.");if((null==(c=s)||0===c.length)&&(s=function(e){return"string"==typeof e||_(e)?y(e):_(e.data)?y(e.data):null}(t)),(o=m.call(this,s))||(t instanceof Uint8Array||"RGBA"===r||(l=t,t=S(t)),o=this["process"+r.toUpperCase()](t,d.call(this),s,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:v.NONE}(a),l)),!o)throw new Error("An unknown error occurred whilst processing the image.");return o},A=e.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var n,r="";if("string"==typeof e){var s;n=null!==(s=w(e))&&void 0!==s?s:e;try{r=Fm(n)}catch(i){if(t)throw b(n)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+i.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return r};e.getImageProperties=function(t){var r,s,a="";if(h(t)&&(t=p(t)),"string"==typeof t&&i(t)===n&&(""===(a=A(t,!1))&&(a=e.loadFile(t)||""),t=a),s=i(t),!u(s))throw new Error("addImage does not support files of type '"+s+"', please ensure that a plugin for '"+s+"' support is added.");if(t instanceof Uint8Array||(t=S(t)),!(r=this["process"+s.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return r.fileType=s,r}}(lf.API),function(e){var t=function(e){if(void 0!==e&&""!=e)return!0};lf.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var n,r,i,s=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,o=this.internal.getPageInfoByObjId(e.objId),l=e.pageContext.annotations,c=!1,d=0;d<l.length&&!c;d++)switch((n=l[d]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var u=0;u<l.length;u++){n=l[u];var h=this.internal.pdfEscape,p=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),f=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(m.objId),x=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(r="/Rect ["+s(n.bounds.x)+" "+a(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y)+"] ")+"/Contents ("+h(g(n.contents))+")",i+=" /Popup "+f.objId+" 0 R",i+=" /P "+o.objId+" 0 R",i+=" /T ("+h(g(x))+") >>",m.content=i;var v=m.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+s(n.bounds.x+30)+" "+a(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+a(n.bounds.y)+"] ")+" /Parent "+v,n.open&&(i+=" /Open true"),i+=" >>",f.content=i,this.internal.write(m.objId,"0 R",f.objId,"0 R");break;case"freetext":r="/Rect ["+s(n.bounds.x)+" "+a(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+a(n.bounds.y+n.bounds.h)+"] ";var y=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+h(p(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+y+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var b=this.annotations._nameMap[n.options.name];n.options.pageNumber=b.page,n.options.top=b.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+h(p(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var w=a(n.options.top);n.options.left=n.options.left||0,void 0===n.options.zoom&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+w+" "+n.options.zoom+"]"}""!=i&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,n,r,i){var s=this.internal.getCurrentPageInfo(),a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:a(e),y:o(t),w:a(e+n),h:o(t+r)},options:i,type:"link"})},e.textWithLink=function(e,t,n,r){var i,s,a=this.getTextWidth(e),o=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==r.maxWidth){s=r.maxWidth;var l=this.splitTextToSize(e,s).length;i=Math.ceil(o*l)}else s=a,i=o;return this.text(e,t,n,r),n+=.2*o,"center"===r.align&&(t-=a/2),"right"===r.align&&(t-=a),this.link(t,n-o,s,i,r),a},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(lf.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},a=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},o=e.__arabicParser__.isArabicEndLetter=function(e){return a(e)&&s(e)&&t[e.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(e){return a(e)&&i.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return a(e)&&s(e)&&t[e.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return a(e)&&s(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return a(e)&&s(e)&&t[e.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return a(e)&&s(e)&&4==t[e.charCodeAt(0)].length},u=e.__arabicParser__.resolveLigatures=function(e){var t=0,r=n,i="",s=0;for(t=0;t<e.length;t+=1)void 0!==r[e.charCodeAt(t)]?(s++,"number"==typeof(r=r[e.charCodeAt(t)])&&(i+=String.fromCharCode(r),r=n,s=0),t===e.length-1&&(r=n,i+=e.charAt(t-(s-1)),t-=s-1,s=0)):(r=n,i+=e.charAt(t-s),t-=s,s=0);return i};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==r[e.charCodeAt(0)]};var h=e.__arabicParser__.getCorrectForm=function(e,t,n){return a(e)?!1===s(e)?-1:!c(e)||!a(t)&&!a(n)||!a(n)&&o(t)||o(e)&&!a(t)||o(e)&&l(t)||o(e)&&o(t)?0:d(e)&&a(t)&&!o(t)&&a(n)&&c(n)?3:o(e)||!a(n)?1:2:-1},p=function(e){var n=0,r=0,i=0,s="",o="",l="",c=(e=e||"").split("\\s+"),d=[];for(n=0;n<c.length;n+=1){for(d.push(""),r=0;r<c[n].length;r+=1)s=c[n][r],o=c[n][r-1],l=c[n][r+1],a(s)?(i=h(s,o,l),d[n]+=-1!==i?String.fromCharCode(t[s.charCodeAt(0)][i]):s):d[n]+=s;d[n]=u(d[n])}return d.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,n=[];if(Array.isArray(t)){var r=0;for(n=[],r=0;r<t.length;r+=1)Array.isArray(t[r])?n.push([p(t[r][0]),t[r][1],t[r][2]]):n.push([p(t[r])]);e=n}else e=p(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",m])}(lf.API),lf.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform","javascript"===e.variant?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(e){n=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var r=[];Object.defineProperty(this,"childNodes",{get:function(){return r},set:function(e){r=e}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var n;if("2d"!==(e=e||"2d"))return null;for(n in t)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=t[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(lf.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var n=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var r=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var i=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return i},set:function(e){i=e}});var s=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return s},set:function(e){s=e}});var a=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return a},set:function(e){a=e}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return r.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){r.call(this);var n=(t=t||{}).fontSize||this.getFontSize(),i=t.font||this.getFont(),s=t.scaleFactor||this.internal.scaleFactor,a=0,o=0,l=0,c=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var d=t.maxWidth;d>0?"string"==typeof e?e=this.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(c.splitTextToSize(t,d))},[])):e=Array.isArray(e)?e:[e];for(var u=0;u<e.length;u++)a<(l=this.getStringUnitWidth(e[u],{font:i})*n)&&(a=l);return 0!==a&&(o=e.length),{w:a/=s,h:Math.max((o*n*this.getLineHeightFactor()-n*(this.getLineHeightFactor()-1))/s,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=e.cell=function(){var e;e=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var i=this.internal.__cell__.lastCell,a=this.internal.__cell__.padding,o=this.internal.__cell__.margins||t,l=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==i.lineNumber&&(i.lineNumber===e.lineNumber?(e.x=(i.x||0)+(i.width||0),e.y=i.y||0):i.y+i.height+e.height+o.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=o.top,c&&l&&(this.printHeaderRow(e.lineNumber,!0),e.y+=l[0].height)):e.y=i.y+i.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===n?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-a,e.y+a,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+a,{align:"center",baseline:"top",maxWidth:e.width-a-a}):this.text(e.text,e.x+a,e.y+a,{align:"left",baseline:"top",maxWidth:e.width-a-a})),this.internal.__cell__.lastCell=e,this};e.table=function(e,n,l,c,d){if(r.call(this),!l)throw new Error("No data for PDF table.");var u,h,p,m,f=[],g=[],x=[],v={},y={},b=[],w=[],_=(d=d||{}).autoSize||!1,S=!1!==d.printHeaders,N=d.css&&void 0!==d.css["font-size"]?16*d.css["font-size"]:d.fontSize||12,j=d.margins||Object.assign({width:this.getPageWidth()},t),A="number"==typeof d.padding?d.padding:3,M=d.headerBackgroundColor||"#c8c8c8",E=d.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=j,this.internal.__cell__.table_font_size=N,this.internal.__cell__.padding=A,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=E,this.setFontSize(N),null==c)g=f=Object.keys(l[0]),x=f.map(function(){return"left"});else if(Array.isArray(c)&&"object"===(0,xc.A)(c[0]))for(f=c.map(function(e){return e.name}),g=c.map(function(e){return e.prompt||e.name||""}),x=c.map(function(e){return e.align||"left"}),u=0;u<c.length;u+=1)y[c[u].name]=.7499990551181103*c[u].width;else Array.isArray(c)&&"string"==typeof c[0]&&(g=f=c,x=f.map(function(){return"left"}));if(_||Array.isArray(c)&&"string"==typeof c[0])for(u=0;u<f.length;u+=1){for(v[m=f[u]]=l.map(function(e){return e[m]}),this.setFont(void 0,"bold"),b.push(this.getTextDimensions(g[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),h=v[m],this.setFont(void 0,"normal"),p=0;p<h.length;p+=1)b.push(this.getTextDimensions(h[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);y[m]=Math.max.apply(null,b)+A+A,b=[]}if(S){var C={};for(u=0;u<f.length;u+=1)C[f[u]]={},C[f[u]].text=g[u],C[f[u]].align=x[u];var k=o.call(this,C,y);w=f.map(function(t){return new s(e,n,y[t],k,C[t].text,void 0,C[t].align)}),this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}var T=c.reduce(function(e,t){return e[t.name]=t.align,e},{});for(u=0;u<l.length;u+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:u,data:l[u]},this);var P=o.call(this,l[u],y);for(p=0;p<f.length;p+=1){var L=l[u][f[p]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:u,col:p,data:L},this),a.call(this,new s(e,n,y[f[p]],P,L,u+2,T[f[p]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=n,this};var o=function(e,t){var n=this.internal.__cell__.padding,r=this.internal.__cell__.table_font_size,i=this.internal.scaleFactor;return Object.keys(e).map(function(r){var i=e[r];return this.splitTextToSize(i.hasOwnProperty("text")?i.text:i,t[r]-n-n)},this).map(function(e){return this.getLineHeightFactor()*e.length*r/i+n+n},this).reduce(function(e,t){return Math.max(e,t)},0)};e.setTableHeaderRow=function(e){r.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var i;if(n=!0,"function"==typeof this.internal.__cell__.headerFunction){var o=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(o[0],o[1],o[2],o[3],void 0,-1)}this.setFont(void 0,"bold");for(var l=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){i=this.internal.__cell__.tableHeaderRow[c].clone(),t&&(i.y=this.internal.__cell__.margins.top||0,l.push(i)),i.lineNumber=e;var d=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,i),this.setTextColor(d)}l.length>0&&this.setTableHeaderRow(l),this.setFont(void 0,"normal"),n=!1}}(lf.API);var Jf={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Kf=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Qf=Zf(Kf),$f=[100,200,300,400,500,600,700,800,900],eg=Zf($f);function tg(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(e){return Jf[e=e||"normal"]?e:"normal"}(e.style),r=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),i=function(e){return"number"==typeof Qf[e=e||"normal"]?e:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,n,r].join(" ")}}}function ng(e,t,n,r){var i;for(i=n;i>=0&&i<t.length;i+=r)if(e[t[i]])return e[t[i]];for(i=n;i>=0&&i<t.length;i-=r)if(e[t[i]])return e[t[i]]}var rg={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},ig={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function sg(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function ag(e){return e.trimLeft()}function og(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function lg(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var cg,dg,ug,hg,pg,mg,fg,gg,xg,vg=["times"];function yg(e,t,n,r,i){var s=4,a=_g;switch(i){case lf.API.image_compression.FAST:s=1,a=wg;break;case lf.API.image_compression.MEDIUM:s=6,a=Sg;break;case lf.API.image_compression.SLOW:s=9,a=Ng}e=function(e,t,n,r){for(var i,s=e.length/t,a=new Uint8Array(e.length+s),o=[bg,wg,_g,Sg,Ng],l=0;l<s;l+=1){var c=l*t,d=e.subarray(c,c+t);if(r)a.set(r(d,n,i),c+l);else{for(var u=o.length,h=[],p=0;p<u;p+=1)h[p]=o[p](d,n,i);var m=Ag(h.concat());a.set(h[m],c+l)}i=d}return a}(e,t,Math.ceil(n*r/8),a);var o=td(e,{level:s});return lf.API.__addimage__.arrayBufferToBinaryString(o)}function bg(e){var t=Array.apply([],e);return t.unshift(0),t}function wg(e,t){var n=e.length,r=[];r[0]=1;for(var i=0;i<n;i+=1){var s=e[i-t]||0;r[i+1]=e[i]-s+256&255}return r}function _g(e,t,n){var r=e.length,i=[];i[0]=2;for(var s=0;s<r;s+=1){var a=n&&n[s]||0;i[s+1]=e[s]-a+256&255}return i}function Sg(e,t,n){var r=e.length,i=[];i[0]=3;for(var s=0;s<r;s+=1){var a=e[s-t]||0,o=n&&n[s]||0;i[s+1]=e[s]+256-(a+o>>>1)&255}return i}function Ng(e,t,n){var r=e.length,i=[];i[0]=4;for(var s=0;s<r;s+=1){var a=jg(e[s-t]||0,n&&n[s]||0,n&&n[s-t]||0);i[s+1]=e[s]-a+256&255}return i}function jg(e,t,n){if(e===t&&t===n)return e;var r=Math.abs(t-n),i=Math.abs(e-n),s=Math.abs(e+t-n-n);return r<=i&&r<=s?e:i<=s?t:n}function Ag(e){var t=e.map(function(e){return e.reduce(function(e,t){return e+Math.abs(t)},0)});return t.indexOf(Math.min.apply(null,t))}function Mg(e,t,n){var r=t*n,i=Math.floor(r/8),s=16-(r-8*i+n),a=(1<<n)-1;return Cg(e,i)>>s&a}function Eg(e,t,n,r){var i=n*r,s=Math.floor(i/8),a=16-(i-8*s+r),o=(1<<r)-1,l=(t&o)<<a;!function(e,t,n){if(t+1<e.byteLength)e.setUint16(t,n,!1);else{var r=n>>8&255;e.setUint8(t,r)}}(e,s,Cg(e,s)&~(o<<a)&65535|l)}function Cg(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function kg(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,a=1<<1+(7&i);e[t++],e[t++];var o=null,l=null;s&&(o=t,l=a,t+=3*a);var c=!0,d=[],u=0,h=null,p=0,m=null;for(this.width=n,this.height=r;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((M=e[t++])>=0))throw Error("Invalid block size");if(0===M)break;t+=M}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var f=e[t++];u=e[t++]|e[t++]<<8,h=e[t++],1&f||(h=null),p=f>>2&7,t++;break;case 254:for(;;){if(!((M=e[t++])>=0))throw Error("Invalid block size");if(0===M)break;t+=M}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,b=e[t++],w=b>>6&1,_=1<<1+(7&b),S=o,N=l,j=!1;b>>7&&(j=!0,S=t,N=_,t+=3*_);var A=t;for(t++;;){var M;if(!((M=e[t++])>=0))throw Error("Invalid block size");if(0===M)break;t+=M}d.push({x:g,y:x,width:v,height:y,has_local_palette:j,palette_offset:S,palette_size:N,data_offset:A,data_length:t-A,transparent_index:h,interlaced:!!w,delay:u,disposal:p});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(e){if(e<0||e>=d.length)throw new Error("Frame index out of range.");return d[e]},this.decodeAndBlitFrameBGRA=function(t,r){var i=this.frameInfo(t),s=i.width*i.height,a=new Uint8Array(s);Tg(e,i.data_offset,a,s);var o=i.palette_offset,l=i.transparent_index;null===l&&(l=256);var c=i.width,d=n-c,u=c,h=4*(i.y*n+i.x),p=4*((i.y+i.height)*n+i.x),m=h,f=4*d;!0===i.interlaced&&(f+=4*n*7);for(var g=8,x=0,v=a.length;x<v;++x){var y=a[x];if(0===u&&(u=c,(m+=f)>=p&&(f=4*d+4*n*(g-1),m=h+(c+d)*(g<<1),g>>=1)),y===l)m+=4;else{var b=e[o+3*y],w=e[o+3*y+1],_=e[o+3*y+2];r[m++]=_,r[m++]=w,r[m++]=b,r[m++]=255}--u}},this.decodeAndBlitFrameRGBA=function(t,r){var i=this.frameInfo(t),s=i.width*i.height,a=new Uint8Array(s);Tg(e,i.data_offset,a,s);var o=i.palette_offset,l=i.transparent_index;null===l&&(l=256);var c=i.width,d=n-c,u=c,h=4*(i.y*n+i.x),p=4*((i.y+i.height)*n+i.x),m=h,f=4*d;!0===i.interlaced&&(f+=4*n*7);for(var g=8,x=0,v=a.length;x<v;++x){var y=a[x];if(0===u&&(u=c,(m+=f)>=p&&(f=4*d+4*n*(g-1),m=h+(c+d)*(g<<1),g>>=1)),y===l)m+=4;else{var b=e[o+3*y],w=e[o+3*y+1],_=e[o+3*y+2];r[m++]=b,r[m++]=w,r[m++]=_,r[m++]=255}--u}}}function Tg(e,t,n,r){for(var i=e[t++],s=1<<i,a=s+1,o=a+1,l=i+1,c=(1<<l)-1,d=0,u=0,h=0,p=e[t++],m=new Int32Array(4096),f=null;;){for(;d<16&&0!==p;)u|=e[t++]<<d,d+=8,1===p?p=e[t++]:--p;if(d<l)break;var g=u&c;if(u>>=l,d-=l,g!==s){if(g===a)break;for(var x=g<o?g:f,v=0,y=x;y>s;)y=m[y]>>8,++v;var b=y;if(h+v+(x!==g?1:0)>r)return void km.log("Warning, gif stream longer than expected.");n[h++]=b;var w=h+=v;for(x!==g&&(n[h++]=b),y=x;v--;)y=m[y],n[--w]=255&y,y>>=8;null!==f&&o<4096&&(m[o++]=f<<8|b,o>=c+1&&l<12&&(++l,c=c<<1|1)),f=g}else o=a+1,c=(1<<(l=i+1))-1,f=null}return h!==r&&km.log("Warning, gif stream shorter than expected."),n}function Pg(e){var t,n,r,i,s,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(65535),h=new Array(65535),p=new Array(64),m=new Array(64),f=[],g=0,x=7,v=new Array(64),y=new Array(64),b=new Array(64),w=new Array(256),_=new Array(2048),S=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],N=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],M=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],E=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],k=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],T=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function P(e,t){for(var n=0,r=0,i=new Array,s=1;s<=16;s++){for(var a=1;a<=e[s];a++)i[t[r]]=[],i[t[r]][0]=n,i[t[r]][1]=s,r++,n++;n*=2}return i}function L(e){for(var t=e[0],n=e[1]-1;n>=0;)t&1<<n&&(g|=1<<x),n--,--x<0&&(255==g?(R(255),R(0)):R(g),x=7,g=0)}function R(e){f.push(e)}function I(e){R(e>>8&255),R(255&e)}function F(e,t,n,r,i){for(var s,a=i[0],o=i[240],l=function(e,t){var n,r,i,s,a,o,l,c,d,u,h=0;for(d=0;d<8;++d){n=e[h],r=e[h+1],i=e[h+2],s=e[h+3],a=e[h+4],o=e[h+5],l=e[h+6];var m=n+(c=e[h+7]),f=n-c,g=r+l,x=r-l,v=i+o,y=i-o,b=s+a,w=s-a,_=m+b,S=m-b,N=g+v,j=g-v;e[h]=_+N,e[h+4]=_-N;var A=.707106781*(j+S);e[h+2]=S+A,e[h+6]=S-A;var M=.382683433*((_=w+y)-(j=x+f)),E=.5411961*_+M,C=1.306562965*j+M,k=.707106781*(N=y+x),T=f+k,P=f-k;e[h+5]=P+E,e[h+3]=P-E,e[h+1]=T+C,e[h+7]=T-C,h+=8}for(h=0,d=0;d<8;++d){n=e[h],r=e[h+8],i=e[h+16],s=e[h+24],a=e[h+32],o=e[h+40],l=e[h+48];var L=n+(c=e[h+56]),R=n-c,I=r+l,F=r-l,O=i+o,D=i-o,U=s+a,z=s-a,B=L+U,V=L-U,H=I+O,W=I-O;e[h]=B+H,e[h+32]=B-H;var G=.707106781*(W+V);e[h+16]=V+G,e[h+48]=V-G;var q=.382683433*((B=z+D)-(W=F+R)),X=.5411961*B+q,Y=1.306562965*W+q,Z=.707106781*(H=D+F),J=R+Z,K=R-Z;e[h+40]=K+X,e[h+24]=K-X,e[h+8]=J+Y,e[h+56]=J-Y,h++}for(d=0;d<64;++d)u=e[d]*t[d],p[d]=u>0?u+.5|0:u-.5|0;return p}(e,t),c=0;c<64;++c)m[S[c]]=l[c];var d=m[0]-n;n=m[0],0==d?L(r[0]):(L(r[h[s=32767+d]]),L(u[s]));for(var f=63;f>0&&0==m[f];)f--;if(0==f)return L(a),n;for(var g,x=1;x<=f;){for(var v=x;0==m[x]&&x<=f;)++x;var y=x-v;if(y>=16){g=y>>4;for(var b=1;b<=g;++b)L(o);y&=15}s=32767+m[x],L(i[(y<<4)+h[s]]),L(u[s]),x++}return 63!=f&&L(a),n}function O(e){e=Math.min(Math.max(e,1),100),s!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=a((t[n]*e+50)/100);r=Math.min(Math.max(r,1),255),o[S[n]]=r}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var u=a((i[s]*e+50)/100);u=Math.min(Math.max(u,1),255),l[S[s]]=u}for(var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0,m=0;m<8;m++)for(var f=0;f<8;f++)c[p]=1/(o[S[p]]*h[m]*h[f]*8),d[p]=1/(l[S[p]]*h[m]*h[f]*8),p++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),s=e)}this.encode=function(e,s){s&&O(s),f=new Array,g=0,x=7,I(65496),I(65504),I(16),R(74),R(70),R(73),R(70),R(0),R(1),R(1),R(0),I(1),I(1),R(0),R(0),function(){I(65499),I(132),R(0);for(var e=0;e<64;e++)R(o[e]);R(1);for(var t=0;t<64;t++)R(l[t])}(),function(e,t){I(65472),I(17),R(8),I(t),I(e),R(3),R(1),R(17),R(0),R(2),R(17),R(1),R(3),R(17),R(1)}(e.width,e.height),function(){I(65476),I(418),R(0);for(var e=0;e<16;e++)R(N[e+1]);for(var t=0;t<=11;t++)R(j[t]);R(16);for(var n=0;n<16;n++)R(A[n+1]);for(var r=0;r<=161;r++)R(M[r]);R(1);for(var i=0;i<16;i++)R(E[i+1]);for(var s=0;s<=11;s++)R(C[s]);R(17);for(var a=0;a<16;a++)R(k[a+1]);for(var o=0;o<=161;o++)R(T[o])}(),I(65498),I(12),R(3),R(1),R(0),R(2),R(17),R(3),R(17),R(0),R(63),R(0);var a=0,u=0,h=0;g=0,x=7,this.encode.displayName="_encode_";for(var p,m,w,S,P,D,U,z,B,V=e.data,H=e.width,W=e.height,G=4*H,q=0;q<W;){for(p=0;p<G;){for(P=G*q+p,U=-1,z=0,B=0;B<64;B++)D=P+(z=B>>3)*G+(U=4*(7&B)),q+z>=W&&(D-=G*(q+1+z-W)),p+U>=G&&(D-=p+U-G+4),m=V[D++],w=V[D++],S=V[D++],v[B]=(_[m]+_[w+256|0]+_[S+512|0]>>16)-128,y[B]=(_[m+768|0]+_[w+1024|0]+_[S+1280|0]>>16)-128,b[B]=(_[m+1280|0]+_[w+1536|0]+_[S+1792|0]>>16)-128;a=F(v,c,a,t,r),u=F(y,d,u,n,i),h=F(b,d,h,n,i),p+=32}q+=8}if(x>=0){var X=[];X[1]=x+1,X[0]=(1<<x+1)-1,L(X)}return I(65497),new Uint8Array(f)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)w[t]=e(t)}(),t=P(N,j),n=P(E,C),r=P(A,M),i=P(k,T),function(){for(var e=1,t=2,n=1;n<=15;n++){for(var r=e;r<t;r++)h[32767+r]=n,u[32767+r]=[],u[32767+r][1]=n,u[32767+r][0]=r;for(var i=-(t-1);i<=-e;i++)h[32767+i]=n,u[32767+i]=[],u[32767+i][1]=n,u[32767+i][0]=t-1+i;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)_[e]=19595*e,_[e+256|0]=38470*e,_[e+512|0]=7471*e+32768,_[e+768|0]=-11059*e,_[e+1024|0]=-21709*e,_[e+1280|0]=32768*e+8421375,_[e+1536|0]=-27439*e,_[e+1792|0]=-5329*e}(),O(e)}function Lg(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Rg(e){function t(e){if(!e)throw Error("assert :P")}function n(e,t,n){for(var r=0;4>r;r++)if(e[t+r]!=n.charCodeAt(r))return!0;return!1}function r(e,t,n,r,i){for(var s=0;s<i;s++)e[t+s]=n[r+s]}function i(e,t,n,r){for(var i=0;i<r;i++)e[t+i]=n}function s(e){return new Int32Array(e)}function a(e,t){for(var n=[],r=0;r<e;r++)n.push(new t);return n}function o(e,t){var n=[];return function e(n,r,i){for(var s=i[r],a=0;a<s&&(n.push(i.length>r+1?[]:new t),!(i.length<r+1));a++)e(n[a],r+1,i)}(n,0,e),n}var l=function(){var e=this;function l(e,t){for(var n=1<<t-1>>>0;e&n;)n>>>=1;return n?(e&n-1)+n:e}function c(e,n,r,i,s){t(!(i%r));do{e[n+(i-=r)]=s}while(0<i)}function d(e,n,r,i,a){if(t(2328>=a),512>=a)var o=s(512);else if(null==(o=s(a)))return 0;return function(e,n,r,i,a,o){var d,h,p=n,m=1<<r,f=s(16),g=s(16);for(t(0!=a),t(null!=i),t(null!=e),t(0<r),h=0;h<a;++h){if(15<i[h])return 0;++f[i[h]]}if(f[0]==a)return 0;for(g[1]=0,d=1;15>d;++d){if(f[d]>1<<d)return 0;g[d+1]=g[d]+f[d]}for(h=0;h<a;++h)d=i[h],0<i[h]&&(o[g[d]++]=h);if(1==g[15])return(i=new u).g=0,i.value=o[0],c(e,p,1,m,i),m;var x,v=-1,y=m-1,b=0,w=1,_=1,S=1<<r;for(h=0,d=1,a=2;d<=r;++d,a<<=1){if(w+=_<<=1,0>(_-=f[d]))return 0;for(;0<f[d];--f[d])(i=new u).g=d,i.value=o[h++],c(e,p+b,a,S,i),b=l(b,d)}for(d=r+1,a=2;15>=d;++d,a<<=1){if(w+=_<<=1,0>(_-=f[d]))return 0;for(;0<f[d];--f[d]){if(i=new u,(b&y)!=v){for(p+=S,x=1<<(v=d)-r;15>v&&!(0>=(x-=f[v]));)++v,x<<=1;m+=S=1<<(x=v-r),e[n+(v=b&y)].g=x+r,e[n+v].value=p-n-v}i.g=d-r,i.value=o[h++],c(e,p+(b>>r),a,S,i),b=l(b,d)}}return w!=2*g[15]-1?0:m}(e,n,r,i,a,o)}function u(){this.value=this.g=0}function h(){this.value=this.g=0}function p(){this.G=a(5,u),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(Dn,h)}function m(e,n,r,i){t(null!=e),t(null!=n),t(2147483648>i),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=n,e.pa=r,e.Jd=n,e.Yc=r+i,e.Zc=4<=i?r+i-4+1:r,A(e)}function f(e,t){for(var n=0;0<t--;)n|=E(e,128)<<t;return n}function g(e,t){var n=f(e,t);return M(e)?-n:n}function x(e,n,r,i){var s,a=0;for(t(null!=e),t(null!=n),t(4294967288>i),e.Sb=i,e.Ra=0,e.u=0,e.h=0,4<i&&(i=4),s=0;s<i;++s)a+=n[r+s]<<8*s;e.Ra=a,e.bb=i,e.oa=n,e.pa=r}function v(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<Bn-8>>>0,++e.bb,e.u-=8;S(e)&&(e.h=1,e.u=0)}function y(e,n){if(t(0<=n),!e.h&&n<=zn){var r=_(e)&Un[n];return e.u+=n,v(e),r}return e.h=1,e.u=0}function b(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function w(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function _(e){return e.Ra>>>(e.u&Bn-1)>>>0}function S(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>Bn}function N(e,t){e.u=t,e.h=S(e)}function j(e){e.u>=Vn&&(t(e.u>=Vn),v(e))}function A(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function M(e){return f(e,1)}function E(e,t){var n=e.Ca;0>e.b&&A(e);var r=e.b,i=n*t>>>8,s=(e.I>>>r>i)+0;for(s?(n-=i,e.I-=i+1<<r>>>0):n=i+1,r=n,i=0;256<=r;)i+=8,r>>=8;return r=7^i+Hn[r],e.b-=r,e.Ca=(n<<r)-1,s}function C(e,t,n){e[t+0]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function k(e,t){return e[t+0]|e[t+1]<<8}function T(e,t){return k(e,t)|e[t+2]<<16}function P(e,t){return k(e,t)|k(e,t+2)<<16}function L(e,n){var r=1<<n;return t(null!=e),t(0<n),e.X=s(r),null==e.X?0:(e.Mb=32-n,e.Xa=n,1)}function R(e,n){t(null!=e),t(null!=n),t(e.Xa==n.Xa),r(n.X,0,e.X,0,1<<n.Xa)}function I(){this.X=[],this.Xa=this.Mb=0}function F(e,n,r,i){t(null!=r),t(null!=i);var s=r[0],a=i[0];return 0==s&&(s=(e*a+n/2)/n),0==a&&(a=(n*s+e/2)/e),0>=s||0>=a?0:(r[0]=s,i[0]=a,1)}function O(e,t){return e+(1<<t)-1>>>t}function D(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function U(t,n){e[n]=function(n,r,i,s,a,o,l){var c;for(c=0;c<a;++c){var d=e[t](o[l+c-1],i,s+c);o[l+c]=D(n[r+c],d)}}}function z(){this.ud=this.hd=this.jd=0}function B(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function V(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function H(e,t){return V(e+(e-t+.5>>1))}function W(e,t,n){return Math.abs(t-n)-Math.abs(e-n)}function G(e,t,n,r,i,s,a){for(r=s[a-1],n=0;n<i;++n)s[a+n]=r=D(e[t+n],r)}function q(e,t,n,r,i){var s;for(s=0;s<n;++s){var a=e[t+s],o=a>>8&255,l=16711935&(l=(l=16711935&a)+((o<<16)+o));r[i+s]=(4278255360&a)+l>>>0}}function X(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function Y(e,t,n,r,i,s){var a;for(a=0;a<r;++a){var o=t[n+a],l=o>>>8,c=o,d=255&(d=(d=o>>>16)+((e.jd<<24>>24)*(l<<24>>24)>>>5));c=255&(c=(c+=(e.hd<<24>>24)*(l<<24>>24)>>>5)+((e.ud<<24>>24)*(d<<24>>24)>>>5)),i[s+a]=(4278255360&o)+(d<<16)+c}}function Z(t,n,r,i,s){e[n]=function(e,t,n,r,a,o,l,c,d){for(r=l;r<c;++r)for(l=0;l<d;++l)a[o++]=s(n[i(e[t++])])},e[t]=function(t,n,a,o,l,c,d){var u=8>>t.b,h=t.Ea,p=t.K[0],m=t.w;if(8>u)for(t=(1<<t.b)-1,m=(1<<u)-1;n<a;++n){var f,g=0;for(f=0;f<h;++f)f&t||(g=i(o[l++])),c[d++]=s(p[g&m]),g>>=u}else e["VP8LMapColor"+r](o,l,p,m,c,d,n,a,h)}}function J(e,t,n,r,i){for(n=t+n;t<n;){var s=e[t++];r[i++]=s>>16&255,r[i++]=s>>8&255,r[i++]=255&s}}function K(e,t,n,r,i){for(n=t+n;t<n;){var s=e[t++];r[i++]=s>>16&255,r[i++]=s>>8&255,r[i++]=255&s,r[i++]=s>>24&255}}function Q(e,t,n,r,i){for(n=t+n;t<n;){var s=(a=e[t++])>>16&240|a>>12&15,a=240&a|a>>28&15;r[i++]=s,r[i++]=a}}function $(e,t,n,r,i){for(n=t+n;t<n;){var s=(a=e[t++])>>16&248|a>>13&7,a=a>>5&224|a>>3&31;r[i++]=s,r[i++]=a}}function ee(e,t,n,r,i){for(n=t+n;t<n;){var s=e[t++];r[i++]=255&s,r[i++]=s>>8&255,r[i++]=s>>16&255}}function te(e,t,n,i,s,a){if(0==a)for(n=t+n;t<n;)C(i,((a=e[t++])[0]>>24|a[1]>>8&65280|a[2]<<8&16711680|a[3]<<24)>>>0),s+=32;else r(i,s,e,t,n)}function ne(t,n){e[n][0]=e[t+"0"],e[n][1]=e[t+"1"],e[n][2]=e[t+"2"],e[n][3]=e[t+"3"],e[n][4]=e[t+"4"],e[n][5]=e[t+"5"],e[n][6]=e[t+"6"],e[n][7]=e[t+"7"],e[n][8]=e[t+"8"],e[n][9]=e[t+"9"],e[n][10]=e[t+"10"],e[n][11]=e[t+"11"],e[n][12]=e[t+"12"],e[n][13]=e[t+"13"],e[n][14]=e[t+"0"],e[n][15]=e[t+"0"]}function re(e){return e==Vr||e==Hr||e==Wr||e==Gr}function ie(){this.eb=[],this.size=this.A=this.fb=0}function se(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ae(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ie,this.f.kb=new se,this.sd=null}function oe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function le(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ce(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function de(e,t){var n=e.T,i=t.ba.f.RGBA,s=i.eb,a=i.fb+e.ka*i.A,o=gi[t.ba.S],l=e.y,c=e.O,d=e.f,u=e.N,h=e.ea,p=e.W,m=t.cc,f=t.dc,g=t.Mc,x=t.Nc,v=e.ka,y=e.ka+e.T,b=e.U,w=b+1>>1;for(0==v?o(l,c,null,null,d,u,h,p,d,u,h,p,s,a,null,null,b):(o(t.ec,t.fc,l,c,m,f,g,x,d,u,h,p,s,a-i.A,s,a,b),++n);v+2<y;v+=2)m=d,f=u,g=h,x=p,u+=e.Rc,p+=e.Rc,a+=2*i.A,o(l,(c+=2*e.fa)-e.fa,l,c,m,f,g,x,d,u,h,p,s,a-i.A,s,a,b);return c+=e.fa,e.j+y<e.o?(r(t.ec,t.fc,l,c,b),r(t.cc,t.dc,d,u,w),r(t.Mc,t.Nc,h,p,w),n--):1&y||o(l,c,null,null,d,u,h,p,d,u,h,p,s,a+i.A,null,null,b),n}function ue(e,n,r){var i=e.F,s=[e.J];if(null!=i){var a=e.U,o=n.ba.S,l=o==Ur||o==Wr;n=n.ba.f.RGBA;var c=[0],d=e.ka;c[0]=e.T,e.Kb&&(0==d?--c[0]:(--d,s[0]-=e.width),e.j+e.ka+e.T==e.o&&(c[0]=e.o-e.j-d));var u=n.eb;d=n.fb+d*n.A,e=Nr(i,s[0],e.width,a,c,u,d+(l?0:3),n.A),t(r==c),e&&re(o)&&_r(u,d,l,a,c,n.A)}return 0}function he(e){var t=e.ma,n=t.ba.S,r=11>n,i=n==Fr||n==Dr||n==Ur||n==zr||12==n||re(n);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!In(t.Oa,e,i?11:12))return 0;if(i&&re(n)&&vn(),e.da)alert("todo:use_scaling");else{if(r){if(t.Ib=ce,e.Kb){if(n=e.U+1>>1,t.memory=s(e.U+2*n),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+n,t.Ib=de,vn()}}else alert("todo:EmitYUV");i&&(t.Jb=ue,r&&gn())}if(r&&!ki){for(e=0;256>e;++e)Ti[e]=89858*(e-128)+ji>>Ni,Ri[e]=-22014*(e-128)+ji,Li[e]=-45773*(e-128),Pi[e]=113618*(e-128)+ji>>Ni;for(e=Ai;e<Mi;++e)t=76283*(e-16)+ji>>Ni,Ii[e-Ai]=Ge(t,255),Fi[e-Ai]=Ge(t+8>>4,15);ki=1}return 1}function pe(e){var n=e.ma,r=e.U,i=e.T;return t(!(1&e.ka)),0>=r||0>=i?0:(r=n.Ib(e,n),null!=n.Jb&&n.Jb(e,n,r),n.Dc+=r,1)}function me(e){e.ma.memory=null}function fe(e,t,n,r){return 47!=y(e,8)?0:(t[0]=y(e,14)+1,n[0]=y(e,14)+1,r[0]=y(e,1),0!=y(e,3)?0:!e.h)}function ge(e,t){if(4>e)return e+1;var n=e-2>>1;return(2+(1&e)<<n)+y(t,n)+1}function xe(e,t){return 120<t?t-120:1<=(n=((n=Kr[t-1])>>4)*e+(8-(15&n)))?n:1;var n}function ve(e,t,n){var r=_(n),i=e[t+=255&r].g-8;return 0<i&&(N(n,n.u+8),r=_(n),t+=e[t].value,t+=r&(1<<i)-1),N(n,n.u+e[t].g),e[t].value}function ye(e,n,r){return r.g+=e.g,r.value+=e.value<<n>>>0,t(8>=r.g),e.g}function be(e,n,r){var i=e.xc;return t((n=0==i?0:e.vc[e.md*(r>>i)+(n>>i)])<e.Wb),e.Ya[n]}function we(e,n,i,s){var a=e.ab,o=e.c*n,l=e.C;n=l+n;var c=i,d=s;for(s=e.Ta,i=e.Ua;0<a--;){var u=e.gc[a],h=l,p=n,m=c,f=d,g=(d=s,c=i,u.Ea);switch(t(h<p),t(p<=u.nc),u.hc){case 2:qn(m,f,(p-h)*g,d,c);break;case 0:var x=h,v=p,y=d,b=c,w=(A=u).Ea;0==x&&(Wn(m,f,null,null,1,y,b),G(m,f+1,0,0,w-1,y,b+1),f+=w,b+=w,++x);for(var _=1<<A.b,S=_-1,N=O(w,A.b),j=A.K,A=A.w+(x>>A.b)*N;x<v;){var M=j,E=A,C=1;for(Gn(m,f,y,b-w,1,y,b);C<w;){var k=(C&~S)+_;k>w&&(k=w),(0,Kn[M[E++]>>8&15])(m,f+ +C,y,b+C-w,k-C,y,b+C),C=k}f+=w,b+=w,++x&S||(A+=N)}p!=u.nc&&r(d,c-g,d,c+(p-h-1)*g,g);break;case 1:for(g=m,v=f,w=(m=u.Ea)-(b=m&~(y=(f=1<<u.b)-1)),x=O(m,u.b),_=u.K,u=u.w+(h>>u.b)*x;h<p;){for(S=_,N=u,j=new z,A=v+b,M=v+m;v<A;)X(S[N++],j),Qn(j,g,v,f,d,c),v+=f,c+=f;v<M&&(X(S[N++],j),Qn(j,g,v,w,d,c),v+=w,c+=w),++h&y||(u+=x)}break;case 3:if(m==d&&f==c&&0<u.b){for(v=d,m=g=c+(p-h)*g-(b=(p-h)*O(u.Ea,u.b)),f=d,y=c,x=[],b=(w=b)-1;0<=b;--b)x[b]=f[y+b];for(b=w-1;0<=b;--b)v[m+b]=x[b];Xn(u,h,p,d,g,d,c)}else Xn(u,h,p,m,f,d,c)}c=s,d=i}d!=i&&r(s,i,c,d,o)}function _e(e,n){var r=e.V,i=e.Ba+e.c*e.C,s=n-e.C;if(t(n<=e.l.o),t(16>=s),0<s){var a=e.l,o=e.Ta,l=e.Ua,c=a.width;if(we(e,s,r,i),s=l=[l],t((r=e.C)<(i=n)),t(a.v<a.va),i>a.o&&(i=a.o),r<a.j){var d=a.j-r;r=a.j,s[0]+=d*c}if(r>=i?r=0:(s[0]+=4*a.v,a.ka=r-a.j,a.U=a.va-a.v,a.T=i-r,r=1),r){if(l=l[0],11>(r=e.ca).S){var u=r.f.RGBA,h=(i=r.S,s=a.U,a=a.T,d=u.eb,u.A),p=a;for(u=u.fb+e.Ma*u.A;0<p--;){var m=o,f=l,g=s,x=d,v=u;switch(i){case Ir:$n(m,f,g,x,v);break;case Fr:er(m,f,g,x,v);break;case Vr:er(m,f,g,x,v),_r(x,v,0,g,1,0);break;case Or:rr(m,f,g,x,v);break;case Dr:te(m,f,g,x,v,1);break;case Hr:te(m,f,g,x,v,1),_r(x,v,0,g,1,0);break;case Ur:te(m,f,g,x,v,0);break;case Wr:te(m,f,g,x,v,0),_r(x,v,1,g,1,0);break;case zr:tr(m,f,g,x,v);break;case Gr:tr(m,f,g,x,v),Sr(x,v,g,1,0);break;case Br:nr(m,f,g,x,v);break;default:t(0)}l+=c,u+=h}e.Ma+=a}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=r.height)}}e.C=n,t(e.C<=e.i)}function Se(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var n=e.Ya[t].G,r=e.Ya[t].H;if(0<n[1][r[1]+0].g||0<n[2][r[2]+0].g||0<n[3][r[3]+0].g)return 0}return 1}function Ne(e,n,r,i,s,a){if(0!=e.Z){var o=e.qd,l=e.rd;for(t(null!=fi[e.Z]);n<r;++n)fi[e.Z](o,l,i,s,i,s,a),o=i,l=s,s+=a;e.qd=o,e.rd=l}}function je(e,n){var r=e.l.ma,i=0==r.Z||1==r.Z?e.l.j:e.C;if(i=e.C<i?i:e.C,t(n<=e.l.o),n>i){var s=e.l.width,a=r.ca,o=r.tb+s*i,l=e.V,c=e.Ba+e.c*i,d=e.gc;t(1==e.ab),t(3==d[0].hc),Zn(d[0],i,n,l,c,a,o),Ne(r,i,n,a,o,s)}e.C=e.Ma=n}function Ae(e,n,r,i,s,a,o){var l=e.$/i,c=e.$%i,d=e.m,u=e.s,h=r+e.$,p=h;s=r+i*s;var m=r+i*a,f=280+u.ua,g=e.Pb?l:16777216,x=0<u.ua?u.Wa:null,v=u.wc,y=h<m?be(u,c,l):null;t(e.C<a),t(m<=s);var b=!1;e:for(;;){for(;b||h<m;){var w=0;if(l>=g){var A=h-r;t((g=e).Pb),g.wd=g.m,g.xd=A,0<g.s.ua&&R(g.s.Wa,g.s.vb),g=l+$r}if(c&v||(y=be(u,c,l)),t(null!=y),y.Qb&&(n[h]=y.qb,b=!0),!b)if(j(d),y.jc){w=d,A=n;var M=h,E=y.pd[_(w)&Dn-1];t(y.jc),256>E.g?(N(w,w.u+E.g),A[M]=E.value,w=0):(N(w,w.u+E.g-256),t(256<=E.value),w=E.value),0==w&&(b=!0)}else w=ve(y.G[0],y.H[0],d);if(d.h)break;if(b||256>w){if(!b)if(y.nd)n[h]=(y.qb|w<<8)>>>0;else{if(j(d),b=ve(y.G[1],y.H[1],d),j(d),A=ve(y.G[2],y.H[2],d),M=ve(y.G[3],y.H[3],d),d.h)break;n[h]=(M<<24|b<<16|w<<8|A)>>>0}if(b=!1,++h,++c>=i&&(c=0,++l,null!=o&&l<=a&&!(l%16)&&o(e,l),null!=x))for(;p<h;)w=n[p++],x.X[(506832829*w&4294967295)>>>x.Mb]=w}else if(280>w){if(w=ge(w-256,d),A=ve(y.G[4],y.H[4],d),j(d),A=xe(i,A=ge(A,d)),d.h)break;if(h-r<A||s-h<w)break e;for(M=0;M<w;++M)n[h+M]=n[h+M-A];for(h+=w,c+=w;c>=i;)c-=i,++l,null!=o&&l<=a&&!(l%16)&&o(e,l);if(t(h<=s),c&v&&(y=be(u,c,l)),null!=x)for(;p<h;)w=n[p++],x.X[(506832829*w&4294967295)>>>x.Mb]=w}else{if(!(w<f))break e;for(b=w-280,t(null!=x);p<h;)w=n[p++],x.X[(506832829*w&4294967295)>>>x.Mb]=w;w=h,t(!(b>>>(A=x).Xa)),n[w]=A.X[b],b=!0}b||t(d.h==S(d))}if(e.Pb&&d.h&&h<s)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&R(e.s.vb,e.s.Wa);else{if(d.h)break e;null!=o&&o(e,l>a?a:l),e.a=0,e.$=h-r}return 1}return e.a=3,0}function Me(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var n=e.Wa;null!=n&&(n.X=null),e.vb=null,t(null!=e)}function Ee(){var t=new an;return null==t?null:(t.a=0,t.xb=mi,ne("Predictor","VP8LPredictors"),ne("Predictor","VP8LPredictors_C"),ne("PredictorAdd","VP8LPredictorsAdd"),ne("PredictorAdd","VP8LPredictorsAdd_C"),qn=q,Qn=Y,$n=J,er=K,tr=Q,nr=$,rr=ee,e.VP8LMapColor32b=Yn,e.VP8LMapColor8b=Jn,t)}function Ce(e,n,r,o,l){var c=1,h=[e],m=[n],f=o.m,g=o.s,x=null,v=0;e:for(;;){if(r)for(;c&&y(f,1);){var b=h,w=m,S=o,A=1,M=S.m,E=S.gc[S.ab],C=y(M,2);if(S.Oc&1<<C)c=0;else{switch(S.Oc|=1<<C,E.hc=C,E.Ea=b[0],E.nc=w[0],E.K=[null],++S.ab,t(4>=S.ab),C){case 0:case 1:E.b=y(M,3)+2,A=Ce(O(E.Ea,E.b),O(E.nc,E.b),0,S,E.K),E.K=E.K[0];break;case 3:var k,T=y(M,8)+1,P=16<T?0:4<T?1:2<T?2:3;if(b[0]=O(E.Ea,P),E.b=P,k=A=Ce(T,1,0,S,E.K)){var R,I=T,F=E,U=1<<(8>>F.b),z=s(U);if(null==z)k=0;else{var B=F.K[0],V=F.w;for(z[0]=F.K[0][0],R=1;R<1*I;++R)z[R]=D(B[V+R],z[R-1]);for(;R<4*U;++R)z[R]=0;F.K[0]=null,F.K[0]=z,k=1}}A=k;break;case 2:break;default:t(0)}c=A}}if(h=h[0],m=m[0],c&&y(f,1)&&!(c=1<=(v=y(f,4))&&11>=v)){o.a=3;break e}var H;if(H=c)t:{var W,G,q,X=o,Y=h,Z=m,J=v,K=r,Q=X.m,$=X.s,ee=[null],te=1,ne=0,re=Qr[J];n:for(;;){if(K&&y(Q,1)){var ie=y(Q,3)+2,se=O(Y,ie),ae=O(Z,ie),oe=se*ae;if(!Ce(se,ae,0,X,ee))break n;for(ee=ee[0],$.xc=ie,W=0;W<oe;++W){var le=ee[W]>>8&65535;ee[W]=le,le>=te&&(te=le+1)}}if(Q.h)break n;for(G=0;5>G;++G){var ce=Yr[G];!G&&0<J&&(ce+=1<<J),ne<ce&&(ne=ce)}var de=a(te*re,u),ue=te,he=a(ue,p);if(null==he)var pe=null;else t(65536>=ue),pe=he;var me=s(ne);if(null==pe||null==me||null==de){X.a=1;break n}var fe=de;for(W=q=0;W<te;++W){var ge=pe[W],xe=ge.G,ve=ge.H,be=0,we=1,_e=0;for(G=0;5>G;++G){ce=Yr[G],xe[G]=fe,ve[G]=q,!G&&0<J&&(ce+=1<<J);r:{var Se,Ne=ce,je=X,Ee=me,ke=fe,Te=q,Pe=0,Le=je.m,Re=y(Le,1);if(i(Ee,0,0,Ne),Re){var Ie=y(Le,1)+1,Fe=y(Le,1),Oe=y(Le,0==Fe?1:8);Ee[Oe]=1,2==Ie&&(Ee[Oe=y(Le,8)]=1);var De=1}else{var Ue=s(19),ze=y(Le,4)+4;if(19<ze){je.a=3;var Be=0;break r}for(Se=0;Se<ze;++Se)Ue[Jr[Se]]=y(Le,3);var Ve=void 0,He=void 0,We=je,Ge=Ue,qe=Ne,Xe=Ee,Ye=0,Ze=We.m,Je=8,Ke=a(128,u);i:for(;d(Ke,0,7,Ge,19);){if(y(Ze,1)){var Qe=2+2*y(Ze,3);if((Ve=2+y(Ze,Qe))>qe)break i}else Ve=qe;for(He=0;He<qe&&Ve--;){j(Ze);var $e=Ke[0+(127&_(Ze))];N(Ze,Ze.u+$e.g);var et=$e.value;if(16>et)Xe[He++]=et,0!=et&&(Je=et);else{var tt=16==et,nt=et-16,rt=Xr[nt],it=y(Ze,qr[nt])+rt;if(He+it>qe)break i;for(var st=tt?Je:0;0<it--;)Xe[He++]=st}}Ye=1;break i}Ye||(We.a=3),De=Ye}(De=De&&!Le.h)&&(Pe=d(ke,Te,8,Ee,Ne)),De&&0!=Pe?Be=Pe:(je.a=3,Be=0)}if(0==Be)break n;if(we&&1==Zr[G]&&(we=0==fe[q].g),be+=fe[q].g,q+=Be,3>=G){var at,ot=me[0];for(at=1;at<ce;++at)me[at]>ot&&(ot=me[at]);_e+=ot}}if(ge.nd=we,ge.Qb=0,we&&(ge.qb=(xe[3][ve[3]+0].value<<24|xe[1][ve[1]+0].value<<16|xe[2][ve[2]+0].value)>>>0,0==be&&256>xe[0][ve[0]+0].value&&(ge.Qb=1,ge.qb+=xe[0][ve[0]+0].value<<8)),ge.jc=!ge.Qb&&6>_e,ge.jc){var lt,ct=ge;for(lt=0;lt<Dn;++lt){var dt=lt,ut=ct.pd[dt],ht=ct.G[0][ct.H[0]+dt];256<=ht.value?(ut.g=ht.g+256,ut.value=ht.value):(ut.g=0,ut.value=0,dt>>=ye(ht,8,ut),dt>>=ye(ct.G[1][ct.H[1]+dt],16,ut),dt>>=ye(ct.G[2][ct.H[2]+dt],0,ut),ye(ct.G[3][ct.H[3]+dt],24,ut))}}}$.vc=ee,$.Wb=te,$.Ya=pe,$.yc=de,H=1;break t}H=0}if(!(c=H)){o.a=3;break e}if(0<v){if(g.ua=1<<v,!L(g.Wa,v)){o.a=1,c=0;break e}}else g.ua=0;var pt=o,mt=h,ft=m,gt=pt.s,xt=gt.xc;if(pt.c=mt,pt.i=ft,gt.md=O(mt,xt),gt.wc=0==xt?-1:(1<<xt)-1,r){o.xb=pi;break e}if(null==(x=s(h*m))){o.a=1,c=0;break e}c=(c=Ae(o,x,0,h,m,m,null))&&!f.h;break e}return c?(null!=l?l[0]=x:(t(null==x),t(r)),o.$=0,r||Me(g)):Me(g),c}function ke(e,n){var r=e.c*e.i,i=r+n+16*n;return t(e.c<=n),e.V=s(i),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+r+n,1)}function Te(e,n){var r=e.C,i=n-r,s=e.V,a=e.Ba+e.c*r;for(t(n<=e.l.o);0<i;){var o=16<i?16:i,l=e.l.ma,c=e.l.width,d=c*o,u=l.ca,h=l.tb+c*r,p=e.Ta,m=e.Ua;we(e,o,s,a),jr(p,m,u,h,d),Ne(l,r,r+o,u,h,c),i-=o,s+=o*e.c,r+=o}t(r==n),e.C=e.Ma=n}function Pe(){this.ub=this.yd=this.td=this.Rb=0}function Le(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Re(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Ie(){this.Yb=function(){var e=[];return function e(t,n,r){for(var i=r[n],s=0;s<i&&(t.push(r.length>n+1?[]:0),!(r.length<n+1));s++)e(t[s],n+1,r)}(e,0,[3,11]),e}()}function Fe(){this.jb=s(3),this.Wc=o([4,8],Ie),this.Xc=o([4,17],Ie)}function Oe(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function De(){this.ld=this.La=this.dd=this.tc=0}function Ue(){this.Na=this.la=0}function ze(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Be(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ve(){this.uc=this.M=this.Nb=0,this.wa=Array(new De),this.Y=0,this.ya=Array(new Be),this.aa=0,this.l=new qe}function He(){this.y=s(16),this.f=s(8),this.ea=s(8)}function We(){this.cb=this.a=0,this.sc="",this.m=new b,this.Od=new Pe,this.Kc=new Le,this.ed=new Oe,this.Qa=new Re,this.Ic=this.$c=this.Aa=0,this.D=new Ve,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,b),this.ia=0,this.pb=a(4,ze),this.Pa=new Fe,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new He),this.Hd=0,this.rb=Array(new Ue),this.sb=0,this.wa=Array(new De),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Be),this.L=this.aa=0,this.gd=o([4,2],De),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ge(e,t){return 0>e?0:e>t?t:e}function qe(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Xe(){var e=new We;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,ni||(ni=Ke)),e}function Ye(e,t,n){return 0==e.a&&(e.a=t,e.sc=n,e.cb=0),0}function Ze(e,t,n){return 3<=n&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function Je(e,n){if(null==e)return 0;if(e.a=0,e.sc="OK",null==n)return Ye(e,2,"null VP8Io passed to VP8GetHeaders()");var r=n.data,s=n.w,a=n.ha;if(4>a)return Ye(e,7,"Truncated header.");var o=r[s+0]|r[s+1]<<8|r[s+2]<<16,l=e.Od;if(l.Rb=!(1&o),l.td=o>>1&7,l.yd=o>>4&1,l.ub=o>>5,3<l.td)return Ye(e,3,"Incorrect keyframe parameters.");if(!l.yd)return Ye(e,4,"Frame not displayable.");s+=3,a-=3;var c=e.Kc;if(l.Rb){if(7>a)return Ye(e,7,"cannot parse picture header");if(!Ze(r,s,a))return Ye(e,3,"Bad code word");c.c=16383&(r[s+4]<<8|r[s+3]),c.Td=r[s+4]>>6,c.i=16383&(r[s+6]<<8|r[s+5]),c.Ud=r[s+6]>>6,s+=7,a-=7,e.za=c.c+15>>4,e.Ub=c.i+15>>4,n.width=c.c,n.height=c.i,n.Da=0,n.j=0,n.v=0,n.va=n.width,n.o=n.height,n.da=0,n.ib=n.width,n.hb=n.height,n.U=n.width,n.T=n.height,i((o=e.Pa).jb,0,255,o.jb.length),t(null!=(o=e.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,i(o.Zb,0,0,o.Zb.length),i(o.Lb,0,0,o.Lb)}if(l.ub>a)return Ye(e,7,"bad partition length");m(o=e.m,r,s,l.ub),s+=l.ub,a-=l.ub,l.Rb&&(c.Ld=M(o),c.Kd=M(o)),c=e.Qa;var d,u=e.Pa;if(t(null!=o),t(null!=c),c.Cb=M(o),c.Cb){if(c.Bb=M(o),M(o)){for(c.Fb=M(o),d=0;4>d;++d)c.Zb[d]=M(o)?g(o,7):0;for(d=0;4>d;++d)c.Lb[d]=M(o)?g(o,6):0}if(c.Bb)for(d=0;3>d;++d)u.jb[d]=M(o)?f(o,8):255}else c.Bb=0;if(o.Ka)return Ye(e,3,"cannot parse segment header");if((c=e.ed).zd=M(o),c.Tb=f(o,6),c.wb=f(o,3),c.Pc=M(o),c.Pc&&M(o)){for(u=0;4>u;++u)M(o)&&(c.vd[u]=g(o,6));for(u=0;4>u;++u)M(o)&&(c.od[u]=g(o,6))}if(e.L=0==c.Tb?0:c.zd?1:2,o.Ka)return Ye(e,3,"cannot parse filter header");var h=a;if(a=d=s,s=d+h,c=h,e.Xb=(1<<f(e.m,2))-1,h<3*(u=e.Xb))r=7;else{for(d+=3*u,c-=3*u,h=0;h<u;++h){var p=r[a+0]|r[a+1]<<8|r[a+2]<<16;p>c&&(p=c),m(e.Jc[+h],r,d,p),d+=p,c-=p,a+=3}m(e.Jc[+u],r,d,c),r=d<s?0:5}if(0!=r)return Ye(e,r,"cannot parse partitions");for(r=f(d=e.m,7),a=M(d)?g(d,4):0,s=M(d)?g(d,4):0,c=M(d)?g(d,4):0,u=M(d)?g(d,4):0,d=M(d)?g(d,4):0,h=e.Qa,p=0;4>p;++p){if(h.Cb){var x=h.Zb[p];h.Fb||(x+=r)}else{if(0<p){e.pb[p]=e.pb[0];continue}x=r}var v=e.pb[p];v.Sc[0]=ei[Ge(x+a,127)],v.Sc[1]=ti[Ge(x+0,127)],v.Eb[0]=2*ei[Ge(x+s,127)],v.Eb[1]=101581*ti[Ge(x+c,127)]>>16,8>v.Eb[1]&&(v.Eb[1]=8),v.Qc[0]=ei[Ge(x+u,117)],v.Qc[1]=ti[Ge(x+d,127)],v.lc=x+d}if(!l.Rb)return Ye(e,4,"Not a key frame.");for(M(o),l=e.Pa,r=0;4>r;++r){for(a=0;8>a;++a)for(s=0;3>s;++s)for(c=0;11>c;++c)u=E(o,li[r][a][s][c])?f(o,8):ai[r][a][s][c],l.Wc[r][a].Yb[s][c]=u;for(a=0;17>a;++a)l.Xc[r][a]=l.Wc[r][ci[a]]}return e.kc=M(o),e.kc&&(e.Bd=f(o,8)),e.cb=1}function Ke(e,t,n,r,i,s,a){var o=t[i].Yb[n];for(n=0;16>i;++i){if(!E(e,o[n+0]))return i;for(;!E(e,o[n+1]);)if(o=t[++i].Yb[0],n=0,16==i)return 16;var l=t[i+1].Yb;if(E(e,o[n+2])){var c=e,d=0;if(E(c,(h=o)[(u=n)+3]))if(E(c,h[u+6])){for(o=0,u=2*(d=E(c,h[u+8]))+(h=E(c,h[u+9+d])),d=0,h=ri[u];h[o];++o)d+=d+E(c,h[o]);d+=3+(8<<u)}else E(c,h[u+7])?(d=7+2*E(c,165),d+=E(c,145)):d=5+E(c,159);else d=E(c,h[u+4])?3+E(c,h[u+5]):2;o=l[2]}else d=1,o=l[1];l=a+ii[i],0>(c=e).b&&A(c);var u,h=c.b,p=(u=c.Ca>>1)-(c.I>>h)>>31;--c.b,c.Ca+=p,c.Ca|=1,c.I-=(u+1&p)<<h,s[l]=((d^p)-p)*r[(0<i)+0]}return 16}function Qe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,i(e.zc,0,0,e.zc.length),e.ja=0}function $e(e,t,n,r,i){i=e[t+n+32*r]+(i>>3),e[t+n+32*r]=-256&i?0>i?0:255:i}function et(e,t,n,r,i,s){$e(e,t,0,n,r+i),$e(e,t,1,n,r+s),$e(e,t,2,n,r-s),$e(e,t,3,n,r-i)}function tt(e){return(20091*e>>16)+e}function nt(e,t,n,r){var i,a=0,o=s(16);for(i=0;4>i;++i){var l=e[t+0]+e[t+8],c=e[t+0]-e[t+8],d=(35468*e[t+4]>>16)-tt(e[t+12]),u=tt(e[t+4])+(35468*e[t+12]>>16);o[a+0]=l+u,o[a+1]=c+d,o[a+2]=c-d,o[a+3]=l-u,a+=4,t++}for(i=a=0;4>i;++i)l=(e=o[a+0]+4)+o[a+8],c=e-o[a+8],d=(35468*o[a+4]>>16)-tt(o[a+12]),$e(n,r,0,0,l+(u=tt(o[a+4])+(35468*o[a+12]>>16))),$e(n,r,1,0,c+d),$e(n,r,2,0,c-d),$e(n,r,3,0,l-u),a++,r+=32}function rt(e,t,n,r){var i=e[t+0]+4,s=35468*e[t+4]>>16,a=tt(e[t+4]),o=35468*e[t+1]>>16;et(n,r,0,i+a,e=tt(e[t+1]),o),et(n,r,1,i+s,e,o),et(n,r,2,i-s,e,o),et(n,r,3,i-a,e,o)}function it(e,t,n,r,i){nt(e,t,n,r),i&&nt(e,t+16,n,r+4)}function st(e,t,n,r){sr(e,t+0,n,r,1),sr(e,t+32,n,r+128,1)}function at(e,t,n,r){var i;for(e=e[t+0]+4,i=0;4>i;++i)for(t=0;4>t;++t)$e(n,r,t,i,e)}function ot(e,t,n,r){e[t+0]&&lr(e,t+0,n,r),e[t+16]&&lr(e,t+16,n,r+4),e[t+32]&&lr(e,t+32,n,r+128),e[t+48]&&lr(e,t+48,n,r+128+4)}function lt(e,t,n,r){var i,a=s(16);for(i=0;4>i;++i){var o=e[t+0+i]+e[t+12+i],l=e[t+4+i]+e[t+8+i],c=e[t+4+i]-e[t+8+i],d=e[t+0+i]-e[t+12+i];a[0+i]=o+l,a[8+i]=o-l,a[4+i]=d+c,a[12+i]=d-c}for(i=0;4>i;++i)o=(e=a[0+4*i]+3)+a[3+4*i],l=a[1+4*i]+a[2+4*i],c=a[1+4*i]-a[2+4*i],d=e-a[3+4*i],n[r+0]=o+l>>3,n[r+16]=d+c>>3,n[r+32]=o-l>>3,n[r+48]=d-c>>3,r+=64}function ct(e,t,n){var r,i=t-32,s=Lr,a=255-e[i-1];for(r=0;r<n;++r){var o,l=s,c=a+e[t-1];for(o=0;o<n;++o)e[t+o]=l[c+e[i+o]];t+=32}}function dt(e,t){ct(e,t,4)}function ut(e,t){ct(e,t,8)}function ht(e,t){ct(e,t,16)}function pt(e,t){var n;for(n=0;16>n;++n)r(e,t+32*n,e,t-32,16)}function mt(e,t){var n;for(n=16;0<n;--n)i(e,t,e[t-1],16),t+=32}function ft(e,t,n){var r;for(r=0;16>r;++r)i(t,n+32*r,e,16)}function gt(e,t){var n,r=16;for(n=0;16>n;++n)r+=e[t-1+32*n]+e[t+n-32];ft(r>>5,e,t)}function xt(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t-1+32*n];ft(r>>4,e,t)}function vt(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t+n-32];ft(r>>4,e,t)}function yt(e,t){ft(128,e,t)}function bt(e,t,n){return e+2*t+n+2>>2}function wt(e,t){var n,i=t-32;for(i=new Uint8Array([bt(e[i-1],e[i+0],e[i+1]),bt(e[i+0],e[i+1],e[i+2]),bt(e[i+1],e[i+2],e[i+3]),bt(e[i+2],e[i+3],e[i+4])]),n=0;4>n;++n)r(e,t+32*n,i,0,i.length)}function _t(e,t){var n=e[t-1],r=e[t-1+32],i=e[t-1+64],s=e[t-1+96];C(e,t+0,16843009*bt(e[t-1-32],n,r)),C(e,t+32,16843009*bt(n,r,i)),C(e,t+64,16843009*bt(r,i,s)),C(e,t+96,16843009*bt(i,s,s))}function St(e,t){var n,r=4;for(n=0;4>n;++n)r+=e[t+n-32]+e[t-1+32*n];for(r>>=3,n=0;4>n;++n)i(e,t+32*n,r,4)}function Nt(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],s=e[t-1-32],a=e[t+0-32],o=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+96]=bt(r,i,e[t-1+96]),e[t+1+96]=e[t+0+64]=bt(n,r,i),e[t+2+96]=e[t+1+64]=e[t+0+32]=bt(s,n,r),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=bt(a,s,n),e[t+3+64]=e[t+2+32]=e[t+1+0]=bt(o,a,s),e[t+3+32]=e[t+2+0]=bt(l,o,a),e[t+3+0]=bt(c,l,o)}function jt(e,t){var n=e[t+1-32],r=e[t+2-32],i=e[t+3-32],s=e[t+4-32],a=e[t+5-32],o=e[t+6-32],l=e[t+7-32];e[t+0+0]=bt(e[t+0-32],n,r),e[t+1+0]=e[t+0+32]=bt(n,r,i),e[t+2+0]=e[t+1+32]=e[t+0+64]=bt(r,i,s),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=bt(i,s,a),e[t+3+32]=e[t+2+64]=e[t+1+96]=bt(s,a,o),e[t+3+64]=e[t+2+96]=bt(a,o,l),e[t+3+96]=bt(o,l,l)}function At(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],s=e[t-1-32],a=e[t+0-32],o=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+0]=e[t+1+64]=s+a+1>>1,e[t+1+0]=e[t+2+64]=a+o+1>>1,e[t+2+0]=e[t+3+64]=o+l+1>>1,e[t+3+0]=l+c+1>>1,e[t+0+96]=bt(i,r,n),e[t+0+64]=bt(r,n,s),e[t+0+32]=e[t+1+96]=bt(n,s,a),e[t+1+32]=e[t+2+96]=bt(s,a,o),e[t+2+32]=e[t+3+96]=bt(a,o,l),e[t+3+32]=bt(o,l,c)}function Mt(e,t){var n=e[t+0-32],r=e[t+1-32],i=e[t+2-32],s=e[t+3-32],a=e[t+4-32],o=e[t+5-32],l=e[t+6-32],c=e[t+7-32];e[t+0+0]=n+r+1>>1,e[t+1+0]=e[t+0+64]=r+i+1>>1,e[t+2+0]=e[t+1+64]=i+s+1>>1,e[t+3+0]=e[t+2+64]=s+a+1>>1,e[t+0+32]=bt(n,r,i),e[t+1+32]=e[t+0+96]=bt(r,i,s),e[t+2+32]=e[t+1+96]=bt(i,s,a),e[t+3+32]=e[t+2+96]=bt(s,a,o),e[t+3+64]=bt(a,o,l),e[t+3+96]=bt(o,l,c)}function Et(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],s=e[t-1+96];e[t+0+0]=n+r+1>>1,e[t+2+0]=e[t+0+32]=r+i+1>>1,e[t+2+32]=e[t+0+64]=i+s+1>>1,e[t+1+0]=bt(n,r,i),e[t+3+0]=e[t+1+32]=bt(r,i,s),e[t+3+32]=e[t+1+64]=bt(i,s,s),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=s}function Ct(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],s=e[t-1+96],a=e[t-1-32],o=e[t+0-32],l=e[t+1-32],c=e[t+2-32];e[t+0+0]=e[t+2+32]=n+a+1>>1,e[t+0+32]=e[t+2+64]=r+n+1>>1,e[t+0+64]=e[t+2+96]=i+r+1>>1,e[t+0+96]=s+i+1>>1,e[t+3+0]=bt(o,l,c),e[t+2+0]=bt(a,o,l),e[t+1+0]=e[t+3+32]=bt(n,a,o),e[t+1+32]=e[t+3+64]=bt(r,n,a),e[t+1+64]=e[t+3+96]=bt(i,r,n),e[t+1+96]=bt(s,i,r)}function kt(e,t){var n;for(n=0;8>n;++n)r(e,t+32*n,e,t-32,8)}function Tt(e,t){var n;for(n=0;8>n;++n)i(e,t,e[t-1],8),t+=32}function Pt(e,t,n){var r;for(r=0;8>r;++r)i(t,n+32*r,e,8)}function Lt(e,t){var n,r=8;for(n=0;8>n;++n)r+=e[t+n-32]+e[t-1+32*n];Pt(r>>4,e,t)}function Rt(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t+n-32];Pt(r>>3,e,t)}function It(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t-1+32*n];Pt(r>>3,e,t)}function Ft(e,t){Pt(128,e,t)}function Ot(e,t,n){var r=e[t-n],i=e[t+0],s=3*(i-r)+Tr[1020+e[t-2*n]-e[t+n]],a=Pr[112+(s+4>>3)];e[t-n]=Lr[255+r+Pr[112+(s+3>>3)]],e[t+0]=Lr[255+i-a]}function Dt(e,t,n,r){var i=e[t+0],s=e[t+n];return Rr[255+e[t-2*n]-e[t-n]]>r||Rr[255+s-i]>r}function Ut(e,t,n,r){return 4*Rr[255+e[t-n]-e[t+0]]+Rr[255+e[t-2*n]-e[t+n]]<=r}function zt(e,t,n,r,i){var s=e[t-3*n],a=e[t-2*n],o=e[t-n],l=e[t+0],c=e[t+n],d=e[t+2*n],u=e[t+3*n];return 4*Rr[255+o-l]+Rr[255+a-c]>r?0:Rr[255+e[t-4*n]-s]<=i&&Rr[255+s-a]<=i&&Rr[255+a-o]<=i&&Rr[255+u-d]<=i&&Rr[255+d-c]<=i&&Rr[255+c-l]<=i}function Bt(e,t,n,r){var i=2*r+1;for(r=0;16>r;++r)Ut(e,t+r,n,i)&&Ot(e,t+r,n)}function Vt(e,t,n,r){var i=2*r+1;for(r=0;16>r;++r)Ut(e,t+r*n,1,i)&&Ot(e,t+r*n,1)}function Ht(e,t,n,r){var i;for(i=3;0<i;--i)Bt(e,t+=4*n,n,r)}function Wt(e,t,n,r){var i;for(i=3;0<i;--i)Vt(e,t+=4,n,r)}function Gt(e,t,n,r,i,s,a,o){for(s=2*s+1;0<i--;){if(zt(e,t,n,s,a))if(Dt(e,t,n,o))Ot(e,t,n);else{var l=e,c=t,d=n,u=l[c-2*d],h=l[c-d],p=l[c+0],m=l[c+d],f=l[c+2*d],g=27*(v=Tr[1020+3*(p-h)+Tr[1020+u-m]])+63>>7,x=18*v+63>>7,v=9*v+63>>7;l[c-3*d]=Lr[255+l[c-3*d]+v],l[c-2*d]=Lr[255+u+x],l[c-d]=Lr[255+h+g],l[c+0]=Lr[255+p-g],l[c+d]=Lr[255+m-x],l[c+2*d]=Lr[255+f-v]}t+=r}}function qt(e,t,n,r,i,s,a,o){for(s=2*s+1;0<i--;){if(zt(e,t,n,s,a))if(Dt(e,t,n,o))Ot(e,t,n);else{var l=e,c=t,d=n,u=l[c-d],h=l[c+0],p=l[c+d],m=Pr[112+(4+(f=3*(h-u))>>3)],f=Pr[112+(f+3>>3)],g=m+1>>1;l[c-2*d]=Lr[255+l[c-2*d]+g],l[c-d]=Lr[255+u+f],l[c+0]=Lr[255+h-m],l[c+d]=Lr[255+p-g]}t+=r}}function Xt(e,t,n,r,i,s){Gt(e,t,n,1,16,r,i,s)}function Yt(e,t,n,r,i,s){Gt(e,t,1,n,16,r,i,s)}function Zt(e,t,n,r,i,s){var a;for(a=3;0<a;--a)qt(e,t+=4*n,n,1,16,r,i,s)}function Jt(e,t,n,r,i,s){var a;for(a=3;0<a;--a)qt(e,t+=4,1,n,16,r,i,s)}function Kt(e,t,n,r,i,s,a,o){Gt(e,t,i,1,8,s,a,o),Gt(n,r,i,1,8,s,a,o)}function Qt(e,t,n,r,i,s,a,o){Gt(e,t,1,i,8,s,a,o),Gt(n,r,1,i,8,s,a,o)}function $t(e,t,n,r,i,s,a,o){qt(e,t+4*i,i,1,8,s,a,o),qt(n,r+4*i,i,1,8,s,a,o)}function en(e,t,n,r,i,s,a,o){qt(e,t+4,1,i,8,s,a,o),qt(n,r+4,1,i,8,s,a,o)}function tn(){this.ba=new ae,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new le,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function nn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function rn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function sn(){this.ua=0,this.Wa=new I,this.vb=new I,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new p,this.yc=new u}function an(){this.xb=this.a=0,this.l=new qe,this.ca=new ae,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new w,this.Pb=0,this.wd=new w,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new sn,this.ab=0,this.gc=a(4,rn),this.Oc=0}function on(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new qe,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ln(e,t,n,r,i,s,a){for(e=null==e?0:e[t+0],t=0;t<a;++t)i[s+t]=e+n[r+t]&255,e=i[s+t]}function cn(e,t,n,r,i,s,a){var o;if(null==e)ln(null,null,n,r,i,s,a);else for(o=0;o<a;++o)i[s+o]=e[t+o]+n[r+o]&255}function dn(e,t,n,r,i,s,a){if(null==e)ln(null,null,n,r,i,s,a);else{var o,l=e[t+0],c=l,d=l;for(o=0;o<a;++o)c=d+(l=e[t+o])-c,d=n[r+o]+(-256&c?0>c?0:255:c)&255,c=l,i[s+o]=d}}function un(e,n,i,a){var o=n.width,l=n.o;if(t(null!=e&&null!=n),0>i||0>=a||i+a>l)return null;if(!e.Cc){if(null==e.ga){var c;if(e.ga=new on,(c=null==e.ga)||(c=n.width*n.o,t(0==e.Gb.length),e.Gb=s(c),e.Uc=0,null==e.Gb?c=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,c=1),c=!c),!c){c=e.ga;var d=e.Fa,u=e.P,h=e.qc,p=e.mb,m=e.nb,f=u+1,g=h-1,v=c.l;if(t(null!=d&&null!=p&&null!=n),fi[0]=null,fi[1]=ln,fi[2]=cn,fi[3]=dn,c.ca=p,c.tb=m,c.c=n.width,c.i=n.height,t(0<c.c&&0<c.i),1>=h)n=0;else if(c.$a=3&d[u+0],c.Z=d[u+0]>>2&3,c.Lc=d[u+0]>>4&3,u=d[u+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||u)n=0;else if(v.put=pe,v.ac=he,v.bc=me,v.ma=c,v.width=n.width,v.height=n.height,v.Da=n.Da,v.v=n.v,v.va=n.va,v.j=n.j,v.o=n.o,c.$a)e:{t(1==c.$a),n=Ee();t:for(;;){if(null==n){n=0;break e}if(t(null!=c),c.mc=n,n.c=c.c,n.i=c.i,n.l=c.l,n.l.ma=c,n.l.width=c.c,n.l.height=c.i,n.a=0,x(n.m,d,f,g),!Ce(c.c,c.i,1,n,null))break t;if(1==n.ab&&3==n.gc[0].hc&&Se(n.s)?(c.ic=1,d=n.c*n.i,n.Ta=null,n.Ua=0,n.V=s(d),n.Ba=0,null==n.V?(n.a=1,n=0):n=1):(c.ic=0,n=ke(n,c.c)),!n)break t;n=1;break e}c.mc=null,n=0}else n=g>=c.c*c.i;c=!n}if(c)return null;1!=e.ga.Lc?e.Ga=0:a=l-i}t(null!=e.ga),t(i+a<=l);e:{if(n=(d=e.ga).c,l=d.l.o,0==d.$a){if(f=e.rc,g=e.Vc,v=e.Fa,u=e.P+1+i*n,h=e.mb,p=e.nb+i*n,t(u<=e.P+e.qc),0!=d.Z)for(t(null!=fi[d.Z]),c=0;c<a;++c)fi[d.Z](f,g,v,u,h,p,n),f=h,g=p,p+=n,u+=n;else for(c=0;c<a;++c)r(h,p,v,u,n),f=h,g=p,p+=n,u+=n;e.rc=f,e.Vc=g}else{if(t(null!=d.mc),n=i+a,t(null!=(c=d.mc)),t(n<=c.i),c.C>=n)n=1;else if(d.ic||gn(),d.ic){d=c.V,f=c.Ba,g=c.c;var y=c.i,b=(v=1,u=c.$/g,h=c.$%g,p=c.m,m=c.s,c.$),w=g*y,_=g*n,N=m.wc,A=b<_?be(m,h,u):null;t(b<=w),t(n<=y),t(Se(m));t:for(;;){for(;!p.h&&b<_;){if(h&N||(A=be(m,h,u)),t(null!=A),j(p),256>(y=ve(A.G[0],A.H[0],p)))d[f+b]=y,++b,++h>=g&&(h=0,++u<=n&&!(u%16)&&je(c,u));else{if(!(280>y)){v=0;break t}y=ge(y-256,p);var M,E=ve(A.G[4],A.H[4],p);if(j(p),!(b>=(E=xe(g,E=ge(E,p)))&&w-b>=y)){v=0;break t}for(M=0;M<y;++M)d[f+b+M]=d[f+b+M-E];for(b+=y,h+=y;h>=g;)h-=g,++u<=n&&!(u%16)&&je(c,u);b<_&&h&N&&(A=be(m,h,u))}t(p.h==S(p))}je(c,u>n?n:u);break t}!v||p.h&&b<w?(v=0,c.a=p.h?5:3):c.$=b,n=v}else n=Ae(c,c.V,c.Ba,c.c,c.i,n,Te);if(!n){a=0;break e}}i+a>=l&&(e.Cc=1),a=1}if(!a)return null;if(e.Cc&&(null!=(a=e.ga)&&(a.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+i*o}function hn(e,t,n,r,i,s){for(;0<i--;){var a,o=e,l=t+(n?1:0),c=e,d=t+(n?0:3);for(a=0;a<r;++a){var u=c[d+4*a];255!=u&&(u*=32897,o[l+4*a+0]=o[l+4*a+0]*u>>23,o[l+4*a+1]=o[l+4*a+1]*u>>23,o[l+4*a+2]=o[l+4*a+2]*u>>23)}t+=s}}function pn(e,t,n,r,i){for(;0<r--;){var s;for(s=0;s<n;++s){var a=e[t+2*s+0],o=15&(c=e[t+2*s+1]),l=4369*o,c=(240&c|c>>4)*l>>16;e[t+2*s+0]=(240&a|a>>4)*l>>16&240|(15&a|a<<4)*l>>16>>4&15,e[t+2*s+1]=240&c|o}t+=i}}function mn(e,t,n,r,i,s,a,o){var l,c,d=255;for(c=0;c<i;++c){for(l=0;l<r;++l){var u=e[t+l];s[a+4*l]=u,d&=u}t+=n,a+=o}return 255!=d}function fn(e,t,n,r,i){var s;for(s=0;s<i;++s)n[r+s]=e[t+s]>>8}function gn(){_r=hn,Sr=pn,Nr=mn,jr=fn}function xn(n,r,i){e[n]=function(e,n,s,a,o,l,c,d,u,h,p,m,f,g,x,v,y){var b,w=y-1>>1,_=o[l+0]|c[d+0]<<16,S=u[h+0]|p[m+0]<<16;t(null!=e);var N=3*_+S+131074>>2;for(r(e[n+0],255&N,N>>16,f,g),null!=s&&(N=3*S+_+131074>>2,r(s[a+0],255&N,N>>16,x,v)),b=1;b<=w;++b){var j=o[l+b]|c[d+b]<<16,A=u[h+b]|p[m+b]<<16,M=_+j+S+A+524296,E=M+2*(j+S)>>3;N=E+_>>1,_=(M=M+2*(_+A)>>3)+j>>1,r(e[n+2*b-1],255&N,N>>16,f,g+(2*b-1)*i),r(e[n+2*b-0],255&_,_>>16,f,g+(2*b-0)*i),null!=s&&(N=M+S>>1,_=E+A>>1,r(s[a+2*b-1],255&N,N>>16,x,v+(2*b-1)*i),r(s[a+2*b+0],255&_,_>>16,x,v+(2*b+0)*i)),_=j,S=A}1&y||(N=3*_+S+131074>>2,r(e[n+y-1],255&N,N>>16,f,g+(y-1)*i),null!=s&&(N=3*S+_+131074>>2,r(s[a+y-1],255&N,N>>16,x,v+(y-1)*i)))}}function vn(){gi[Ir]=xi,gi[Fr]=yi,gi[Or]=vi,gi[Dr]=bi,gi[Ur]=wi,gi[zr]=_i,gi[Br]=Si,gi[Vr]=yi,gi[Hr]=bi,gi[Wr]=wi,gi[Gr]=_i}function yn(e){return e&~Ci?0>e?0:255:e>>Ei}function bn(e,t){return yn((19077*e>>8)+(26149*t>>8)-14234)}function wn(e,t,n){return yn((19077*e>>8)-(6419*t>>8)-(13320*n>>8)+8708)}function _n(e,t){return yn((19077*e>>8)+(33050*t>>8)-17685)}function Sn(e,t,n,r,i){r[i+0]=bn(e,n),r[i+1]=wn(e,t,n),r[i+2]=_n(e,t)}function Nn(e,t,n,r,i){r[i+0]=_n(e,t),r[i+1]=wn(e,t,n),r[i+2]=bn(e,n)}function jn(e,t,n,r,i){var s=wn(e,t,n);t=s<<3&224|_n(e,t)>>3,r[i+0]=248&bn(e,n)|s>>5,r[i+1]=t}function An(e,t,n,r,i){var s=240&_n(e,t)|15;r[i+0]=240&bn(e,n)|wn(e,t,n)>>4,r[i+1]=s}function Mn(e,t,n,r,i){r[i+0]=255,Sn(e,t,n,r,i+1)}function En(e,t,n,r,i){Nn(e,t,n,r,i),r[i+3]=255}function Cn(e,t,n,r,i){Sn(e,t,n,r,i),r[i+3]=255}function Ge(e,t){return 0>e?0:e>t?t:e}function kn(t,n,r){e[t]=function(e,t,i,s,a,o,l,c,d){for(var u=c+(-2&d)*r;c!=u;)n(e[t+0],i[s+0],a[o+0],l,c),n(e[t+1],i[s+0],a[o+0],l,c+r),t+=2,++s,++o,c+=2*r;1&d&&n(e[t+0],i[s+0],a[o+0],l,c)}}function Tn(e,t,n){return 0==n?0==e?0==t?6:5:0==t?4:0:n}function Pn(e,t,n,r,i){switch(e>>>30){case 3:sr(t,n,r,i,0);break;case 2:ar(t,n,r,i);break;case 1:lr(t,n,r,i)}}function Ln(e,t){var n,s,a=t.M,o=t.Nb,l=e.oc,c=e.pc+40,d=e.oc,u=e.pc+584,h=e.oc,p=e.pc+600;for(n=0;16>n;++n)l[c+32*n-1]=129;for(n=0;8>n;++n)d[u+32*n-1]=129,h[p+32*n-1]=129;for(0<a?l[c-1-32]=d[u-1-32]=h[p-1-32]=129:(i(l,c-32-1,127,21),i(d,u-32-1,127,9),i(h,p-32-1,127,9)),s=0;s<e.za;++s){var m=t.ya[t.aa+s];if(0<s){for(n=-1;16>n;++n)r(l,c+32*n-4,l,c+32*n+12,4);for(n=-1;8>n;++n)r(d,u+32*n-4,d,u+32*n+4,4),r(h,p+32*n-4,h,p+32*n+4,4)}var f=e.Gd,g=e.Hd+s,x=m.ad,v=m.Hc;if(0<a&&(r(l,c-32,f[g].y,0,16),r(d,u-32,f[g].f,0,8),r(h,p-32,f[g].ea,0,8)),m.Za){var y=l,b=c-32+16;for(0<a&&(s>=e.za-1?i(y,b,f[g].y[15],4):r(y,b,f[g+1].y,0,4)),n=0;4>n;n++)y[b+128+n]=y[b+256+n]=y[b+384+n]=y[b+0+n];for(n=0;16>n;++n,v<<=2)y=l,b=c+Oi[n],ui[m.Ob[n]](y,b),Pn(v,x,16*+n,y,b)}else if(y=Tn(s,a,m.Ob[0]),di[y](l,c),0!=v)for(n=0;16>n;++n,v<<=2)Pn(v,x,16*+n,l,c+Oi[n]);for(n=m.Gc,y=Tn(s,a,m.Dd),hi[y](d,u),hi[y](h,p),v=x,y=d,b=u,255&(m=0|n)&&(170&m?or(v,256,y,b):cr(v,256,y,b)),m=h,v=p,255&(n>>=8)&&(170&n?or(x,320,m,v):cr(x,320,m,v)),a<e.Ub-1&&(r(f[g].y,0,l,c+480,16),r(f[g].f,0,d,u+224,8),r(f[g].ea,0,h,p+224,8)),n=8*o*e.B,f=e.sa,g=e.ta+16*s+16*o*e.R,x=e.qa,m=e.ra+8*s+n,v=e.Ha,y=e.Ia+8*s+n,n=0;16>n;++n)r(f,g+n*e.R,l,c+32*n,16);for(n=0;8>n;++n)r(x,m+n*e.B,d,u+32*n,8),r(v,y+n*e.B,h,p+32*n,8)}}function Rn(e,r,i,s,a,o,l,c,d){var u=[0],h=[0],p=0,m=null!=d?d.kd:0,f=null!=d?d:new nn;if(null==e||12>i)return 7;f.data=e,f.w=r,f.ha=i,r=[r],i=[i],f.gb=[f.gb];e:{var g=r,v=i,y=f.gb;if(t(null!=e),t(null!=v),t(null!=y),y[0]=0,12<=v[0]&&!n(e,g[0],"RIFF")){if(n(e,g[0]+8,"WEBP")){y=3;break e}var b=P(e,g[0]+4);if(12>b||4294967286<b){y=3;break e}if(m&&b>v[0]-8){y=7;break e}y[0]=b,g[0]+=12,v[0]-=12}y=0}if(0!=y)return y;for(b=0<f.gb[0],i=i[0];;){e:{var _=e;v=r,y=i;var S=u,N=h,j=g=[0];if((E=p=[p])[0]=0,8>y[0])y=7;else{if(!n(_,v[0],"VP8X")){if(10!=P(_,v[0]+4)){y=3;break e}if(18>y[0]){y=7;break e}var A=P(_,v[0]+8),M=1+T(_,v[0]+12);if(2147483648<=M*(_=1+T(_,v[0]+15))){y=3;break e}null!=j&&(j[0]=A),null!=S&&(S[0]=M),null!=N&&(N[0]=_),v[0]+=18,y[0]-=18,E[0]=1}y=0}}if(p=p[0],g=g[0],0!=y)return y;if(v=!!(2&g),!b&&p)return 3;if(null!=o&&(o[0]=!!(16&g)),null!=l&&(l[0]=v),null!=c&&(c[0]=0),l=u[0],g=h[0],p&&v&&null==d){y=0;break}if(4>i){y=7;break}if(b&&p||!b&&!p&&!n(e,r[0],"ALPH")){i=[i],f.na=[f.na],f.P=[f.P],f.Sa=[f.Sa];e:{A=e,y=r,b=i;var E=f.gb;S=f.na,N=f.P,j=f.Sa,M=22,t(null!=A),t(null!=b),_=y[0];var C=b[0];for(t(null!=S),t(null!=j),S[0]=null,N[0]=null,j[0]=0;;){if(y[0]=_,b[0]=C,8>C){y=7;break e}var k=P(A,_+4);if(4294967286<k){y=3;break e}var L=8+k+1&-2;if(M+=L,0<E&&M>E){y=3;break e}if(!n(A,_,"VP8 ")||!n(A,_,"VP8L")){y=0;break e}if(C[0]<L){y=7;break e}n(A,_,"ALPH")||(S[0]=A,N[0]=_+8,j[0]=k),_+=L,C-=L}}if(i=i[0],f.na=f.na[0],f.P=f.P[0],f.Sa=f.Sa[0],0!=y)break}i=[i],f.Ja=[f.Ja],f.xa=[f.xa];e:if(E=e,y=r,b=i,S=f.gb[0],N=f.Ja,j=f.xa,A=y[0],_=!n(E,A,"VP8 "),M=!n(E,A,"VP8L"),t(null!=E),t(null!=b),t(null!=N),t(null!=j),8>b[0])y=7;else{if(_||M){if(E=P(E,A+4),12<=S&&E>S-12){y=3;break e}if(m&&E>b[0]-8){y=7;break e}N[0]=E,y[0]+=8,b[0]-=8,j[0]=M}else j[0]=5<=b[0]&&47==E[A+0]&&!(E[A+4]>>5),N[0]=b[0];y=0}if(i=i[0],f.Ja=f.Ja[0],f.xa=f.xa[0],r=r[0],0!=y)break;if(4294967286<f.Ja)return 3;if(null==c||v||(c[0]=f.xa?2:1),l=[l],g=[g],f.xa){if(5>i){y=7;break}c=l,m=g,v=o,null==e||5>i?e=0:5<=i&&47==e[r+0]&&!(e[r+4]>>5)?(b=[0],E=[0],S=[0],x(N=new w,e,r,i),fe(N,b,E,S)?(null!=c&&(c[0]=b[0]),null!=m&&(m[0]=E[0]),null!=v&&(v[0]=S[0]),e=1):e=0):e=0}else{if(10>i){y=7;break}c=g,null==e||10>i||!Ze(e,r+3,i-3)?e=0:(m=e[r+0]|e[r+1]<<8|e[r+2]<<16,v=16383&(e[r+7]<<8|e[r+6]),e=16383&(e[r+9]<<8|e[r+8]),1&m||3<(m>>1&7)||!(m>>4&1)||m>>5>=f.Ja||!v||!e?e=0:(l&&(l[0]=v),c&&(c[0]=e),e=1))}if(!e)return 3;if(l=l[0],g=g[0],p&&(u[0]!=l||h[0]!=g))return 3;null!=d&&(d[0]=f,d.offset=r-d.w,t(4294967286>r-d.w),t(d.offset==d.ha-i));break}return 0==y||7==y&&p&&null==d?(null!=o&&(o[0]|=null!=f.na&&0<f.na.length),null!=s&&(s[0]=l),null!=a&&(a[0]=g),0):y}function In(e,t,n){var r=t.width,i=t.height,s=0,a=0,o=r,l=i;if(t.Da=null!=e&&0<e.Da,t.Da&&(o=e.cd,l=e.bd,s=e.v,a=e.j,11>n||(s&=-2,a&=-2),0>s||0>a||0>=o||0>=l||s+o>r||a+l>i))return 0;if(t.v=s,t.j=a,t.va=s+o,t.o=a+l,t.U=o,t.T=l,t.da=null!=e&&0<e.da,t.da){if(!F(o,l,n=[e.ib],s=[e.hb]))return 0;t.ib=n[0],t.hb=s[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*r/4&&t.hb<3*i/4,t.Kb=0),1}function Fn(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function On(e,t,n,r){if(null==r||0>=e||0>=t)return 2;if(null!=n){if(n.Da){var i=n.cd,a=n.bd,o=-2&n.v,l=-2&n.j;if(0>o||0>l||0>=i||0>=a||o+i>e||l+a>t)return 2;e=i,t=a}if(n.da){if(!F(e,t,i=[n.ib],a=[n.hb]))return 2;e=i[0],t=a[0]}}r.width=e,r.height=t;e:{var c=r.width,d=r.height;if(e=r.S,0>=c||0>=d||!(e>=Ir&&13>e))e=2;else{if(0>=r.Rd&&null==r.sd){o=a=i=t=0;var u=(l=c*zi[e])*d;if(11>e||(a=(d+1)/2*(t=(c+1)/2),12==e&&(o=(i=c)*d)),null==(d=s(u+2*a+o))){e=1;break e}r.sd=d,11>e?((c=r.f.RGBA).eb=d,c.fb=0,c.A=l,c.size=u):((c=r.f.kb).y=d,c.O=0,c.fa=l,c.Fd=u,c.f=d,c.N=0+u,c.Ab=t,c.Cd=a,c.ea=d,c.W=0+u+a,c.Db=t,c.Ed=a,12==e&&(c.F=d,c.J=0+u+2*a),c.Tc=o,c.lb=i)}if(t=1,i=r.S,a=r.width,o=r.height,i>=Ir&&13>i)if(11>i)e=r.f.RGBA,t&=(l=Math.abs(e.A))*(o-1)+a<=e.size,t&=l>=a*zi[i],t&=null!=e.eb;else{e=r.f.kb,l=(a+1)/2,u=(o+1)/2,c=Math.abs(e.fa),d=Math.abs(e.Ab);var h=Math.abs(e.Db),p=Math.abs(e.lb),m=p*(o-1)+a;t&=c*(o-1)+a<=e.Fd,t&=d*(u-1)+l<=e.Cd,t=(t&=h*(u-1)+l<=e.Ed)&c>=a&d>=l&h>=l,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==i&&(t&=p>=a,t&=m<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=n&&n.fd&&(e=Fn(r)),e}var Dn=64,Un=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],zn=24,Bn=32,Vn=8,Hn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];U("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,n){return t[n+0]},e.Predictor3=function(e,t,n){return t[n+1]},e.Predictor4=function(e,t,n){return t[n-1]},e.Predictor5=function(e,t,n){return B(B(e,t[n+1]),t[n+0])},e.Predictor6=function(e,t,n){return B(e,t[n-1])},e.Predictor7=function(e,t,n){return B(e,t[n+0])},e.Predictor8=function(e,t,n){return B(t[n-1],t[n+0])},e.Predictor9=function(e,t,n){return B(t[n+0],t[n+1])},e.Predictor10=function(e,t,n){return B(B(e,t[n-1]),B(t[n+0],t[n+1]))},e.Predictor11=function(e,t,n){var r=t[n+0];return 0>=W(r>>24&255,e>>24&255,(t=t[n-1])>>24&255)+W(r>>16&255,e>>16&255,t>>16&255)+W(r>>8&255,e>>8&255,t>>8&255)+W(255&r,255&e,255&t)?r:e},e.Predictor12=function(e,t,n){var r=t[n+0];return(V((e>>24&255)+(r>>24&255)-((t=t[n-1])>>24&255))<<24|V((e>>16&255)+(r>>16&255)-(t>>16&255))<<16|V((e>>8&255)+(r>>8&255)-(t>>8&255))<<8|V((255&e)+(255&r)-(255&t)))>>>0},e.Predictor13=function(e,t,n){var r=t[n-1];return(H((e=B(e,t[n+0]))>>24&255,r>>24&255)<<24|H(e>>16&255,r>>16&255)<<16|H(e>>8&255,r>>8&255)<<8|H(255&e,255&r))>>>0};var Wn=e.PredictorAdd0;e.PredictorAdd1=G,U("Predictor2","PredictorAdd2"),U("Predictor3","PredictorAdd3"),U("Predictor4","PredictorAdd4"),U("Predictor5","PredictorAdd5"),U("Predictor6","PredictorAdd6"),U("Predictor7","PredictorAdd7"),U("Predictor8","PredictorAdd8"),U("Predictor9","PredictorAdd9"),U("Predictor10","PredictorAdd10"),U("Predictor11","PredictorAdd11"),U("Predictor12","PredictorAdd12"),U("Predictor13","PredictorAdd13");var Gn=e.PredictorAdd2;Z("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),Z("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var qn,Xn=e.ColorIndexInverseTransform,Yn=e.MapARGB,Zn=e.VP8LColorIndexInverseTransformAlpha,Jn=e.MapAlpha,Kn=e.VP8LPredictorsAdd=[];Kn.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var Qn,$n,er,tr,nr,rr,ir,sr,ar,or,lr,cr,dr,ur,hr,pr,mr,fr,gr,xr,vr,yr,br,wr,_r,Sr,Nr,jr,Ar=s(511),Mr=s(2041),Er=s(225),Cr=s(767),kr=0,Tr=Mr,Pr=Er,Lr=Cr,Rr=Ar,Ir=0,Fr=1,Or=2,Dr=3,Ur=4,zr=5,Br=6,Vr=7,Hr=8,Wr=9,Gr=10,qr=[2,3,7],Xr=[3,3,11],Yr=[280,256,256,256,40],Zr=[0,1,1,1,0],Jr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Kr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Qr=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],$r=8,ei=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ti=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ni=null,ri=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ii=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],si=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ai=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],oi=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],li=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ci=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],di=[],ui=[],hi=[],pi=1,mi=2,fi=[],gi=[];xn("UpsampleRgbLinePair",Sn,3),xn("UpsampleBgrLinePair",Nn,3),xn("UpsampleRgbaLinePair",Cn,4),xn("UpsampleBgraLinePair",En,4),xn("UpsampleArgbLinePair",Mn,4),xn("UpsampleRgba4444LinePair",An,2),xn("UpsampleRgb565LinePair",jn,2);var xi=e.UpsampleRgbLinePair,vi=e.UpsampleBgrLinePair,yi=e.UpsampleRgbaLinePair,bi=e.UpsampleBgraLinePair,wi=e.UpsampleArgbLinePair,_i=e.UpsampleRgba4444LinePair,Si=e.UpsampleRgb565LinePair,Ni=16,ji=1<<Ni-1,Ai=-227,Mi=482,Ei=6,Ci=(256<<Ei)-1,ki=0,Ti=s(256),Pi=s(256),Li=s(256),Ri=s(256),Ii=s(Mi-Ai),Fi=s(Mi-Ai);kn("YuvToRgbRow",Sn,3),kn("YuvToBgrRow",Nn,3),kn("YuvToRgbaRow",Cn,4),kn("YuvToBgraRow",En,4),kn("YuvToArgbRow",Mn,4),kn("YuvToRgba4444Row",An,2),kn("YuvToRgb565Row",jn,2);var Oi=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Di=[0,2,8],Ui=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(e,n,o,l,c){var d=Fr,u=new tn,h=new ae;u.ba=h,h.S=d,h.width=[h.width],h.height=[h.height];var p=h.width,m=h.height,f=new oe;if(null==f||null==e)var g=2;else t(null!=f),g=Rn(e,n,o,f.width,f.height,f.Pd,f.Qd,f.format,null);if(0!=g?p=0:(null!=p&&(p[0]=f.width[0]),null!=m&&(m[0]=f.height[0]),p=1),p){h.width=h.width[0],h.height=h.height[0],null!=l&&(l[0]=h.width),null!=c&&(c[0]=h.height);e:{if(l=new qe,(c=new nn).data=e,c.w=n,c.ha=o,c.kd=1,n=[0],t(null!=c),(0==(e=Rn(c.data,c.w,c.ha,null,null,null,n,null,c))||7==e)&&n[0]&&(e=4),0==(n=e)){if(t(null!=u),l.data=c.data,l.w=c.w+c.offset,l.ha=c.ha-c.offset,l.put=pe,l.ac=he,l.bc=me,l.ma=u,c.xa){if(null==(e=Ee())){u=1;break e}if(function(e,n){var r=[0],i=[0],s=[0];t:for(;;){if(null==e)return 0;if(null==n)return e.a=2,0;if(e.l=n,e.a=0,x(e.m,n.data,n.w,n.ha),!fe(e.m,r,i,s)){e.a=3;break t}if(e.xb=mi,n.width=r[0],n.height=i[0],!Ce(r[0],i[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,l)){if(l=0==(n=On(l.width,l.height,u.Oa,u.ba))){t:{l=e;n:for(;;){if(null==l){l=0;break t}if(t(null!=l.s.yc),t(null!=l.s.Ya),t(0<l.s.Wb),t(null!=(o=l.l)),t(null!=(c=o.ma)),0!=l.xb){if(l.ca=c.ba,l.tb=c.tb,t(null!=l.ca),!In(c.Oa,o,Dr)){l.a=2;break n}if(!ke(l,o.width))break n;if(o.da)break n;if((o.da||re(l.ca.S))&&gn(),11>l.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=l.ca.f.kb.F&&gn()),l.Pb&&0<l.s.ua&&null==l.s.vb.X&&!L(l.s.vb,l.s.Wa.Xa)){l.a=1;break n}l.xb=0}if(!Ae(l,l.V,l.Ba,l.c,l.i,o.o,_e))break n;c.Dc=l.Ma,l=1;break t}t(0!=l.a),l=0}l=!l}l&&(n=e.a)}else n=e.a}else{if(null==(e=new Xe)){u=1;break e}if(e.Fa=c.na,e.P=c.P,e.qc=c.Sa,Je(e,l)){if(0==(n=On(l.width,l.height,u.Oa,u.ba))){if(e.Aa=0,o=u.Oa,t(null!=(c=e)),null!=o){if(0<(p=0>(p=o.Md)?0:100<p?255:255*p/100)){for(m=f=0;4>m;++m)12>(g=c.pb[m]).lc&&(g.ia=p*Ui[0>g.lc?0:g.lc]>>3),f|=g.ia;f&&(alert("todo:VP8InitRandom"),c.ia=1)}c.Ga=o.Id,100<c.Ga?c.Ga=100:0>c.Ga&&(c.Ga=0)}(function(e,n){if(null==e)return 0;if(null==n)return Ye(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!Je(e,n))return 0;if(t(e.cb),null==n.ac||n.ac(n)){n.ob&&(e.L=0);var o=Di[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=n.v-o>>4,e.zb=n.j-o>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=n.o+15+o>>4,e.Hb=n.va+15+o>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var l=e.ed;for(o=0;4>o;++o){var c;if(e.Qa.Cb){var d=e.Qa.Lb[o];e.Qa.Fb||(d+=l.Tb)}else d=l.Tb;for(c=0;1>=c;++c){var u=e.gd[o][c],h=d;if(l.Pc&&(h+=l.vd[0],c&&(h+=l.od[0])),0<(h=0>h?0:63<h?63:h)){var p=h;0<l.wb&&(p=4<l.wb?p>>2:p>>1)>9-l.wb&&(p=9-l.wb),1>p&&(p=1),u.dd=p,u.tc=2*h+p,u.ld=40<=h?2:15<=h?1:0}else u.tc=0;u.La=c}}}o=0}else Ye(e,6,"Frame setup failed"),o=e.a;if(o=0==o){if(o){e.$c=0,0<e.Aa||(e.Ic=1);t:{o=e.Ic,l=4*(p=e.za);var m=32*p,f=p+1,g=0<e.L?p*(0<e.Aa?2:1):0,x=(2==e.Aa?2:1)*p;if((u=l+832+(c=3*(16*o+Di[e.L])/2*m)+(d=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=u)o=0;else{if(u>e.Vb){if(e.Vb=0,e.Ec=s(u),e.Fc=0,null==e.Ec){o=Ye(e,1,"no memory during frame initialization.");break t}e.Vb=u}u=e.Ec,h=e.Fc,e.Ac=u,e.Bc=h,h+=l,e.Gd=a(m,He),e.Hd=0,e.rb=a(f+1,Ue),e.sb=1,e.wa=g?a(g,De):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=p),t(!0),e.oc=u,e.pc=h,h+=832,e.ya=a(x,Be),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=p),e.R=16*p,e.B=8*p,p=(m=Di[e.L])*e.R,m=m/2*e.B,e.sa=u,e.ta=h+p,e.qa=e.sa,e.ra=e.ta+16*o*e.R+m,e.Ha=e.qa,e.Ia=e.ra+8*o*e.B+m,e.$c=0,h+=c,e.mb=d?u:null,e.nb=d?h:null,t(h+d<=e.Fc+e.Vb),Qe(e),i(e.Ac,e.Bc,0,l),o=1}}if(o){if(n.ka=0,n.y=e.sa,n.O=e.ta,n.f=e.qa,n.N=e.ra,n.ea=e.Ha,n.Vd=e.Ia,n.fa=e.R,n.Rc=e.B,n.F=null,n.J=0,!kr){for(o=-255;255>=o;++o)Ar[255+o]=0>o?-o:o;for(o=-1020;1020>=o;++o)Mr[1020+o]=-128>o?-128:127<o?127:o;for(o=-112;112>=o;++o)Er[112+o]=-16>o?-16:15<o?15:o;for(o=-255;510>=o;++o)Cr[255+o]=0>o?0:255<o?255:o;kr=1}ir=lt,sr=it,or=st,lr=at,cr=ot,ar=rt,dr=Xt,ur=Yt,hr=Kt,pr=Qt,mr=Zt,fr=Jt,gr=$t,xr=en,vr=Bt,yr=Vt,br=Ht,wr=Wt,ui[0]=St,ui[1]=dt,ui[2]=wt,ui[3]=_t,ui[4]=Nt,ui[5]=At,ui[6]=jt,ui[7]=Mt,ui[8]=Ct,ui[9]=Et,di[0]=gt,di[1]=ht,di[2]=pt,di[3]=mt,di[4]=xt,di[5]=vt,di[6]=yt,hi[0]=Lt,hi[1]=ut,hi[2]=kt,hi[3]=Tt,hi[4]=It,hi[5]=Rt,hi[6]=Ft,o=1}else o=0}o&&(o=function(e,n){for(e.M=0;e.M<e.Va;++e.M){var a,o=e.Jc[e.M&e.Xb],l=e.m,c=e;for(a=0;a<c.za;++a){var d=l,u=c,h=u.Ac,p=u.Bc+4*a,m=u.zc,f=u.ya[u.aa+a];if(u.Qa.Bb?f.$b=E(d,u.Pa.jb[0])?2+E(d,u.Pa.jb[2]):E(d,u.Pa.jb[1]):f.$b=0,u.kc&&(f.Ad=E(d,u.Bd)),f.Za=!E(d,145)+0,f.Za){var g=f.Ob,x=0;for(u=0;4>u;++u){var v,y=m[0+u];for(v=0;4>v;++v){y=oi[h[p+v]][y];for(var b=si[E(d,y[0])];0<b;)b=si[2*b+E(d,y[b])];y=-b,h[p+v]=y}r(g,x,h,p,4),x+=4,m[0+u]=y}}else y=E(d,156)?E(d,128)?1:3:E(d,163)?2:0,f.Ob[0]=y,i(h,p,y,4),i(m,0,y,4);f.Dd=E(d,142)?E(d,114)?E(d,183)?1:3:2:0}if(c.m.Ka)return Ye(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(c=o,d=(l=e).rb[l.sb-1],h=l.rb[l.sb+l.ja],a=l.ya[l.aa+l.ja],p=l.kc?a.Ad:0)d.la=h.la=0,a.Za||(d.Na=h.Na=0),a.Hc=0,a.Gc=0,a.ia=0;else{var w,_;if(d=h,h=c,p=l.Pa.Xc,m=l.ya[l.aa+l.ja],f=l.pb[m.$b],u=m.ad,g=0,x=l.rb[l.sb-1],y=v=0,i(u,g,0,384),m.Za)var S=0,N=p[3];else{b=s(16);var j=d.Na+x.Na;if(j=ni(h,p[1],j,f.Eb,0,b,0),d.Na=x.Na=(0<j)+0,1<j)ir(b,0,u,g);else{var A=b[0]+3>>3;for(b=0;256>b;b+=16)u[g+b]=A}S=1,N=p[0]}var M=15&d.la,C=15&x.la;for(b=0;4>b;++b){var k=1&C;for(A=_=0;4>A;++A)M=M>>1|(k=(j=ni(h,N,j=k+(1&M),f.Sc,S,u,g))>S)<<7,_=_<<2|(3<j?3:1<j?2:0!=u[g+0]),g+=16;M>>=4,C=C>>1|k<<7,v=(v<<8|_)>>>0}for(N=M,S=C>>4,w=0;4>w;w+=2){for(_=0,M=d.la>>4+w,C=x.la>>4+w,b=0;2>b;++b){for(k=1&C,A=0;2>A;++A)j=k+(1&M),M=M>>1|(k=0<(j=ni(h,p[2],j,f.Qc,0,u,g)))<<3,_=_<<2|(3<j?3:1<j?2:0!=u[g+0]),g+=16;M>>=2,C=C>>1|k<<5}y|=_<<4*w,N|=M<<4<<w,S|=(240&C)<<w}d.la=N,x.la=S,m.Hc=v,m.Gc=y,m.ia=43690&y?0:f.ia,p=!(v|y)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[a.$b][a.Za],l.wa[l.Y+l.ja].La|=!p),c.Ka)return Ye(e,7,"Premature end-of-file encountered.")}if(Qe(e),l=n,c=1,a=(o=e).D,d=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)t:{if(a.M=o.M,a.uc=d,Ln(o,a),c=1,a=(_=o.D).Nb,d=(y=Di[o.L])*o.R,h=y/2*o.B,b=16*a*o.R,A=8*a*o.B,p=o.sa,m=o.ta-d+b,f=o.qa,u=o.ra-h+A,g=o.Ha,x=o.Ia-h+A,C=0==(M=_.M),v=M>=o.Va-1,2==o.Aa&&Ln(o,_),_.uc)for(k=(j=o).D.M,t(j.D.uc),_=j.yb;_<j.Hb;++_){S=_,N=k;var T=(P=(B=j).D).Nb;w=B.R;var P=P.wa[P.Y+S],L=B.sa,R=B.ta+16*T*w+16*S,I=P.dd,F=P.tc;if(0!=F)if(t(3<=F),1==B.L)0<S&&yr(L,R,w,F+4),P.La&&wr(L,R,w,F),0<N&&vr(L,R,w,F+4),P.La&&br(L,R,w,F);else{var O=B.B,D=B.qa,U=B.ra+8*T*O+8*S,z=B.Ha,B=B.Ia+8*T*O+8*S;T=P.ld,0<S&&(ur(L,R,w,F+4,I,T),pr(D,U,z,B,O,F+4,I,T)),P.La&&(fr(L,R,w,F,I,T),xr(D,U,z,B,O,F,I,T)),0<N&&(dr(L,R,w,F+4,I,T),hr(D,U,z,B,O,F+4,I,T)),P.La&&(mr(L,R,w,F,I,T),gr(D,U,z,B,O,F,I,T))}}if(o.ia&&alert("todo:DitherRow"),null!=l.put){if(_=16*M,M=16*(M+1),C?(l.y=o.sa,l.O=o.ta+b,l.f=o.qa,l.N=o.ra+A,l.ea=o.Ha,l.W=o.Ia+A):(_-=y,l.y=p,l.O=m,l.f=f,l.N=u,l.ea=g,l.W=x),v||(M-=y),M>l.o&&(M=l.o),l.F=null,l.J=null,null!=o.Fa&&0<o.Fa.length&&_<M&&(l.J=un(o,l,_,M-_),l.F=o.mb,null==l.F&&0==l.F.length)){c=Ye(o,3,"Could not decode alpha data.");break t}_<l.j&&(y=l.j-_,_=l.j,t(!(1&y)),l.O+=o.R*y,l.N+=o.B*(y>>1),l.W+=o.B*(y>>1),null!=l.F&&(l.J+=l.width*y)),_<M&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=_-l.j,l.U=l.va-l.v,l.T=M-_,c=l.put(l))}a+1!=o.Ic||v||(r(o.sa,o.ta-d,p,m+16*o.R,d),r(o.qa,o.ra-h,f,u+8*o.B,h),r(o.Ha,o.Ia-h,g,x+8*o.B,h))}if(!c)return Ye(e,6,"Output aborted.")}return 1}(e,n)),null!=n.bc&&n.bc(n),o&=1}return o?(e.cb=0,o):0})(e,l)||(n=e.a)}}else n=e.a}0==n&&null!=u.Oa&&u.Oa.fd&&(n=Fn(u.ba))}u=n}d=0!=u?null:11>d?h.f.RGBA.eb:h.f.kb.y}else d=null;return d};var zi=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(e,t){for(var n="",r=0;r<4;r++)n+=String.fromCharCode(e[t++]);return n}function d(e,t){return e[t+0]|e[t+1]<<8}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function h(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new l;var p=[0],m=[0],f=[],g=new l,x=e,v=function(e,t){var n={},r=0,i=!1,s=0,a=0;if(n.frames=[],!function(e,t){for(var n=0;n<4;n++)if(e[t+n]!="RIFF".charCodeAt(n))return!0;return!1}(e,t)){for(h(e,t+=4),t+=8;t<e.length;){var o=c(e,t),l=h(e,t+=4);t+=4;var p=l+(1&l);switch(o){case"VP8 ":case"VP8L":void 0===n.frames[r]&&(n.frames[r]={}),(g=n.frames[r]).src_off=i?a:t-8,g.src_size=s+l+8,r++,i&&(i=!1,s=0,a=0);break;case"VP8X":(g=n.header={}).feature_flags=e[t];var m=t+4;g.canvas_width=1+u(e,m),m+=3,g.canvas_height=1+u(e,m),m+=3;break;case"ALPH":i=!0,s=p+8,a=t-8;break;case"ANIM":(g=n.header).bgcolor=h(e,t),m=t+4,g.loop_count=d(e,m),m+=2;break;case"ANMF":var f,g;(g=n.frames[r]={}).offset_x=2*u(e,t),t+=3,g.offset_y=2*u(e,t),t+=3,g.width=1+u(e,t),t+=3,g.height=1+u(e,t),t+=3,g.duration=u(e,t),t+=3,f=e[t++],g.dispose=1&f,g.blend=f>>1&1}"ANMF"!=o&&(t+=p)}return n}}(x,0);v.response=x,v.rgbaoutput=!0,v.dataurl=!1;var y=v.header?v.header:null,b=v.frames?v.frames:null;if(y){y.loop_counter=y.loop_count,p=[y.canvas_height],m=[y.canvas_width];for(var w=0;w<b.length&&0!=b[w].blend;w++);}var _=b[0],S=g.WebPDecodeRGBA(x,_.src_off,_.src_size,m,p);_.rgba=S,_.imgwidth=m[0],_.imgheight=p[0];for(var N=0;N<m[0]*p[0]*4;N++)f[N]=S[N];return this.width=m,this.height=p,this.data=f,this}!function(e){var t,n,r,i,s,a,o,l,c,d=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new l,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new a,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new a,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new u(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new d}]);var u=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var n=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return n},set:function(e){n=Boolean(e)}});var r=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var i=0;Object.defineProperty(this,"posX",{get:function(){return i},set:function(e){isNaN(e)||(i=e)}});var s=0;Object.defineProperty(this,"posY",{get:function(){return s},set:function(e){isNaN(e)||(s=e)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),c.margin=t}});var a=!1;Object.defineProperty(this,"autoPaging",{get:function(){return a},set:function(e){a=e}});var o=0;Object.defineProperty(this,"lastBreak",{get:function(){return o},set:function(e){o=e}});var l=[];Object.defineProperty(this,"pageBreaks",{get:function(){return l},set:function(e){l=e}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(e){e instanceof d&&(c=e)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(e){c.path=e}});var u=[];Object.defineProperty(this,"ctxStack",{get:function(){return u},set:function(e){u=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=h(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=h(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var p=null,m=null;Object.defineProperty(this,"fontFaces",{get:function(){return m},set:function(e){p=null,m=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var n=t[1];t[2];var r=t[3],i=t[4];t[5];var s=t[6],a=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(i)[2];i="px"===a?Math.floor(parseFloat(i)*this.pdf.internal.scaleFactor):"em"===a?Math.floor(parseFloat(i)*this.pdf.getFontSize()):Math.floor(parseFloat(i)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(i);var o=function(e){var t,n,r=[],i=e.trim();if(""===i)return vg;if(i in ig)return[ig[i]];for(;""!==i;){switch(n=null,t=(i=ag(i)).charAt(0)){case'"':case"'":n=og(i.substring(1),t);break;default:n=lg(i)}if(null===n)return vg;if(r.push(n[0]),""!==(i=ag(n[1]))&&","!==i.charAt(0))return vg;i=i.replace(/^,/,"")}return r}(s);if(this.fontFaces){var l=function(e,t){if(null===p){var n=function(e){var t=[];return Object.keys(e).forEach(function(n){e[n].forEach(function(e){var r=null;switch(e){case"bold":r={family:n,weight:"bold"};break;case"italic":r={family:n,style:"italic"};break;case"bolditalic":r={family:n,weight:"bold",style:"italic"};break;case"":case"normal":r={family:n}}null!==r&&(r.ref={name:n,style:e},t.push(r))})}),t}(e.getFontList());p=function(e){for(var t={},n=0;n<e.length;++n){var r=tg(e[n]),i=r.family,s=r.stretch,a=r.style,o=r.weight;t[i]=t[i]||{},t[i][s]=t[i][s]||{},t[i][s][a]=t[i][s][a]||{},t[i][s][a][o]=r}return t}(n.concat(t))}return p}(this.pdf,this.fontFaces),c=o.map(function(e){return{family:e,stretch:"normal",weight:r,style:n}}),d=function(e,t,n){for(var r=(n=n||{}).defaultFontFamily||"times",i=Object.assign({},rg,n.genericFontFamilies||{}),s=null,a=null,o=0;o<t.length;++o)if(i[(s=tg(t[o])).family]&&(s.family=i[s.family]),e.hasOwnProperty(s.family)){a=e[s.family];break}if(!(a=a||e[r]))throw new Error("Could not find a font-family for the rule '"+sg(s)+"' and default family '"+r+"'.");if(a=function(e,t){if(t[e])return t[e];var n=Qf[e],r=n<=Qf.normal?-1:1,i=ng(t,Kf,n,r);if(!i)throw new Error("Could not find a matching font-stretch value for "+e);return i}(s.stretch,a),a=function(e,t){if(t[e])return t[e];for(var n=Jf[e],r=0;r<n.length;++r)if(t[n[r]])return t[n[r]];throw new Error("Could not find a matching font-style for "+e)}(s.style,a),!(a=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var n=eg[e],r=ng(t,$f,n,e<400?-1:1);if(!r)throw new Error("Could not find a matching font-weight for value "+e);return r}(s.weight,a)))throw new Error("Failed to resolve a font for the rule '"+sg(s)+"'.");return a}(l,c);this.pdf.setFont(d.ref.name,d.ref.style)}else{var u="";("bold"===r||parseInt(r,10)>=700||"bold"===n)&&(u="bold"),"italic"===n&&(u+="italic"),0===u.length&&(u="normal");for(var h="",m={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},f=0;f<o.length;f++){if(void 0!==this.pdf.internal.getFont(o[f],u,{noFallback:!0,disableWarning:!0})){h=o[f];break}if("bolditalic"===u&&void 0!==this.pdf.internal.getFont(o[f],"bold",{noFallback:!0,disableWarning:!0}))h=o[f],u="bold";else if(void 0!==this.pdf.internal.getFont(o[f],"normal",{noFallback:!0,disableWarning:!0})){h=o[f],u="normal";break}}if(""===h)for(var g=0;g<o.length;g++)if(m[o[g]]){h=m[o[g]];break}h=""===h?"Times":h,this.pdf.setFont(h,u)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,O.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,O.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};u.prototype.setLineDash=function(e){this.lineDash=e},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){b.call(this,"fill",!1)},u.prototype.stroke=function(){b.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw km.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var n=this.ctx.transform.applyToPoint(new a(e,t));this.path.push({type:"mt",x:n.x,y:n.y}),this.ctx.lastPoint=new a(e,t)},u.prototype.closePath=function(){var e=new a(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===(0,xc.A)(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new a(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(e.x,e.y)},u.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw km.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var n=this.ctx.transform.applyToPoint(new a(e,t));this.path.push({type:"lt",x:n.x,y:n.y}),this.ctx.lastPoint=new a(n.x,n.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),b.call(this,null,!0)},u.prototype.quadraticCurveTo=function(e,t,n,r){if(isNaN(n)||isNaN(r)||isNaN(e)||isNaN(t))throw km.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var i=this.ctx.transform.applyToPoint(new a(n,r)),s=this.ctx.transform.applyToPoint(new a(e,t));this.path.push({type:"qct",x1:s.x,y1:s.y,x:i.x,y:i.y}),this.ctx.lastPoint=new a(i.x,i.y)},u.prototype.bezierCurveTo=function(e,t,n,r,i,s){if(isNaN(i)||isNaN(s)||isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw km.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var o=this.ctx.transform.applyToPoint(new a(i,s)),l=this.ctx.transform.applyToPoint(new a(e,t)),c=this.ctx.transform.applyToPoint(new a(n,r));this.path.push({type:"bct",x1:l.x,y1:l.y,x2:c.x,y2:c.y,x:o.x,y:o.y}),this.ctx.lastPoint=new a(o.x,o.y)},u.prototype.arc=function(e,t,n,r,i,s){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i))throw km.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(s=Boolean(s),!this.ctx.transform.isIdentity){var o=this.ctx.transform.applyToPoint(new a(e,t));e=o.x,t=o.y;var l=this.ctx.transform.applyToPoint(new a(0,n)),c=this.ctx.transform.applyToPoint(new a(0,0));n=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2))}Math.abs(i-r)>=2*Math.PI&&(r=0,i=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:n,startAngle:r,endAngle:i,counterclockwise:s})},u.prototype.arcTo=function(e,t,n,r,i){throw new Error("arcTo not implemented.")},u.prototype.rect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw km.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+r),this.lineTo(e,t+r),this.lineTo(e,t),this.lineTo(e+n,t),this.lineTo(e,t)},u.prototype.fillRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw km.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var i={};"butt"!==this.lineCap&&(i.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(i.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,n,r),this.fill(),i.hasOwnProperty("lineCap")&&(this.lineCap=i.lineCap),i.hasOwnProperty("lineJoin")&&(this.lineJoin=i.lineJoin)}},u.prototype.strokeRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw km.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(e,t,n,r),this.stroke())},u.prototype.clearRect=function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r))throw km.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,n,r))},u.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var r=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=r}},u.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,n=0;n<this.pdf.internal.getNumberOfPages();n++)this.pdf.setPage(n+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(e){var t,n,r,i;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,n=0,r=0,i=0;else{var s=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==s)t=parseInt(s[1]),n=parseInt(s[2]),r=parseInt(s[3]),i=1;else if(null!==(s=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(s[1]),n=parseInt(s[2]),r=parseInt(s[3]),i=parseFloat(s[4]);else{if(i=1,"string"==typeof e&&"#"!==e.charAt(0)){var a=new Im(e);e=a.ok?a.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,n=e.substring(2,3),n+=n,r=e.substring(3,4),r+=r):(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7)),t=parseInt(t,16),n=parseInt(n,16),r=parseInt(r,16)}}return{r:t,g:n,b:r,a:i,style:e}},p=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},m=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};u.prototype.fillText=function(e,t,n,r){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw km.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(r=isNaN(r)?void 0:r,!p.call(this)){var i=R(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;E.call(this,{text:e,x:t,y:n,scale:s,angle:i,align:this.textAlign,maxWidth:r})}},u.prototype.strokeText=function(e,t,n,r){if(isNaN(t)||isNaN(n)||"string"!=typeof e)throw km.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){r=isNaN(r)?void 0:r;var i=R(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;E.call(this,{text:e,x:t,y:n,scale:s,renderingMode:"stroke",angle:i,align:this.textAlign,maxWidth:r})}},u.prototype.measureText=function(e){if("string"!=typeof e)throw km.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,n=this.pdf.internal.scaleFactor,r=t.internal.getFontSize(),i=t.getStringUnitWidth(e)*r/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:i*=Math.round(96*n/72*1e4)/1e4})},u.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw km.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var n=new l(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(n)},u.prototype.rotate=function(e){if(isNaN(e))throw km.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new l(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},u.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw km.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var n=new l(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(n)},u.prototype.transform=function(e,t,n,r,i,s){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(i)||isNaN(s))throw km.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var a=new l(e,t,n,r,i,s);this.ctx.transform=this.ctx.transform.multiply(a)},u.prototype.setTransform=function(e,t,n,r,i,s){e=isNaN(e)?1:e,t=isNaN(t)?0:t,n=isNaN(n)?0:n,r=isNaN(r)?1:r,i=isNaN(i)?0:i,s=isNaN(s)?0:s,this.ctx.transform=new l(e,t,n,r,i,s)};var f=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(e,t,n,r,i,s,a,c,d){var u=this.pdf.getImageProperties(e),h=1,p=1,m=1,x=1;void 0!==r&&void 0!==c&&(m=c/r,x=d/i,h=u.width/r*c/r,p=u.height/i*d/i),void 0===s&&(s=t,a=n,t=0,n=0),void 0!==r&&void 0===c&&(c=r,d=i),void 0===r&&void 0===c&&(c=u.width,d=u.height);for(var b,_=this.ctx.transform.decompose(),S=R(_.rotate.shx),N=new l,j=(N=(N=(N=N.multiply(_.translate)).multiply(_.skew)).multiply(_.scale)).applyToRectangle(new o(s-t*m,a-n*x,r*h,i*p)),A=g.call(this,j),M=[],E=0;E<A.length;E+=1)-1===M.indexOf(A[E])&&M.push(A[E]);if(y(M),this.autoPaging)for(var C=M[0],k=M[M.length-1],T=C;T<k+1;T++){this.pdf.setPage(T);var P=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],L=1===T?this.posY+this.margin[0]:this.margin[0],I=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],F=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],O=1===T?0:I+(T-2)*F;if(0!==this.ctx.clip_path.length){var D=this.path;b=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(b,this.posX+this.margin[3],-O+L+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=D}var U=JSON.parse(JSON.stringify(j));U=v([U],this.posX+this.margin[3],-O+L+this.ctx.prevPageLastElemOffset)[0];var z=(T>C||T<k)&&f.call(this);z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],P,F,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",U.x,U.y,U.w,U.h,null,null,S),z&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",j.x,j.y,j.w,j.h,null,null,S)};var g=function(e,t,n){var r=[];t=t||this.pdf.internal.pageSize.width,n=n||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var i=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":r.push(Math.floor((e.y+i)/n)+1);break;case"arc":r.push(Math.floor((e.y+i-e.radius)/n)+1),r.push(Math.floor((e.y+i+e.radius)/n)+1);break;case"qct":var s=I(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);r.push(Math.floor((s.y+i)/n)+1),r.push(Math.floor((s.y+s.h+i)/n)+1);break;case"bct":var a=F(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);r.push(Math.floor((a.y+i)/n)+1),r.push(Math.floor((a.y+a.h+i)/n)+1);break;case"rect":r.push(Math.floor((e.y+i)/n)+1),r.push(Math.floor((e.y+e.h+i)/n)+1)}for(var o=0;o<r.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<r[o];)x.call(this);return r},x=function(){var e=this.fillStyle,t=this.strokeStyle,n=this.font,r=this.lineCap,i=this.lineWidth,s=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=n,this.lineCap=r,this.lineWidth=i,this.lineJoin=s},v=function(e,t,n){for(var r=0;r<e.length;r++)switch(e[r].type){case"bct":e[r].x2+=t,e[r].y2+=n;case"qct":e[r].x1+=t,e[r].y1+=n;default:e[r].x+=t,e[r].y+=n}return e},y=function(e){return e.sort(function(e,t){return e-t})},b=function(e,t){for(var n,r,i=this.fillStyle,s=this.strokeStyle,a=this.lineCap,o=this.lineWidth,l=Math.abs(o*this.ctx.transform.scaleX),c=this.lineJoin,d=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),h=[],p=0;p<u.length;p++)if(void 0!==u[p].x)for(var m=g.call(this,u[p]),b=0;b<m.length;b+=1)-1===h.indexOf(m[b])&&h.push(m[b]);for(var _=0;_<h.length;_++)for(;this.pdf.internal.getNumberOfPages()<h[_];)x.call(this);if(y(h),this.autoPaging)for(var S=h[0],N=h[h.length-1],j=S;j<N+1;j++){this.pdf.setPage(j),this.fillStyle=i,this.strokeStyle=s,this.lineCap=a,this.lineWidth=l,this.lineJoin=c;var A=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],M=1===j?this.posY+this.margin[0]:this.margin[0],E=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],C=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],k=1===j?0:E+(j-2)*C;if(0!==this.ctx.clip_path.length){var T=this.path;n=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(n,this.posX+this.margin[3],-k+M+this.ctx.prevPageLastElemOffset),w.call(this,e,!0),this.path=T}if(r=JSON.parse(JSON.stringify(d)),this.path=v(r,this.posX+this.margin[3],-k+M+this.ctx.prevPageLastElemOffset),!1===t||0===j){var P=(j>S||j<N)&&f.call(this);P&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],A,C,null).clip().discardPath()),w.call(this,e,t),P&&this.pdf.restoreGraphicsState()}this.lineWidth=o}else this.lineWidth=l,w.call(this,e,t),this.lineWidth=o;this.path=d},w=function(e,t){if(("stroke"!==e||t||!m.call(this))&&("stroke"===e||t||!p.call(this))){for(var n,r,i=[],s=this.path,a=0;a<s.length;a++){var o=s[a];switch(o.type){case"begin":i.push({begin:!0});break;case"close":i.push({close:!0});break;case"mt":i.push({start:o,deltas:[],abs:[]});break;case"lt":var l=i.length;if(s[a-1]&&!isNaN(s[a-1].x)&&(n=[o.x-s[a-1].x,o.y-s[a-1].y],l>0))for(;l>=0;l--)if(!0!==i[l-1].close&&!0!==i[l-1].begin){i[l-1].deltas.push(n),i[l-1].abs.push(o);break}break;case"bct":n=[o.x1-s[a-1].x,o.y1-s[a-1].y,o.x2-s[a-1].x,o.y2-s[a-1].y,o.x-s[a-1].x,o.y-s[a-1].y],i[i.length-1].deltas.push(n);break;case"qct":var c=s[a-1].x+2/3*(o.x1-s[a-1].x),d=s[a-1].y+2/3*(o.y1-s[a-1].y),u=o.x+2/3*(o.x1-o.x),h=o.y+2/3*(o.y1-o.y),f=o.x,g=o.y;n=[c-s[a-1].x,d-s[a-1].y,u-s[a-1].x,h-s[a-1].y,f-s[a-1].x,g-s[a-1].y],i[i.length-1].deltas.push(n);break;case"arc":i.push({deltas:[],abs:[],arc:!0}),Array.isArray(i[i.length-1].abs)&&i[i.length-1].abs.push(o)}}r=t?null:"stroke"===e?"stroke":"fill";for(var x=!1,v=0;v<i.length;v++)if(i[v].arc)for(var y=i[v].abs,b=0;b<y.length;b++){var w=y[b];"arc"===w.type?N.call(this,w.x,w.y,w.radius,w.startAngle,w.endAngle,w.counterclockwise,void 0,t,!x):C.call(this,w.x,w.y),x=!0}else if(!0===i[v].close)this.pdf.internal.out("h"),x=!1;else if(!0!==i[v].begin){var _=i[v].start.x,S=i[v].start.y;k.call(this,i[v].deltas,_,S),x=!0}r&&j.call(this,r),t&&A.call(this)}},_=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,n=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-n;case"top":return e+t-n;case"hanging":return e+t-2*n;case"middle":return e+t/2-n;default:return e}},S=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var N=function(e,t,n,r,i,s,a,o,l){for(var c=P.call(this,n,r,i,s),d=0;d<c.length;d++){var u=c[d];0===d&&(l?M.call(this,u.x1+e,u.y1+t):C.call(this,u.x1+e,u.y1+t)),T.call(this,e,t,u.x2,u.y2,u.x3,u.y3,u.x4,u.y4)}o?A.call(this):j.call(this,a)},j=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},A=function(){this.pdf.clip(),this.pdf.discardPath()},M=function(e,t){this.pdf.internal.out(n(e)+" "+r(t)+" m")},E=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var n=this.pdf.getTextDimensions(e.text),r=_.call(this,e.y),i=S.call(this,r)-n.h,s=this.ctx.transform.applyToPoint(new a(e.x,r)),c=this.ctx.transform.decompose(),d=new l;d=(d=(d=d.multiply(c.translate)).multiply(c.skew)).multiply(c.scale);for(var u,h,p,m=this.ctx.transform.applyToRectangle(new o(e.x,r,n.w,n.h)),x=d.applyToRectangle(new o(e.x,i,n.w,n.h)),b=g.call(this,x),N=[],j=0;j<b.length;j+=1)-1===N.indexOf(b[j])&&N.push(b[j]);if(y(N),this.autoPaging)for(var A=N[0],M=N[N.length-1],E=A;E<M+1;E++){this.pdf.setPage(E);var C=1===E?this.posY+this.margin[0]:this.margin[0],k=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],T=this.pdf.internal.pageSize.height-this.margin[2],P=T-this.margin[0],L=this.pdf.internal.pageSize.width-this.margin[1],R=L-this.margin[3],I=1===E?0:k+(E-2)*P;if(0!==this.ctx.clip_path.length){var F=this.path;u=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(u,this.posX+this.margin[3],-1*I+C),w.call(this,"fill",!0),this.path=F}var O=v([JSON.parse(JSON.stringify(x))],this.posX+this.margin[3],-I+C+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(h=this.pdf.internal.getFontSize(),this.pdf.setFontSize(h*e.scale),p=this.lineWidth,this.lineWidth=p*e.scale);var D="text"!==this.autoPaging;if(D||O.y+O.h<=T){if(D||O.y>=C&&O.x<=L){var U=D?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||L-O.x)[0],z=v([JSON.parse(JSON.stringify(m))],this.posX+this.margin[3],-I+C+this.ctx.prevPageLastElemOffset)[0],B=D&&(E>A||E<M)&&f.call(this);B&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],R,P,null).clip().discardPath()),this.pdf.text(U,z.x,z.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),B&&this.pdf.restoreGraphicsState()}}else O.y<T&&(this.ctx.prevPageLastElemOffset+=T-O.y);e.scale>=.01&&(this.pdf.setFontSize(h),this.lineWidth=p)}else e.scale>=.01&&(h=this.pdf.internal.getFontSize(),this.pdf.setFontSize(h*e.scale),p=this.lineWidth,this.lineWidth=p*e.scale),this.pdf.text(e.text,s.x+this.posX,s.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(h),this.lineWidth=p)},C=function(e,t,i,s){i=i||0,s=s||0,this.pdf.internal.out(n(e+i)+" "+r(t+s)+" l")},k=function(e,t,n){return this.pdf.lines(e,t,n,null,null)},T=function(e,n,r,a,o,l,c,d){this.pdf.internal.out([t(i(r+e)),t(s(a+n)),t(i(o+e)),t(s(l+n)),t(i(c+e)),t(s(d+n)),"c"].join(" "))},P=function(e,t,n,r){for(var i=2*Math.PI,s=Math.PI/2;t>n;)t-=i;var a=Math.abs(n-t);a<i&&r&&(a=i-a);for(var o=[],l=r?-1:1,c=t;a>1e-5;){var d=c+l*Math.min(a,s);o.push(L.call(this,e,c,d)),a-=Math.abs(d-c),c=d}return o},L=function(e,t,n){var r=(n-t)/2,i=e*Math.cos(r),s=e*Math.sin(r),a=i,o=-s,l=a*a+o*o,c=l+a*i+o*s,d=4/3*(Math.sqrt(2*l*c)-c)/(a*s-o*i),u=a-d*o,h=o+d*a,p=u,m=-h,f=r+t,g=Math.cos(f),x=Math.sin(f);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:u*g-h*x,y2:u*x+h*g,x3:p*g-m*x,y3:p*x+m*g,x4:e*Math.cos(n),y4:e*Math.sin(n)}},R=function(e){return 180*e/Math.PI},I=function(e,t,n,r,i,s){var a=e+.5*(n-e),l=t+.5*(r-t),c=i+.5*(n-i),d=s+.5*(r-s),u=Math.min(e,i,a,c),h=Math.max(e,i,a,c),p=Math.min(t,s,l,d),m=Math.max(t,s,l,d);return new o(u,p,h-u,m-p)},F=function(e,t,n,r,i,s,a,l){var c,d,u,h,p,m,f,g,x,v,y,b,w,_,S=n-e,N=r-t,j=i-n,A=s-r,M=a-i,E=l-s;for(d=0;d<41;d++)x=(f=(u=e+(c=d/40)*S)+c*((p=n+c*j)-u))+c*(p+c*(i+c*M-p)-f),v=(g=(h=t+c*N)+c*((m=r+c*A)-h))+c*(m+c*(s+c*E-m)-g),0==d?(y=x,b=v,w=x,_=v):(y=Math.min(y,x),b=Math.min(b,v),w=Math.max(w,x),_=Math.max(_,v));return new o(Math.round(y),Math.round(b),Math.round(w-y),Math.round(_-b))},O=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,n=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==n&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=n)}}}(lf.API),function(e){var t=function(e){var t,n,r,i,s,a,o,l,c,d;for(/[^\x00-\xFF]/.test(e),n=[],r=0,i=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;i>r;r+=4)0!==(s=(e.charCodeAt(r)<<24)+(e.charCodeAt(r+1)<<16)+(e.charCodeAt(r+2)<<8)+e.charCodeAt(r+3))?(a=(s=((s=((s=((s=(s-(d=s%85))/85)-(c=s%85))/85)-(l=s%85))/85)-(o=s%85))/85)%85,n.push(a+33,o+33,l+33,c+33,d+33)):n.push(122);return function(e,t){for(var n=t;n>0;n--)e.pop()}(n,t.length),String.fromCharCode.apply(String,n)+"~>"},n=function(e){var t,n,r,i,s,a=String,o="length",l=255,c="charCodeAt",d="slice",u="replace";for(e[d](-2),e=e[d](0,-2)[u](/\s/g,"")[u]("z","!!!!!"),r=[],i=0,s=(e+=t="uuuuu"[d](e[o]%5||5))[o];s>i;i+=5)n=52200625*(e[c](i)-33)+614125*(e[c](i+1)-33)+7225*(e[c](i+2)-33)+85*(e[c](i+3)-33)+(e[c](i+4)-33),r.push(l&n>>24,l&n>>16,l&n>>8,l&n);return function(e,t){for(var n=t;n>0;n--)e.pop()}(r,t[o]),a.fromCharCode.apply(a,r)},r=function(e){return e.split("").map(function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var n="",r=0;r<e.length;r+=2)n+=String.fromCharCode("0x"+(e[r]+e[r+1]));return n},s=function(e){for(var t=new Uint8Array(e.length),n=e.length;n--;)t[n]=e.charCodeAt(n);return(t=td(t)).reduce(function(e,t){return e+String.fromCharCode(t)},"")};e.processDataByFilters=function(e,a){var o=0,l=e||"",c=[];for("string"==typeof(a=a||[])&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=n(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=i(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=r(l),c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=s(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(lf.API),(xg=lf.API).loadFile=function(e,t,n){return function(e,t,n){t=!1!==t,n="function"==typeof n?n:function(){};var r=void 0;try{r=function(e,t,n){var r=new XMLHttpRequest,i=0,s=function(e){var t=e.length,n=[],r=String.fromCharCode;for(i=0;i<t;i+=1)n.push(r(255&e.charCodeAt(i)));return n.join("")};if(r.open("GET",e,!t),r.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(r.onload=function(){200===r.status?n(s(this.responseText)):n(void 0)}),r.send(null),t&&200===r.status)return s(r.responseText)}(e,t,n)}catch(Tc){}return r}(e,t,n)},xg.loadImageFile=xg.loadFile,function(e){function t(){return(Em.html2canvas?Promise.resolve(Em.html2canvas):n.e(239).then(n.t.bind(n,5239,23))).catch(function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))}).then(function(e){return e.default?e.default:e})}function r(){return(Em.DOMPurify?Promise.resolve(Em.DOMPurify):n.e(977).then(n.bind(n,7977))).catch(function(e){return Promise.reject(new Error("Could not load dompurify: "+e))}).then(function(e){return e.default?e.default:e})}var i=function(e){var t=(0,xc.A)(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},s=function(e,t){var n=document.createElement(e);for(var r in t.className&&(n.className=t.className),t.innerHTML&&t.dompurify&&(n.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)n.style[r]=t.style[r];return n},a=function e(t,n){for(var r=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),i=t.firstChild;i;i=i.nextSibling)!0!==n&&1===i.nodeType&&"SCRIPT"===i.nodeName||r.appendChild(e(i,n));return 1===t.nodeType&&("CANVAS"===t.nodeName?(r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(r.value=t.value),r.addEventListener("load",function(){r.scrollTop=t.scrollTop,r.scrollLeft=t.scrollLeft},!0)),r},o=function e(t){var n=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),r=e.convert(Promise.resolve(),n);return(r=r.setProgress(1,e,1,[e])).set(t)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(e,t){return e.__proto__=t||o.prototype,e},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(e){switch(i(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e),t){case"string":return this.then(r).then(function(t){return this.set({src:s("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},o.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=this.opt.jsPDF,n=this.opt.fontFaces,r="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,i=Object.assign({async:!0,allowTaint:!0,scale:r,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete i.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=n,n)for(var s=0;s<n.length;++s){var a=n[s],o=a.src.find(function(e){return"truetype"===e.format});o&&t.addFont(o.url,a.ref.name,a.ref.style)}return i.windowHeight=i.windowHeight||0,i.windowHeight=0==i.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):i.windowHeight,t.context2d.save(!0),e(this.prop.container,i)}).then(function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(e,t,n){return"img"===(n=n||"pdf").toLowerCase()||"image"===n.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},o.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(e,t)})},o.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},o.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(e){if("object"!==i(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in o.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},o.prototype.get=function(e,t){return this.then(function(){var n=e in o.template.prop?this.prop[e]:this.opt[e];return t?t(n):n})},o.prototype.setMargin=function(e){return this.then(function(){switch(i(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},o.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){(e=e||lf.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},o.prototype.setProgress=function(e,t,n,r){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=n&&(this.progress.n=n),null!=r&&(this.progress.stack=r),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(e,t,n,r){return this.setProgress(e?this.progress.val+e:null,t||null,n?this.progress.n+n:null,r?this.progress.stack.concat(r):null)},o.prototype.then=function(e,t){var n=this;return this.thenCore(e,t,function(e,t){return n.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return n.updateProgress(null,e),t}).then(e,t).then(function(e){return n.updateProgress(1),e})})},o.prototype.thenCore=function(e,t,n){n=n||Promise.prototype.then;var r=this;e&&(e=e.bind(r)),t&&(t=t.bind(r));var i=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?r:o.convert(Object.assign({},r),Promise.prototype),s=n.call(i,e,t);return o.convert(s,r.__proto__)},o.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},o.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},o.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return o.convert(t,this)},o.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},o.prototype.error=function(e){return this.then(function(){throw new Error(e)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,lf.getPageSize=function(e,t,n){if("object"===(0,xc.A)(e)){var r=e;e=r.orientation,t=r.unit||t,n=r.format||n}t=t||"mm",n=n||"a4",e=(""+(e||"P")).toLowerCase();var i,s=(""+n).toLowerCase(),a={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":i=1;break;case"mm":i=72/25.4;break;case"cm":i=72/2.54;break;case"in":i=72;break;case"px":i=.75;break;case"pc":case"em":i=12;break;case"ex":i=6;break;default:throw"Invalid unit: "+t}var o,l=0,c=0;if(a.hasOwnProperty(s))l=a[s][1]/i,c=a[s][0]/i;else try{l=n[1],c=n[0]}catch(Im){throw new Error("Invalid format: "+n)}if("p"===e||"portrait"===e)e="p",c>l&&(o=c,c=l,l=o);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",l>c&&(o=c,c=l,l=o)}return{width:c,height:l,unit:t,k:i,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(tg):null;var n=new o(t);return t.worker?n:n.from(e).doCallback()}}(lf.API),lf.API.addJS=function(e){return ug=e,this.internal.events.subscribe("postPutResources",function(){cg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(cg+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),dg=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+ug+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==cg&&void 0!==dg&&this.internal.out("/Names <</JavaScript "+cg+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),i=0;i<r.length;i++){var s=r[i],a=n.exec(s);if(null!=a){var o=a[1];e.internal.newObjectDeferredBegin(o,!1)}e.internal.write(s)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,c=[];for(i=0;i<l;i++){var d=e.internal.newObject();c.push(d);var u=e.internal.getPageInfo(i+1);e.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var h=e.internal.newObject();for(e.internal.write("<< /Names [ "),i=0;i<c.length;i++)e.internal.write("(page_"+(i+1)+")"+c[i]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+h+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,n){var r={title:t,options:n,children:[]};return null==e&&(e=this.root),e.children.push(r),r},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var n=0;n<t.children.length;n++)this.genIds_r(t.children[n])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,r=0;r<t.children.length;r++){var i=t.children[r];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(t)),r>0&&this.line("/Prev "+this.makeRef(t.children[r-1])),r<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[r+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var s=this.count=this.count_r({count:0},i);if(s>0&&this.line("/Count "+s),i.options&&i.options.pageNumber){var a=e.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+a.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var o=0;o<t.children.length;o++)this.renderItems(t.children[o])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var n=0;n<t.children.length;n++)e.count++,this.count_r(e,t.children[n]);return e.count}}])}(lf.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,n,r,i,s,a){var o,l=this.decode.DCT_DECODE,c=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=s||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,o=function(e){for(var n,r=256*e.charCodeAt(4)+e.charCodeAt(5),i=e.length,s={width:0,height:0,numcomponents:1},a=4;a<i;a+=2){if(a+=r,-1!==t.indexOf(e.charCodeAt(a+1))){n=256*e.charCodeAt(a+5)+e.charCodeAt(a+6),s={width:256*e.charCodeAt(a+7)+e.charCodeAt(a+8),height:n,numcomponents:e.charCodeAt(a+9)};break}r=256*e.charCodeAt(a+2)+e.charCodeAt(a+3)}return s}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),o.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}c={data:e,width:o.width,height:o.height,colorSpace:a,bitsPerComponent:8,filter:l,index:n,alias:r}}return c}}(lf.API),lf.API.processPNG=function(e,t,n,r){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,s=function(e,t){return new Am(e,t).decode()}(e,{checkCrc:!0}),a=s.width,o=s.height,l=s.channels,c=s.palette,d=s.depth;i=c&&1===l?function(e){for(var t=e.width,n=e.height,r=e.data,i=e.palette,s=e.depth,a=!1,o=[],l=[],c=void 0,d=!1,u=0,h=0;h<i.length;h++){var p=id(i[h],4),m=p[0],f=p[1],g=p[2],x=p[3];o.push(m,f,g),null!=x&&(0===x?(u++,l.length<1&&l.push(h)):x<255&&(d=!0))}if(d||u>1){a=!0,l=void 0;var v=t*n;c=new Uint8Array(v);for(var y=new DataView(r.buffer),b=0;b<v;b++){var w=id(i[Mg(y,b,s)],4)[3];c[b]=w}}else 0===u&&(l=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:a?8:void 0,colorBytes:r,alphaBytes:c,needSMask:a,palette:o,mask:l}}(s):2===l||4===l?function(e){for(var t=e.data,n=e.width,r=e.height,i=e.channels,s=e.depth,a=2===i?"DeviceGray":"DeviceRGB",o=i-1,l=n*r,c=o,d=l*c,u=1*l,h=Math.ceil(d*s/8),p=Math.ceil(u*s/8),m=new Uint8Array(h),f=new Uint8Array(p),g=new DataView(t.buffer),x=new DataView(m.buffer),v=new DataView(f.buffer),y=!1,b=0;b<l;b++){for(var w=b*i,_=0;_<c;_++)Eg(x,Mg(g,w+_,s),b*c+_,s);var S=Mg(g,w+c,s);S<(1<<s)-1&&(y=!0),Eg(v,S,1*b,s)}return{colorSpace:a,colorsPerPixel:o,sMaskBitsPerComponent:y?s:void 0,colorBytes:m,alphaBytes:f,needSMask:y}}(s):function(e){var t=e.data,n=1===e.channels?"DeviceGray":"DeviceRGB";return{colorSpace:n,colorsPerPixel:"DeviceGray"===n?1:3,colorBytes:t instanceof Uint16Array?function(e){for(var t=e.length,n=new Uint8Array(2*t),r=new DataView(n.buffer,n.byteOffset,n.byteLength),i=0;i<t;i++)r.setUint16(2*i,e[i],!1);return n}(t):t,needSMask:!1}}(s);var u,h,p,m=i,f=m.colorSpace,g=m.colorsPerPixel,x=m.sMaskBitsPerComponent,v=m.colorBytes,y=m.alphaBytes,b=m.needSMask,w=m.palette,_=m.mask,S=null;return r!==lf.API.image_compression.NONE?(S=function(e){var t;switch(e){case lf.API.image_compression.FAST:t=11;break;case lf.API.image_compression.MEDIUM:t=13;break;case lf.API.image_compression.SLOW:t=14;break;default:t=12}return t}(r),u=this.decode.FLATE_DECODE,h="/Predictor ".concat(S," /Colors ").concat(g," /BitsPerComponent ").concat(d," /Columns ").concat(a),e=yg(v,Math.ceil(a*g*d/8),g,d,r),b&&(p=yg(y,Math.ceil(a*x/8),1,x,r))):(u=void 0,h=void 0,e=v,b&&(p=y)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:n,data:e,index:t,filter:u,decodeParameters:h,transparency:_,palette:w,sMask:p,predictor:S,width:a,height:o,bitsPerComponent:d,sMaskBitsPerComponent:x,colorSpace:f}}},function(e){e.processGIF89A=function(t,n,r,i){var s=new kg(t),a=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},d=new Pg(100).encode(c,100);return e.processJPEG.call(this,d,n,r,i)},e.processGIF87A=e.processGIF89A}(lf.API),Lg.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:r,blue:n,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Lg.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){km.log("bit decode error:"+n)}},Lg.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}0!==n&&(this.pos+=4-n)}},Lg.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+2*i*4,o=s>>4,l=15&s,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*i+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}0!==t&&(this.pos+=4-t)}},Lg.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+4*r;if(i<this.palette.length){var a=this.palette[i];this.data[s]=a.red,this.data[s+1]=a.green,this.data[s+2]=a.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}0!==e&&(this.pos+=4-e)}},Lg.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,c=s>>15?255:0,d=r*this.width*4+4*i;this.data[d]=l,this.data[d+1]=o,this.data[d+2]=a,this.data[d+3]=c}this.pos+=e}},Lg.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&t)/t*255|0,l=(a>>5&n)/n*255|0,c=(a>>11)/t*255|0,d=i*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=255}this.pos+=e}},Lg.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*n;this.data[a]=s,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=255}this.pos+=this.width%4}},Lg.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=r,this.data[o+3]=a}},Lg.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,i){var s=new Lg(t,!1),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new Pg(100).encode(l,100);return e.processJPEG.call(this,c,n,r,i)}}(lf.API),Rg.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,i){var s=new Rg(t),a=s.width,o=s.height,l={data:s.getData(),width:a,height:o},c=new Pg(100).encode(l,100);return e.processJPEG.call(this,c,n,r,i)}}(lf.API),lf.API.processRGBA=function(e,t,n){for(var r=e.data,i=r.length,s=new Uint8Array(i/4*3),a=new Uint8Array(i/4),o=0,l=0,c=0;c<i;c+=4){var d=r[c],u=r[c+1],h=r[c+2],p=r[c+3];s[o++]=d,s[o++]=u,s[o++]=h,a[l++]=p}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:m,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},lf.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},hg=lf.API,pg=hg.getCharWidthsArray=function(e,t){var n,r,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),a=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:i.metadata.Unicode.kerning,d=c.fof?c.fof:1,u=!1!==t.doKerning,h=0,p=e.length,m=0,f=o[0]||l,g=[];for(n=0;n<p;n++)r=e.charCodeAt(n),"function"==typeof i.metadata.widthOfString?g.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(r))+a*(1e3/s)||0)/1e3):(h=u&&"object"===(0,xc.A)(c[r])&&!isNaN(parseInt(c[r][m],10))?c[r][m]/d:0,g.push((o[r]||f)/l+h)),m=r;return g},mg=hg.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return hg.processArabic&&(e=hg.processArabic(e)),"function"==typeof r.metadata.widthOfString?r.metadata.widthOfString(e,n,i)/n:pg.apply(this,arguments).reduce(function(e,t){return e+t},0)},fg=function(e,t,n,r){for(var i=[],s=0,a=e.length,o=0;s!==a&&o+t[s]<n;)o+=t[s],s++;i.push(e.slice(0,s));var l=s;for(o=0;s!==a;)o+t[s]>r&&(i.push(e.slice(l,s)),o=0,l=s),o+=t[s],s++;return l!==s&&i.push(e.slice(l,s)),i},gg=function(e,t,n){n||(n={});var r,i,s,a,o,l,c,d=[],u=[d],h=n.textIndent||0,p=0,m=0,f=e.split(" "),g=pg.apply(this,[" ",n])[0];if(l=-1===n.lineIndent?f[0].length+2:n.lineIndent||0){var x=Array(l).join(" "),v=[];f.map(function(e){(e=e.split(/\s*\n/)).length>1?v=v.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):v.push(e[0])}),f=v,l=mg.apply(this,[x,n])}for(s=0,a=f.length;s<a;s++){var y=0;if(r=f[s],l&&"\n"==r[0]&&(r=r.substr(1),y=1),h+p+(m=(i=pg.apply(this,[r,n])).reduce(function(e,t){return e+t},0))>t||y){if(m>t){for(o=fg.apply(this,[r,i,t-(h+p),t]),d.push(o.shift()),d=[o.pop()];o.length;)u.push([o.shift()]);m=i.slice(r.length-(d[0]?d[0].length:0)).reduce(function(e,t){return e+t},0)}else d=[r];u.push(d),h=m+l,p=g}else d.push(r),h+=p+m,p=g}return c=l?function(e,t){return(t?x:"")+e.join(" ")}:function(e){return e.join(" ")},u.map(c)},hg.splitTextToSize=function(e,t,n){var r,i=(n=n||{}).fontSize||this.internal.getFontSize(),s=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle),n="Unicode";return t.metadata[n]?{widths:t.metadata[n].widths||{0:1},kerning:t.metadata[n].kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var a=1*this.internal.scaleFactor*t/i;s.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=n.lineIndent;var o,l,c=[];for(o=0,l=r.length;o<l;o++)c=c.concat(gg.apply(this,[r[o],a,s]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",n="klmnopqrstuvwxyz",r={},i={},s=0;s<16;s++)r[n[s]]=t[s],i[t[s]]=n[s];var a=function(e){return"0x"+parseInt(e,10).toString(16)},o=e.__fontmetrics__.compress=function(e){var t,n,r,s,l=["{"];for(var c in e){if(t=e[c],isNaN(parseInt(c,10))?n="'"+c+"'":(c=parseInt(c,10),n=(n=a(c).slice(2)).slice(0,-1)+i[n.slice(-1)]),"number"==typeof t)t<0?(r=a(t).slice(3),s="-"):(r=a(t).slice(2),s=""),r=s+r.slice(0,-1)+i[r.slice(-1)];else{if("object"!==(0,xc.A)(t))throw new Error("Don't know what to do with value type "+(0,xc.A)(t)+".");r=o(t)}l.push(n+r)}return l.push("}"),l.join("")},l=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,n,i,s,a={},o=1,l=a,c=[],d="",u="",h=e.length-1,p=1;p<h;p+=1)"'"==(s=e[p])?t?(i=t.join(""),t=void 0):t=[]:t?t.push(s):"{"==s?(c.push([l,i]),l={},i=void 0):"}"==s?((n=c.pop())[0][n[1]]=l,i=void 0,l=n[0]):"-"==s?o=-1:void 0===i?r.hasOwnProperty(s)?(d+=r[s],i=parseInt(d,16)*o,o=1,d=""):d+=s:r.hasOwnProperty(s)?(u+=r[s],l[i]=parseInt(u,16)*o,o=1,i=void 0,u=""):u+=s;return a},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,n=u.Unicode[t.postScriptName];n&&(t.metadata.Unicode={},t.metadata.Unicode.widths=n.widths,t.metadata.Unicode.kerning=n.kerning);var r=d.Unicode[t.postScriptName];r&&(t.metadata.Unicode.encoding=r,t.encoding=r.codePages[0])}])}(lf.API),function(e){var t=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n};e.API.events.push(["addFont",function(n){var r=void 0,i=n.font,s=n.instance;if(!i.isStandardFont){if(void 0===s)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if("string"!=typeof(r=!1===s.existsFileInVFS(i.postScriptName)?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");!function(n,r){r=/^\x00\x01\x00\x00/.test(r)?t(r):t(Fm(r)),n.metadata=e.API.TTFFont.open(r),n.metadata.Unicode=n.metadata.Unicode||{encoding:{},kerning:{},widths:[]},n.metadata.glyIdsUsed=[0]}(i,r)}}])}(lf),lf.API.addSvgAsImage=function(e,t,r,i,s,a,o,l){if(isNaN(t)||isNaN(r))throw km.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw km.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=i,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Em.canvg?Promise.resolve(Em.canvg):n.e(455).then(n.bind(n,8455))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e}).then(function(t){return t.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(e){return e.render(u)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,r,i,s,o,l)})},lf.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var i=0;i<this.internal.pages[r].length;i++)this.internal.pages[r][i]=this.internal.pages[r][i].replace(t,n);return this},lf.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,i,s,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,d=0,u=0;function h(e,t){var n,r=!1;for(n=0;n<e.length;n+=1)e[n]===t&&(r=!0);return r}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var p=o.length;for(u=0;u<p;u+=1)n[o[u]].value=n[o[u]].defaultValue,n[o[u]].explicitSet=!1}if("object"===(0,xc.A)(e))for(i in e)if(s=e[i],h(o,i)&&void 0!==s){if("boolean"===n[i].type&&"boolean"==typeof s)n[i].value=s;else if("name"===n[i].type&&h(n[i].valueSet,s))n[i].value=s;else if("integer"===n[i].type&&Number.isInteger(s))n[i].value=s;else if("array"===n[i].type){for(c=0;c<s.length;c+=1)if(r=!0,1===s[c].length&&"number"==typeof s[c][0])l.push(String(s[c]-1));else if(s[c].length>1){for(d=0;d<s[c].length;d+=1)"number"!=typeof s[c][d]&&(r=!1);!0===r&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}n[i].value="["+l.join(" ")+"]"}else n[i].value=n[i].defaultValue;n[i].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in n)!0===n[e].explicitSet&&("name"===n[e].type?t.push("/"+e+" /"+n[e].value):t.push("/"+e+" "+n[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n=unescape(encodeURIComponent(e)),r=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),i=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),s=unescape(encodeURIComponent("</x:xmpmeta>")),a=n.length+r.length+i.length+t.length+s.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+a+" >>"),this.internal.write("stream"),this.internal.write(t+n+r+i+s),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,r){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(lf.API),function(e){var t=e.API,n=t.pdfEscape16=function(e,t){for(var n,r=t.metadata.Unicode.widths,i=["","0","00","000","0000"],s=[""],a=0,o=e.length;a<o;++a){if(n=t.metadata.characterToGlyph(e.charCodeAt(a)),t.metadata.glyIdsUsed.push(n),t.metadata.toUnicode[n]=e.charCodeAt(a),-1==r.indexOf(n)&&(r.push(n),r.push([parseInt(t.metadata.widthOfGlyph(n),10)])),"0"==n)return s.join("");n=n.toString(16),s.push(i[4-n.length],n)}return s.join("")},r=function(e){var t,n,r,i,s,a,o;for(s="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",r=[],a=0,o=(n=Object.keys(e).sort(function(e,t){return e-t})).length;a<o;a++)t=n[a],r.length>=100&&(s+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar",r=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(i=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),r.push("<"+t+"><"+i+">"));return r.length&&(s+="\n"+r.length+" beginbfchar\n"+r.join("\n")+"\nendbfchar\n"),s+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var n=t.font,i=t.out,s=t.newObject,a=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"Identity-H"===n.encoding){for(var o=n.metadata.Unicode.widths,l=n.metadata.subset.encode(n.metadata.glyIdsUsed,1),c="",d=0;d<l.length;d++)c+=String.fromCharCode(l[d]);var u=s();a({data:c,addLength1:!0,objectId:u}),i("endobj");var h=s();a({data:r(n.metadata.toUnicode),addLength1:!0,objectId:h}),i("endobj");var p=s();i("<<"),i("/Type /FontDescriptor"),i("/FontName /"+tf(n.fontName)),i("/FontFile2 "+u+" 0 R"),i("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),i("/Flags "+n.metadata.flags),i("/StemV "+n.metadata.stemV),i("/ItalicAngle "+n.metadata.italicAngle),i("/Ascent "+n.metadata.ascender),i("/Descent "+n.metadata.decender),i("/CapHeight "+n.metadata.capHeight),i(">>"),i("endobj");var m=s();i("<<"),i("/Type /Font"),i("/BaseFont /"+tf(n.fontName)),i("/FontDescriptor "+p+" 0 R"),i("/W "+e.API.PDFObject.convert(o)),i("/CIDToGIDMap /Identity"),i("/DW 1000"),i("/Subtype /CIDFontType2"),i("/CIDSystemInfo"),i("<<"),i("/Supplement 0"),i("/Registry (Adobe)"),i("/Ordering ("+n.encoding+")"),i(">>"),i(">>"),i("endobj"),n.objectNumber=s(),i("<<"),i("/Type /Font"),i("/Subtype /Type0"),i("/ToUnicode "+h+" 0 R"),i("/BaseFont /"+tf(n.fontName)),i("/Encoding /"+n.encoding),i("/DescendantFonts ["+m+" 0 R]"),i(">>"),i("endobj"),n.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var n=t.font,i=t.out,s=t.newObject,a=t.putStream;if(n.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===n.encoding){for(var o=n.metadata.rawData,l="",c=0;c<o.length;c++)l+=String.fromCharCode(o[c]);var d=s();a({data:l,addLength1:!0,objectId:d}),i("endobj");var u=s();a({data:r(n.metadata.toUnicode),addLength1:!0,objectId:u}),i("endobj");var h=s();i("<<"),i("/Descent "+n.metadata.decender),i("/CapHeight "+n.metadata.capHeight),i("/StemV "+n.metadata.stemV),i("/Type /FontDescriptor"),i("/FontFile2 "+d+" 0 R"),i("/Flags 96"),i("/FontBBox "+e.API.PDFObject.convert(n.metadata.bbox)),i("/FontName /"+tf(n.fontName)),i("/ItalicAngle "+n.metadata.italicAngle),i("/Ascent "+n.metadata.ascender),i(">>"),i("endobj"),n.objectNumber=s();for(var p=0;p<n.metadata.hmtx.widths.length;p++)n.metadata.hmtx.widths[p]=parseInt(n.metadata.hmtx.widths[p]*(1e3/n.metadata.head.unitsPerEm));i("<</Subtype/TrueType/Type/Font/ToUnicode "+u+" 0 R/BaseFont/"+tf(n.fontName)+"/FontDescriptor "+h+" 0 R/Encoding/"+n.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(n.metadata.hmtx.widths)+">>"),i("endobj"),n.isAlreadyPutted=!0}}(t)}]);var i=function(e){var t,r=e.text||"",i=e.x,s=e.y,a=e.options||{},o=e.mutex||{},l=o.pdfEscape,c=o.activeFontKey,d=o.fonts,u=c,h="",p=0,m="",f=d[u].encoding;if("Identity-H"!==d[u].encoding)return{text:r,x:i,y:s,options:a,mutex:o};for(m=r,u=c,Array.isArray(r)&&(m=r[0]),p=0;p<m.length;p+=1)d[u].metadata.hasOwnProperty("cmap")&&(t=d[u].metadata.cmap.unicode.codeMap[m[p].charCodeAt(0)]),t||m[p].charCodeAt(0)<256&&d[u].metadata.hasOwnProperty("Unicode")?h+=m[p]:h+="";var g="";return parseInt(u.slice(1))<14||"WinAnsiEncoding"===f?g=l(h,u).split("").map(function(e){return e.charCodeAt(0).toString(16)}).join(""):"Identity-H"===f&&(g=n(h,d[u])),o.isHex=!0,{text:g,x:i,y:s,options:a,mutex:o}};t.events.push(["postProcessText",function(e){var t=e.text||"",n=[],r={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var s=0;for(s=0;s<t.length;s+=1)Array.isArray(t[s])&&3===t[s].length?n.push([i(Object.assign({},r,{text:t[s][0]})).text,t[s][1],t[s][2]]):n.push(i(Object.assign({},r,{text:t[s]})).text);e.text=n}else e.text=i(Object.assign({},r,{text:t})).text}])}(lf),function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(lf.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var n,r,i,s,a,o,l,c=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],h={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},m=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],f=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,x=0;this.__bidiEngine__={};var v=function(e){var t=e.charCodeAt(),n=t>>8,r=p[n];return void 0!==r?c[256*r+(255&t)]:252===n||253===n?"AL":f.test(n)?"L":8===n?"R":"N"},y=function(e){for(var t,n=0;n<e.length;n++){if("L"===(t=v(e.charAt(n))))return!1;if("R"===t)return!0}return!1},b=function(e,t,a,o){var l,c,d,u,h=t[o];switch(h){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"N":case"AN":break;case"EN":g&&(h="AN");break;case"AL":g=!0,h="R";break;case"WS":case"BN":h="N";break;case"CS":o<1||o+1>=t.length||"EN"!==(l=a[o-1])&&"AN"!==l||"EN"!==(c=t[o+1])&&"AN"!==c?h="N":g&&(c="AN"),h=c===l?c:"N";break;case"ES":h="EN"===(l=o>0?a[o-1]:"B")&&o+1<t.length&&"EN"===t[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===a[o-1]){h="EN";break}if(g){h="N";break}for(d=o+1,u=t.length;d<u&&"ET"===t[d];)d++;h=d<u&&"EN"===t[d]?"EN":"N";break;case"NSM":if(i&&!s){for(u=t.length,d=o+1;d<u&&"NSM"===t[d];)d++;if(d<u){var p=e[o],m=p>=1425&&p<=2303||64286===p;if(l=t[d],m&&("R"===l||"AL"===l)){h="R";break}}}h=o<1||"B"===(l=t[o-1])?"N":a[o-1];break;case"B":g=!1,n=!0,h=x;break;case"S":r=!0,h="N"}return h},w=function(e,t,n){var r=e.split("");return n&&_(r,n,{hiLevel:x}),r.reverse(),t&&t.reverse(),r.join("")},_=function(e,t,i){var s,a,o,l,c,p=-1,m=e.length,f=0,y=[],w=x?u:d,_=[];for(g=!1,n=!1,r=!1,a=0;a<m;a++)_[a]=v(e[a]);for(o=0;o<m;o++){if(c=f,y[o]=b(e,_,y,o),s=240&(f=w[c][h[y[o]]]),f&=15,t[o]=l=w[f][5],s>0)if(16===s){for(a=p;a<o;a++)t[a]=1;p=-1}else p=-1;if(w[f][6])-1===p&&(p=o);else if(p>-1){for(a=p;a<o;a++)t[a]=l;p=-1}"B"===_[o]&&(t[o]=0),i.hiLevel|=l}r&&function(e,t,n){for(var r=0;r<n;r++)if("S"===e[r]){t[r]=x;for(var i=r-1;i>=0&&"WS"===e[i];i--)t[i]=x}}(_,t,m)},S=function(e,t,r,i,s){if(!(s.hiLevel<e)){if(1===e&&1===x&&!n)return t.reverse(),void(r&&r.reverse());for(var a,o,l,c,d=t.length,u=0;u<d;){if(i[u]>=e){for(l=u+1;l<d&&i[l]>=e;)l++;for(c=u,o=l-1;c<o;c++,o--)a=t[c],t[c]=t[o],t[o]=a,r&&(a=r[c],r[c]=r[o],r[o]=a);u=l}u++}}},N=function(e,t,n){var r=e.split(""),i={hiLevel:x};return n||(n=[]),_(r,n,i),function(e,t,n){if(0!==n.hiLevel&&l)for(var r,i=0;i<e.length;i++)1===t[i]&&(r=m.indexOf(e[i]))>=0&&(e[i]=m[r+1])}(r,n,i),S(2,r,t,n,i),S(1,r,t,n,i),r.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,n){if(function(e,t){if(t)for(var n=0;n<e.length;n++)t[n]=n;void 0===s&&(s=y(e)),void 0===o&&(o=y(e))}(e,t),i||!a||o)if(i&&a&&s^o)x=s?1:0,e=w(e,t,n);else if(!i&&a&&o)x=s?1:0,e=N(e,t,n),e=w(e,t);else if(!i||s||a||o){if(i&&!a&&s^o)e=w(e,t),s?(x=0,e=N(e,t,n)):(x=1,e=N(e,t,n),e=w(e,t));else if(i&&s&&!a&&o)x=1,e=N(e,t,n),e=w(e,t);else if(!i&&!a&&s^o){var r=l;s?(x=1,e=N(e,t,n),x=0,l=!1,e=N(e,t,n),l=r):(x=0,e=N(e,t,n),e=w(e,t),x=1,l=!1,e=N(e,t,n),l=r,e=w(e,t))}}else x=0,e=N(e,t,n);else x=s?1:0,e=N(e,t,n);return e},this.__bidiEngine__.setOptions=function(e){e&&(i=e.isInputVisual,a=e.isOutputVisual,s=e.isInputRtl,o=e.isOutputRtl,l=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text;e.x,e.y;var r=e.options||{};e.mutex,r.lang;var i=[];if(r.isInputVisual="boolean"!=typeof r.isInputVisual||r.isInputVisual,n.setOptions(r),"[object Array]"===Object.prototype.toString.call(t)){var s=0;for(i=[],s=0;s<t.length;s+=1)"[object Array]"===Object.prototype.toString.call(t[s])?i.push([n.doBidiReorder(t[s][0]),t[s][1],t[s][2]]):i.push([n.doBidiReorder(t[s])]);e.text=i}else e.text=n.doBidiReorder(t);n.setOptions({isInputVisual:!0})}])}(lf),lf.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new Fg(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new tx(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new Og(this.contents),this.head=new zg(this),this.name=new Xg(this),this.cmap=new Vg(this),this.toUnicode={},this.hhea=new Hg(this),this.maxp=new Yg(this),this.hmtx=new Zg(this),this.post=new Gg(this),this.os2=new Wg(this),this.loca=new ex(this),this.glyf=new Kg(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,n,r,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,n,r,i;for(i=[],t=0,n=(r=this.bbox).length;t<n;t++)e=r[t],i.push(Math.round(e*this.scaleFactor));return i}.call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(i=this.familyClass)||2===i||3===i||4===i||5===i||7===i,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,n){var r,i,s,a;for(s=0,i=0,a=(e=""+e).length;0<=a?i<a:i>a;i=0<=a?++i:--i)r=e.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/t)||0;return s*(t/1e3)},e.prototype.lineHeight=function(e,t){var n;return null==t&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},e}();var Ig,Fg=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(e){var t,n,r;for(r=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,n,r,i,s,a,o;return e=this.readByte(),t=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),s=this.readByte(),a=this.readByte(),o=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^i)+65536*(255^s)+256*(255^a)+(255^o)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*r+16777216*i+65536*s+256*a+o},e.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},e.prototype.write=function(e){var t,n,r,i;for(i=[],n=0,r=e.length;n<r;n++)t=e[n],i.push(this.writeByte(t));return i},e}(),Og=function(){var e;function t(e){var t,n,r;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},n=0,r=this.tableCount;0<=r?n<r:n>r;n=0<=r?++n:--n)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var n,r,i,s,a,o,l,c,d,u,h,p,m;for(m in h=Object.keys(t).length,o=Math.log(2),d=16*Math.floor(Math.log(h)/o),s=Math.floor(d/o),c=16*h-d,(r=new Fg).writeInt(this.scalarType),r.writeShort(h),r.writeShort(d),r.writeShort(s),r.writeShort(c),i=16*h,l=r.pos+i,a=null,p=[],t)for(u=t[m],r.writeString(m),r.writeInt(e(u)),r.writeInt(l),r.writeInt(u.length),p=p.concat(u),"head"===m&&(a=l),l+=u.length;l%4;)p.push(0),l++;return r.write(p),n=2981146554-e(r.data),r.pos=a+8,r.writeUInt32(n),r.data},e=function(e){var t,n,r,i;for(e=Jg.call(e);e.length%4;)e.push(0);for(r=new Fg(e),n=0,t=0,i=e.length;t<i;t=t+=4)n+=r.readUInt32();return 4294967295&n},t}(),Dg={}.hasOwnProperty,Ug=function(e,t){for(var n in t)Dg.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};Ig=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var zg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new Fg).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),Bg=function(){function e(e,t){var n,r,i,s,a,o,l,c,d,u,h,p,m,f,g,x,v;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=0;o<256;++o)this.codeMap[o]=e.readByte();break;case 4:for(h=e.readUInt16(),u=h/2,e.pos+=6,i=function(){var t,n;for(n=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)n.push(e.readUInt16());return n}(),e.pos+=2,m=function(){var t,n;for(n=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)n.push(e.readUInt16());return n}(),l=function(){var t,n;for(n=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)n.push(e.readUInt16());return n}(),c=function(){var t,n;for(n=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)n.push(e.readUInt16());return n}(),r=(this.length-e.pos+this.offset)/2,a=function(){var t,n;for(n=[],o=t=0;0<=r?t<r:t>r;o=0<=r?++t:--t)n.push(e.readUInt16());return n}(),o=g=0,v=i.length;g<v;o=++g)for(f=i[o],n=x=p=m[o];p<=f?x<=f:x>=f;n=p<=f?++x:--x)0===c[o]?s=n+l[o]:0!==(s=a[c[o]/2+(n-p)-(u-o)]||0)&&(s+=l[o]),this.codeMap[n]=65535&s}e.pos=d}return e.encode=function(e,t){var n,r,i,s,a,o,l,c,d,u,h,p,m,f,g,x,v,y,b,w,_,S,N,j,A,M,E,C,k,T,P,L,R,I,F,O,D,U,z,B,V,H,W,G,q,X;switch(C=new Fg,s=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(m=0,f=function(){var e=[];for(p=0;p<256;++p)e.push(0);return e}(),x={0:0},i={},k=0,R=s.length;k<R;k++)null==x[W=e[r=s[k]]]&&(x[W]=++m),i[r]={old:e[r],new:x[e[r]]},f[r]=x[e[r]];return C.writeUInt16(1),C.writeUInt16(0),C.writeUInt32(12),C.writeUInt16(0),C.writeUInt16(262),C.writeUInt16(0),C.write(f),{charMap:i,subtable:C.data,maxGlyphID:m+1};case"unicode":for(M=[],d=[],v=0,x={},n={},g=l=null,T=0,I=s.length;T<I;T++)null==x[b=e[r=s[T]]]&&(x[b]=++v),n[r]={old:b,new:x[b]},a=x[b]-r,null!=g&&a===l||(g&&d.push(g),M.push(r),l=a),g=r;for(g&&d.push(g),d.push(65535),M.push(65535),j=2*(N=M.length),S=2*Math.pow(Math.log(N)/Math.LN2,2),u=Math.log(S/2)/Math.LN2,_=2*N-S,o=[],w=[],h=[],p=P=0,F=M.length;P<F;p=++P){if(A=M[p],c=d[p],65535===A){o.push(0),w.push(0);break}if(A-(E=n[A].new)>=32768)for(o.push(0),w.push(2*(h.length+N-p)),r=L=A;A<=c?L<=c:L>=c;r=A<=c?++L:--L)h.push(n[r].new);else o.push(E-A),w.push(0)}for(C.writeUInt16(3),C.writeUInt16(1),C.writeUInt32(12),C.writeUInt16(4),C.writeUInt16(16+8*N+2*h.length),C.writeUInt16(0),C.writeUInt16(j),C.writeUInt16(S),C.writeUInt16(u),C.writeUInt16(_),V=0,O=d.length;V<O;V++)r=d[V],C.writeUInt16(r);for(C.writeUInt16(0),H=0,D=M.length;H<D;H++)r=M[H],C.writeUInt16(r);for(G=0,U=o.length;G<U;G++)a=o[G],C.writeUInt16(a);for(q=0,z=w.length;q<z;q++)y=w[q],C.writeUInt16(y);for(X=0,B=h.length;X<B;X++)m=h[X],C.writeUInt16(m);return{charMap:n,subtable:C.data,maxGlyphID:v+1}}},e}(),Vg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,n,r;for(e.pos=this.offset,this.version=e.readUInt16(),r=e.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)t=new Bg(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var n,r;return null==t&&(t="macroman"),n=Bg.encode(e,t),(r=new Fg).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},e}(),Hg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),Wg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,n;for(n=[],t=0;t<10;++t)n.push(e.readByte());return n}(),this.charRange=function(){var t,n;for(n=[],t=0;t<4;++t)n.push(e.readInt());return n}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,n;for(n=[],t=0;t<2;t=++t)n.push(e.readInt());return n}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),Gg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="post",e.prototype.parse=function(e){var t,n,r;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=e.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],r=[];e.pos<this.offset+this.length;)t=e.readByte(),r.push(this.names.push(e.readString(t)));return r;case 151552:return n=e.readUInt16(),this.offsets=e.read(n);case 262144:return this.map=function(){var t,n,r;for(r=[],i=t=0,n=this.file.maxp.numGlyphs;0<=n?t<n:t>n;i=0<=n?++t:--t)r.push(e.readUInt32());return r}.call(this)}},e}(),qg=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Xg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="name",e.prototype.parse=function(e){var t,n,r,i,s,a,o,l,c,d,u;for(e.pos=this.offset,e.readShort(),t=e.readShort(),a=e.readShort(),n=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)n.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+a+e.readShort()});for(o={},i=c=0,d=n.length;c<d;i=++c)r=n[i],e.pos=r.offset,l=e.readString(r.length),s=new qg(l,r),null==o[u=r.nameID]&&(o[u]=[]),o[r.nameID].push(s);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(Fm){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},e}(),Yg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),Zg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,n,r,i,s,a,o;for(e.pos=this.offset,this.metrics=[],t=0,a=this.file.hhea.numberOfMetrics;0<=a?t<a:t>a;t=0<=a?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var n,i;for(i=[],t=n=0;0<=r?n<r:n>r;t=0<=r?++n:--n)i.push(e.readInt16());return i}(),this.widths=function(){var e,t,n,r;for(r=[],e=0,t=(n=this.metrics).length;e<t;e++)i=n[e],r.push(i.advance);return r}.call(this),n=this.widths[this.widths.length-1],o=[],t=s=0;0<=r?s<r:s>r;t=0<=r?++s:--s)o.push(this.widths.push(n));return o},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),Jg=[].slice,Kg=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,n,r,i,s,a,o,l,c,d;return e in this.cache?this.cache[e]:(i=this.file.loca,t=this.file.contents,n=i.indexOf(e),0===(r=i.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+n,s=(a=new Fg(t.read(r))).readShort(),l=a.readShort(),d=a.readShort(),o=a.readShort(),c=a.readShort(),this.cache[e]=-1===s?new $g(a,l,d,o,c):new Qg(a,s,l,d,o,c),this.cache[e]))},e.prototype.encode=function(e,t,n){var r,i,s,a,o;for(s=[],i=[],a=0,o=t.length;a<o;a++)r=e[t[a]],i.push(s.length),r&&(s=s.concat(r.encode(n)));return i.push(s.length),{table:s,offsets:i}},e}(),Qg=function(){function e(e,t,n,r,i,s){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),$g=function(){function e(e,t,n,r,i){var s,a;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=r,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;a=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&a;)s.pos+=1&a?4:2,128&a?s.pos+=8:64&a?s.pos+=4:8&a&&(s.pos+=2)}return e.prototype.encode=function(){var e,t,n;for(t=new Fg(Jg.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),ex=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ug(e,Ig),e.prototype.tag="loca",e.prototype.parse=function(e){var t,n;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,r;for(r=[],n=0,t=this.length;n<t;n+=2)r.push(2*e.readUInt16());return r}.call(this):function(){var t,r;for(r=[],n=0,t=this.length;n<t;n+=4)r.push(e.readUInt32());return r}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var n=new Uint32Array(this.offsets.length),r=0,i=0,s=0;s<n.length;++s)if(n[s]=r,i<t.length&&t[i]==s){++i,n[s]=r;var a=this.offsets[s],o=this.offsets[s+1]-a;o>0&&(r+=o)}for(var l=new Array(4*n.length),c=0;c<n.length;++c)l[4*c+3]=255&n[c],l[4*c+2]=(65280&n[c])>>8,l[4*c+1]=(16711680&n[c])>>16,l[4*c]=(4278190080&n[c])>>24;return l},e}(),tx=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,n,r,i;for(t in r=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[t],e[t]=r[n];return e},e.prototype.glyphsFor=function(e){var t,n,r,i,s,a,o;for(r={},s=0,a=e.length;s<a;s++)r[i=e[s]]=this.font.glyf.glyphFor(i);for(i in t=[],r)(null!=(n=r[i])?n.compound:void 0)&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(i in o=this.glyphsFor(t))n=o[i],r[i]=n;return r},e.prototype.encode=function(e,t){var n,r,i,s,a,o,l,c,d,u,h,p,m,f,g;for(r in n=Vg.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),h={0:0},g=n.charMap)h[(o=g[r]).old]=o.new;for(p in u=n.maxGlyphID,s)p in h||(h[p]=u++);return c=function(e){var t,n;for(t in n={},e)n[e[t]]=t;return n}(h),d=Object.keys(c).sort(function(e,t){return e-t}),m=function(){var e,t,n;for(n=[],e=0,t=d.length;e<t;e++)a=d[e],n.push(c[a]);return n}(),i=this.font.glyf.encode(s,m,h),l=this.font.loca.encode(i.offsets,m),f={cmap:this.font.cmap.raw(),glyf:i.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(f["OS/2"]=this.font.os2.raw()),this.font.directory.encode(f)},e}();function nx(e,t,n,r,i){r=r||{};var s=i.internal.scaleFactor,a=i.internal.getFontSize()/s,o=a*(i.getLineHeightFactor?i.getLineHeightFactor():1.15),l="",c=1;if("middle"!==r.valign&&"bottom"!==r.valign&&"center"!==r.halign&&"right"!==r.halign||(c=(l="string"===typeof e?e.split(/\r\n|\r|\n/g):e).length||1),n+=a*(2-1.15),"middle"===r.valign?n-=c/2*o:"bottom"===r.valign&&(n-=c*o),"center"===r.halign||"right"===r.halign){var d=a;if("center"===r.halign&&(d*=.5),l&&c>=1){for(var u=0;u<l.length;u++)i.text(l[u],t-i.getStringUnitWidth(l[u])*d,n),n+=o;return i}t-=i.getStringUnitWidth(e)*d}return"justify"===r.halign?i.text(e,t,n,{maxWidth:r.maxWidth||100,align:"justify"}):i.text(e,t,n),i}lf.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(n){var r,i,s,a;if(Array.isArray(n))return"["+function(){var e,i,s;for(s=[],e=0,i=n.length;e<i;e++)r=n[e],s.push(t.convert(r));return s}().join(" ")+"]";if("string"==typeof n)return"/"+n;if(null!=n?n.isString:void 0)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(n)){for(i in s=["<<"],n)a=n[i],s.push("/"+i+" "+t.convert(a));return s.push(">>"),s.join("\n")}return""+n},t}();var rx={},ix=function(){function e(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(e,t){void 0===t&&(t=null),t?t.__autoTableDocumentDefaults=e:rx=e},e.unifyColor=function(e){return Array.isArray(e)?e:"number"===typeof e?[e,e,e]:"string"===typeof e?[e]:null},e.prototype.applyStyles=function(t,n){var r,i,s;void 0===n&&(n=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var a=this.jsPDFDocument.internal.getFont(),o=a.fontStyle,l=a.fontName;if(t.font&&(l=t.font),t.fontStyle){o=t.fontStyle;var c=this.getFontList()[l];c&&-1===c.indexOf(o)&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!n){var d=e.unifyColor(t.fillColor);d&&(r=this.jsPDFDocument).setFillColor.apply(r,d),(d=e.unifyColor(t.textColor))&&(i=this.jsPDFDocument).setTextColor.apply(i,d),(d=e.unifyColor(t.lineColor))&&(s=this.jsPDFDocument).setDrawColor.apply(s,d),"number"===typeof t.lineWidth&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(e,t,n){return this.jsPDFDocument.splitTextToSize(e,t,n)},e.prototype.rect=function(e,t,n,r,i){return this.jsPDFDocument.rect(e,t,n,r,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return rx||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return null==e.width&&(e={width:e.getWidth(),height:e.getHeight()}),e},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),sx=function(e,t){return sx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},sx(e,t)};function ax(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}sx(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}"function"===typeof SuppressedError&&SuppressedError;var ox=function(e){function t(t){var n=e.call(this)||this;return n._element=t,n}return ax(t,e),t}(Array);function lx(e,t,n){n.applyStyles(t,!0);var r=(Array.isArray(e)?e:[e]).map(function(e){return n.getTextWidth(e)}).reduce(function(e,t){return Math.max(e,t)},0);return r}function cx(e,t,n,r){var i=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:i,lineColor:s});var a=dx(i,!1);a&&e.rect(n.x,n.y,t.getWidth(e.pageSize().width),r.y-n.y,a)}function dx(e,t){var n=e>0,r=t||0===t;return n&&r?"DF":n?"S":r?"F":null}function ux(e,t){var n,r,i,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(3===e.length)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(2===e.length)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e=1===e.length?e[0]:t}return"object"===typeof e?("number"===typeof e.vertical&&(e.top=e.vertical,e.bottom=e.vertical),"number"===typeof e.horizontal&&(e.right=e.horizontal,e.left=e.horizontal),{left:null!==(n=e.left)&&void 0!==n?n:t,top:null!==(r=e.top)&&void 0!==r?r:t,right:null!==(i=e.right)&&void 0!==i?i:t,bottom:null!==(s=e.bottom)&&void 0!==s?s:t}):("number"!==typeof e&&(e=t),{top:e,right:e,bottom:e,left:e})}function hx(e,t){var n=ux(t.settings.margin,0);return e.pageSize().width-(n.left+n.right)}function px(e,t,n,r,i){var s={},a=96/72,o=mx(t,function(e){return i.getComputedStyle(e).backgroundColor});null!=o&&(s.fillColor=o);var l=mx(t,function(e){return i.getComputedStyle(e).color});null!=l&&(s.textColor=l);var c=function(e,t){var n=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],r=96/(72/t),i=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=n.map(function(e){return parseInt(e||"0")/r}),a=ux(s,0);i>a.top&&(a.top=i);i>a.bottom&&(a.bottom=i);return a}(r,n);c&&(s.cellPadding=c);var d="borderTopColor",u=a*n,h=r.borderTopWidth;if(r.borderBottomWidth===h&&r.borderRightWidth===h&&r.borderLeftWidth===h){var p=(parseFloat(h)||0)/u;p&&(s.lineWidth=p)}else s.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/u,right:(parseFloat(r.borderRightWidth)||0)/u,bottom:(parseFloat(r.borderBottomWidth)||0)/u,left:(parseFloat(r.borderLeftWidth)||0)/u},s.lineWidth.top||(s.lineWidth.right?d="borderRightColor":s.lineWidth.bottom?d="borderBottomColor":s.lineWidth.left&&(d="borderLeftColor"));var m=mx(t,function(e){return i.getComputedStyle(e)[d]});null!=m&&(s.lineColor=m);var f=["left","right","center","justify"];-1!==f.indexOf(r.textAlign)&&(s.halign=r.textAlign),-1!==(f=["middle","bottom","top"]).indexOf(r.verticalAlign)&&(s.valign=r.verticalAlign);var g=parseInt(r.fontSize||"");isNaN(g)||(s.fontSize=g/a);var x=function(e){var t="";("bold"===e.fontWeight||"bolder"===e.fontWeight||parseInt(e.fontWeight)>=700)&&(t="bold");"italic"!==e.fontStyle&&"oblique"!==e.fontStyle||(t+="italic");return t}(r);x&&(s.fontStyle=x);var v=(r.fontFamily||"").toLowerCase();return-1!==e.indexOf(v)&&(s.font=v),s}function mx(e,t){var n=fx(e,t);if(!n)return null;var r=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var i=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])];return 0===parseInt(r[4])||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function fx(e,t){var n=t(e);return"rgba(0, 0, 0, 0)"===n||"transparent"===n||"initial"===n||"inherit"===n?null==e.parentElement?null:fx(e.parentElement,t):n}function gx(e,t,n,r,i){var s,a,o;void 0===r&&(r=!1),void 0===i&&(i=!1),o="string"===typeof t?n.document.querySelector(t):t;var l=Object.keys(e.getFontList()),c=e.scaleFactor(),d=[],u=[],h=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:d,body:u,foot:h};for(var p=0;p<o.rows.length;p++){var m=o.rows[p],f=null===(a=null===(s=null===m||void 0===m?void 0:m.parentElement)||void 0===s?void 0:s.tagName)||void 0===a?void 0:a.toLowerCase(),g=xx(l,c,n,m,r,i);g&&("thead"===f?d.push(g):"tfoot"===f?h.push(g):u.push(g))}return{head:d,body:u,foot:h}}function xx(e,t,n,r,i,s){for(var a=new ox(r),o=0;o<r.cells.length;o++){var l=r.cells[o],c=n.getComputedStyle(l);if(i||"none"!==c.display){var d=void 0;s&&(d=px(e,l,t,c,n)),a.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:d,_element:l,content:vx(l)})}}var u=n.getComputedStyle(r);if(a.length>0&&(i||"none"!==u.display))return a}function vx(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join("\n"),t.innerText||t.textContent||""}function yx(e,t,n,r,i){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),a=1;a<arguments.length;a++){var o=arguments[a];if(null!=o)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(s[l]=o[l])}return s}function bx(e,t){var n=new ix(e),r=n.getDocumentOptions(),i=n.getGlobalOptions();!function(e,t,n){for(var r=0,i=[e,t,n];r<i.length;r++){var s=i[r];s&&"object"!==typeof s&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&"number"!==typeof s.startY&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}(i,r,t);var s,a=yx({},i,r,t);"undefined"!==typeof window&&(s=window);var o=function(e,t,n){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(i){if("columnStyles"===i){var s=e[i],a=t[i],o=n[i];r.columnStyles=yx({},s,a,o)}else{var l=[e,t,n].map(function(e){return e[i]||{}});r[i]=yx({},l[0],l[1],l[2])}},s=0,a=Object.keys(r);s<a.length;s++){i(a[s])}return r}(i,r,t),l=function(e,t,n){for(var r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=[e,t,n];i<s.length;i++){var a=s[i];a.didParseCell&&r.didParseCell.push(a.didParseCell),a.willDrawCell&&r.willDrawCell.push(a.willDrawCell),a.didDrawCell&&r.didDrawCell.push(a.didDrawCell),a.willDrawPage&&r.willDrawPage.push(a.willDrawPage),a.didDrawPage&&r.didDrawPage.push(a.didDrawPage)}return r}(i,r,t),c=function(e,t){var n,r,i,s,a,o,l,c,d,u,h,p,m,f,g=ux(t.margin,40/e.scaleFactor()),x=null!==(n=function(e,t){var n=e.getLastAutoTable(),r=e.scaleFactor(),i=e.pageNumber(),s=!1;if(n&&n.startPageNumber){s=n.startPageNumber+n.pageNumber-1===i}if("number"===typeof t)return t;if((null==t||!1===t)&&s&&null!=(null===n||void 0===n?void 0:n.finalY))return n.finalY+20/r;return null}(e,t.startY))&&void 0!==n?n:g.top;m=!0===t.showFoot?"everyPage":!1===t.showFoot?"never":null!==(r=t.showFoot)&&void 0!==r?r:"everyPage";f=!0===t.showHead?"everyPage":!1===t.showHead?"never":null!==(i=t.showHead)&&void 0!==i?i:"everyPage";var v=null!==(s=t.useCss)&&void 0!==s&&s,y=t.theme||(v?"plain":"striped"),b=!!t.horizontalPageBreak,w=null!==(a=t.horizontalPageBreakRepeat)&&void 0!==a?a:null;return{includeHiddenHtml:null!==(o=t.includeHiddenHtml)&&void 0!==o&&o,useCss:v,theme:y,startY:x,margin:g,pageBreak:null!==(l=t.pageBreak)&&void 0!==l?l:"auto",rowPageBreak:null!==(c=t.rowPageBreak)&&void 0!==c?c:"auto",tableWidth:null!==(d=t.tableWidth)&&void 0!==d?d:"auto",showHead:f,showFoot:m,tableLineWidth:null!==(u=t.tableLineWidth)&&void 0!==u?u:0,tableLineColor:null!==(h=t.tableLineColor)&&void 0!==h?h:200,horizontalPageBreak:b,horizontalPageBreakRepeat:w,horizontalPageBreakBehaviour:null!==(p=t.horizontalPageBreakBehaviour)&&void 0!==p?p:"afterAllRows"}}(n,a),d=function(e,t,n){var r=t.head||[],i=t.body||[],s=t.foot||[];if(t.html){var a=t.includeHiddenHtml;if(n){var o=gx(e,t.html,n,a,t.useCss)||{};r=o.head||r,i=o.body||r,s=o.foot||r}else console.error("Cannot parse html in non browser environment")}var l=t.columns||function(e,t,n){var r=e[0]||t[0]||n[0]||[],i=[];return Object.keys(r).filter(function(e){return"_element"!==e}).forEach(function(e){var t,n=1;"object"!==typeof(t=Array.isArray(r)?r[parseInt(e)]:r[e])||Array.isArray(t)||(n=(null===t||void 0===t?void 0:t.colSpan)||1);for(var s=0;s<n;s++){var a={dataKey:Array.isArray(r)?i.length:e+(s>0?"_".concat(s):"")};i.push(a)}}),i}(r,i,s);return{columns:l,head:r,body:i,foot:s}}(n,a,s);return{id:t.tableId,content:d,hooks:l,styles:o,settings:c}}var wx,_x=function(e,t,n){this.table=t,this.pageNumber=t.pageNumber,this.settings=t.settings,this.cursor=n,this.doc=e.getDocument()},Sx=function(e){function t(t,n,r,i,s,a){var o=e.call(this,t,n,a)||this;return o.cell=r,o.row=i,o.column=s,o.section=i.section,o}return ax(t,e),t}(_x),Nx=function(){function e(e,t){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return e.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},e.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(e,t,n,r,i,s){for(var a=0,o=t;a<o.length;a++){var l=!1===(0,o[a])(new Sx(e,this,n,r,i,s));if(n.text=Array.isArray(n.text)?n.text:[n.text],l)return!1}return!0},e.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var n=0,r=this.hooks.didDrawPage;n<r.length;n++){(0,r[n])(new _x(e,this,t))}},e.prototype.callWillDrawPageHooks=function(e,t){for(var n=0,r=this.hooks.willDrawPage;n<r.length;n++){(0,r[n])(new _x(e,this,t))}},e.prototype.getWidth=function(e){if("number"===typeof this.settings.tableWidth)return this.settings.tableWidth;if("wrap"===this.settings.tableWidth)return this.columns.reduce(function(e,t){return e+t.wrappedWidth},0);var t=this.settings.margin;return e-t.left-t.right},e}(),jx=function(){function e(e,t,n,r,i){void 0===i&&(i=!1),this.height=0,this.raw=e,e instanceof ox&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=n,this.cells=r,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(e,n){var r;return Math.max(e,(null===(r=t.cells[n.index])||void 0===r?void 0:r.height)||0)},0)},e.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(e){var n=t.cells[e.index];return!!n&&n.rowSpan>1}).length>0},e.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},e.prototype.getMinimumRowHeight=function(e,t){var n=this;return e.reduce(function(e,r){var i=n.cells[r.index];if(!i)return 0;var s=t.getLineHeight(i.styles.fontSize),a=i.padding("vertical")+s;return a>e?a:e},0)},e}(),Ax=function(){function e(e,t,n){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=e;var i=e;null==e||"object"!==typeof e||Array.isArray(e)?(this.rowSpan=1,this.colSpan=1):(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,i=null!==(r=e.content)&&void 0!==r?r:e,e._element&&(this.raw=e._element));var s=null!=i?""+i:"";this.text=s.split(/\r\n|\r|\n/g)}return e.prototype.getTextPos=function(){var e,t;if("top"===this.styles.valign)e=this.y+this.padding("top");else if("bottom"===this.styles.valign)e=this.y+this.height-this.padding("bottom");else{var n=this.height-this.padding("vertical");e=this.y+n/2+this.padding("top")}if("right"===this.styles.halign)t=this.x+this.width-this.padding("right");else if("center"===this.styles.halign){var r=this.width-this.padding("horizontal");t=this.x+r/2+this.padding("left")}else t=this.x+this.padding("left");return{x:t,y:e}},e.prototype.getContentHeight=function(e,t){void 0===t&&(t=1.15);var n=(Array.isArray(this.text)?this.text.length:1)*(this.styles.fontSize/e*t)+this.padding("vertical");return Math.max(n,this.styles.minCellHeight)},e.prototype.padding=function(e){var t=ux(this.styles.cellPadding,0);return"vertical"===e?t.top+t.bottom:"horizontal"===e?t.left+t.right:t[e]},e}(),Mx=function(){function e(e,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=n}return e.prototype.getMaxCustomCellWidth=function(e){for(var t=0,n=0,r=e.allRows();n<r.length;n++){var i=r[n].cells[this.index];i&&"number"===typeof i.styles.cellWidth&&(t=Math.max(t,i.styles.cellWidth))}return t},e}();function Ex(e,t){!function(e,t){var n=e.scaleFactor(),r=t.settings.horizontalPageBreak,i=hx(e,t);t.allRows().forEach(function(s){for(var a=0,o=t.columns;a<o.length;a++){var l=o[a],c=s.cells[l.index];if(c){var d=t.hooks.didParseCell;t.callCellHooks(e,d,c,s,l,null);var u=c.padding("horizontal");c.contentWidth=lx(c.text,c.styles,e)+u;var h=lx(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,e);if(c.minReadableWidth=h+c.padding("horizontal"),"number"===typeof c.styles.cellWidth)c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if("wrap"===c.styles.cellWidth||!0===r)c.contentWidth>i?(c.minWidth=i,c.wrappedWidth=i):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var p=10/n;c.minWidth=c.styles.minCellWidth||p,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),t.allRows().forEach(function(e){for(var n=0,r=t.columns;n<r.length;n++){var i=r[n],s=e.cells[i.index];if(s&&1===s.colSpan)i.wrappedWidth=Math.max(i.wrappedWidth,s.wrappedWidth),i.minWidth=Math.max(i.minWidth,s.minWidth),i.minReadableWidth=Math.max(i.minReadableWidth,s.minReadableWidth);else{var a=t.styles.columnStyles[i.dataKey]||t.styles.columnStyles[i.index]||{},o=a.cellWidth||a.minCellWidth;o&&"number"===typeof o&&(i.minWidth=o,i.wrappedWidth=o)}s&&(s.colSpan>1&&!i.minWidth&&(i.minWidth=s.minWidth),s.colSpan>1&&!i.wrappedWidth&&(i.wrappedWidth=s.minWidth))}})}(e,t);var n=[],r=0;t.columns.forEach(function(e){var i=e.getMaxCustomCellWidth(t);i?e.width=i:(e.width=e.wrappedWidth,n.push(e)),r+=e.width});var i=t.getWidth(e.pageSize().width)-r;i&&(i=Cx(n,i,function(e){return Math.max(e.minReadableWidth,e.minWidth)})),i&&(i=Cx(n,i,function(e){return e.minWidth})),i=Math.abs(i),!t.settings.horizontalPageBreak&&i>.1/e.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),function(e){for(var t=e.allRows(),n=0;n<t.length;n++)for(var r=t[n],i=null,s=0,a=0,o=0;o<e.columns.length;o++){var l=e.columns[o];if((a-=1)>1&&e.columns[o+1])s+=l.width,delete r.cells[l.index];else if(i){var c=i;delete r.cells[l.index],i=null,c.width=l.width+s}else{if(!(c=r.cells[l.index]))continue;if(a=c.colSpan,s=0,c.colSpan>1){i=c,s+=l.width;continue}c.width=l.width+s}}}(t),function(e,t){for(var n={count:0,height:0},r=0,i=e.allRows();r<i.length;r++){for(var s=i[r],a=0,o=e.columns;a<o.length;a++){var l=o[a],c=s.cells[l.index];if(c){t.applyStyles(c.styles,!0);var d=c.width-c.padding("horizontal");if("linebreak"===c.styles.overflow)c.text=t.splitTextToSize(c.text,d+1/t.scaleFactor(),{fontSize:c.styles.fontSize});else if("ellipsize"===c.styles.overflow)c.text=kx(c.text,d,c.styles,t,"...");else if("hidden"===c.styles.overflow)c.text=kx(c.text,d,c.styles,t,"");else if("function"===typeof c.styles.overflow){var u=c.styles.overflow(c.text,d);c.text="string"===typeof u?[u]:u}c.contentHeight=c.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var h=c.contentHeight/c.rowSpan;c.rowSpan>1&&n.count*n.height<h*c.rowSpan?n={height:h,count:c.rowSpan}:n&&n.count>0&&n.height>h&&(h=n.height),h>s.height&&(s.height=h)}}n.count--}}(t,e),function(e){for(var t={},n=1,r=e.allRows(),i=0;i<r.length;i++)for(var s=r[i],a=0,o=e.columns;a<o.length;a++){var l=o[a],c=t[l.index];if(n>1)n--,delete s.cells[l.index];else if(c)c.cell.height+=s.height,n=c.cell.colSpan,delete s.cells[l.index],c.left--,c.left<=1&&delete t[l.index];else{var d=s.cells[l.index];if(!d)continue;if(d.height=s.height,d.rowSpan>1){var u=r.length-i,h=d.rowSpan>u?u:d.rowSpan;t[l.index]={cell:d,left:h,row:s}}}}}(t)}function Cx(e,t,n){for(var r=t,i=e.reduce(function(e,t){return e+t.wrappedWidth},0),s=0;s<e.length;s++){var a=e[s],o=r*(a.wrappedWidth/i),l=a.width+o,c=n(a),d=l<c?c:l;t-=d-a.width,a.width=d}if(t=Math.round(1e10*t)/1e10){var u=e.filter(function(e){return!(t<0)||e.width>n(e)});u.length&&(t=Cx(u,t,n))}return t}function kx(e,t,n,r,i){return e.map(function(e){return function(e,t,n,r,i){var s=1e4*r.scaleFactor();if(t=Math.ceil(t*s)/s,t>=lx(e,n,r))return e;for(;t<lx(e+i,n,r)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+i}(e,t,n,r,i)})}function Tx(e,t){var n=new ix(e),r=function(e,t){var n=e.content,r=function(e){return e.map(function(e,t){var n,r;return r="object"===typeof e&&null!==(n=e.dataKey)&&void 0!==n?n:t,new Mx(r,e,t)})}(n.columns);if(0===n.head.length){(i=Lx(r,"head"))&&n.head.push(i)}if(0===n.foot.length){var i;(i=Lx(r,"foot"))&&n.foot.push(i)}var s=e.settings.theme,a=e.styles;return{columns:r,head:Px("head",n.head,r,a,s,t),body:Px("body",n.body,r,a,s,t),foot:Px("foot",n.foot,r,a,s,t)}}(t,n.scaleFactor()),i=new Nx(t,r);return Ex(n,i),n.applyStyles(n.userStyles),i}function Px(e,t,n,r,i,s){var a={};return t.map(function(t,o){for(var l=0,c={},d=0,u=0,h=0,p=n;h<p.length;h++){var m=p[h];if(null==a[m.index]||0===a[m.index].left)if(0===u){var f=void 0,g={};"object"!==typeof(f=Array.isArray(t)?t[m.index-d-l]:t[m.dataKey])||Array.isArray(f)||(g=(null===f||void 0===f?void 0:f.styles)||{});var x=Rx(e,m,o,i,r,s,g),v=new Ax(f,x,e);c[m.dataKey]=v,c[m.index]=v,u=v.colSpan-1,a[m.index]={left:v.rowSpan-1,times:u}}else u--,d++;else a[m.index].left--,u=a[m.index].times,l++}return new jx(t,o,e,c)})}function Lx(e,t){var n={};return e.forEach(function(e){if(null!=e.raw){var r=function(e,t){if("head"===e){if("object"===typeof t)return t.header||null;if("string"===typeof t||"number"===typeof t)return t}else if("foot"===e&&"object"===typeof t)return t.footer;return null}(t,e.raw);null!=r&&(n[e.dataKey]=r)}}),Object.keys(n).length>0?n:null}function Rx(e,t,n,r,i,s,a){var o,l={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}}[r];"head"===e?o=i.headStyles:"body"===e?o=i.bodyStyles:"foot"===e&&(o=i.footStyles);var c=yx({},l.table,l[e],i.styles,o),d=i.columnStyles[t.dataKey]||i.columnStyles[t.index]||{},u="body"===e?d:{},h="body"===e&&n%2===0?yx({},l.alternateRow,i.alternateRowStyles):{},p=function(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}(s),m=yx({},p,c,h,u);return yx(m,a)}function Ix(e,t,n){var r;void 0===n&&(n={});var i=hx(e,t),s=new Map,a=[],o=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:"string"!==typeof t.settings.horizontalPageBreakRepeat&&"number"!==typeof t.settings.horizontalPageBreakRepeat||(l=[t.settings.horizontalPageBreakRepeat]),l.forEach(function(e){var n=t.columns.find(function(t){return t.dataKey===e||t.index===e});n&&!s.has(n.index)&&(s.set(n.index,!0),a.push(n.index),o.push(t.columns[n.index]),i-=n.wrappedWidth)});for(var c=!0,d=null!==(r=null===n||void 0===n?void 0:n.start)&&void 0!==r?r:0;d<t.columns.length;)if(s.has(d))d++;else{var u=t.columns[d].wrappedWidth;if(!(c||i>=u))break;c=!1,a.push(d),o.push(t.columns[d]),i-=u,d++}return{colIndexes:a,columns:o,lastIndex:d-1}}function Fx(e,t){var n=t.settings,r=n.startY,i=n.margin,s={x:i.left,y:r},a=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=r+i.bottom+a;"avoid"===n.pageBreak&&(o+=t.body.reduce(function(e,t){return e+t.height},0));var l=new ix(e);("always"===n.pageBreak||null!=n.startY&&o>l.pageSize().height)&&(qx(l),s.y=i.top),t.callWillDrawPageHooks(l,s);var c=yx({},s);t.startPageNumber=l.pageNumber(),n.horizontalPageBreak?function(e,t,n,r){var i=function(e,t){for(var n=[],r=0;r<t.columns.length;r++){var i=Ix(e,t,{start:r});i.columns.length&&(n.push(i),r=i.lastIndex)}return n}(e,t),s=t.settings;if("afterAllRows"===s.horizontalPageBreakBehaviour)i.forEach(function(i,s){e.applyStyles(e.userStyles),s>0?Gx(e,t,n,r,i.columns,!0):Ox(e,t,r,i.columns),function(e,t,n,r,i){e.applyStyles(e.userStyles),t.body.forEach(function(s,a){var o=a===t.body.length-1;Bx(e,t,s,o,n,r,i)})}(e,t,n,r,i.columns),Ux(e,t,r,i.columns)});else for(var a=-1,o=i[0],l=function(){var s=a;if(o){e.applyStyles(e.userStyles);var l=o.columns;a>=0?Gx(e,t,n,r,l,!0):Ox(e,t,r,l),s=Dx(e,t,a+1,r,l),Ux(e,t,r,l)}var c=s-a;i.slice(1).forEach(function(i){e.applyStyles(e.userStyles),Gx(e,t,n,r,i.columns,!0),Dx(e,t,a+1,r,i.columns,c),Ux(e,t,r,i.columns)}),a=s};a<t.body.length-1;)l()}(l,t,c,s):(l.applyStyles(l.userStyles),"firstPage"!==n.showHead&&"everyPage"!==n.showHead||t.head.forEach(function(e){return Vx(l,t,e,s,t.columns)}),l.applyStyles(l.userStyles),t.body.forEach(function(e,n){var r=n===t.body.length-1;Bx(l,t,e,r,c,s,t.columns)}),l.applyStyles(l.userStyles),"lastPage"!==n.showFoot&&"everyPage"!==n.showFoot||t.foot.forEach(function(e){return Vx(l,t,e,s,t.columns)})),cx(l,t,c,s),t.callEndPageHooks(l,s),t.finalY=s.y,e.lastAutoTable=t,l.applyStyles(l.userStyles)}function Ox(e,t,n,r){var i=t.settings;e.applyStyles(e.userStyles),"firstPage"!==i.showHead&&"everyPage"!==i.showHead||t.head.forEach(function(i){return Vx(e,t,i,n,r)})}function Dx(e,t,n,r,i,s){e.applyStyles(e.userStyles),s=null!==s&&void 0!==s?s:t.body.length;var a=Math.min(n+s,t.body.length),o=-1;return t.body.slice(n,a).forEach(function(s,a){var l=n+a===t.body.length-1,c=Wx(e,t,l,r);s.canEntireRowFit(c,i)&&(Vx(e,t,s,r,i),o=n+a)}),o}function Ux(e,t,n,r){var i=t.settings;e.applyStyles(e.userStyles),"lastPage"!==i.showFoot&&"everyPage"!==i.showFoot||t.foot.forEach(function(i){return Vx(e,t,i,n,r)})}function zx(e,t,n){var r=n.getLineHeight(e.styles.fontSize),i=e.padding("vertical"),s=Math.floor((t-i)/r);return Math.max(0,s)}function Bx(e,t,n,r,i,s,a){var o=Wx(e,t,r,s);if(n.canEntireRowFit(o,a))Vx(e,t,n,s,a);else if(function(e,t,n,r){var i=e.pageSize().height,s=r.settings.margin,a=i-(s.top+s.bottom);"body"===t.section&&(a-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var o=t.getMinimumRowHeight(r.columns,e),l=o<n;if(o>a)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!l)return!1;var c=t.hasRowSpan(r.columns);return t.getMaxCellHeight(r.columns)>a?(c&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!c&&"avoid"!==r.settings.rowPageBreak}(e,n,o,t)){var l=function(e,t,n,r){var i={};e.spansMultiplePages=!0,e.height=0;for(var s=0,a=0,o=n.columns;a<o.length;a++){var l=o[a];if(g=e.cells[l.index]){Array.isArray(g.text)||(g.text=[g.text]),(f=yx(f=new Ax(g.raw,g.styles,g.section),g)).text=[];var c=zx(g,t,r);g.text.length>c&&(f.text=g.text.splice(c,g.text.length));var d=r.scaleFactor(),u=r.getLineHeightFactor();g.contentHeight=g.getContentHeight(d,u),g.contentHeight>=t&&(g.contentHeight=t,f.styles.minCellHeight-=t),g.contentHeight>e.height&&(e.height=g.contentHeight),f.contentHeight=f.getContentHeight(d,u),f.contentHeight>s&&(s=f.contentHeight),i[l.index]=f}}var h=new jx(e.raw,-1,e.section,i,!0);h.height=s;for(var p=0,m=n.columns;p<m.length;p++){var f,g;l=m[p],(f=h.cells[l.index])&&(f.height=h.height),(g=e.cells[l.index])&&(g.height=e.height)}return h}(n,o,t,e);Vx(e,t,n,s,a),Gx(e,t,i,s,a),Bx(e,t,l,r,i,s,a)}else Gx(e,t,i,s,a),Bx(e,t,n,r,i,s,a)}function Vx(e,t,n,r,i){r.x=t.settings.margin.left;for(var s=0,a=i;s<a.length;s++){var o=a[s],l=n.cells[o.index];if(l)if(e.applyStyles(l.styles),l.x=r.x,l.y=r.y,!1!==t.callCellHooks(e,t.hooks.willDrawCell,l,n,o,r)){Hx(e,l,r);var c=l.getTextPos();nx(l.text,c.x,c.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,l,n,o,r),r.x+=o.width}else r.x+=o.width;else r.x+=o.width}r.y+=n.height}function Hx(e,t,n){var r=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),"number"===typeof r.lineWidth){var i=dx(r.lineWidth,r.fillColor);i&&e.rect(t.x,n.y,t.width,t.height,i)}else"object"===typeof r.lineWidth&&(r.fillColor&&e.rect(t.x,n.y,t.width,t.height,"F"),function(e,t,n,r){var i,s,a,o;r.top&&(i=n.x,s=n.y,a=n.x+t.width,o=n.y,r.right&&(a+=.5*r.right),r.left&&(i-=.5*r.left),l(r.top,i,s,a,o));r.bottom&&(i=n.x,s=n.y+t.height,a=n.x+t.width,o=n.y+t.height,r.right&&(a+=.5*r.right),r.left&&(i-=.5*r.left),l(r.bottom,i,s,a,o));r.left&&(i=n.x,s=n.y,a=n.x,o=n.y+t.height,r.top&&(s-=.5*r.top),r.bottom&&(o+=.5*r.bottom),l(r.left,i,s,a,o));r.right&&(i=n.x+t.width,s=n.y,a=n.x+t.width,o=n.y+t.height,r.top&&(s-=.5*r.top),r.bottom&&(o+=.5*r.bottom),l(r.right,i,s,a,o));function l(t,n,r,i,s){e.getDocument().setLineWidth(t),e.getDocument().line(n,r,i,s,"S")}}(e,t,n,r.lineWidth))}function Wx(e,t,n,r){var i=t.settings.margin.bottom,s=t.settings.showFoot;return("everyPage"===s||"lastPage"===s&&n)&&(i+=t.getFootHeight(t.columns)),e.pageSize().height-r.y-i}function Gx(e,t,n,r,i,s){void 0===i&&(i=[]),void 0===s&&(s=!1),e.applyStyles(e.userStyles),"everyPage"!==t.settings.showFoot||s||t.foot.forEach(function(n){return Vx(e,t,n,r,i)}),t.callEndPageHooks(e,r);var a=t.settings.margin;cx(e,t,n,r),qx(e),t.pageNumber++,r.x=a.left,r.y=a.top,n.y=a.top,t.callWillDrawPageHooks(e,r),"everyPage"===t.settings.showHead&&(t.head.forEach(function(n){return Vx(e,t,n,r,i)}),e.applyStyles(e.userStyles))}function qx(e){var t=e.pageNumber();return e.setPage(t+1),e.pageNumber()===t&&(e.addPage(),!0)}try{if("undefined"!==typeof window&&window){var Xx=window,Yx=Xx.jsPDF||(null===(wx=Xx.jspdf)||void 0===wx?void 0:wx.jsPDF);Yx&&function(e){e.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Fx(this,Tx(this,bx(this,e[0]))),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(e,t,n,r){nx(e,t,n,r,this)},e.API.autoTableSetDefaults=function(e){return ix.setDefaults(e,this),this},e.autoTableSetDefaults=function(e,t){ix.setDefaults(e,t)},e.API.autoTableHtmlToJson=function(e,t){var n;if(void 0===t&&(t=!1),"undefined"===typeof window)return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var r=gx(new ix(this),e,window,t,!1),i=r.head,s=r.body,a=(null===(n=i[0])||void 0===n?void 0:n.map(function(e){return e.content}))||[];return{columns:a,rows:s,data:s}}}(Yx)}}catch(nU){console.error("Could not apply autoTable plugin",nU)}const Zx=()=>{const e=ne(),{user:t,isAuthenticated:n}=Be(),[r,s]=(0,i.useState)({totalOrders:0,pendingOrders:0,totalRevenue:0,totalCustomers:0,lowStockItems:0,todaySales:0,recentOrders:[],lowStockAlerts:[],topProducts:[],feedback:{totalFeedback:0,averageRating:0,recentFeedback:[],ratingDistribution:{1:0,2:0,3:0,4:0,5:0}}}),[a,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)(""),[d,u]=(0,i.useState)("overview");(0,i.useEffect)(()=>{n&&t&&"admin"===t.user_type||e("/")},[n,t,e]),(0,i.useEffect)(()=>{h()},[]);const h=async()=>{try{c(""),o(!0),console.log("Loading dashboard data...");try{console.log("Fetching dashboard data from admin endpoint...");const e=await fetch("http://localhost:8000/api/orders/admin-dashboard/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("Dashboard response status:",e.status),e.ok){const t=await e.json();console.log("Dashboard data received:",t);const n=t.overview||{},r=t.orders||{},i=t.inventory||{},a=await fetch("http://localhost:8000/api/feedback/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});let o={totalFeedback:0,averageRating:0,recentFeedback:[],ratingDistribution:{1:0,2:0,3:0,4:0,5:0}};if(a.ok){const e=await a.json();console.log("Raw feedback data from API:",e);const t=Array.isArray(e)?e:e.results||[];console.log("Processed feedback list:",t);const n={1:0,2:0,3:0,4:0,5:0};Array.isArray(t)&&t.forEach(e=>{e.rating&&e.rating>=1&&e.rating<=5&&(n[e.rating]=(n[e.rating]||0)+1)}),o={totalFeedback:t.length,averageRating:t.length>0?(t.reduce((e,t)=>e+(parseFloat(t.rating)||0),0)/t.length).toFixed(1):0,recentFeedback:t.slice(0,5),ratingDistribution:n},console.log("Final feedback data:",o)}else console.error("Failed to load feedback data:",a.status);return void s({totalOrders:n.total_orders||0,pendingOrders:n.pending_orders||0,totalRevenue:n.total_revenue||0,totalCustomers:n.total_customers||0,lowStockItems:n.low_stock_items||0,todaySales:n.today_sales||0,recentOrders:r.recent_orders||[],lowStockAlerts:i.low_stock_alerts||[],topProducts:[],feedback:o})}{const t=await e.text();console.error("Failed to load dashboard data:",e.status,t),c("Dashboard API error: ".concat(e.status," - ").concat(t))}}catch(e){console.error("Dashboard API error:",e),c("Dashboard API error: ".concat(e.message))}console.log("Falling back to individual API calls...");let a=0,l=0,d=0,u=0,h=0,p=0,m=[],f=[],g=[];try{console.log("Fetching orders data...");const e=await fetch("http://localhost:8000/api/orders/orders/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("Orders response status:",e.status),e.ok){const t=await e.json();if(console.log("Orders data received:",t),Array.isArray(t)){a=t.length,l=t.filter(e=>["pending","confirmed","preparing"].includes(e.order_status)).length,d=t.reduce((e,t)=>{const n=parseFloat(t.total_amount||0);return e+(isNaN(n)?0:n)},0),m=t.slice(0,5);const e=(new Date).toISOString().split("T")[0];p=t.filter(t=>t.created_at&&t.created_at.startsWith(e)).reduce((e,t)=>{const n=parseFloat(t.total_amount||0);return e+(isNaN(n)?0:n)},0)}}else{const t=await e.text();console.error("Failed to load orders data:",e.status,t)}}catch(t){console.error("Orders API error:",t)}try{console.log("Fetching inventory data...");const e=await fetch("http://localhost:8000/api/inventory/ingredients/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("Inventory response status:",e.status),e.ok){const t=await e.json();console.log("Inventory data received:",t),Array.isArray(t)&&(f=t.filter(e=>e.current_stock<=e.minimum_stock),h=f.length)}else{const t=await e.text();console.error("Failed to load inventory data:",e.status,t)}}catch(n){console.error("Inventory API error:",n)}try{console.log("Fetching users data...");const e=await fetch("http://localhost:8000/api/users/users/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("Users response status:",e.status),e.ok){const t=await e.json();console.log("Users data received:",t),Array.isArray(t)&&(u=t.filter(e=>"customer"===e.user_type).length)}else{const t=await e.text();console.error("Failed to load users data:",e.status,t)}}catch(r){console.error("Users API error:",r)}let x={totalFeedback:0,averageRating:0,recentFeedback:[],ratingDistribution:{1:0,2:0,3:0,4:0,5:0}};try{console.log("Loading feedback data in fallback...");const e=await fetch("http://localhost:8000/api/feedback/feedback/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(e.ok){const t=await e.json();console.log("Raw feedback data from fallback API:",t);const n=Array.isArray(t)?t:t.results||[];console.log("Processed feedback list in fallback:",n);const r={1:0,2:0,3:0,4:0,5:0};Array.isArray(n)&&n.forEach(e=>{e.rating&&e.rating>=1&&e.rating<=5&&(r[e.rating]=(r[e.rating]||0)+1)}),x={totalFeedback:n.length,averageRating:n.length>0?(n.reduce((e,t)=>e+(parseFloat(t.rating)||0),0)/n.length).toFixed(1):0,recentFeedback:n.slice(0,5),ratingDistribution:r},console.log("Final feedback data from fallback:",x)}else console.error("Failed to load feedback data in fallback:",e.status)}catch(i){console.error("Feedback API error in fallback:",i)}const v={totalOrders:a,pendingOrders:l,totalRevenue:d,totalCustomers:u,lowStockItems:h,todaySales:p,recentOrders:m,lowStockAlerts:f,topProducts:g,feedback:x};console.log("Setting dashboard data:",v),s(v)}catch(l){console.error("Error loading dashboard data:",l),c("Dashboard error: ".concat(l.message)),s({totalOrders:0,pendingOrders:0,totalRevenue:0,totalCustomers:0,lowStockItems:0,todaySales:0,recentOrders:[],lowStockAlerts:[],topProducts:[],feedback:{totalFeedback:0,averageRating:0,recentFeedback:[],ratingDistribution:{1:0,2:0,3:0,4:0,5:0}}})}finally{o(!1)}},p=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-blue-100 text-blue-800";case"preparing":return"bg-purple-100 text-purple-800";case"ready":case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},m=e=>"RS ".concat(e.toFixed(2)),f=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return!a&&n&&t&&"admin"===t.user_type?l&&"Network error occurred. Please check your connection."!==l?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Error Loading Dashboard"}),(0,Ue.jsx)("p",{className:"text-red-600 mb-4",children:l}),(0,Ue.jsx)("button",{onClick:()=>{c(""),o(!0),h()},className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Try Again"})]})})}):(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Welcome back! Here's what's happening with your bakery today."})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsxs)("button",{onClick:()=>{o(!0),h()},disabled:a,className:"bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-lg transition-colors disabled:opacity-50",children:[a?(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 inline mr-2"}):(0,Ue.jsx)("svg",{className:"h-4 w-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]}),(0,Ue.jsxs)("button",{onClick:()=>e("/profile"),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg transition-colors",children:[(0,Ue.jsx)(Zl,{className:"h-5 w-5 inline mr-2"}),"Profile"]}),(0,Ue.jsx)("button",{onClick:()=>e("/"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Back to Site"})]})]})})}),(0,Ue.jsx)("div",{className:"bg-white border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsx)("nav",{className:"flex space-x-8",children:[{id:"overview",name:"Overview",icon:Ql},{id:"orders",name:"Orders",icon:tc},{id:"inventory",name:"Inventory",icon:El},{id:"customers",name:"Customers",icon:Zl},{id:"reports",name:"Reports",icon:ic}].map(e=>(0,Ue.jsxs)("button",{onClick:()=>u(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ".concat(d===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,Ue.jsx)(e.icon,{className:"h-5 w-5"}),(0,Ue.jsx)("span",{children:e.name})]},e.id))})})}),(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["overview"===d&&(0,Ue.jsxs)("div",{className:"space-y-8",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,Ue.jsx)(tc,{className:"h-6 w-6 text-blue-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:r.totalOrders})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,Ue.jsx)(oc,{className:"h-6 w-6 text-yellow-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending Orders"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:r.pendingOrders})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,Ue.jsx)(Rl,{className:"h-6 w-6 text-green-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:m(r.totalRevenue)})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,Ue.jsx)(Zl,{className:"h-6 w-6 text-purple-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Customers"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:r.totalCustomers})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,Ue.jsx)(dc,{className:"h-6 w-6 text-yellow-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Rating"}),(0,Ue.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:[r.feedback.averageRating,"/5"]}),(0,Ue.jsxs)("p",{className:"text-xs text-gray-500",children:[r.feedback.totalFeedback," reviews"]})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Quick Actions"})}),(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ue.jsxs)("button",{onClick:()=>e("/admin/orders"),className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,Ue.jsx)(tc,{className:"h-8 w-8 text-blue-600 mr-3"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:"Manage Orders"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Update status, track delivery"})]})]}),(0,Ue.jsxs)("button",{onClick:()=>u("inventory"),className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,Ue.jsx)(El,{className:"h-8 w-8 text-green-600 mr-3"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:"Inventory"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Check stock levels"})]})]}),(0,Ue.jsxs)("button",{onClick:()=>u("customers"),className:"flex items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,Ue.jsx)(Zl,{className:"h-8 w-8 text-purple-600 mr-3"}),(0,Ue.jsxs)("div",{className:"text-left",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:"Customers"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"View customer data"})]})]})]}),(0,Ue.jsx)("div",{className:"mt-6 grid grid-cols-1 gap-4",children:(0,Ue.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)("div",{className:"flex items-center justify-between",children:(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:"Catalog Management"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Manage cakes, categories and offers"})]})}),(0,Ue.jsxs)("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,Ue.jsx)("button",{onClick:()=>e("/admin/catalog?tab=cakes"),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Manage Cakes"}),(0,Ue.jsx)("button",{onClick:()=>e("/admin/catalog?tab=categories"),className:"flex-1 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Manage Categories"}),(0,Ue.jsx)("button",{onClick:()=>e("/admin/offers"),className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Manage Offers"})]})]})})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Orders"})}),(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsx)("div",{className:"space-y-4",children:(r.recentOrders||[]).map(e=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("p",{className:"font-medium text-gray-900",children:["#",e.order_number]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:f(e.created_at)})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:m(e.total_amount)}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(p(e.order_status)),children:e.order_status.replace("_"," ")})]})]},e.id))}),(0,Ue.jsx)("button",{onClick:()=>e("/admin/orders"),className:"w-full mt-4 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"View All Orders"})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Customer Feedback"})}),(0,Ue.jsxs)("div",{className:"p-6",children:[(r.feedback.recentFeedback||[]).length>0?(0,Ue.jsx)("div",{className:"space-y-4",children:(r.feedback.recentFeedback||[]).map(e=>{var t;return(0,Ue.jsx)("div",{className:"border-b border-gray-200 pb-4 last:border-b-0",children:(0,Ue.jsx)("div",{className:"flex items-start justify-between",children:(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Ue.jsx)("div",{className:"flex",children:[1,2,3,4,5].map(t=>(0,Ue.jsx)(dc,{className:"h-4 w-4 ".concat(t<=e.rating?"text-yellow-400 fill-current":"text-gray-300")},t))}),(0,Ue.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:(null===(t=e.customer)||void 0===t?void 0:t.username)||"Anonymous"})]}),(0,Ue.jsx)("p",{className:"text-gray-900 text-sm mb-2",children:e.message}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500",children:f(e.created_at)})]})})},e.id)})}):(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)(dc,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"No feedback received yet"})]}),(0,Ue.jsx)("button",{onClick:()=>e("/admin/reports"),className:"w-full mt-4 bg-yellow-600 text-white py-2 px-4 rounded-lg hover:bg-yellow-700 transition-colors",children:"View All Feedback"})]})]})]})]}),"orders"===d&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Order Management"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(tc,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Manage Orders"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Update order status, track delivery, and manage customer orders"}),(0,Ue.jsx)("button",{onClick:()=>e("/admin/orders"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Go to Orders"})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(pc,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delivery Tracking"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Monitor delivery status and update customer notifications"}),(0,Ue.jsx)("button",{onClick:()=>e("/admin/orders"),className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Track Delivery"})]})]})})]}),"inventory"===d&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Inventory Management"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(El,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Stock Levels"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Monitor current stock levels and set reorder points"}),(0,Ue.jsx)("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"View Stock"})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(ic,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Purchase Orders"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Create and manage purchase orders with suppliers"}),(0,Ue.jsx)("button",{className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Manage PO"})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(jl,{className:"h-16 w-16 text-red-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Low Stock Alerts"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Get notified when items need reordering"}),(0,Ue.jsx)("button",{className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"View Alerts"})]})]})})]}),"customers"===d&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Customer Management"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(Zl,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Customer Database"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"View and manage customer information and order history"}),(0,Ue.jsx)("button",{onClick:()=>{console.log("View Customers clicked, navigating to /admin/customers?tab=customers"),console.log("Current user:",t),console.log("Is authenticated:",n),e("/admin/customers?tab=customers")},className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"View Customers"})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(Ql,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Purchase History"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"View comprehensive purchase history and analytics"}),(0,Ue.jsx)("button",{onClick:()=>e("/admin/purchase-history"),className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"View Purchase History"})]})]})})]}),"reports"===d&&(0,Ue.jsxs)("div",{className:"space-y-8",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Business Reports"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Generate and download business reports as PDF"})]}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(dc,{className:"h-16 w-16 text-yellow-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-xl font-medium text-gray-900 mb-2",children:"Feedback Report"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Download customer feedback analysis as PDF"}),(0,Ue.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Total Feedback:"})," ",r.feedback.totalFeedback]}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Avg Rating:"})," ",r.feedback.averageRating,"/5"]}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Recent Reviews:"})," ",r.feedback.recentFeedback.length]})]}),(0,Ue.jsxs)("button",{onClick:async()=>{try{var e;console.log("Generating feedback PDF...");const t=r.feedback;if(!t.totalFeedback&&(null===(e=t.recentFeedback)||void 0===e||!e.length))return void alert("No feedback data found. Please ensure there are customer reviews to generate a report.");const n=new lf,i=(new Date).toLocaleDateString();let s=20;if(n.setFontSize(20),n.text("Customer Feedback Report",20,s),s+=15,n.setFontSize(12),n.text("Generated on: ".concat(i),20,s),s+=15,n.setFontSize(14),n.text("Feedback Summary",20,s),s+=15,n.setFontSize(10),n.text("Total Feedback: ".concat(t.totalFeedback),20,s),s+=8,n.text("Average Rating: ".concat((parseFloat(t.averageRating)||0).toFixed(2),"/5.0"),20,s),s+=8,n.text("Recent Reviews: ".concat(t.recentFeedback.length),20,s),s+=15,t.ratingDistribution){n.setFontSize(14),n.text("Rating Distribution",20,s),s+=15,n.setFontSize(10);for(let e=5;e>=1;e--){const r=t.ratingDistribution[e]||0;n.text("".concat(e," Stars: ").concat(r," reviews"),20,s),s+=6}s+=10}t.recentFeedback.length>0&&(n.setFontSize(14),n.text("Recent Customer Feedback",20,s),s+=15,n.setFontSize(8),t.recentFeedback.slice(0,15).forEach((e,t)=>{var r,i;const a=e.comment||e.message||"No comment",o=a.length>60?a.substring(0,60)+"...":a,l=(null===(r=e.customer)||void 0===r?void 0:r.username)||(null===(i=e.customer)||void 0===i?void 0:i.first_name)||"Anonymous",c=e.rating||"N/A";n.text("".concat(t+1,". ").concat(l," - ").concat(c," stars"),20,s),s+=5,n.text('   "'.concat(o,'"'),20,s),s+=8,s>250&&(n.addPage(),s=20)}));const a="Feedback_Report_".concat((new Date).toISOString().split("T")[0],".pdf");n.save(a),alert("PDF report generated successfully!")}catch(l){console.error("Error generating PDF:",l),alert("Failed to generate PDF report. Error: ".concat(l.message))}},className:"bg-yellow-600 text-white px-6 py-3 rounded-lg hover:bg-yellow-700 transition-colors flex items-center justify-center mx-auto space-x-2",children:[(0,Ue.jsx)(gc,{className:"h-5 w-5"}),(0,Ue.jsx)("span",{children:"Download Feedback Report"})]})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(tc,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-xl font-medium text-gray-900 mb-2",children:"Order Report"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Download order analysis and sales data as PDF"}),(0,Ue.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Total Orders:"})," ",r.totalOrders]}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Pending Orders:"})," ",r.pendingOrders]}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Total Revenue:"})," ",m(r.totalRevenue)]})]}),(0,Ue.jsxs)("button",{onClick:async()=>{try{var e;if(console.log("Generating order PDF..."),!r.totalOrders&&(null===(e=r.recentOrders)||void 0===e||!e.length))return void alert("No order data found. Please ensure there are orders to generate a report.");const t=new lf,n=(new Date).toLocaleDateString();let i=20;t.setFontSize(20),t.text("Order Report",20,i),i+=15,t.setFontSize(12),t.text("Generated on: ".concat(n),20,i),i+=15,t.setFontSize(14),t.text("Order Summary",20,i),i+=15,t.setFontSize(10),t.text("Total Orders: ".concat(r.totalOrders),20,i),i+=8,t.text("Pending Orders: ".concat(r.pendingOrders),20,i),i+=8,t.text("Total Revenue: ".concat(m(r.totalRevenue)),20,i),i+=8,t.text("Today's Sales: ".concat(m(r.todaySales)),20,i),i+=15,r.recentOrders&&r.recentOrders.length>0&&(t.setFontSize(14),t.text("Recent Orders",20,i),i+=15,t.setFontSize(8),r.recentOrders.slice(0,15).forEach((e,n)=>{var r,s;const a=new Date(e.created_at).toLocaleDateString(),o=(null===(r=e.customer)||void 0===r?void 0:r.username)||(null===(s=e.customer)||void 0===s?void 0:s.first_name)||"Anonymous",l=e.order_status||"Unknown",c=m(parseFloat(e.total_amount)||0);t.text("".concat(n+1,". Order #").concat(e.id," - ").concat(o),20,i),i+=5,t.text("   Date: ".concat(a," | Status: ").concat(l," | Amount: ").concat(c),20,i),i+=8,i>250&&(t.addPage(),i=20)}));const s="Order_Report_".concat((new Date).toISOString().split("T")[0],".pdf");t.save(s),alert("Order PDF report generated successfully!")}catch(l){console.error("Error generating order PDF:",l),alert("Failed to generate order PDF report. Error: ".concat(l.message))}},className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center mx-auto space-x-2",children:[(0,Ue.jsx)(gc,{className:"h-5 w-5"}),(0,Ue.jsx)("span",{children:"Download Order Report"})]})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Quick Reports Overview"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Rating Distribution"}),(0,Ue.jsx)("div",{className:"space-y-3",children:[5,4,3,2,1].map(e=>(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsxs)("span",{className:"text-sm font-medium text-gray-700 w-8",children:[e,"\u2605"]}),(0,Ue.jsx)("div",{className:"flex-1 mx-3 bg-gray-200 rounded-full h-2",children:(0,Ue.jsx)("div",{className:"bg-yellow-400 h-2 rounded-full",style:{width:"".concat(r.feedback.totalFeedback>0?r.feedback.ratingDistribution[e]/r.feedback.totalFeedback*100:0,"%")}})}),(0,Ue.jsx)("span",{className:"text-sm text-gray-600 w-8",children:r.feedback.ratingDistribution[e]||0})]},e))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Recent Orders Status"}),(0,Ue.jsx)("div",{className:"space-y-3",children:r.recentOrders.slice(0,5).map(e=>(0,Ue.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("span",{className:"text-sm font-medium",children:["#",e.order_number]}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500",children:f(e.created_at)})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("span",{className:"text-sm font-medium",children:m(e.total_amount)}),(0,Ue.jsx)("span",{className:"block px-2 py-1 rounded-full text-xs font-medium ".concat(p(e.order_status)),children:e.order_status.replace("_"," ")})]})]},e.id))})]})]})})]})]})]})]}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})})},Jx="http://localhost:8000/api",Kx=()=>{const{isAuthenticated:e,user:t}=Be(),[n,r]=(0,i.useState)([]),[s,a]=(0,i.useState)(!0),[o,l]=(0,i.useState)(""),[c,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(null),[p,m]=(0,i.useState)(!1),f=[{value:"percentage",label:"Percentage Discount"},{value:"fixed",label:"Fixed Amount Discount"},{value:"free_delivery",label:"Free Delivery"},{value:"buy_one_get_one",label:"Buy One Get One"},{value:"special",label:"Special Offer"}],g={title:"",description:"",offer_type:"percentage",status:"draft",discount_percentage:"",discount_amount:"",minimum_order_amount:"0",start_date:(new Date).toISOString().slice(0,16),end_date:new Date(Date.now()+6048e5).toISOString().slice(0,16),is_homepage_featured:!0,is_popup:!1,background_color:"#FF6B6B",text_color:"#FFFFFF",max_usage:"",target_user_types:[],banner_image:null},[x,v]=(0,i.useState)(g);(0,i.useEffect)(()=>{y()},[]);const y=async()=>{try{a(!0),l("");const e=localStorage.getItem("token"),t=await fetch("".concat(Jx,"/offers/"),{headers:{Authorization:"Token ".concat(e)}});if(!t.ok)throw new Error("Load offers failed: ".concat(t.status));const n=await t.json();r(Array.isArray(n)?n:n.results||[])}catch(AB){l(AB.message)}finally{a(!1)}},b=e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"draft":default:return"bg-gray-100 text-gray-800";case"expired":return"bg-red-100 text-red-800";case"paused":return"bg-yellow-100 text-yellow-800"}};return e&&t&&"admin"===t.user_type?(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Offer Management"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Create, edit, and schedule offers and banners"})]}),(0,Ue.jsx)("button",{onClick:()=>{h(null),v(g),d(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Add Offer"})]})})}),(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded",children:o}),s?(0,Ue.jsx)("div",{className:"py-12 text-center text-gray-600",children:"Loading..."}):(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Discount"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valid Until"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Display"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:(n||[]).map(e=>{var t,n;return(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title})}),(0,Ue.jsx)("td",{className:"px-6 py-4",children:(0,Ue.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",title:e.description,children:e.description||"-"})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(null===(t=f.find(t=>t.value===e.offer_type))||void 0===t?void 0:t.label)||e.offer_type}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(b(e.status)),children:e.status})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.discount_display||"-"}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(n=e.end_date,new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}))}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[e.is_homepage_featured&&(0,Ue.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Homepage"}),e.is_popup&&(0,Ue.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded",children:"Popup"})]})}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[(0,Ue.jsx)("button",{onClick:()=>(e=>{h(e),v({title:e.title||"",description:e.description||"",offer_type:e.offer_type||"percentage",status:e.status||"draft",discount_percentage:e.discount_percentage||"",discount_amount:e.discount_amount||"",minimum_order_amount:e.minimum_order_amount||"0",start_date:e.start_date?new Date(e.start_date).toISOString().slice(0,16):"",end_date:e.end_date?new Date(e.end_date).toISOString().slice(0,16):"",is_homepage_featured:!!e.is_homepage_featured,is_popup:!!e.is_popup,background_color:e.background_color||"#FF6B6B",text_color:e.text_color||"#FFFFFF",max_usage:e.max_usage||"",target_user_types:e.target_user_types||[],banner_image:null}),d(!0)})(e),className:"text-indigo-600 hover:text-indigo-900",children:"Edit"}),(0,Ue.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Delete this offer?"))try{const t=localStorage.getItem("token"),n=await fetch("".concat(Jx,"/offers/").concat(e,"/"),{method:"DELETE",headers:{Authorization:"Token ".concat(t)}});if(204!==n.status)throw new Error("Delete failed: ".concat(n.status));r(t=>t.filter(t=>t.id!==e))}catch(AB){alert(AB.message)}})(e.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id)})})]})})}),c&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,Ue.jsxs)("div",{className:"px-6 py-4 border-b flex items-center justify-between",children:[(0,Ue.jsx)("h4",{className:"text-lg font-semibold",children:u?"Edit Offer":"Add Offer"}),(0,Ue.jsx)("button",{onClick:()=>{d(!1),h(null)},className:"text-gray-500 hover:text-gray-700",children:"\u2715"})]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{m(!0);const e=localStorage.getItem("token"),n=new FormData;n.append("title",x.title),n.append("description",x.description),n.append("offer_type",x.offer_type),n.append("status",x.status),n.append("minimum_order_amount",x.minimum_order_amount),n.append("start_date",x.start_date),n.append("end_date",x.end_date),n.append("is_homepage_featured",x.is_homepage_featured),n.append("is_popup",x.is_popup),n.append("background_color",x.background_color),n.append("text_color",x.text_color),n.append("target_user_types",JSON.stringify(x.target_user_types)),u||n.append("created_by",t.id),x.discount_percentage&&n.append("discount_percentage",x.discount_percentage),x.discount_amount&&n.append("discount_amount",x.discount_amount),x.max_usage&&n.append("max_usage",x.max_usage),x.banner_image&&n.append("banner_image",x.banner_image);const r=u?"PUT":"POST",i=u?"".concat(Jx,"/offers/").concat(u.id,"/"):"".concat(Jx,"/offers/"),s=await fetch(i,{method:r,headers:{Authorization:"Token ".concat(e)},body:n});if(!s.ok){const e=await s.text();throw new Error("Save failed: ".concat(s.status," ").concat(e))}await y(),d(!1),h(null),v(g)}catch(n){alert(n.message)}finally{m(!1)}},className:"p-6 space-y-6",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,Ue.jsx)("input",{value:x.title,onChange:e=>v(qe(qe({},x),{},{title:e.target.value})),required:!0,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Offer Type"}),(0,Ue.jsx)("select",{value:x.offer_type,onChange:e=>v(qe(qe({},x),{},{offer_type:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:f.map(e=>(0,Ue.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,Ue.jsx)("select",{value:x.status,onChange:e=>v(qe(qe({},x),{},{status:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:"draft",label:"Draft"},{value:"active",label:"Active"},{value:"expired",label:"Expired"},{value:"paused",label:"Paused"}].map(e=>(0,Ue.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Order Amount"}),(0,Ue.jsx)("input",{type:"number",step:"0.01",value:x.minimum_order_amount,onChange:e=>v(qe(qe({},x),{},{minimum_order_amount:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),"percentage"===x.offer_type&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Percentage"}),(0,Ue.jsx)("input",{type:"number",step:"0.01",min:"0",max:"100",value:x.discount_percentage,onChange:e=>v(qe(qe({},x),{},{discount_percentage:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),"fixed"===x.offer_type&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Amount"}),(0,Ue.jsx)("input",{type:"number",step:"0.01",min:"0",value:x.discount_amount,onChange:e=>v(qe(qe({},x),{},{discount_amount:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,Ue.jsx)("input",{type:"datetime-local",value:x.start_date,onChange:e=>v(qe(qe({},x),{},{start_date:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,Ue.jsx)("input",{type:"datetime-local",value:x.end_date,onChange:e=>v(qe(qe({},x),{},{end_date:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Usage (optional)"}),(0,Ue.jsx)("input",{type:"number",min:"1",value:x.max_usage,onChange:e=>v(qe(qe({},x),{},{max_usage:e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Background Color"}),(0,Ue.jsx)("input",{type:"color",value:x.background_color,onChange:e=>v(qe(qe({},x),{},{background_color:e.target.value})),className:"w-full h-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Text Color"}),(0,Ue.jsx)("input",{type:"color",value:x.text_color,onChange:e=>v(qe(qe({},x),{},{text_color:e.target.value})),className:"w-full h-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,Ue.jsx)("textarea",{value:x.description,onChange:e=>v(qe(qe({},x),{},{description:e.target.value})),rows:3,required:!0,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Banner Image"}),(0,Ue.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return v(qe(qe({},x),{},{banner_image:(null===(t=e.target.files)||void 0===t?void 0:t[0])||null}))},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,Ue.jsxs)("label",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:x.is_homepage_featured,onChange:e=>v(qe(qe({},x),{},{is_homepage_featured:e.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,Ue.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Show on Homepage"})]}),(0,Ue.jsxs)("label",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:x.is_popup,onChange:e=>v(qe(qe({},x),{},{is_popup:e.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,Ue.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Show as Popup"})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:()=>{d(!1),h(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:p,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:p?"Saving...":u?"Update":"Create"})]})]})]})})]})]}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsx)("p",{className:"text-gray-600",children:"Unauthorized"})})})},Qx=()=>{const e=ne(),{user:t,isAuthenticated:n,loading:r}=Be(),[s,a]=(0,i.useState)([]),[o,l]=(0,i.useState)(!0),[c,d]=(0,i.useState)(null),[u,h]=(0,i.useState)({}),[p,m]=(0,i.useState)(null),f=["pending","confirmed","preparing","ready","out_for_delivery","delivered","cancelled"],g=async()=>{try{l(!0),m(null),console.log("Loading orders...");const e=localStorage.getItem("token");if(console.log("Token found:",!!e),console.log("Token value:",e?e.substring(0,20)+"...":"null"),!e)throw new Error("No authentication token found");const t=await fetch("http://localhost:8000/api/orders/orders/",{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});if(console.log("Response status:",t.status),console.log("Response headers:",Object.fromEntries(t.headers.entries())),t.ok){const e=await t.json();console.log("Orders data:",e),console.log("Data type:",typeof e),console.log("Is array:",Array.isArray(e));let n=e;if(e&&e.results&&Array.isArray(e.results))n=e.results;else if(e&&e.data&&Array.isArray(e.data))n=e.data;else if(Array.isArray(e))n=e;else{if(!(e&&e.orders&&Array.isArray(e.orders)))return console.error("API response is not in expected format:",e),a([]),void m("Invalid data format received from server. Expected array but got: "+typeof e);n=e.orders}a(n),m(null)}else{const e=await t.json();console.error("API Error:",e),m("Failed to load orders: "+(e.detail||"Unknown error")),a([])}}catch(p){console.error("Error loading orders:",p),m("Error loading orders: "+p.message),a([])}finally{l(!1)}};(0,i.useEffect)(()=>{g()},[]);const x=e=>{switch(e){case"pending":return(0,Ue.jsx)(oc,{className:"h-5 w-5 text-yellow-500"});case"confirmed":case"preparing":return(0,Ue.jsx)(oc,{className:"h-5 w-5 text-blue-500"});case"ready":case"out_for_delivery":return(0,Ue.jsx)(pc,{className:"h-5 w-5 text-purple-500"});case"delivered":return(0,Ue.jsx)(_l,{className:"h-5 w-5 text-green-500"});case"cancelled":return(0,Ue.jsx)(jl,{className:"h-5 w-5 text-red-500"});default:return(0,Ue.jsx)(oc,{className:"h-5 w-5 text-gray-500"})}},v=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":case"preparing":return"bg-blue-100 text-blue-800";case"ready":case"out_for_delivery":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},y=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return r||o?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading orders..."})]})}):p?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ue.jsx)(jl,{className:"h-12 w-12 text-red-500"})}),(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Orders"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-6",children:p}),(0,Ue.jsx)("button",{onClick:g,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Orders"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Manage orders and update shipping status"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,Ue.jsx)("div",{className:"lg:col-span-3",children:(0,Ue.jsx)("div",{className:"space-y-4",children:Array.isArray(s)&&0!==s.length?Array.isArray(s)&&s.map(e=>{var t,n,r,i,s;return(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h3",{className:"font-semibold text-lg",children:["Order #",e.order_number]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:y(e.created_at)}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["Customer: ",(null===(t=e.customer)||void 0===t?void 0:t.username)||"Unknown"]})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsxs)("p",{className:"font-semibold text-lg",children:["RS ",e.total_amount]}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(v(e.order_status)),children:e.order_status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[x(e.order_status),(0,Ue.jsx)("span",{className:"text-sm text-gray-600",children:e.order_status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())})]}),(0,Ue.jsxs)("div",{className:"space-y-2 mb-4",children:[Array.isArray(e.items)&&e.items.slice(0,3).map(e=>{var t;return(0,Ue.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ue.jsxs)("span",{className:"text-gray-600",children:[e.quantity,"x ",(null===(t=e.cake)||void 0===t?void 0:t.name)||"Unknown Item"]}),(0,Ue.jsxs)("span",{className:"font-medium",children:["RS ",e.total_price]})]},e.id)}),Array.isArray(e.items)&&e.items.length>3&&(0,Ue.jsxs)("p",{className:"text-sm text-gray-500",children:["+",e.items.length-3," more items"]})]}),e.shipping_address&&(0,Ue.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded text-sm",children:[(0,Ue.jsx)("h5",{className:"font-medium mb-2",children:"Shipping Address"}),(0,Ue.jsxs)("p",{children:[e.shipping_address.first_name," ",e.shipping_address.last_name]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:e.shipping_address.address_line1}),e.shipping_address.address_line2&&(0,Ue.jsx)("p",{className:"text-gray-600",children:e.shipping_address.address_line2}),(0,Ue.jsxs)("p",{className:"text-gray-600",children:[e.shipping_address.city,", ",e.shipping_address.state," ",e.shipping_address.postal_code]})]}),(0,Ue.jsxs)("div",{className:"border-t pt-4",children:[(0,Ue.jsx)("h4",{className:"font-medium mb-3",children:"Update Order Status"}),(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsxs)("select",{value:(null===(n=u[e.id])||void 0===n?void 0:n.status)||"",onChange:t=>h(n=>qe(qe({},n),{},{[e.id]:qe(qe({},n[e.id]),{},{status:t.target.value})})),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,Ue.jsx)("option",{value:"",children:"Select Status"}),f.map(e=>(0,Ue.jsx)("option",{value:e,children:e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())},e))]}),(0,Ue.jsx)("input",{type:"text",placeholder:"Notes (optional)",value:(null===(r=u[e.id])||void 0===r?void 0:r.notes)||"",onChange:t=>h(n=>qe(qe({},n),{},{[e.id]:qe(qe({},n[e.id]),{},{notes:t.target.value})})),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,Ue.jsx)("button",{onClick:()=>(async e=>{const t=u[e];if(t&&t.status)try{const n=await fetch("http://localhost:8000/api/orders/orders/".concat(e,"/update_status/"),{method:"POST",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify(t)});if(n.ok)await g(),h(t=>{const n=qe({},t);return delete n[e],n}),alert("Order status updated successfully!");else{const e=await n.json();alert("Failed to update order status: "+(e.detail||"Unknown error"))}}catch(p){console.error("Error updating order status:",p),alert("Error updating order status: "+p.message)}else alert("Please select a status")})(e.id),disabled:!(null!==(i=u[e.id])&&void 0!==i&&i.status),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(null!==(s=u[e.id])&&void 0!==s&&s.status?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Update"})]})]}),Array.isArray(e.status_history)&&e.status_history.length>0&&(0,Ue.jsxs)("div",{className:"mt-4",children:[(0,Ue.jsx)("h5",{className:"font-medium mb-2",children:"Order Timeline"}),(0,Ue.jsx)("div",{className:"space-y-2",children:e.status_history.map(e=>(0,Ue.jsxs)("div",{className:"flex items-start space-x-3 text-sm",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("p",{className:"font-medium",children:e.status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500",children:y(e.created_at)}),e.notes&&(0,Ue.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.notes})]})]},e.id))})]})]},e.id)}):(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[(0,Ue.jsx)("div",{className:"text-gray-400 mb-4",children:(0,Ue.jsx)("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Orders Found"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"There are no orders to display at the moment."}),(0,Ue.jsx)("button",{onClick:g,className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh Orders"})]})})}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Admin Summary"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Total Orders"}),(0,Ue.jsx)("span",{className:"font-medium",children:Array.isArray(s)?s.length:0})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Pending"}),(0,Ue.jsx)("span",{className:"font-medium",children:Array.isArray(s)?s.filter(e=>"pending"===e.order_status).length:0})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Preparing"}),(0,Ue.jsx)("span",{className:"font-medium",children:Array.isArray(s)?s.filter(e=>"preparing"===e.order_status).length:0})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Ready"}),(0,Ue.jsx)("span",{className:"font-medium",children:Array.isArray(s)?s.filter(e=>"ready"===e.order_status).length:0})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Out for Delivery"}),(0,Ue.jsx)("span",{className:"font-medium",children:Array.isArray(s)?s.filter(e=>"out_for_delivery"===e.order_status).length:0})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Delivered"}),(0,Ue.jsx)("span",{className:"font-medium",children:Array.isArray(s)?s.filter(e=>"delivered"===e.order_status).length:0})]})]}),(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,Ue.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Quick Actions"}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsx)("button",{onClick:()=>e("/admin"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Back to Dashboard"}),(0,Ue.jsx)("button",{onClick:()=>e("/"),className:"w-full bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors text-sm",children:"Back to Home"})]})]})]})})]})]})})},$x=["title","titleId"];function ev(e,t){let{title:n,titleId:r}=e,s=Ie(e,$x);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const tv=i.forwardRef(ev),nv=["title","titleId"];function rv(e,t){let{title:n,titleId:r}=e,s=Ie(e,nv);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const iv=i.forwardRef(rv),sv=["title","titleId"];function av(e,t){let{title:n,titleId:r}=e,s=Ie(e,sv);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const ov=i.forwardRef(av),lv=["title","titleId"];function cv(e,t){let{title:n,titleId:r}=e,s=Ie(e,lv);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const dv=i.forwardRef(cv),uv=["title","titleId"];function hv(e,t){let{title:n,titleId:r}=e,s=Ie(e,uv);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const pv=i.forwardRef(hv),mv=()=>{const e=ne(),{user:t,isAuthenticated:n}=Be(),[r,s]=(0,i.useState)([]),[a,o]=(0,i.useState)([]),[l,c]=(0,i.useState)(!0),[d,u]=(0,i.useState)(""),[h,p]=(0,i.useState)(null),[m,f]=(0,i.useState)({search:"",status:"",paymentMethod:"",dateFrom:"",dateTo:"",customer:"",minAmount:"",maxAmount:""}),[g,x]=(0,i.useState)({totalRevenue:0,totalOrders:0,averageOrderValue:0,topCustomers:[],salesByStatus:{},salesByPaymentMethod:{},monthlyTrends:[]});(0,i.useEffect)(()=>{n&&t&&"admin"===t.user_type?v():e("/")},[n,t,e]),(0,i.useEffect)(()=>{b()},[r,m]);const v=async()=>{try{c(!0);const e=await fetch("http://localhost:8000/api/orders/orders/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(e.ok){const t=await e.json();s(Array.isArray(t)?t:[]),y(Array.isArray(t)?t:[])}else u("Failed to load purchase history")}catch(d){u("Error loading purchase history: "+d.message)}finally{c(!1)}},y=e=>{const t=e.reduce((e,t)=>e+parseFloat(t.total_amount),0),n=e.length,r=n>0?t/n:0,i={};e.forEach(e=>{const t=e.customer.id;i[t]||(i[t]={customer:e.customer,totalSpent:0,orderCount:0}),i[t].totalSpent+=parseFloat(e.total_amount),i[t].orderCount+=1});const s=Object.values(i).sort((e,t)=>t.totalSpent-e.totalSpent).slice(0,10),a={};e.forEach(e=>{a[e.order_status]||(a[e.order_status]={count:0,revenue:0}),a[e.order_status].count+=1,a[e.order_status].revenue+=parseFloat(e.total_amount)});const o={};e.forEach(e=>{o[e.payment_method]||(o[e.payment_method]={count:0,revenue:0}),o[e.payment_method].count+=1,o[e.payment_method].revenue+=parseFloat(e.total_amount)}),x({totalRevenue:t,totalOrders:n,averageOrderValue:r,topCustomers:s,salesByStatus:a,salesByPaymentMethod:o,monthlyTrends:[]})},b=()=>{let e=[...r];if(m.search){const t=m.search.toLowerCase();e=e.filter(e=>e.order_number.toLowerCase().includes(t)||e.customer.first_name.toLowerCase().includes(t)||e.customer.last_name.toLowerCase().includes(t)||e.customer.email.toLowerCase().includes(t))}m.status&&(e=e.filter(e=>e.order_status===m.status)),m.paymentMethod&&(e=e.filter(e=>e.payment_method===m.paymentMethod)),m.dateFrom&&(e=e.filter(e=>new Date(e.created_at)>=new Date(m.dateFrom))),m.dateTo&&(e=e.filter(e=>new Date(e.created_at)<=new Date(m.dateTo))),m.minAmount&&(e=e.filter(e=>parseFloat(e.total_amount)>=parseFloat(m.minAmount))),m.maxAmount&&(e=e.filter(e=>parseFloat(e.total_amount)<=parseFloat(m.maxAmount))),o(e)},w=(e,t)=>{f(n=>qe(qe({},n),{},{[e]:t}))},_=e=>({pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",preparing:"bg-orange-100 text-orange-800",ready:"bg-purple-100 text-purple-800",out_for_delivery:"bg-green-100 text-green-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800"),S=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=e=>"RS ".concat(parseFloat(e).toFixed(2));return l?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading purchase history..."})]})}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsx)("div",{className:"mb-8",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Purchase History"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"View and analyze all customer purchases"})]}),(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsxs)("button",{onClick:()=>{const e=[["Order Number","Customer","Email","Date","Status","Payment Method","Total Amount"].join(","),...a.map(e=>[e.order_number,'"'.concat(e.customer.first_name," ").concat(e.customer.last_name,'"'),e.customer.email,new Date(e.created_at).toLocaleDateString(),e.order_status,e.payment_method,e.total_amount].join(","))].join("\n"),t=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="purchase_history_".concat((new Date).toISOString().split("T")[0],".csv"),r.click(),window.URL.revokeObjectURL(n)},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,Ue.jsx)(tv,{className:"h-5 w-5 mr-2"}),"Export CSV"]}),(0,Ue.jsx)("button",{onClick:()=>e("/admin"),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Back to Dashboard"})]})]})}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Rl,{className:"h-8 w-8 text-green-600"}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:N(g.totalRevenue)})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(iv,{className:"h-8 w-8 text-blue-600"}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.totalOrders})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Ql,{className:"h-8 w-8 text-purple-600"}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:N(g.averageOrderValue)})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(ov,{className:"h-8 w-8 text-orange-600"}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Customers"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.topCustomers.length})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),(0,Ue.jsx)("button",{onClick:()=>{f({search:"",status:"",paymentMethod:"",dateFrom:"",dateTo:"",customer:"",minAmount:"",maxAmount:""})},className:"text-sm text-blue-600 hover:text-blue-700",children:"Clear All"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)(dv,{className:"h-5 w-5 absolute left-3 top-3 text-gray-400"}),(0,Ue.jsx)("input",{type:"text",placeholder:"Order number, customer name...",value:m.search,onChange:e=>w("search",e.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,Ue.jsxs)("select",{value:m.status,onChange:e=>w("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Ue.jsx)("option",{value:"",children:"All Statuses"}),(0,Ue.jsx)("option",{value:"pending",children:"Pending"}),(0,Ue.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,Ue.jsx)("option",{value:"preparing",children:"Preparing"}),(0,Ue.jsx)("option",{value:"ready",children:"Ready"}),(0,Ue.jsx)("option",{value:"out_for_delivery",children:"Out for Delivery"}),(0,Ue.jsx)("option",{value:"delivered",children:"Delivered"}),(0,Ue.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),(0,Ue.jsxs)("select",{value:m.paymentMethod,onChange:e=>w("paymentMethod",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Ue.jsx)("option",{value:"",children:"All Methods"}),(0,Ue.jsx)("option",{value:"cash",children:"Cash"}),(0,Ue.jsx)("option",{value:"card",children:"Card"}),(0,Ue.jsx)("option",{value:"online",children:"Online"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),(0,Ue.jsx)("input",{type:"date",value:m.dateFrom,onChange:e=>w("dateFrom",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),(0,Ue.jsx)("input",{type:"date",value:m.dateTo,onChange:e=>w("dateTo",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Amount"}),(0,Ue.jsx)("input",{type:"number",placeholder:"0.00",value:m.minAmount,onChange:e=>w("minAmount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Amount"}),(0,Ue.jsx)("input",{type:"number",placeholder:"1000.00",value:m.maxAmount,onChange:e=>w("maxAmount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Purchase History (",a.length," orders)"]})}),(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(t=>(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["#",t.order_number]}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:[t.items.length," item",1!==t.items.length?"s":""]})]})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[t.customer.first_name," ",t.customer.last_name]}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:t.customer.email})]})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S(t.created_at)}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(_(t.order_status)),children:t.order_status.replace("_"," ").toUpperCase()})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.payment_method.toUpperCase()}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:N(t.total_amount)}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,Ue.jsx)("button",{onClick:()=>p((null===h||void 0===h?void 0:h.id)===t.id?null:t),className:"text-blue-600 hover:text-blue-900 mr-3",children:(0,Ue.jsx)(pv,{className:"h-5 w-5"})}),(0,Ue.jsx)("button",{onClick:()=>e("/admin/orders/".concat(t.id)),className:"text-green-600 hover:text-green-900",children:(0,Ue.jsx)(ic,{className:"h-5 w-5"})})]})]},t.id))})]})})]}),h&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Ue.jsx)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsxs)("h3",{className:"text-xl font-semibold text-gray-900",children:["Order Details - #",h.order_number]}),(0,Ue.jsxs)("button",{onClick:()=>p(null),className:"text-gray-400 hover:text-gray-600",children:[(0,Ue.jsx)("span",{className:"sr-only",children:"Close"}),(0,Ue.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Customer Information"}),(0,Ue.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Name:"})," ",h.customer.first_name," ",h.customer.last_name]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Email:"})," ",h.customer.email]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Phone:"})," ",h.customer.phone||"N/A"]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Order Information"}),(0,Ue.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Date:"})," ",S(h.created_at)]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Status:"}),(0,Ue.jsx)("span",{className:"ml-2 px-2 py-1 text-xs font-medium rounded-full ".concat(_(h.order_status)),children:h.order_status.replace("_"," ").toUpperCase()})]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Payment:"})," ",h.payment_method.toUpperCase()]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Total:"})," ",N(h.total_amount)]})]})]})]}),(0,Ue.jsxs)("div",{className:"mt-6",children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Order Items"}),(0,Ue.jsx)("div",{className:"space-y-3",children:h.items.map(e=>(0,Ue.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium",children:e.cake.name}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["Quantity: ",e.quantity]}),e.customization_notes&&(0,Ue.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.customization_notes})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("p",{className:"font-medium",children:N(e.total_price)}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:[N(e.unit_price)," each"]})]})]},e.id))})]}),h.shipping_address&&(0,Ue.jsxs)("div",{className:"mt-6",children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Shipping Address"}),(0,Ue.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:[(0,Ue.jsxs)("p",{children:[h.shipping_address.first_name," ",h.shipping_address.last_name]}),(0,Ue.jsx)("p",{children:h.shipping_address.address_line1}),h.shipping_address.address_line2&&(0,Ue.jsx)("p",{children:h.shipping_address.address_line2}),(0,Ue.jsxs)("p",{children:[h.shipping_address.city,", ",h.shipping_address.state," ",h.shipping_address.postal_code]})]})]})]})})}),d&&(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-4",children:(0,Ue.jsx)("p",{className:"text-red-800",children:d})})]})})},fv=()=>{var e,t,n,r,s,a,o,l,c;const d=ne(),[u]=Re(),{loading:h}=Be(),[p,m]=(0,i.useState)(!0),[f,g]=(0,i.useState)(null),[x,v]=(0,i.useState)(null),[y,b]=(0,i.useState)({orders:{totalOrders:0,totalRevenue:0,pendingOrders:0,completedOrders:0,cancelledOrders:0,averageOrderValue:0,recentOrders:[]},feedback:{totalFeedback:0,averageRating:0,recentFeedback:[]},inventory:{totalProducts:0,lowStockItems:0,outOfStockItems:0,totalStockValue:0,lowStockAlerts:[]}}),[w,_]=(0,i.useState)("orders");(0,i.useEffect)(()=>{const e=u.get("type");console.log("=== AdminReportsPage URL Debug ==="),console.log("URL search params:",u.toString()),console.log("Report type from URL:",e),e&&["orders","feedback","inventory"].includes(e)?(console.log("Setting selected report to:",e),_(e)):console.log("No valid report type in URL, using default: orders")},[u]);const[S,N]=(0,i.useState)({startDate:new Date((new Date).setMonth((new Date).getMonth()-1)).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0]}),j=()=>{const e=new Date(S.startDate),t=new Date(S.endDate),n=new Date;return e>t?(g("Start date cannot be after end date"),!1):!(t>n)||(g("End date cannot be in the future"),!1)},A=(0,i.useCallback)(async()=>{try{if(console.log("=== Loading Reports Data ==="),console.log("Selected report type:",w),console.log("Date range:",S),m(!0),g(null),v(null),!j())return console.error("Date range validation failed"),void m(!1);const e=localStorage.getItem("token");if(console.log("Token available:",!!e),!e)throw new Error("No authentication token found");const t=await fetch("http://localhost:8000/api/orders/orders/",{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}}),n=await fetch("http://localhost:8000/api/feedback/feedback/",{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}}),r=await fetch("http://localhost:8000/api/inventory/ingredients/",{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});if(!t.ok){const e=await t.text();throw console.error("Orders API Error:",e),new Error("Failed to load orders: ".concat(t.status," ").concat(t.statusText," - ").concat(e))}if(!n.ok){const e=await n.text();throw console.error("Feedback API Error:",e),new Error("Failed to load feedback: ".concat(n.status," ").concat(n.statusText," - ").concat(e))}if(!r.ok){const e=await r.text();throw console.error("Inventory API Error:",e),new Error("Failed to load inventory: ".concat(r.status," ").concat(r.statusText," - ").concat(e))}const i=await t.json(),s=await n.json(),a=await r.json();console.log("=== API Response Data ==="),console.log("Orders data received:",i),console.log("Orders count:",Array.isArray(i.results)?i.results.length:Array.isArray(i)?i.length:"Not array"),console.log("Feedback data received:",s),console.log("Feedback count:",Array.isArray(s.results)?s.results.length:Array.isArray(s)?s.length:"Not array"),console.log("Inventory data received:",a),console.log("Inventory count:",Array.isArray(a.results)?a.results.length:Array.isArray(a)?a.length:"Not array");const o=i.results||i,l=s.results||s,c=a.results||a,d={totalOrders:Array.isArray(o)?o.length:0,totalRevenue:Array.isArray(o)?o.reduce((e,t)=>{const n=parseFloat(t.total_amount||0);return e+(isNaN(n)?0:n)},0):0,pendingOrders:Array.isArray(o)?o.filter(e=>"pending"===e.order_status).length:0,completedOrders:Array.isArray(o)?o.filter(e=>"delivered"===e.order_status).length:0,cancelledOrders:Array.isArray(o)?o.filter(e=>"cancelled"===e.order_status).length:0,averageOrderValue:0,recentOrders:Array.isArray(o)?o.slice(0,10):[]};d.averageOrderValue=d.totalOrders>0?d.totalRevenue/d.totalOrders:0;const u={totalFeedback:Array.isArray(l)?l.length:0,averageRating:0,recentFeedback:Array.isArray(l)?l.slice(0,10):[]};if(Array.isArray(l)&&l.length>0){const e=l.filter(e=>e.rating&&!isNaN(parseFloat(e.rating))&&parseFloat(e.rating)>=1&&parseFloat(e.rating)<=5);if(e.length>0){const t=e.reduce((e,t)=>e+parseFloat(t.rating),0);u.averageRating=t/e.length}}const h={totalProducts:Array.isArray(c)?c.length:0,lowStockItems:Array.isArray(c)?c.filter(e=>{const t=parseInt(e.current_stock||0),n=parseInt(e.minimum_stock||5);return!isNaN(t)&&!isNaN(n)&&t<=n&&t>0}).length:0,outOfStockItems:Array.isArray(c)?c.filter(e=>{const t=parseInt(e.current_stock||0);return!isNaN(t)&&0===t}).length:0,totalStockValue:Array.isArray(c)?c.reduce((e,t)=>{const n=parseInt(t.current_stock||0),r=parseFloat(t.unit_cost||t.price||0);return e+(isNaN(n)||isNaN(r)?0:n*r)},0):0,lowStockAlerts:Array.isArray(c)?c.filter(e=>{const t=parseInt(e.current_stock||0),n=parseInt(e.minimum_stock||5);return!isNaN(t)&&!isNaN(n)&&t<=n}):[]},p={orders:d,feedback:u,inventory:h};console.log("=== Final Processed Reports Data ==="),console.log("Final reports data:",p),console.log("Orders total:",d.totalOrders),console.log("Feedback total:",u.totalFeedback),console.log("Inventory total:",h.totalProducts),b(p),v("Reports loaded successfully!"),setTimeout(()=>v(null),3e3)}catch(f){console.error("Error loading reports data:",f),g(f.message||"Failed to load reports data")}finally{m(!1)}},[S,j]);(0,i.useEffect)(()=>{A()},[A]);const M=e=>{try{if(console.log("=== PDF Generation Debug Info ==="),console.log("Generating PDF report for:",e),console.log("Reports data structure:",y),console.log("jsPDF available:",!0),console.log("Date range:",S),!y||0===Object.keys(y).length)return console.error("No reports data available"),g("Please load reports data first by clicking the Refresh button."),void alert("Please load reports data first by clicking the Refresh button.");if(!y[e])return console.error("No ".concat(e," data available")),g("No ".concat(e," data available. Please refresh the data and try again.")),void alert("No ".concat(e," data available. Please refresh the data and try again."));const a=y[e];var t;if("orders"===e){if(!a.totalOrders&&(null===(t=a.recentOrders)||void 0===t||!t.length))return console.error("No order data to generate report"),g("No order data found for the selected date range."),void alert("No order data found for the selected date range. Please select a different date range or refresh the data.")}else if("feedback"===e){var n;if(!a.totalFeedback&&(null===(n=a.recentFeedback)||void 0===n||!n.length))return console.error("No feedback data to generate report"),g("No feedback data found for the selected date range."),void alert("No feedback data found for the selected date range. Please select a different date range or refresh the data.")}else if("inventory"===e){var r;if(!a.totalProducts&&(null===(r=a.lowStockAlerts)||void 0===r||!r.length))return console.error("No inventory data to generate report"),g("No inventory data found."),void alert("No inventory data found. Please refresh the data and try again.")}0,console.log("Starting PDF generation for ".concat(e," with data:"),a);const o=new lf,l=(new Date).toLocaleDateString();let c=20;if(o.setFontSize(20),o.text("".concat(e.charAt(0).toUpperCase()+e.slice(1)," Report"),20,c),c+=15,o.setFontSize(12),o.text("Generated on: ".concat(l),20,c),c+=10,o.text("Date Range: ".concat(S.startDate," to ").concat(S.endDate),20,c),c+=20,"orders"===e){const e=y.orders;o.setFontSize(14),o.text("Orders Summary",20,c),c+=15,o.setFontSize(10),o.text("Total Orders: ".concat(e.totalOrders),20,c),c+=8,o.text("Total Revenue: RS ".concat((e.totalRevenue||0).toFixed(2)),20,c),c+=8,o.text("Average Order Value: RS ".concat((e.averageOrderValue||0).toFixed(2)),20,c),c+=8,o.text("Pending Orders: ".concat(e.pendingOrders),20,c),c+=8,o.text("Completed Orders: ".concat(e.completedOrders),20,c),c+=8,o.text("Cancelled Orders: ".concat(e.cancelledOrders),20,c),c+=15,e.recentOrders.length>0&&(o.setFontSize(14),o.text("Recent Orders",20,c),c+=15,o.setFontSize(8),e.recentOrders.slice(0,10).forEach(e=>{var t;const n="Order #".concat(e.order_number||"N/A"," - ").concat((null===(t=e.customer)||void 0===t?void 0:t.username)||"N/A"," - ").concat(e.order_status||"N/A"," - RS ").concat(e.total_amount||0);o.text(n,20,c),c+=6}),c+=10)}else if("feedback"===e){const e=y.feedback;o.setFontSize(14),o.text("Feedback Summary",20,c),c+=15,o.setFontSize(10),o.text("Total Feedback: ".concat(e.totalFeedback),20,c),c+=8,o.text("Average Rating: ".concat((e.averageRating||0).toFixed(2),"/5.0"),20,c),c+=8,o.text("Date Range: ".concat(S.startDate," to ").concat(S.endDate),20,c),c+=15,e.recentFeedback.length>0&&(o.setFontSize(14),o.text("Recent Feedback",20,c),c+=15,o.setFontSize(8),e.recentFeedback.slice(0,10).forEach(e=>{var t;const n=e.comment||e.message||"No comment",r=n.length>50?n.substring(0,50)+"...":n,i="".concat((null===(t=e.customer)||void 0===t?void 0:t.username)||"Anonymous"," - ").concat(e.rating||"N/A"," stars - ").concat(r);o.text(i,20,c),c+=6}),c+=10)}else if("inventory"===e){const e=y.inventory;o.setFontSize(14),o.text("Inventory Summary",20,c),c+=15,o.setFontSize(10),o.text("Total Products: ".concat(e.totalProducts),20,c),c+=8,o.text("Low Stock Items: ".concat(e.lowStockItems),20,c),c+=8,o.text("Out of Stock Items: ".concat(e.outOfStockItems),20,c),c+=8,o.text("Total Stock Value: RS ".concat((e.totalStockValue||0).toFixed(2)),20,c),c+=15,e.lowStockAlerts.length>0&&(o.setFontSize(14),o.text("Low Stock Alerts",20,c),c+=15,o.setFontSize(8),e.lowStockAlerts.slice(0,10).forEach(e=>{const t="".concat(e.name||"N/A"," - Stock: ").concat(e.current_stock||0," - Price: RS ").concat(e.unit_cost||0," - Unit: ").concat(e.unit||"N/A");o.text(t,20,c),c+=6}),c+=10)}const d="".concat(e,"_report_").concat((new Date).toISOString().split("T")[0],".pdf");console.log("Attempting to save PDF with filename:",d);const u=(()=>{const e={userAgent:navigator.userAgent,cookiesEnabled:navigator.cookieEnabled,javaEnabled:!!navigator.javaEnabled&&navigator.javaEnabled(),onLine:navigator.onLine,popupBlocker:!1};try{const t=window.open("","_blank","width=1,height=1");t?(t.close(),e.popupBlocker=!1):e.popupBlocker=!0}catch(AB){e.popupBlocker=!0}return console.log("Browser diagnostics:",e),e})();g(null);try{console.log("Attempting primary download method..."),o.save(d),console.log("Primary download method executed successfully")}catch(i){console.warn("Primary download method failed, trying fallback...",i);try{const e=((e,t)=>{try{const n=URL.createObjectURL(e),r=document.createElement("a");return r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n),!0}catch(f){return console.error("Fallback download failed:",f),!1}})(o.output("blob"),d);if(!e)throw new Error("Both primary and fallback download methods failed");console.log("Fallback download method succeeded")}catch(s){throw console.error("Fallback download also failed:",s),new Error("Download failed: ".concat(i.message,". Fallback also failed: ").concat(s.message))}}u.popupBlocker&&(console.warn("\u26a0\ufe0f Popup blocker detected - this may prevent downloads"),console.warn("Please disable popup blocker for this site or manually allow downloads"));let h="".concat(e.charAt(0).toUpperCase()+e.slice(1)," report generated successfully! Check your Downloads folder.");u.popupBlocker&&(h+=" If download didn't start, please disable popup blocker and try again."),v(h),setTimeout(()=>v(null),8e3)}catch(f){console.error("=== PDF Generation Error ==="),console.error("Error details:",f),console.error("Error stack:",f.stack);const n="Failed to generate ".concat(e," report: ").concat(f.message||"Unknown error occurred");g(n),alert("Failed to generate PDF report. Error: ".concat(f.message||"Unknown error",". Please check the console for more details and try again."))}},E=e=>"RS ".concat(parseFloat(e||0).toFixed(2)),C=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return h||p?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading reports..."})]})}):f?(console.error("=== AdminReportsPage Error State ==="),console.error("Error message:",f),console.error("Current state:",{loading:p,authLoading:h,selectedReport:w,reportsData:y}),(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-center max-w-md mx-auto p-6",children:(0,Ue.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,Ue.jsx)(jl,{className:"h-12 w-12 text-red-600 mx-auto mb-4"}),(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Error Loading Reports"}),(0,Ue.jsx)("p",{className:"text-red-600 mb-4",children:f}),(0,Ue.jsxs)("div",{className:"text-sm text-red-500 mb-4",children:[(0,Ue.jsxs)("p",{children:["Selected Report: ",w]}),(0,Ue.jsx)("p",{children:"Check browser console for detailed error logs"})]}),(0,Ue.jsx)("button",{onClick:A,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Try Again"})]})})})):(console.log("=== AdminReportsPage Render ==="),console.log("Current state:",{loading:p,authLoading:h,error:f,selectedReport:w,successMessage:x}),console.log("Reports data summary:",{ordersTotal:null===(e=y.orders)||void 0===e?void 0:e.totalOrders,feedbackTotal:null===(t=y.feedback)||void 0===t?void 0:t.totalFeedback,inventoryTotal:null===(n=y.inventory)||void 0===n?void 0:n.totalProducts}),(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsx)("div",{className:"mb-8",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reports & Analytics"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Generate and download comprehensive business reports"}),(0,Ue.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["Debug: Report=",w," | Loading=",p.toString()," | Error=",!!f]})]}),(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsxs)("button",{onClick:A,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",disabled:p,children:[(0,Ue.jsx)(Ql,{className:"h-4 w-4"}),(0,Ue.jsx)("span",{children:"Refresh"})]}),(0,Ue.jsx)("button",{onClick:()=>d("/admin"),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Back to Dashboard"})]})]})}),x&&(0,Ue.jsx)("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(_l,{className:"h-5 w-5 text-green-600 mr-2"}),(0,Ue.jsx)("p",{className:"text-green-800",children:x})]})}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Report Period"}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),(0,Ue.jsx)("input",{type:"date",value:S.startDate,onChange:e=>N(t=>qe(qe({},t),{},{startDate:e.target.value})),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),(0,Ue.jsx)("input",{type:"date",value:S.endDate,onChange:e=>N(t=>qe(qe({},t),{},{endDate:e.target.value})),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsx)("button",{onClick:A,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors mt-6 flex items-center space-x-2",disabled:p,children:p?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,Ue.jsx)("span",{children:"Updating..."})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)(Ql,{className:"h-4 w-4"}),(0,Ue.jsx)("span",{children:"Update Reports"})]})})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Report Type"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ue.jsxs)("button",{onClick:()=>_("orders"),className:"p-4 rounded-lg border-2 transition-colors ".concat("orders"===w?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300"),children:[(0,Ue.jsx)(tc,{className:"h-8 w-8 mx-auto mb-2"}),(0,Ue.jsx)("h4",{className:"font-medium",children:"Orders Report"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Sales, orders, revenue"})]}),(0,Ue.jsxs)("button",{onClick:()=>_("feedback"),className:"p-4 rounded-lg border-2 transition-colors ".concat("feedback"===w?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-green-300"),children:[(0,Ue.jsx)(dc,{className:"h-8 w-8 mx-auto mb-2"}),(0,Ue.jsx)("h4",{className:"font-medium",children:"Feedback Report"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Customer reviews, ratings"})]}),(0,Ue.jsxs)("button",{onClick:()=>_("inventory"),className:"p-4 rounded-lg border-2 transition-colors ".concat("inventory"===w?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-200 hover:border-purple-300"),children:[(0,Ue.jsx)(El,{className:"h-8 w-8 mx-auto mb-2"}),(0,Ue.jsx)("h4",{className:"font-medium",children:"Inventory Report"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Stock levels, alerts"})]})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,Ue.jsx)("div",{className:"lg:col-span-3",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 capitalize",children:[w," Report"]}),(0,Ue.jsxs)("button",{onClick:()=>M(w),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[(0,Ue.jsx)(gc,{className:"h-5 w-5"}),(0,Ue.jsx)("span",{children:"Download PDF"})]})]}),"orders"===w&&(0,Ue.jsxs)("div",{className:"space-y-6",children:[console.log("=== Orders Report Render Debug ===")||console.log("Orders data for rendering:",y.orders)||console.log("Total orders to display:",y.orders.totalOrders),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ue.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(tc,{className:"h-8 w-8 text-blue-600"}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Total Orders"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:y.orders.totalOrders})]})]})}),(0,Ue.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Rl,{className:"h-8 w-8 text-green-600"}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Total Revenue"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-green-900",children:E(y.orders.totalRevenue)})]})]})}),(0,Ue.jsx)("div",{className:"bg-purple-50 p-4 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Ql,{className:"h-8 w-8 text-purple-600"}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-purple-600",children:"Avg Order Value"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:E(y.orders.averageOrderValue)})]})]})})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ue.jsxs)("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[(0,Ue.jsx)("p",{className:"text-sm text-yellow-600",children:"Pending"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:y.orders.pendingOrders})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,Ue.jsx)("p",{className:"text-sm text-green-600",children:"Completed"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-green-900",children:y.orders.completedOrders})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[(0,Ue.jsx)("p",{className:"text-sm text-red-600",children:"Cancelled"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-red-900",children:y.orders.cancelledOrders})]})]}),y.orders.recentOrders.length>0?(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Orders"}),(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Order #"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:y.orders.recentOrders.map(e=>{var t;return(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.order_number||"N/A"}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(null===(t=e.customer)||void 0===t?void 0:t.username)||"N/A"}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,Ue.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat("delivered"===e.order_status?"bg-green-100 text-green-800":"pending"===e.order_status?"bg-yellow-100 text-yellow-800":"cancelled"===e.order_status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.order_status||"N/A"})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E(e.total_amount||0)}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:C(e.created_at)})]},e.id)})})]})})]}):(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("p",{className:"text-gray-500",children:"No recent orders found for the selected date range."}),(0,Ue.jsx)("p",{className:"text-sm text-gray-400",children:"Try refreshing the data or selecting a different date range."})]})]}),"feedback"===w&&(0,Ue.jsxs)("div",{className:"space-y-6",children:[console.log("=== Feedback Report Render Debug ===")||console.log("Feedback data for rendering:",y.feedback)||console.log("Total feedback to display:",y.feedback.totalFeedback),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(dc,{className:"h-8 w-8 text-blue-600"}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Total Feedback"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:y.feedback.totalFeedback})]})]})}),(0,Ue.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Ql,{className:"h-8 w-8 text-green-600"}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Average Rating"}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold text-green-900",children:[y.feedback.averageRating.toFixed(1),"/5"]})]})]})})]}),y.feedback.recentFeedback.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Feedback"}),(0,Ue.jsx)("div",{className:"space-y-4",children:y.feedback.recentFeedback.map(e=>{var t;return(0,Ue.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("span",{className:"font-medium text-gray-900",children:(null===(t=e.customer)||void 0===t?void 0:t.username)||"Anonymous"}),(0,Ue.jsx)("div",{className:"flex items-center",children:[...Array(5)].map((t,n)=>(0,Ue.jsx)(dc,{className:"h-4 w-4 ".concat(n<(e.rating||0)?"text-yellow-400 fill-current":"text-gray-300")},n))})]}),(0,Ue.jsx)("span",{className:"text-sm text-gray-500",children:C(e.created_at)})]}),e.comment&&(0,Ue.jsx)("p",{className:"text-gray-700",children:e.comment})]},e.id)})})]})]}),"inventory"===w&&(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(El,{className:"h-8 w-8 text-blue-600"}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Total Products"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:y.inventory.totalProducts})]})]})}),(0,Ue.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Rl,{className:"h-8 w-8 text-green-600"}),(0,Ue.jsxs)("div",{className:"ml-3",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Stock Value"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-green-900",children:E(y.inventory.totalStockValue)})]})]})})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[(0,Ue.jsx)(jl,{className:"h-8 w-8 text-yellow-600 mx-auto mb-2"}),(0,Ue.jsx)("p",{className:"text-sm text-yellow-600",children:"Low Stock Items"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:y.inventory.lowStockItems})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[(0,Ue.jsx)(jl,{className:"h-8 w-8 text-red-600 mx-auto mb-2"}),(0,Ue.jsx)("p",{className:"text-sm text-red-600",children:"Out of Stock"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-red-900",children:y.inventory.outOfStockItems})]})]}),y.inventory.lowStockAlerts.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Low Stock Alerts"}),(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Stock"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Price"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:y.inventory.lowStockAlerts.map(e=>(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name||"N/A"}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,Ue.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat(0===(e.current_stock||0)?"bg-red-100 text-red-800":(e.current_stock||0)<10?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.current_stock||0})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E(e.cost_per_unit||0)}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.unit||"N/A"})]},e.id))})]})})]})]})]})}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("button",{onClick:A,className:"w-full bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2",disabled:p,children:[(0,Ue.jsx)(Ql,{className:"h-5 w-5"}),(0,Ue.jsx)("span",{children:p?"Loading...":"Refresh Data"})]}),(0,Ue.jsxs)("button",{onClick:()=>M("orders"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",disabled:p,children:[(0,Ue.jsx)(gc,{className:"h-5 w-5"}),(0,Ue.jsx)("span",{children:"Download Sales Report"})]}),(0,Ue.jsxs)("button",{onClick:()=>M("feedback"),className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",disabled:p,children:[(0,Ue.jsx)(gc,{className:"h-5 w-5"}),(0,Ue.jsx)("span",{children:"Download Feedback PDF"})]}),(0,Ue.jsxs)("button",{onClick:()=>M("inventory"),className:"w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors flex items-center justify-center space-x-2",disabled:p,children:[(0,Ue.jsx)(gc,{className:"h-5 w-5"}),(0,Ue.jsx)("span",{children:"Download Inventory PDF"})]})]}),(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Data Status"}),(0,Ue.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Orders:"}),(0,Ue.jsxs)("span",{className:(null===(r=y.orders)||void 0===r?void 0:r.totalOrders)>0?"text-green-600":"text-red-600",children:[(null===(s=y.orders)||void 0===s?void 0:s.totalOrders)||0," loaded"]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Feedback:"}),(0,Ue.jsxs)("span",{className:(null===(a=y.feedback)||void 0===a?void 0:a.totalFeedback)>0?"text-green-600":"text-red-600",children:[(null===(o=y.feedback)||void 0===o?void 0:o.totalFeedback)||0," loaded"]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Inventory:"}),(0,Ue.jsxs)("span",{className:(null===(l=y.inventory)||void 0===l?void 0:l.totalProducts)>0?"text-green-600":"text-red-600",children:[(null===(c=y.inventory)||void 0===c?void 0:c.totalProducts)||0," loaded"]})]})]}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Reports use data from the selected date range."})]}),(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,Ue.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Download Troubleshooting"}),(0,Ue.jsxs)("div",{className:"text-xs text-blue-700 space-y-1",children:[(0,Ue.jsx)("p",{children:"\u2022 If downloads don't start, check popup blocker settings"}),(0,Ue.jsx)("p",{children:"\u2022 Try disabling browser extensions temporarily"}),(0,Ue.jsx)("p",{children:"\u2022 Check Downloads folder for completed files"}),(0,Ue.jsx)("p",{children:"\u2022 Use Chrome/Firefox for best compatibility"}),(0,Ue.jsx)("p",{children:"\u2022 Open browser console (F12) for detailed error info"})]})]})]})})]})]})}))},gv=()=>{const e=ne(),[t,n]=(0,i.useState)("Checking..."),[r,s]=(0,i.useState)([]),[a,o]=(0,i.useState)("");(0,i.useEffect)(()=>{l()},[]);const l=async()=>{try{const t=localStorage.getItem("token");if(console.log("\ud83d\udd11 Token from localStorage:",t),!t)return n("\u274c No token found"),void o("Please log in first");n("\ud83d\udd0d Testing authentication...");const r=await fetch("http://localhost:8000/api/orders/orders/",{headers:{Authorization:"Token ".concat(t),"Content-Type":"application/json"}});if(console.log("\ud83d\udce1 Orders API response:",r.status,r.statusText),r.ok){var e;const t=await r.json();console.log("\u2705 Orders data:",t),s(t.results||t),n("\u2705 Authentication successful! Found ".concat((null===(e=t.results)||void 0===e?void 0:e.length)||t.length||0," orders"))}else{const e=await r.text();console.log("\u274c API Error:",e),n("\u274c Authentication failed: ".concat(r.status," ").concat(r.statusText)),o(e)}}catch(a){console.error("\ud83d\udca5 Error:",a),n("\u274c Network error: ".concat(a.message)),o(a.message)}};return(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"\ud83d\udd27 Authentication Test Page"}),(0,Ue.jsxs)("div",{className:"mb-6",children:[(0,Ue.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Authentication Status:"}),(0,Ue.jsx)("p",{className:"text-gray-700",children:t}),a&&(0,Ue.jsx)("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,Ue.jsx)("p",{className:"text-red-800 text-sm",children:a})})]}),(0,Ue.jsxs)("div",{className:"mb-6",children:[(0,Ue.jsx)("button",{onClick:l,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 mr-4",children:"\ud83d\udd04 Test Authentication"}),(0,Ue.jsx)("button",{onClick:()=>e("/orders"),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"\ud83d\udccb Go to My Orders"})]}),r.length>0&&(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Your Orders:"}),(0,Ue.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("span",{className:"font-medium",children:["Order #",e.order_number]}),(0,Ue.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:["Status: ",e.order_status]})]}),(0,Ue.jsxs)("button",{onClick:()=>(async e=>{try{const t=localStorage.getItem("token");console.log("\ud83d\udd0d Testing order ".concat(e,"..."));const n=await fetch("http://localhost:8000/api/orders/orders/".concat(e,"/"),{headers:{Authorization:"Token ".concat(t),"Content-Type":"application/json"}});if(console.log("\ud83d\udce1 Order ".concat(e," response:"),n.status,n.statusText),n.ok){const t=await n.json();console.log("\u2705 Order ".concat(e," data:"),t),alert("Order ".concat(e," loaded successfully!"))}else{const t=await n.text();console.log("\u274c Order ".concat(e," error:"),t),alert("Order ".concat(e," failed: ").concat(n.status," ").concat(n.statusText))}}catch(a){console.error("\ud83d\udca5 Order ".concat(e," error:"),a),alert("Order ".concat(e," network error: ").concat(a.message))}})(e.id),className:"bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700",children:["Test Order ",e.id]})]},e.id))})]}),(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,Ue.jsx)("h3",{className:"font-semibold mb-2",children:"Instructions:"}),(0,Ue.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[(0,Ue.jsx)("li",{children:"Make sure you're logged in as feedback_test_user"}),(0,Ue.jsx)("li",{children:'Click "Test Authentication" to check your token'}),(0,Ue.jsx)("li",{children:"If authentication works, you should see your orders"}),(0,Ue.jsx)("li",{children:'Click "Test Order X" to test specific order access'}),(0,Ue.jsx)("li",{children:"Check the browser console for detailed logs"})]})]})]})})})},xv="http://localhost:8000/api";let vv=null,yv=null,bv=0;const wv=3e5,_v=async()=>{const e=Date.now();if(vv&&e-bv<wv)return vv;try{const t=await fetch("".concat(xv,"/cakes/"));if(!t.ok)throw new Error("Failed to fetch cakes: ".concat(t.status));const n=await t.json(),r=n.results||n,i=Array.isArray(r)?r.map(e=>{var t,n;return{id:e.id,name:e.name,description:e.description,price:parseFloat(e.price),image:null!==(t=e.image)&&void 0!==t&&t.startsWith("/media/")?"".concat(xv.replace("/api","")).concat(e.image):e.image,category:(null===(n=e.category)||void 0===n?void 0:n.name)||e.category,rating:4.5,reviewCount:0,isCustomizable:e.is_customizable||!0,ingredients:e.ingredients||[],allergens:e.allergens||[],preparationTime:e.preparation_time||"2-3 hours"}}):[];return vv=i,bv=e,i}catch(nU){return console.error("Error fetching cakes:",nU),[]}},Sv=async()=>{const e=Date.now();if(yv&&e-bv<wv)return yv;try{const e=await fetch("".concat(xv,"/categories/"));if(!e.ok)throw new Error("Failed to fetch categories: ".concat(e.status));const t=(await e.json()).map(e=>({id:e.id,name:e.name,icon:Nv(e.name)}));return yv=t,t}catch(nU){return console.error("Error fetching categories:",nU),[{id:1,name:"Chocolate",icon:"\ud83c\udf6b"},{id:2,name:"Vanilla",icon:"\ud83c\udf70"},{id:3,name:"Red Velvet",icon:"\u2764\ufe0f"},{id:4,name:"Fruit",icon:"\ud83c\udf53"},{id:5,name:"Citrus",icon:"\ud83c\udf4b"},{id:6,name:"Vegetable",icon:"\ud83e\udd55"},{id:7,name:"Cupcakes",icon:"\ud83e\uddc1"}]}},Nv=e=>({chocolate:"\ud83c\udf6b",vanilla:"\ud83c\udf70","red velvet":"\u2764\ufe0f","red-velvet":"\u2764\ufe0f",fruit:"\ud83c\udf53",citrus:"\ud83c\udf4b",vegetable:"\ud83e\udd55",cupcakes:"\ud83e\uddc1",cupcake:"\ud83e\uddc1"}[null===e||void 0===e?void 0:e.toLowerCase()]||"\ud83c\udf70"),jv={sizes:[{id:1,name:"Small (6 inches)",priceModifier:0},{id:2,name:"Medium (8 inches)",priceModifier:500},{id:3,name:"Large (10 inches)",priceModifier:1e3},{id:4,name:"Extra Large (12 inches)",priceModifier:1500}],shapes:[{id:1,name:"Round",priceModifier:0},{id:2,name:"Square",priceModifier:200},{id:3,name:"Heart",priceModifier:300},{id:4,name:"Rectangle",priceModifier:250}],frostings:[{id:1,name:"Buttercream",priceModifier:0},{id:2,name:"Cream Cheese",priceModifier:200},{id:3,name:"Chocolate Ganache",priceModifier:300},{id:4,name:"Whipped Cream",priceModifier:150},{id:5,name:"Fondant",priceModifier:400}],toppings:[{id:1,name:"Fresh Berries",priceModifier:300},{id:2,name:"Chocolate Shavings",priceModifier:200},{id:3,name:"Sprinkles",priceModifier:100},{id:4,name:"Edible Flowers",priceModifier:500},{id:5,name:"Nuts",priceModifier:250}],colors:[{id:1,name:"Pink",color:"#FF69B4",priceModifier:0},{id:2,name:"Red",color:"#DC143C",priceModifier:200},{id:3,name:"Blue",color:"#4169E1",priceModifier:200},{id:4,name:"Green",color:"#32CD32",priceModifier:200},{id:5,name:"Purple",color:"#8A2BE2",priceModifier:200},{id:6,name:"Yellow",color:"#FFD700",priceModifier:200},{id:7,name:"Orange",color:"#FF8C00",priceModifier:200},{id:8,name:"White",color:"#FFFFFF",priceModifier:0}]},Av={frostings:[{id:1,name:"Buttercream",priceModifier:0},{id:2,name:"Cream Cheese",priceModifier:50},{id:3,name:"Chocolate Ganache",priceModifier:75},{id:4,name:"Whipped Cream",priceModifier:40},{id:5,name:"Red Velvet",priceModifier:60}],toppings:[{id:1,name:"Fresh Berries",priceModifier:80},{id:2,name:"Chocolate Shavings",priceModifier:60},{id:3,name:"Sprinkles",priceModifier:30},{id:4,name:"Edible Flowers",priceModifier:100},{id:5,name:"Nuts",priceModifier:50}],colors:[{id:1,name:"Pink",color:"#FF69B4",priceModifier:0},{id:2,name:"Red",color:"#DC143C",priceModifier:20},{id:3,name:"Blue",color:"#4169E1",priceModifier:20},{id:4,name:"Green",color:"#32CD32",priceModifier:20},{id:5,name:"Purple",color:"#8A2BE2",priceModifier:20},{id:6,name:"Yellow",color:"#FFD700",priceModifier:20},{id:7,name:"Orange",color:"#FF8C00",priceModifier:20},{id:8,name:"White",color:"#FFFFFF",priceModifier:0}]},Mv=(e,t,n)=>{var r,i,s,a,o,l;const c=e.shape,d=c&&(null===(r=t.shapes)||void 0===r||null===(i=r.find(e=>e.id===c))||void 0===i?void 0:i.name)||"Round",u=e.frosting&&(null===(s=t.frostings)||void 0===s||null===(a=s.find(t=>t.id===e.frosting))||void 0===a?void 0:a.name)||"Pink",h=e.color&&(null===(o=t.colors)||void 0===o||null===(l=o.find(t=>t.id===e.color))||void 0===l?void 0:l.color)||"#FF69B4",p=e.toppings||[],m=e.message||"",f=document.createElement("canvas");f.width=300,f.height=300;const g=f.getContext("2d");if(g.fillStyle="#f8f9fa",g.fillRect(0,0,300,300),g.fillStyle=h,g.beginPath(),g.arc(150,200,80,0,2*Math.PI),g.fill(),g.fillStyle="Chocolate Ganache"===u?"#8B4513":"Red Velvet"===u?"#DC143C":"Whipped Cream"===u?"#FFFFFF":h,g.beginPath(),g.arc(150,180,70,0,2*Math.PI),g.fill(),p.length>0){g.fillStyle="#FFD700";for(let e=0;e<Math.min(3*p.length,15);e++){const e=120+60*Math.random(),t=160+40*Math.random();g.beginPath(),g.arc(e,t,3,0,2*Math.PI),g.fill()}}g.fillStyle="#333",g.font="12px Arial",g.textAlign="center",g.fillText((d||"Round").toUpperCase(),150,50),m&&(g.fillStyle="#666",g.font="10px Arial",g.fillText("\ud83d\udc8c",150,280));return{image:f.toDataURL("image/png",.8),customizations:e,timestamp:Date.now()}},Ev=e=>{let{sizes:t,selectedSize:n,onSelect:r}=e;return(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Choose Your Cake Size"}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>(0,Ue.jsxs)(tl.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>r(e.id),className:"p-4 border-2 rounded-lg text-left transition-all ".concat(n===e.id?"border-sweetbite-600 bg-sweetbite-50":"border-gray-200 hover:border-sweetbite-300"),children:[(0,Ue.jsx)("div",{className:"font-semibold text-gray-800",children:e.name}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-600",children:["Serves ",e.servings," people"]}),e.priceModifier>0&&(0,Ue.jsxs)("div",{className:"text-sm text-sweetbite-600",children:["+RS ",e.priceModifier]})]},e.id))})]})},Cv=e=>{let{shapes:t,selectedShape:n,onSelect:r}=e;return(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Choose Your Cake Shape"}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>(0,Ue.jsxs)(tl.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>r(e.id),className:"p-4 border-2 rounded-lg text-left transition-all ".concat(n===e.id?"border-sweetbite-600 bg-sweetbite-50":"border-gray-200 hover:border-sweetbite-300"),children:[(0,Ue.jsx)("div",{className:"font-semibold text-gray-800",children:e.name}),e.priceModifier>0&&(0,Ue.jsxs)("div",{className:"text-sm text-sweetbite-600",children:["+RS ",e.priceModifier]})]},e.id))})]})},kv=e=>{let{frostings:t,selectedFrosting:n,onSelect:r}=e;return(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Choose Your Frosting"}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>(0,Ue.jsxs)(tl.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>r(e.id),className:"p-4 border-2 rounded-lg text-left transition-all ".concat(n===e.id?"border-sweetbite-600 bg-sweetbite-50":"border-gray-200 hover:border-sweetbite-300"),children:[(0,Ue.jsx)("div",{className:"font-semibold text-gray-800",children:e.name}),e.priceModifier>0&&(0,Ue.jsxs)("div",{className:"text-sm text-sweetbite-600",children:["+RS ",e.priceModifier]})]},e.id))})]})},Tv=e=>{let{toppings:t,selectedToppings:n,onToggle:r}=e;return(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Choose Your Toppings"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Select multiple toppings to add to your cake"}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>(0,Ue.jsx)(tl.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>r(e.id),className:"p-4 border-2 rounded-lg text-left transition-all ".concat(n.includes(e.id)?"border-sweetbite-600 bg-sweetbite-50":"border-gray-200 hover:border-sweetbite-300"),children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"font-semibold text-gray-800",children:e.name}),(0,Ue.jsxs)("div",{className:"text-sm text-sweetbite-600",children:["+RS ",e.priceModifier]})]}),n.includes(e.id)&&(0,Ue.jsx)("div",{className:"w-6 h-6 bg-sweetbite-600 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})},e.id))})]})},Pv=e=>{let{message:t,onChange:n}=e;return(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Add a Personal Message"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Add a special message to your cake (optional, max 30 characters)"}),(0,Ue.jsx)("textarea",{value:t,onChange:e=>n(e.target.value),maxLength:30,placeholder:"Happy Birthday! \ud83c\udf89",className:"w-full p-4 border-2 border-gray-200 rounded-lg focus:border-sweetbite-600 focus:outline-none resize-none",rows:4}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500 mt-2",children:[t.length,"/30 characters"]})]})},Lv=e=>{let{colors:t,selectedColor:n,onSelect:r}=e;return(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Choose Your Color"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Select a color for your cake frosting"}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.map(e=>(0,Ue.jsxs)(tl.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r(e.id),className:"p-4 border-2 rounded-lg text-center transition-all ".concat(n===e.id?"border-sweetbite-600 bg-sweetbite-50":"border-gray-200 hover:border-sweetbite-300"),children:[(0,Ue.jsx)("div",{className:"w-12 h-12 rounded-full mx-auto mb-2 border-2 border-gray-300",style:{backgroundColor:e.color}}),(0,Ue.jsx)("div",{className:"font-semibold text-gray-800",children:e.name}),e.priceModifier>0&&(0,Ue.jsxs)("div",{className:"text-sm text-sweetbite-600",children:["+RS ",e.priceModifier]}),n===e.id&&(0,Ue.jsx)("div",{className:"w-6 h-6 bg-sweetbite-600 rounded-full flex items-center justify-center mx-auto mt-2",children:(0,Ue.jsx)("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},e.id))})]})},Rv=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){return{1:"Frosting Selection",2:"Color Selection",3:"Toppings Selection",4:"Personal Message"}[e]||""}return{1:"Size Selection",2:"Shape Selection",3:"Frosting Selection",4:"Color Selection",5:"Toppings Selection",6:"Personal Message"}[e]||""},Iv=()=>{var e,t,n,r;const{cakeId:s}=re(),a=ne(),{addItem:o}=hl(),{isAuthenticated:l}=Be(),[c,d]=(0,i.useState)([]),[u,h]=(0,i.useState)(!0),[p,m]=(0,i.useState)(!1),[f,g]=(0,i.useState)(1),[x,v]=(0,i.useState)({size:null,shape:null,frosting:null,color:null,toppings:[],message:""}),[y,b]=(0,i.useState)(null),[w,_]=(0,i.useState)(0),[S,N]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(!l)return alert("Please sign up to customize cakes!"),void m(!0)},[l]),(0,i.useEffect)(()=>{(async()=>{try{h(!0);const e=await _v();d(e)}catch(nU){console.error("Error loading cakes:",nU),d([])}finally{h(!1)}})()},[]),(0,i.useEffect)(()=>{if(c.length>0){const e=s?c.find(e=>e.id===parseInt(s)):c[0];b(e),_(e?e.price:0),N(!!e&&"cupcakes"===e.category)}},[s,c]);(0,i.useEffect)(()=>{_((()=>{if(!y)return 0;let e=y.price;const t=S?Av:jv;if(!S){if(x.size){const n=t.sizes.find(e=>e.id===x.size);n&&(e+=n.priceModifier)}if(x.shape){const n=t.shapes.find(e=>e.id===x.shape);n&&(e+=n.priceModifier)}}if(x.frosting){const n=t.frostings.find(e=>e.id===x.frosting);n&&(e+=n.priceModifier)}if(x.color){const n=t.colors.find(e=>e.id===x.color);n&&(e+=n.priceModifier)}return x.toppings.forEach(n=>{const r=t.toppings.find(e=>e.id===n);r&&(e+=r.priceModifier)}),e})())},[x,y]);const j=(e,t)=>{v(n=>qe(qe({},n),{},{[e]:t}))},A=e=>{v(t=>qe(qe({},t),{},{toppings:t.toppings.includes(e)?t.toppings.filter(t=>t!==e):[...t.toppings,e]}))};return u?(0,Ue.jsx)("div",{className:"loading-spinner mx-auto mt-20"}):y?(0,Ue.jsxs)("div",{className:"min-h-screen gradient-bg py-8",children:[(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"text-center mb-8",children:[(0,Ue.jsxs)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:["Customize Your ",y.name]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Make it uniquely yours with our customization options"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ue.jsx)("div",{className:"lg:col-span-2",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsx)("div",{className:"flex items-center justify-between mb-4",children:(S?[1,2,3,4]:[1,2,3,4,5,6]).map(e=>(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold ".concat(e<=f?"bg-sweetbite-600 text-white":"bg-gray-200 text-gray-600"),children:e}),e<(S?4:6)&&(0,Ue.jsx)("div",{className:"w-16 h-1 mx-2 ".concat(e<f?"bg-sweetbite-600":"bg-gray-200")})]},e))}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-600",children:["Step ",f," of ",S?4:6,": ",Rv(f,S)]})]}),(0,Ue.jsx)("div",{className:"min-h-96",children:S?(0,Ue.jsxs)(Ue.Fragment,{children:[1===f&&(0,Ue.jsx)(kv,{frostings:Av.frostings,selectedFrosting:x.frosting,onSelect:e=>j("frosting",e)}),2===f&&(0,Ue.jsx)(Lv,{colors:Av.colors,selectedColor:x.color,onSelect:e=>j("color",e)}),3===f&&(0,Ue.jsx)(Tv,{toppings:Av.toppings,selectedToppings:x.toppings,onToggle:A}),4===f&&(0,Ue.jsx)(Pv,{message:x.message,onChange:e=>j("message",e)})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[1===f&&(0,Ue.jsx)(Ev,{sizes:jv.sizes,selectedSize:x.size,onSelect:e=>j("size",e)}),2===f&&(0,Ue.jsx)(Cv,{shapes:jv.shapes,selectedShape:x.shape,onSelect:e=>j("shape",e)}),3===f&&(0,Ue.jsx)(kv,{frostings:jv.frostings,selectedFrosting:x.frosting,onSelect:e=>j("frosting",e)}),4===f&&(0,Ue.jsx)(Lv,{colors:jv.colors,selectedColor:x.color,onSelect:e=>j("color",e)}),5===f&&(0,Ue.jsx)(Tv,{toppings:jv.toppings,selectedToppings:x.toppings,onToggle:A}),6===f&&(0,Ue.jsx)(Pv,{message:x.message,onChange:e=>j("message",e)})]})}),(0,Ue.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,Ue.jsx)("button",{onClick:()=>{f>1&&g(f-1)},disabled:1===f,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),f<(S?4:6)?(0,Ue.jsx)("button",{onClick:()=>{f<(S?4:6)&&g(f+1)},className:"px-6 py-2 bg-sweetbite-600 text-white rounded-lg hover:bg-sweetbite-700 transition-colors",children:"Next"}):(0,Ue.jsx)("button",{onClick:()=>{if(!l)return alert("Please sign up to add customized cakes to your cart!"),void m(!0);if(!y)return;const e=Mv(x,jv,y.price),t=qe(qe({},y),{},{price:w,customizations:x,previewImage:e.image,previewData:e});o(t),a("/cart")},className:"px-6 py-2 bg-sweetbite-600 text-white rounded-lg hover:bg-sweetbite-700 transition-colors",children:"Add to Cart"})]})]})}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Cake Preview"}),(0,Ue.jsx)("div",{className:"mb-4",children:(0,Ue.jsx)("img",{src:y.image,alt:y.name,className:"w-full h-48 object-cover rounded-lg"})}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-gray-800",children:y.name}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:y.description})]}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("h5",{className:"font-semibold text-gray-700 mb-2",children:"Your Customizations:"}),(0,Ue.jsxs)("div",{className:"space-y-1 text-sm",children:[!S&&x.size&&(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Size:"}),(0,Ue.jsx)("span",{children:null===(e=jv.sizes.find(e=>e.id===x.size))||void 0===e?void 0:e.name})]}),!S&&x.shape&&(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Shape:"}),(0,Ue.jsx)("span",{children:null===(t=jv.shapes.find(e=>e.id===x.shape))||void 0===t?void 0:t.name})]}),x.frosting&&(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Frosting:"}),(0,Ue.jsx)("span",{children:null===(n=(S?Av:jv).frostings.find(e=>e.id===x.frosting))||void 0===n?void 0:n.name})]}),x.color&&(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Color:"}),(0,Ue.jsx)("span",{children:null===(r=(S?Av:jv).colors.find(e=>e.id===x.color))||void 0===r?void 0:r.name})]}),x.toppings.length>0&&(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Toppings:"}),(0,Ue.jsxs)("span",{children:[x.toppings.length," selected"]})]}),x.message&&(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Message:"}),(0,Ue.jsx)("span",{className:"truncate max-w-20",children:x.message})]})]})]}),(0,Ue.jsx)("div",{className:"border-t pt-4",children:(0,Ue.jsxs)("div",{className:"flex justify-between text-lg font-bold",children:[(0,Ue.jsx)("span",{children:"Total Price:"}),(0,Ue.jsxs)("span",{className:"text-sweetbite-600",children:["RS ",w.toFixed(2)]})]})})]})})]})]}),(0,Ue.jsx)(pl,{isOpen:p,onClose:()=>m(!1)})]}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Cake Not Found"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"The cake you're looking for doesn't exist."}),(0,Ue.jsx)("button",{onClick:()=>a("/menu"),className:"px-6 py-2 bg-sweetbite-600 text-white rounded-lg hover:bg-sweetbite-700 transition-colors",children:"Back to Menu"})]})})},Fv=["title","titleId"];function Ov(e,t){let{title:n,titleId:r}=e,s=Ie(e,Fv);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Dv=i.forwardRef(Ov);function Uv(e,t){return function(){return e.apply(t,arguments)}}const{toString:zv}=Object.prototype,{getPrototypeOf:Bv}=Object,{iterator:Vv,toStringTag:Hv}=Symbol,Wv=(Gv=Object.create(null),e=>{const t=zv.call(e);return Gv[t]||(Gv[t]=t.slice(8,-1).toLowerCase())});var Gv;const qv=e=>(e=e.toLowerCase(),t=>Wv(t)===e),Xv=e=>t=>typeof t===e,{isArray:Yv}=Array,Zv=Xv("undefined");function Jv(e){return null!==e&&!Zv(e)&&null!==e.constructor&&!Zv(e.constructor)&&$v(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Kv=qv("ArrayBuffer");const Qv=Xv("string"),$v=Xv("function"),ey=Xv("number"),ty=e=>null!==e&&"object"===typeof e,ny=e=>{if("object"!==Wv(e))return!1;const t=Bv(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Hv in e)&&!(Vv in e)},ry=qv("Date"),iy=qv("File"),sy=qv("Blob"),ay=qv("FileList"),oy=qv("URLSearchParams"),[ly,cy,dy,uy]=["ReadableStream","Request","Response","Headers"].map(qv);function hy(e,t){let n,r,{allOwnKeys:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),Yv(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{if(Jv(e))return;const r=i?Object.getOwnPropertyNames(e):Object.keys(e),s=r.length;let a;for(n=0;n<s;n++)a=r[n],t.call(null,e[a],a,e)}}function py(e,t){if(Jv(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r,i=n.length;for(;i-- >0;)if(r=n[i],t===r.toLowerCase())return r;return null}const my="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,fy=e=>!Zv(e)&&e!==my;const gy=(xy="undefined"!==typeof Uint8Array&&Bv(Uint8Array),e=>xy&&e instanceof xy);var xy;const vy=qv("HTMLFormElement"),yy=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),by=qv("RegExp"),wy=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};hy(n,(n,i)=>{let s;!1!==(s=t(n,i,e))&&(r[i]=s||n)}),Object.defineProperties(e,r)};const _y=qv("AsyncFunction"),Sy=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),r=[],my.addEventListener("message",e=>{let{source:t,data:i}=e;t===my&&i===n&&r.length&&r.shift()()},!1),e=>{r.push(e),my.postMessage(n,"*")}):e=>setTimeout(e);var n,r})("function"===typeof setImmediate,$v(my.postMessage)),Ny="undefined"!==typeof queueMicrotask?queueMicrotask.bind(my):"undefined"!==typeof process&&process.nextTick||Sy,jy={isArray:Yv,isArrayBuffer:Kv,isBuffer:Jv,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||$v(e.append)&&("formdata"===(t=Wv(e))||"object"===t&&$v(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Kv(e.buffer),t},isString:Qv,isNumber:ey,isBoolean:e=>!0===e||!1===e,isObject:ty,isPlainObject:ny,isEmptyObject:e=>{if(!ty(e)||Jv(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(AB){return!1}},isReadableStream:ly,isRequest:cy,isResponse:dy,isHeaders:uy,isUndefined:Zv,isDate:ry,isFile:iy,isBlob:sy,isRegExp:by,isFunction:$v,isStream:e=>ty(e)&&$v(e.pipe),isURLSearchParams:oy,isTypedArray:gy,isFileList:ay,forEach:hy,merge:function e(){const{caseless:t,skipUndefined:n}=fy(this)&&this||{},r={},i=(i,s)=>{const a=t&&py(r,s)||s;ny(r[a])&&ny(i)?r[a]=e(r[a],i):ny(i)?r[a]=e({},i):Yv(i)?r[a]=i.slice():n&&Zv(i)||(r[a]=i)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&hy(arguments[s],i);return r},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return hy(t,(t,r)=>{n&&$v(t)?e[r]=Uv(t,n):e[r]=t},{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let i,s,a;const o={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)a=i[s],r&&!r(a,e,t)||o[a]||(t[a]=e[a],o[a]=!0);e=!1!==n&&Bv(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:Wv,kindOfTest:qv,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(Yv(e))return e;let t=e.length;if(!ey(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Vv]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:vy,hasOwnProperty:yy,hasOwnProp:yy,reduceDescriptors:wy,freezeMethods:e=>{wy(e,(t,n)=>{if($v(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];$v(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return Yv(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:py,global:my,isContextDefined:fy,isSpecCompliantForm:function(e){return!!(e&&$v(e.append)&&"FormData"===e[Hv]&&e[Vv])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(ty(e)){if(t.indexOf(e)>=0)return;if(Jv(e))return e;if(!("toJSON"in e)){t[r]=e;const i=Yv(e)?[]:{};return hy(e,(e,t)=>{const s=n(e,r+1);!Zv(s)&&(i[t]=s)}),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:_y,isThenable:e=>e&&(ty(e)||$v(e))&&$v(e.then)&&$v(e.catch),setImmediate:Sy,asap:Ny,isIterable:e=>null!=e&&$v(e[Vv])};function Ay(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}jy.inherits(Ay,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:jy.toJSONObject(this.config),code:this.code,status:this.status}}});const My=Ay.prototype,Ey={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ey[e]={value:e}}),Object.defineProperties(Ay,Ey),Object.defineProperty(My,"isAxiosError",{value:!0}),Ay.from=(e,t,n,r,i,s)=>{const a=Object.create(My);jy.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const o=e&&e.message?e.message:"Error",l=null==t&&e?e.code:t;return Ay.call(a,o,l,n,r,i),e&&null==a.cause&&Object.defineProperty(a,"cause",{value:e,configurable:!0}),a.name=e&&e.name||"Error",s&&Object.assign(a,s),a};const Cy=Ay;function ky(e){return jy.isPlainObject(e)||jy.isArray(e)}function Ty(e){return jy.endsWith(e,"[]")?e.slice(0,-2):e}function Py(e,t,n){return e?e.concat(t).map(function(e,t){return e=Ty(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const Ly=jy.toFlatObject(jy,{},null,function(e){return/^is[A-Z]/.test(e)});const Ry=function(e,t,n){if(!jy.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=jy.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!jy.isUndefined(t[e])});const r=n.metaTokens,i=n.visitor||c,s=n.dots,a=n.indexes,o=(n.Blob||"undefined"!==typeof Blob&&Blob)&&jy.isSpecCompliantForm(t);if(!jy.isFunction(i))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(jy.isDate(e))return e.toISOString();if(jy.isBoolean(e))return e.toString();if(!o&&jy.isBlob(e))throw new Cy("Blob is not supported. Use a Buffer instead.");return jy.isArrayBuffer(e)||jy.isTypedArray(e)?o&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,i){let o=e;if(e&&!i&&"object"===typeof e)if(jy.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(jy.isArray(e)&&function(e){return jy.isArray(e)&&!e.some(ky)}(e)||(jy.isFileList(e)||jy.endsWith(n,"[]"))&&(o=jy.toArray(e)))return n=Ty(n),o.forEach(function(e,r){!jy.isUndefined(e)&&null!==e&&t.append(!0===a?Py([n],r,s):null===a?n:n+"[]",l(e))}),!1;return!!ky(e)||(t.append(Py(i,n,s),l(e)),!1)}const d=[],u=Object.assign(Ly,{defaultVisitor:c,convertValue:l,isVisitable:ky});if(!jy.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!jy.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+r.join("."));d.push(n),jy.forEach(n,function(n,s){!0===(!(jy.isUndefined(n)||null===n)&&i.call(t,n,jy.isString(s)?s.trim():s,r,u))&&e(n,r?r.concat(s):[s])}),d.pop()}}(e),t};function Iy(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function Fy(e,t){this._pairs=[],e&&Ry(e,this,t)}const Oy=Fy.prototype;Oy.append=function(e,t){this._pairs.push([e,t])},Oy.toString=function(e){const t=e?function(t){return e.call(this,t,Iy)}:Iy;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const Dy=Fy;function Uy(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function zy(e,t,n){if(!t)return e;const r=n&&n.encode||Uy;jy.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(s=i?i(t,n):jy.isURLSearchParams(t)?t.toString():new Dy(t,n).toString(r),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const By=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){jy.forEach(this.handlers,function(t){null!==t&&e(t)})}},Vy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Hy={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Dy,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Wy="undefined"!==typeof window&&"undefined"!==typeof document,Gy="object"===typeof navigator&&navigator||void 0,qy=Wy&&(!Gy||["ReactNative","NativeScript","NS"].indexOf(Gy.product)<0),Xy="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Yy=Wy&&window.location.href||"http://localhost",Zy=qe(qe({},e),Hy);const Jy=function(e){function t(e,n,r,i){let s=e[i++];if("__proto__"===s)return!0;const a=Number.isFinite(+s),o=i>=e.length;if(s=!s&&jy.isArray(r)?r.length:s,o)return jy.hasOwnProp(r,s)?r[s]=[r[s],n]:r[s]=n,!a;r[s]&&jy.isObject(r[s])||(r[s]=[]);return t(e,n,r[s],i)&&jy.isArray(r[s])&&(r[s]=function(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}(r[s])),!a}if(jy.isFormData(e)&&jy.isFunction(e.entries)){const n={};return jy.forEachEntry(e,(e,r)=>{t(function(e){return jy.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null};const Ky={transitional:Vy,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,i=jy.isObject(e);i&&jy.isHTMLForm(e)&&(e=new FormData(e));if(jy.isFormData(e))return r?JSON.stringify(Jy(e)):e;if(jy.isArrayBuffer(e)||jy.isBuffer(e)||jy.isStream(e)||jy.isFile(e)||jy.isBlob(e)||jy.isReadableStream(e))return e;if(jy.isArrayBufferView(e))return e.buffer;if(jy.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Ry(e,new Zy.classes.URLSearchParams,qe({visitor:function(e,t,n,r){return Zy.isNode&&jy.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=jy.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Ry(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),function(e,t,n){if(jy.isString(e))try{return(t||JSON.parse)(e),jy.trim(e)}catch(AB){if("SyntaxError"!==AB.name)throw AB}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Ky.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(jy.isResponse(e)||jy.isReadableStream(e))return e;if(e&&jy.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(AB){if(n){if("SyntaxError"===AB.name)throw Cy.from(AB,Cy.ERR_BAD_RESPONSE,this,null,this.response);throw AB}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zy.classes.FormData,Blob:Zy.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};jy.forEach(["delete","get","head","post","put","patch"],e=>{Ky.headers[e]={}});const Qy=Ky,$y=jy.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),eb=Symbol("internals");function tb(e){return e&&String(e).trim().toLowerCase()}function nb(e){return!1===e||null==e?e:jy.isArray(e)?e.map(nb):String(e)}function rb(e,t,n,r,i){return jy.isFunction(r)?r.call(this,t,n):(i&&(t=n),jy.isString(t)?jy.isString(r)?-1!==t.indexOf(r):jy.isRegExp(r)?r.test(t):void 0:void 0)}class ib{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){const i=tb(t);if(!i)throw new Error("header name must be a non-empty string");const s=jy.findKey(r,i);(!s||void 0===r[s]||!0===n||void 0===n&&!1!==r[s])&&(r[s||t]=nb(e))}const s=(e,t)=>jy.forEach(e,(e,n)=>i(e,n,t));if(jy.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(jy.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach(function(e){i=e.indexOf(":"),n=e.substring(0,i).trim().toLowerCase(),r=e.substring(i+1).trim(),!n||t[n]&&$y[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(jy.isObject(e)&&jy.isIterable(e)){let n,r,i={};for(const t of e){if(!jy.isArray(t))throw TypeError("Object iterator must return a key-value pair");i[r=t[0]]=(n=i[r])?jy.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}s(i,t)}else null!=e&&i(t,e,n);return this}get(e,t){if(e=tb(e)){const n=jy.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(jy.isFunction(t))return t.call(this,e,n);if(jy.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=tb(e)){const n=jy.findKey(this,e);return!(!n||void 0===this[n]||t&&!rb(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function i(e){if(e=tb(e)){const i=jy.findKey(n,e);!i||t&&!rb(0,n[i],i,t)||(delete n[i],r=!0)}}return jy.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];e&&!rb(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return jy.forEach(this,(r,i)=>{const s=jy.findKey(n,i);if(s)return t[s]=nb(r),void delete t[i];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(i):String(i).trim();a!==i&&delete t[i],t[a]=nb(r),n[a]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return jy.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&jy.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[eb]=this[eb]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=tb(e);t[r]||(!function(e,t){const n=jy.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})})}(n,e),t[r]=!0)}return jy.isArray(e)?e.forEach(r):r(e),this}}ib.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),jy.reduceDescriptors(ib.prototype,(e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}}),jy.freezeMethods(ib);const sb=ib;function ab(e,t){const n=this||Qy,r=t||n,i=sb.from(r.headers);let s=r.data;return jy.forEach(e,function(e){s=e.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function ob(e){return!(!e||!e.__CANCEL__)}function lb(e,t,n){Cy.call(this,null==e?"canceled":e,Cy.ERR_CANCELED,t,n),this.name="CanceledError"}jy.inherits(lb,Cy,{__CANCEL__:!0});const cb=lb;function db(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new Cy("Request failed with status code "+n.status,[Cy.ERR_BAD_REQUEST,Cy.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const ub=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,s=0,a=0;return t=void 0!==t?t:1e3,function(o){const l=Date.now(),c=r[a];i||(i=l),n[s]=o,r[s]=l;let d=a,u=0;for(;d!==s;)u+=n[d++],d%=e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),l-i<t)return;const h=c&&l-c;return h?Math.round(1e3*u/h):void 0}};const hb=function(e,t){let n,r,i=0,s=1e3/t;const a=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();i=s,n=null,r&&(clearTimeout(r),r=null),e(...t)};return[function(){const e=Date.now(),t=e-i;for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];t>=s?a(l,e):(n=l,r||(r=setTimeout(()=>{r=null,a(n)},s-t)))},()=>n&&a(n)]},pb=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const i=ub(50,250);return hb(n=>{const s=n.loaded,a=n.lengthComputable?n.total:void 0,o=s-r,l=i(o);r=s;e({loaded:s,total:a,progress:a?s/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&s<=a?(a-s)/l:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0})},n)},mb=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},fb=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return jy.asap(()=>e(...n))},gb=Zy.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Zy.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Zy.origin),Zy.navigator&&/(msie|trident)/i.test(Zy.navigator.userAgent)):()=>!0,xb=Zy.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const a=[e+"="+encodeURIComponent(t)];jy.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),jy.isString(r)&&a.push("path="+r),jy.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function vb(e,t,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const yb=e=>e instanceof sb?qe({},e):e;function bb(e,t){t=t||{};const n={};function r(e,t,n,r){return jy.isPlainObject(e)&&jy.isPlainObject(t)?jy.merge.call({caseless:r},e,t):jy.isPlainObject(t)?jy.merge({},t):jy.isArray(t)?t.slice():t}function i(e,t,n,i){return jy.isUndefined(t)?jy.isUndefined(e)?void 0:r(void 0,e,0,i):r(e,t,0,i)}function s(e,t){if(!jy.isUndefined(t))return r(void 0,t)}function a(e,t){return jy.isUndefined(t)?jy.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function o(n,i,s){return s in t?r(n,i):s in e?r(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(e,t,n)=>i(yb(e),yb(t),0,!0)};return jy.forEach(Object.keys(qe(qe({},e),t)),function(r){const s=l[r]||i,a=s(e[r],t[r],r);jy.isUndefined(a)&&s!==o||(n[r]=a)}),n}const wb=e=>{const t=bb({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:a,auth:o}=t;if(t.headers=a=sb.from(a),t.url=zy(vb(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),jy.isFormData(n))if(Zy.hasStandardBrowserEnv||Zy.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(jy.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[n,r]=e;t.includes(n.toLowerCase())&&a.set(n,r)})}if(Zy.hasStandardBrowserEnv&&(r&&jy.isFunction(r)&&(r=r(t)),r||!1!==r&&gb(t.url))){const e=i&&s&&xb.read(s);e&&a.set(i,e)}return t},_b="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const r=wb(e);let i=r.data;const s=sb.from(r.headers).normalize();let a,o,l,c,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=r;function m(){c&&c(),d&&d(),r.cancelToken&&r.cancelToken.unsubscribe(a),r.signal&&r.signal.removeEventListener("abort",a)}let f=new XMLHttpRequest;function g(){if(!f)return;const r=sb.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());db(function(e){t(e),m()},function(e){n(e),m()},{data:u&&"text"!==u&&"json"!==u?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f}),f=null}f.open(r.method.toUpperCase(),r.url,!0),f.timeout=r.timeout,"onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(g)},f.onabort=function(){f&&(n(new Cy("Request aborted",Cy.ECONNABORTED,e,f)),f=null)},f.onerror=function(t){const r=t&&t.message?t.message:"Network Error",i=new Cy(r,Cy.ERR_NETWORK,e,f);i.event=t||null,n(i),f=null},f.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const i=r.transitional||Vy;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new Cy(t,i.clarifyTimeoutError?Cy.ETIMEDOUT:Cy.ECONNABORTED,e,f)),f=null},void 0===i&&s.setContentType(null),"setRequestHeader"in f&&jy.forEach(s.toJSON(),function(e,t){f.setRequestHeader(t,e)}),jy.isUndefined(r.withCredentials)||(f.withCredentials=!!r.withCredentials),u&&"json"!==u&&(f.responseType=r.responseType),p&&([l,d]=pb(p,!0),f.addEventListener("progress",l)),h&&f.upload&&([o,c]=pb(h),f.upload.addEventListener("progress",o),f.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(a=t=>{f&&(n(!t||t.type?new cb(null,e,f):t),f.abort(),f=null)},r.cancelToken&&r.cancelToken.subscribe(a),r.signal&&(r.signal.aborted?a():r.signal.addEventListener("abort",a)));const x=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);x&&-1===Zy.protocols.indexOf(x)?n(new Cy("Unsupported protocol "+x+":",Cy.ERR_BAD_REQUEST,e)):f.send(i||null)})},Sb=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const i=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;r.abort(t instanceof Cy?t:new cb(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,i(new Cy("timeout ".concat(t," of ms exceeded"),Cy.ETIMEDOUT))},t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(i):e.removeEventListener("abort",i)}),e=null)};e.forEach(e=>e.addEventListener("abort",i));const{signal:o}=r;return o.unsubscribe=()=>jy.asap(a),o}};function Nb(e,t){this.v=e,this.k=t}function jb(e){return function(){return new Ab(e.apply(this,arguments))}}function Ab(e){var t,n;function r(t,n){try{var s=e[t](n),a=s.value,o=a instanceof Nb;Promise.resolve(o?a.v:a).then(function(n){if(o){var l="return"===t?"return":"next";if(!a.k||n.done)return r(l,n);n=e[l](n).value}i(s.done?"return":"normal",n)},function(e){r("throw",e)})}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(s,a){var o={key:e,arg:i,resolve:s,reject:a,next:null};n?n=n.next=o:(t=n=o,r(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}function Mb(e){return new Nb(e,0)}function Eb(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise(function(n){n(e[t](r))}),{done:!1,value:new Nb(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}function Cb(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new kb(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function kb(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return kb=function(e){this.s=e,this.n=e.next},kb.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new kb(e)}Ab.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Ab.prototype.next=function(e){return this._invoke("next",e)},Ab.prototype.throw=function(e){return this._invoke("throw",e)},Ab.prototype.return=function(e){return this._invoke("return",e)};const Tb=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,i=0;for(;i<n;)r=i+t,yield e.slice(i,r),i=r},Pb=function(){var e=jb(function*(e,t){var n,r=!1,i=!1;try{for(var s,a=Cb(Lb(e));r=!(s=yield Mb(a.next())).done;r=!1){const e=s.value;yield*Eb(Cb(Tb(e,t)))}}catch(o){i=!0,n=o}finally{try{r&&null!=a.return&&(yield Mb(a.return()))}finally{if(i)throw n}}});return function(t,n){return e.apply(this,arguments)}}(),Lb=function(){var e=jb(function*(e){if(e[Symbol.asyncIterator])return void(yield*Eb(Cb(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield Mb(t.read());if(e)break;yield n}}finally{yield Mb(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),Rb=(e,t,n,r)=>{const i=Pb(e,t);let s,a=0,o=e=>{s||(s=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await i.next();if(t)return o(),void e.close();let s=r.byteLength;if(n){let e=a+=s;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw o(t),t}},cancel:e=>(o(e),i.return())},{highWaterMark:2})},{isFunction:Ib}=jy,Fb=(e=>{let{Request:t,Response:n}=e;return{Request:t,Response:n}})(jy.global),{ReadableStream:Ob,TextEncoder:Db}=jy.global,Ub=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(AB){return!1}},zb=e=>{e=jy.merge.call({skipUndefined:!0},Fb,e);const{fetch:t,Request:n,Response:r}=e,i=t?Ib(t):"function"===typeof fetch,s=Ib(n),a=Ib(r);if(!i)return!1;const o=i&&Ib(Ob),l=i&&("function"===typeof Db?(e=>t=>e.encode(t))(new Db):async e=>new Uint8Array(await new n(e).arrayBuffer())),c=s&&o&&Ub(()=>{let e=!1;const t=new n(Zy.origin,{body:new Ob,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),d=a&&o&&Ub(()=>jy.isReadableStream(new r("").body)),u={stream:d&&(e=>e.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!u[e]&&(u[e]=(t,n)=>{let r=t&&t[e];if(r)return r.call(t);throw new Cy("Response type '".concat(e,"' is not supported"),Cy.ERR_NOT_SUPPORT,n)})});const h=async(e,t)=>{const r=jy.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(jy.isBlob(e))return e.size;if(jy.isSpecCompliantForm(e)){const t=new n(Zy.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return jy.isArrayBufferView(e)||jy.isArrayBuffer(e)?e.byteLength:(jy.isURLSearchParams(e)&&(e+=""),jy.isString(e)?(await l(e)).byteLength:void 0)})(t):r};return async e=>{let{url:i,method:a,data:o,signal:l,cancelToken:p,timeout:m,onDownloadProgress:f,onUploadProgress:g,responseType:x,headers:v,withCredentials:y="same-origin",fetchOptions:b}=wb(e),w=t||fetch;x=x?(x+"").toLowerCase():"text";let _=Sb([l,p&&p.toAbortSignal()],m),S=null;const N=_&&_.unsubscribe&&(()=>{_.unsubscribe()});let j;try{if(g&&c&&"get"!==a&&"head"!==a&&0!==(j=await h(v,o))){let e,t=new n(i,{method:"POST",body:o,duplex:"half"});if(jy.isFormData(o)&&(e=t.headers.get("content-type"))&&v.setContentType(e),t.body){const[e,n]=mb(j,pb(fb(g)));o=Rb(t.body,65536,e,n)}}jy.isString(y)||(y=y?"include":"omit");const t=s&&"credentials"in n.prototype,l=qe(qe({},b),{},{signal:_,method:a.toUpperCase(),headers:v.normalize().toJSON(),body:o,duplex:"half",credentials:t?y:void 0});S=s&&new n(i,l);let p=await(s?w(S,b):w(i,l));const m=d&&("stream"===x||"response"===x);if(d&&(f||m&&N)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=p[t]});const t=jy.toFiniteNumber(p.headers.get("content-length")),[n,i]=f&&mb(t,pb(fb(f),!0))||[];p=new r(Rb(p.body,65536,n,()=>{i&&i(),N&&N()}),e)}x=x||"text";let A=await u[jy.findKey(u,x)||"text"](p,e);return!m&&N&&N(),await new Promise((t,n)=>{db(t,n,{data:A,headers:sb.from(p.headers),status:p.status,statusText:p.statusText,config:e,request:S})})}catch(A){if(N&&N(),A&&"TypeError"===A.name&&/Load failed|fetch/i.test(A.message))throw Object.assign(new Cy("Network Error",Cy.ERR_NETWORK,e,S),{cause:A.cause||A});throw Cy.from(A,A&&A.code,e,S)}}},Bb=new Map,Vb=e=>{let t=e?e.env:{};const{fetch:n,Request:r,Response:i}=t,s=[r,i,n];let a,o,l=s.length,c=Bb;for(;l--;)a=s[l],o=c.get(a),void 0===o&&c.set(a,o=l?new Map:zb(t)),c=o;return o},Hb=(Vb(),{http:null,xhr:_b,fetch:{get:Vb}});jy.forEach(Hb,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(AB){}Object.defineProperty(e,"adapterName",{value:t})}});const Wb=e=>"- ".concat(e),Gb=e=>jy.isFunction(e)||null===e||!1===e,qb=(e,t)=>{e=jy.isArray(e)?e:[e];const{length:n}=e;let r,i;const s={};for(let a=0;a<n;a++){let n;if(r=e[a],i=r,!Gb(r)&&(i=Hb[(n=String(r)).toLowerCase()],void 0===i))throw new Cy("Unknown adapter '".concat(n,"'"));if(i&&(jy.isFunction(i)||(i=i.get(t))))break;s[n||"#"+a]=i}if(!i){const e=Object.entries(s).map(e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let t=n?e.length>1?"since :\n"+e.map(Wb).join("\n"):" "+Wb(e[0]):"as no adapter specified";throw new Cy("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return i};function Xb(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new cb(null,e)}function Yb(e){Xb(e),e.headers=sb.from(e.headers),e.data=ab.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return qb(e.adapter||Qy.adapter,e)(e).then(function(t){return Xb(e),t.data=ab.call(e,e.transformResponse,t),t.headers=sb.from(t.headers),t},function(t){return ob(t)||(Xb(e),t&&t.response&&(t.response.data=ab.call(e,e.transformResponse,t.response),t.response.headers=sb.from(t.response.headers))),Promise.reject(t)})}const Zb="1.12.2",Jb={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Jb[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Kb={};Jb.transitional=function(e,t,n){function r(e,t){return"[Axios v"+Zb+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,s)=>{if(!1===e)throw new Cy(r(i," has been removed"+(t?" in "+t:"")),Cy.ERR_DEPRECATED);return t&&!Kb[i]&&(Kb[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,s)}},Jb.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const Qb={assertOptions:function(e,t,n){if("object"!==typeof e)throw new Cy("options must be an object",Cy.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],a=t[s];if(a){const t=e[s],n=void 0===t||a(t,s,e);if(!0!==n)throw new Cy("option "+s+" must be "+n,Cy.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new Cy("Unknown option "+s,Cy.ERR_BAD_OPTION)}},validators:Jb},$b=Qb.validators;class ew{constructor(e){this.defaults=e||{},this.interceptors={request:new By,response:new By}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(AB){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=bb(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;void 0!==n&&Qb.assertOptions(n,{silentJSONParsing:$b.transitional($b.boolean),forcedJSONParsing:$b.transitional($b.boolean),clarifyTimeoutError:$b.transitional($b.boolean)},!1),null!=r&&(jy.isFunction(r)?t.paramsSerializer={serialize:r}:Qb.assertOptions(r,{encode:$b.function,serialize:$b.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Qb.assertOptions(t,{baseUrl:$b.spelling("baseURL"),withXsrfToken:$b.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=i&&jy.merge(i.common,i[t.method]);i&&jy.forEach(["delete","get","head","post","put","patch","common"],e=>{delete i[e]}),t.headers=sb.concat(s,i);const a=[];let o=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,a.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let d,u=0;if(!o){const e=[Yb.bind(this),void 0];for(e.unshift(...a),e.push(...l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=a.length;let h=t;for(;u<d;){const e=a[u++],t=a[u++];try{h=e(h)}catch(nU){t.call(this,nU);break}}try{c=Yb.call(this,h)}catch(nU){return Promise.reject(nU)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return zy(vb((e=bb(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}jy.forEach(["delete","get","head","options"],function(e){ew.prototype[e]=function(t,n){return this.request(bb(n||{},{method:e,url:t,data:(n||{}).data}))}}),jy.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,i){return this.request(bb(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}ew.prototype[e]=t(),ew.prototype[e+"Form"]=t(!0)});const tw=ew;class nw{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,i){n.reason||(n.reason=new cb(e,r,i),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new nw(function(t){e=t});return{token:t,cancel:e}}}const rw=nw;const iw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(iw).forEach(e=>{let[t,n]=e;iw[n]=t});const sw=iw;const aw=function e(t){const n=new tw(t),r=Uv(tw.prototype.request,n);return jy.extend(r,tw.prototype,n,{allOwnKeys:!0}),jy.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(bb(t,n))},r}(Qy);aw.Axios=tw,aw.CanceledError=cb,aw.CancelToken=rw,aw.isCancel=ob,aw.VERSION=Zb,aw.toFormData=Ry,aw.AxiosError=Cy,aw.Cancel=aw.CanceledError,aw.all=function(e){return Promise.all(e)},aw.spread=function(e){return function(t){return e.apply(null,t)}},aw.isAxiosError=function(e){return jy.isObject(e)&&!0===e.isAxiosError},aw.mergeConfig=bb,aw.AxiosHeaders=sb,aw.formToJSON=e=>Jy(jy.isHTMLForm(e)?new FormData(e):e),aw.getAdapter=qb,aw.HttpStatusCode=sw,aw.default=aw;const ow=aw;function lw(){return lw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lw.apply(null,arguments)}const cw="164",dw={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},uw={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},hw=0,pw=1,mw=2,fw=3,gw=0,xw=1,vw=2,yw=3,bw=0,ww=1,_w=2,Sw=0,Nw=1,jw=2,Aw=3,Mw=4,Ew=5,Cw=100,kw=101,Tw=102,Pw=103,Lw=104,Rw=200,Iw=201,Fw=202,Ow=203,Dw=204,Uw=205,zw=206,Bw=207,Vw=208,Hw=209,Ww=210,Gw=211,qw=212,Xw=213,Yw=214,Zw=0,Jw=1,Kw=2,Qw=3,$w=4,e_=5,t_=6,n_=7,r_=0,i_=1,s_=2,a_=0,o_=1,l_=2,c_=3,d_=4,u_=5,h_=6,p_=7,m_="attached",f_="detached",g_=300,x_=301,v_=302,y_=303,b_=304,w_=306,__=1e3,S_=1001,N_=1002,j_=1003,A_=1004,M_=1004,E_=1005,C_=1005,k_=1006,T_=1007,P_=1007,L_=1008,R_=1008,I_=1009,F_=1010,O_=1011,D_=1012,U_=1013,z_=1014,B_=1015,V_=1016,H_=1017,W_=1018,G_=1020,q_=35902,X_=1021,Y_=1022,Z_=1023,J_=1024,K_=1025,Q_=1026,$_=1027,eS=1028,tS=1029,nS=1030,rS=1031,iS=1033,sS=33776,aS=33777,oS=33778,lS=33779,cS=35840,dS=35841,uS=35842,hS=35843,pS=36196,mS=37492,fS=37496,gS=37808,xS=37809,vS=37810,yS=37811,bS=37812,wS=37813,_S=37814,SS=37815,NS=37816,jS=37817,AS=37818,MS=37819,ES=37820,CS=37821,kS=36492,TS=36494,PS=36495,LS=36283,RS=36284,IS=36285,FS=36286,OS=2200,DS=2201,US=2202,zS=2300,BS=2301,VS=2302,HS=2400,WS=2401,GS=2402,qS=2500,XS=2501,YS=0,ZS=1,JS=2,KS=3200,QS=3201,$S=0,eN=1,tN="",nN="srgb",rN="srgb-linear",iN="display-p3",sN="display-p3-linear",aN="linear",oN="srgb",lN="rec709",cN="p3",dN=0,uN=7680,hN=7681,pN=7682,mN=7683,fN=34055,gN=34056,xN=5386,vN=512,yN=513,bN=514,wN=515,_N=516,SN=517,NN=518,jN=519,AN=512,MN=513,EN=514,CN=515,kN=516,TN=517,PN=518,LN=519,RN=35044,IN=35048,FN=35040,ON=35045,DN=35049,UN=35041,zN=35046,BN=35050,VN=35042,HN="100",WN="300 es",GN=2e3,qN=2001;class XN{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}const YN=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ZN=1234567;const JN=Math.PI/180,KN=180/Math.PI;function QN(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(YN[255&e]+YN[e>>8&255]+YN[e>>16&255]+YN[e>>24&255]+"-"+YN[255&t]+YN[t>>8&255]+"-"+YN[t>>16&15|64]+YN[t>>24&255]+"-"+YN[63&n|128]+YN[n>>8&255]+"-"+YN[n>>16&255]+YN[n>>24&255]+YN[255&r]+YN[r>>8&255]+YN[r>>16&255]+YN[r>>24&255]).toLowerCase()}function $N(e,t,n){return Math.max(t,Math.min(n,e))}function ej(e,t){return(e%t+t)%t}function tj(e,t,n){return(1-n)*e+n*t}function nj(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function rj(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const ij={DEG2RAD:JN,RAD2DEG:KN,generateUUID:QN,clamp:$N,euclideanModulo:ej,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:tj,damp:function(e,t,n,r){return tj(e,t,1-Math.exp(-n*r))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(ej(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(ZN=e);let t=ZN+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*JN},radToDeg:function(e){return e*KN},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((t+r)/2),d=a((t+r)/2),u=s((t-r)/2),h=a((t-r)/2),p=s((r-t)/2),m=a((r-t)/2);switch(i){case"XYX":e.set(o*d,l*u,l*h,o*c);break;case"YZY":e.set(l*h,o*d,l*u,o*c);break;case"ZXZ":e.set(l*u,l*h,o*d,o*c);break;case"XZX":e.set(o*d,l*m,l*p,o*c);break;case"YXY":e.set(l*p,o*d,l*m,o*c);break;case"ZYZ":e.set(l*m,l*p,o*d,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:rj,denormalize:nj};class sj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;sj.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos($N(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,s=this.y-e.y;return this.x=i*n-s*r+e.x,this.y=i*r+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class aj{constructor(e,t,n,r,i,s,a,o,l){aj.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,s,a,o,l)}set(e,t,n,r,i,s,a,o,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=i,c[5]=o,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],c=n[4],d=n[7],u=n[2],h=n[5],p=n[8],m=r[0],f=r[3],g=r[6],x=r[1],v=r[4],y=r[7],b=r[2],w=r[5],_=r[8];return i[0]=s*m+a*x+o*b,i[3]=s*f+a*v+o*w,i[6]=s*g+a*y+o*_,i[1]=l*m+c*x+d*b,i[4]=l*f+c*v+d*w,i[7]=l*g+c*y+d*_,i[2]=u*m+h*x+p*b,i[5]=u*f+h*v+p*w,i[8]=u*g+h*y+p*_,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-n*i*c+n*a*o+r*i*l-r*s*o}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],d=c*s-a*l,u=a*o-c*i,h=l*i-s*o,p=t*d+n*u+r*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=d*m,e[1]=(r*l-c*n)*m,e[2]=(a*n-r*s)*m,e[3]=u*m,e[4]=(c*t-r*o)*m,e[5]=(r*i-a*t)*m,e[6]=h*m,e[7]=(n*o-l*t)*m,e[8]=(s*t-n*i)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,s,a){const o=Math.cos(i),l=Math.sin(i);return this.set(n*o,n*l,-n*(o*s+l*a)+s+e,-r*l,r*o,-r*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(oj.makeScale(e,t)),this}rotate(e){return this.premultiply(oj.makeRotation(-e)),this}translate(e,t){return this.premultiply(oj.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const oj=new aj;function lj(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const cj={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function dj(e,t){return new cj[e](t)}function uj(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function hj(){const e=uj("canvas");return e.style.display="block",e}const pj={};function mj(e){e in pj||(pj[e]=!0,console.warn(e))}const fj=(new aj).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),gj=(new aj).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),xj={[rN]:{transfer:aN,primaries:lN,toReference:e=>e,fromReference:e=>e},[nN]:{transfer:oN,primaries:lN,toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[sN]:{transfer:aN,primaries:cN,toReference:e=>e.applyMatrix3(gj),fromReference:e=>e.applyMatrix3(fj)},[iN]:{transfer:oN,primaries:cN,toReference:e=>e.convertSRGBToLinear().applyMatrix3(gj),fromReference:e=>e.applyMatrix3(fj).convertLinearToSRGB()}},vj=new Set([rN,sN]),yj={enabled:!0,_workingColorSpace:rN,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(e){if(!vj.has(e))throw new Error('Unsupported working color space, "'.concat(e,'".'));this._workingColorSpace=e},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;const r=xj[t].toReference;return(0,xj[n].fromReference)(r(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return xj[e].primaries},getTransfer:function(e){return e===tN?aN:xj[e].transfer}};function bj(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function wj(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let _j;class Sj{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===_j&&(_j=uj("canvas")),_j.width=e.width,_j.height=e.height;const n=_j.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=_j}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=uj("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*bj(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*bj(t[e]/255)):t[e]=bj(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Nj=0;class jj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:Nj++}),this.uuid=QN(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(Aj(r[t].image)):e.push(Aj(r[t]))}else e=Aj(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function Aj(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?Sj.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Mj=0;class Ej extends XN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ej.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ej.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S_,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:S_,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:k_,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:L_,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Z_,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:I_,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Ej.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:tN;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Mj++}),this.uuid=QN(),this.name="",this.source=new jj(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new sj(0,0),this.repeat=new sj(1,1),this.center=new sj(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new aj,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==g_)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case __:e.x=e.x-Math.floor(e.x);break;case S_:e.x=e.x<0?0:1;break;case N_:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case __:e.y=e.y-Math.floor(e.y);break;case S_:e.y=e.y<0?0:1;break;case N_:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}Ej.DEFAULT_IMAGE=null,Ej.DEFAULT_MAPPING=g_,Ej.DEFAULT_ANISOTROPY=1;class Cj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Cj.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r+s[12]*i,this.y=s[1]*t+s[5]*n+s[9]*r+s[13]*i,this.z=s[2]*t+s[6]*n+s[10]*r+s[14]*i,this.w=s[3]*t+s[7]*n+s[11]*r+s[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const s=.01,a=.1,o=e.elements,l=o[0],c=o[4],d=o[8],u=o[1],h=o[5],p=o[9],m=o[2],f=o[6],g=o[10];if(Math.abs(c-u)<s&&Math.abs(d-m)<s&&Math.abs(p-f)<s){if(Math.abs(c+u)<a&&Math.abs(d+m)<a&&Math.abs(p+f)<a&&Math.abs(l+h+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(h+1)/2,x=(g+1)/2,v=(c+u)/4,y=(d+m)/4,b=(p+f)/4;return e>o&&e>x?e<s?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=v/n,i=y/n):o>x?o<s?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=v/r,i=b/r):x<s?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(x),n=y/i,r=b/i),this.set(n,r,i,t),this}let x=Math.sqrt((f-p)*(f-p)+(d-m)*(d-m)+(u-c)*(u-c));return Math.abs(x)<.001&&(x=1),this.x=(f-p)/x,this.y=(d-m)/x,this.z=(u-c)/x,this.w=Math.acos((l+h+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class kj extends XN{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Cj(0,0,e,t),this.scissorTest=!1,this.viewport=new Cj(0,0,e,t);const r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:k_,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const i=new Ej(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);i.flipY=!1,i.generateMipmaps=n.generateMipmaps,i.internalFormat=n.internalFormat,this.textures=[];const s=n.count;for(let a=0;a<s;a++)this.textures[a]=i.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new jj(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Tj extends kj{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class Pj extends Ej{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=j_,this.minFilter=j_,this.wrapR=S_,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Lj extends Tj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Pj(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Rj extends Ej{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=j_,this.minFilter=j_,this.wrapR=S_,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ij extends Tj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Rj(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Fj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,s,a){let o=n[r+0],l=n[r+1],c=n[r+2],d=n[r+3];const u=i[s+0],h=i[s+1],p=i[s+2],m=i[s+3];if(0===a)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=d);if(1===a)return e[t+0]=u,e[t+1]=h,e[t+2]=p,void(e[t+3]=m);if(d!==m||o!==u||l!==h||c!==p){let e=1-a;const t=o*u+l*h+c*p+d*m,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),s=Math.atan2(i,t*n);e=Math.sin(e*s)/i,a=Math.sin(a*s)/i}const i=a*n;if(o=o*e+u*i,l=l*e+h*i,c=c*e+p*i,d=d*e+m*i,e===1-a){const e=1/Math.sqrt(o*o+l*l+c*c+d*d);o*=e,l*=e,c*=e,d*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,r,i,s){const a=n[r],o=n[r+1],l=n[r+2],c=n[r+3],d=i[s],u=i[s+1],h=i[s+2],p=i[s+3];return e[t]=a*p+c*d+o*h-l*u,e[t+1]=o*p+c*u+l*d-a*h,e[t+2]=l*p+c*h+a*u-o*d,e[t+3]=c*p-a*d-o*u-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,r=e._y,i=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(n/2),c=a(r/2),d=a(i/2),u=o(n/2),h=o(r/2),p=o(i/2);switch(s){case"XYZ":this._x=u*c*d+l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d-u*h*p;break;case"YXZ":this._x=u*c*d+l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d+u*h*p;break;case"ZXY":this._x=u*c*d-l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d-u*h*p;break;case"ZYX":this._x=u*c*d-l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d+u*h*p;break;case"YZX":this._x=u*c*d+l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d-u*h*p;break;case"XZY":this._x=u*c*d-l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d+u*h*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],d=t[10],u=n+a+d;if(u>0){const e=.5/Math.sqrt(u+1);this._w=.25/e,this._x=(c-o)*e,this._y=(i-l)*e,this._z=(s-r)*e}else if(n>a&&n>d){const e=2*Math.sqrt(1+n-a-d);this._w=(c-o)/e,this._x=.25*e,this._y=(r+s)/e,this._z=(i+l)/e}else if(a>d){const e=2*Math.sqrt(1+a-n-d);this._w=(i-l)/e,this._x=(r+s)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+d-n-a);this._w=(s-r)/e,this._x=(i+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs($N(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+s*a+r*l-i*o,this._y=r*c+s*o+i*a-n*l,this._z=i*c+s*l+n*o-r*a,this._w=s*c-n*a-r*o-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,s=this._w;let a=s*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=n,this._y=r,this._z=i,this;const o=1-a*a;if(o<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this}const l=Math.sqrt(o),c=Math.atan2(l,a),d=Math.sin((1-t)*c)/l,u=Math.sin(t*c)/l;return this._w=s*d+this._w*u,this._x=n*d+this._x*u,this._y=r*d+this._y*u,this._z=i*d+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Oj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Oj.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Uj.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Uj.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,s=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*s,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*s,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,s=e.y,a=e.z,o=e.w,l=2*(s*r-a*n),c=2*(a*t-i*r),d=2*(i*n-s*t);return this.x=t+o*l+s*d-a*c,this.y=n+o*c+a*l-i*d,this.z=r+o*d+i*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,s=t.x,a=t.y,o=t.z;return this.x=r*o-i*a,this.y=i*s-n*o,this.z=n*a-r*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Dj.copy(this).projectOnVector(e),this.sub(Dj)}reflect(e){return this.sub(Dj.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos($N(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Dj=new Oj,Uj=new Fj;class zj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Vj.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Vj.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Vj.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,Vj):Vj.fromBufferAttribute(r,t),Vj.applyMatrix4(e.matrixWorld),this.expandByPoint(Vj);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Hj.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Hj.copy(n.boundingBox)),Hj.applyMatrix4(e.matrixWorld),this.union(Hj)}const r=e.children;for(let i=0,s=r.length;i<s;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Vj),Vj.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Jj),Kj.subVectors(this.max,Jj),Wj.subVectors(e.a,Jj),Gj.subVectors(e.b,Jj),qj.subVectors(e.c,Jj),Xj.subVectors(Gj,Wj),Yj.subVectors(qj,Gj),Zj.subVectors(Wj,qj);let t=[0,-Xj.z,Xj.y,0,-Yj.z,Yj.y,0,-Zj.z,Zj.y,Xj.z,0,-Xj.x,Yj.z,0,-Yj.x,Zj.z,0,-Zj.x,-Xj.y,Xj.x,0,-Yj.y,Yj.x,0,-Zj.y,Zj.x,0];return!!eA(t,Wj,Gj,qj,Kj)&&(t=[1,0,0,0,1,0,0,0,1],!!eA(t,Wj,Gj,qj,Kj)&&(Qj.crossVectors(Xj,Yj),t=[Qj.x,Qj.y,Qj.z],eA(t,Wj,Gj,qj,Kj)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Vj).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Vj).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Bj[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Bj[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Bj[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Bj[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Bj[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Bj[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Bj[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Bj[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Bj)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Bj=[new Oj,new Oj,new Oj,new Oj,new Oj,new Oj,new Oj,new Oj],Vj=new Oj,Hj=new zj,Wj=new Oj,Gj=new Oj,qj=new Oj,Xj=new Oj,Yj=new Oj,Zj=new Oj,Jj=new Oj,Kj=new Oj,Qj=new Oj,$j=new Oj;function eA(e,t,n,r,i){for(let s=0,a=e.length-3;s<=a;s+=3){$j.fromArray(e,s);const a=i.x*Math.abs($j.x)+i.y*Math.abs($j.y)+i.z*Math.abs($j.z),o=t.dot($j),l=n.dot($j),c=r.dot($j);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>a)return!1}return!0}const tA=new zj,nA=new Oj,rA=new Oj;class iA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):tA.setFromPoints(e).getCenter(n);let r=0;for(let i=0,s=e.length;i<s;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;nA.subVectors(e,this.center);const t=nA.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(nA,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(rA.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(nA.copy(e.center).add(rA)),this.expandByPoint(nA.copy(e.center).sub(rA))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const sA=new Oj,aA=new Oj,oA=new Oj,lA=new Oj,cA=new Oj,dA=new Oj,uA=new Oj;class hA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,sA)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=sA.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(sA.copy(this.origin).addScaledVector(this.direction,t),sA.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){aA.copy(e).add(t).multiplyScalar(.5),oA.copy(t).sub(e).normalize(),lA.copy(this.origin).sub(aA);const i=.5*e.distanceTo(t),s=-this.direction.dot(oA),a=lA.dot(this.direction),o=-lA.dot(oA),l=lA.lengthSq(),c=Math.abs(1-s*s);let d,u,h,p;if(c>0)if(d=s*o-a,u=s*a-o,p=i*c,d>=0)if(u>=-p)if(u<=p){const e=1/c;d*=e,u*=e,h=d*(d+s*u+2*a)+u*(s*d+u+2*o)+l}else u=i,d=Math.max(0,-(s*u+a)),h=-d*d+u*(u+2*o)+l;else u=-i,d=Math.max(0,-(s*u+a)),h=-d*d+u*(u+2*o)+l;else u<=-p?(d=Math.max(0,-(-s*i+a)),u=d>0?-i:Math.min(Math.max(-i,-o),i),h=-d*d+u*(u+2*o)+l):u<=p?(d=0,u=Math.min(Math.max(-i,-o),i),h=u*(u+2*o)+l):(d=Math.max(0,-(s*i+a)),u=d>0?i:Math.min(Math.max(-i,-o),i),h=-d*d+u*(u+2*o)+l);else u=s>0?-i:i,d=Math.max(0,-(s*u+a)),h=-d*d+u*(u+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(aA).addScaledVector(oA,u),h}intersectSphere(e,t){sA.subVectors(e.center,this.origin);const n=sA.dot(this.direction),r=sA.dot(sA)-n*n,i=e.radius*e.radius;if(r>i)return null;const s=Math.sqrt(i-r),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,s,a,o;const l=1/this.direction.x,c=1/this.direction.y,d=1/this.direction.z,u=this.origin;return l>=0?(n=(e.min.x-u.x)*l,r=(e.max.x-u.x)*l):(n=(e.max.x-u.x)*l,r=(e.min.x-u.x)*l),c>=0?(i=(e.min.y-u.y)*c,s=(e.max.y-u.y)*c):(i=(e.max.y-u.y)*c,s=(e.min.y-u.y)*c),n>s||i>r?null:((i>n||isNaN(n))&&(n=i),(s<r||isNaN(r))&&(r=s),d>=0?(a=(e.min.z-u.z)*d,o=(e.max.z-u.z)*d):(a=(e.max.z-u.z)*d,o=(e.min.z-u.z)*d),n>o||a>r?null:((a>n||n!==n)&&(n=a),(o<r||r!==r)&&(r=o),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,sA)}intersectTriangle(e,t,n,r,i){cA.subVectors(t,e),dA.subVectors(n,e),uA.crossVectors(cA,dA);let s,a=this.direction.dot(uA);if(a>0){if(r)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}lA.subVectors(this.origin,e);const o=s*this.direction.dot(dA.crossVectors(lA,dA));if(o<0)return null;const l=s*this.direction.dot(cA.cross(lA));if(l<0)return null;if(o+l>a)return null;const c=-s*lA.dot(uA);return c<0?null:this.at(c/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class pA{constructor(e,t,n,r,i,s,a,o,l,c,d,u,h,p,m,f){pA.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,s,a,o,l,c,d,u,h,p,m,f)}set(e,t,n,r,i,s,a,o,l,c,d,u,h,p,m,f){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=c,g[10]=d,g[14]=u,g[3]=h,g[7]=p,g[11]=m,g[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new pA).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/mA.setFromMatrixColumn(e,0).length(),i=1/mA.setFromMatrixColumn(e,1).length(),s=1/mA.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(r),l=Math.sin(r),c=Math.cos(i),d=Math.sin(i);if("XYZ"===e.order){const e=s*c,n=s*d,r=a*c,i=a*d;t[0]=o*c,t[4]=-o*d,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-a*o,t[2]=i-e*l,t[6]=r+n*l,t[10]=s*o}else if("YXZ"===e.order){const e=o*c,n=o*d,r=l*c,i=l*d;t[0]=e+i*a,t[4]=r*a-n,t[8]=s*l,t[1]=s*d,t[5]=s*c,t[9]=-a,t[2]=n*a-r,t[6]=i+e*a,t[10]=s*o}else if("ZXY"===e.order){const e=o*c,n=o*d,r=l*c,i=l*d;t[0]=e-i*a,t[4]=-s*d,t[8]=r+n*a,t[1]=n+r*a,t[5]=s*c,t[9]=i-e*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if("ZYX"===e.order){const e=s*c,n=s*d,r=a*c,i=a*d;t[0]=o*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=o*d,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=a*o,t[10]=s*o}else if("YZX"===e.order){const e=s*o,n=s*l,r=a*o,i=a*l;t[0]=o*c,t[4]=i-e*d,t[8]=r*d+n,t[1]=d,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=n*d+r,t[10]=e-i*d}else if("XZY"===e.order){const e=s*o,n=s*l,r=a*o,i=a*l;t[0]=o*c,t[4]=-d,t[8]=l*c,t[1]=e*d+i,t[5]=s*c,t[9]=n*d-r,t[2]=r*d-n,t[6]=a*c,t[10]=i*d+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(gA,e,xA)}lookAt(e,t,n){const r=this.elements;return bA.subVectors(e,t),0===bA.lengthSq()&&(bA.z=1),bA.normalize(),vA.crossVectors(n,bA),0===vA.lengthSq()&&(1===Math.abs(n.z)?bA.x+=1e-4:bA.z+=1e-4,bA.normalize(),vA.crossVectors(n,bA)),vA.normalize(),yA.crossVectors(bA,vA),r[0]=vA.x,r[4]=yA.x,r[8]=bA.x,r[1]=vA.y,r[5]=yA.y,r[9]=bA.y,r[2]=vA.z,r[6]=yA.z,r[10]=bA.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],c=n[1],d=n[5],u=n[9],h=n[13],p=n[2],m=n[6],f=n[10],g=n[14],x=n[3],v=n[7],y=n[11],b=n[15],w=r[0],_=r[4],S=r[8],N=r[12],j=r[1],A=r[5],M=r[9],E=r[13],C=r[2],k=r[6],T=r[10],P=r[14],L=r[3],R=r[7],I=r[11],F=r[15];return i[0]=s*w+a*j+o*C+l*L,i[4]=s*_+a*A+o*k+l*R,i[8]=s*S+a*M+o*T+l*I,i[12]=s*N+a*E+o*P+l*F,i[1]=c*w+d*j+u*C+h*L,i[5]=c*_+d*A+u*k+h*R,i[9]=c*S+d*M+u*T+h*I,i[13]=c*N+d*E+u*P+h*F,i[2]=p*w+m*j+f*C+g*L,i[6]=p*_+m*A+f*k+g*R,i[10]=p*S+m*M+f*T+g*I,i[14]=p*N+m*E+f*P+g*F,i[3]=x*w+v*j+y*C+b*L,i[7]=x*_+v*A+y*k+b*R,i[11]=x*S+v*M+y*T+b*I,i[15]=x*N+v*E+y*P+b*F,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],d=e[6],u=e[10],h=e[14];return e[3]*(+i*o*d-r*l*d-i*a*u+n*l*u+r*a*h-n*o*h)+e[7]*(+t*o*h-t*l*u+i*s*u-r*s*h+r*l*c-i*o*c)+e[11]*(+t*l*d-t*a*h-i*s*d+n*s*h+i*a*c-n*l*c)+e[15]*(-r*a*c-t*o*d+t*a*u+r*s*d-n*s*u+n*o*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],d=e[9],u=e[10],h=e[11],p=e[12],m=e[13],f=e[14],g=e[15],x=d*f*l-m*u*l+m*o*h-a*f*h-d*o*g+a*u*g,v=p*u*l-c*f*l-p*o*h+s*f*h+c*o*g-s*u*g,y=c*m*l-p*d*l+p*a*h-s*m*h-c*a*g+s*d*g,b=p*d*o-c*m*o-p*a*u+s*m*u+c*a*f-s*d*f,w=t*x+n*v+r*y+i*b;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const _=1/w;return e[0]=x*_,e[1]=(m*u*i-d*f*i-m*r*h+n*f*h+d*r*g-n*u*g)*_,e[2]=(a*f*i-m*o*i+m*r*l-n*f*l-a*r*g+n*o*g)*_,e[3]=(d*o*i-a*u*i-d*r*l+n*u*l+a*r*h-n*o*h)*_,e[4]=v*_,e[5]=(c*f*i-p*u*i+p*r*h-t*f*h-c*r*g+t*u*g)*_,e[6]=(p*o*i-s*f*i-p*r*l+t*f*l+s*r*g-t*o*g)*_,e[7]=(s*u*i-c*o*i+c*r*l-t*u*l-s*r*h+t*o*h)*_,e[8]=y*_,e[9]=(p*d*i-c*m*i-p*n*h+t*m*h+c*n*g-t*d*g)*_,e[10]=(s*m*i-p*a*i+p*n*l-t*m*l-s*n*g+t*a*g)*_,e[11]=(c*a*i-s*d*i-c*n*l+t*d*l+s*n*h-t*a*h)*_,e[12]=b*_,e[13]=(c*m*r-p*d*r+p*n*u-t*m*u-c*n*f+t*d*f)*_,e[14]=(p*a*r-s*m*r-p*n*o+t*m*o+s*n*f-t*a*f)*_,e[15]=(s*d*r-c*a*r+c*n*o-t*d*o-s*n*u+t*a*u)*_,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,s=e.x,a=e.y,o=e.z,l=i*s,c=i*a;return this.set(l*s+n,l*a-r*o,l*o+r*a,0,l*a+r*o,c*a+n,c*o-r*s,0,l*o-r*a,c*o+r*s,i*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,s){return this.set(1,n,i,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,s=t._y,a=t._z,o=t._w,l=i+i,c=s+s,d=a+a,u=i*l,h=i*c,p=i*d,m=s*c,f=s*d,g=a*d,x=o*l,v=o*c,y=o*d,b=n.x,w=n.y,_=n.z;return r[0]=(1-(m+g))*b,r[1]=(h+y)*b,r[2]=(p-v)*b,r[3]=0,r[4]=(h-y)*w,r[5]=(1-(u+g))*w,r[6]=(f+x)*w,r[7]=0,r[8]=(p+v)*_,r[9]=(f-x)*_,r[10]=(1-(u+m))*_,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=mA.set(r[0],r[1],r[2]).length();const s=mA.set(r[4],r[5],r[6]).length(),a=mA.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],fA.copy(this);const o=1/i,l=1/s,c=1/a;return fA.elements[0]*=o,fA.elements[1]*=o,fA.elements[2]*=o,fA.elements[4]*=l,fA.elements[5]*=l,fA.elements[6]*=l,fA.elements[8]*=c,fA.elements[9]*=c,fA.elements[10]*=c,t.setFromRotationMatrix(fA),n.x=i,n.y=s,n.z=a,this}makePerspective(e,t,n,r,i,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:GN;const o=this.elements,l=2*i/(t-e),c=2*i/(n-r),d=(t+e)/(t-e),u=(n+r)/(n-r);let h,p;if(a===GN)h=-(s+i)/(s-i),p=-2*s*i/(s-i);else{if(a!==qN)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);h=-s/(s-i),p=-s*i/(s-i)}return o[0]=l,o[4]=0,o[8]=d,o[12]=0,o[1]=0,o[5]=c,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,n,r,i,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:GN;const o=this.elements,l=1/(t-e),c=1/(n-r),d=1/(s-i),u=(t+e)*l,h=(n+r)*c;let p,m;if(a===GN)p=(s+i)*d,m=-2*d;else{if(a!==qN)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=i*d,m=-1*d}return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=m,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const mA=new Oj,fA=new pA,gA=new Oj(0,0,0),xA=new Oj(1,1,1),vA=new Oj,yA=new Oj,bA=new Oj,wA=new pA,_A=new Fj;class SA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:SA.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.elements,i=r[0],s=r[4],a=r[8],o=r[1],l=r[5],c=r[9],d=r[2],u=r[6],h=r[10];switch(t){case"XYZ":this._y=Math.asin($N(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-$N(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,h),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-d,i),this._z=0);break;case"ZXY":this._x=Math.asin($N(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-d,h),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-$N(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(u,h),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin($N(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,i)):(this._x=0,this._y=Math.atan2(a,h));break;case"XZY":this._z=Math.asin(-$N(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return wA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(wA,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return _A.setFromEuler(this),this.setFromQuaternion(_A,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}SA.DEFAULT_ORDER="XYZ";class NA{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let jA=0;const AA=new Oj,MA=new Fj,EA=new pA,CA=new Oj,kA=new Oj,TA=new Oj,PA=new Fj,LA=new Oj(1,0,0),RA=new Oj(0,1,0),IA=new Oj(0,0,1),FA={type:"added"},OA={type:"removed"},DA={type:"childadded",child:null},UA={type:"childremoved",child:null};class zA extends XN{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:jA++}),this.uuid=QN(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=zA.DEFAULT_UP.clone();const e=new Oj,t=new SA,n=new Fj,r=new Oj(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new pA},normalMatrix:{value:new aj}}),this.matrix=new pA,this.matrixWorld=new pA,this.matrixAutoUpdate=zA.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=zA.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new NA,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return MA.setFromAxisAngle(e,t),this.quaternion.multiply(MA),this}rotateOnWorldAxis(e,t){return MA.setFromAxisAngle(e,t),this.quaternion.premultiply(MA),this}rotateX(e){return this.rotateOnAxis(LA,e)}rotateY(e){return this.rotateOnAxis(RA,e)}rotateZ(e){return this.rotateOnAxis(IA,e)}translateOnAxis(e,t){return AA.copy(e).applyQuaternion(this.quaternion),this.position.add(AA.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(LA,e)}translateY(e){return this.translateOnAxis(RA,e)}translateZ(e){return this.translateOnAxis(IA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(EA.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?CA.copy(e):CA.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),kA.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?EA.lookAt(kA,CA,this.up):EA.lookAt(CA,kA,this.up),this.quaternion.setFromRotationMatrix(EA),r&&(EA.extractRotation(r.matrixWorld),MA.setFromRotationMatrix(EA),this.quaternion.premultiply(MA.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(FA),DA.child=e,this.dispatchEvent(DA),DA.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(OA),UA.child=e,this.dispatchEvent(UA),UA.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),EA.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),EA.multiply(e.parent.matrixWorld)),e.applyMatrix4(EA),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(FA),DA.child=e,this.dispatchEvent(DA),DA.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const r=this.children;for(let i=0,s=r.length;i<s;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(kA,e,TA),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(kA,PA,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){const r=t[n];!0!==r.matrixWorldAutoUpdate&&!0!==e||r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){const n=e[t];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=s(e.geometries),r=s(e.materials),i=s(e.textures),a=s(e.images),o=s(e.shapes),l=s(e.skeletons),c=s(e.animations),d=s(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),d.length>0&&(n.nodes=d)}return n.object=r,n;function s(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}zA.DEFAULT_UP=new Oj(0,1,0),zA.DEFAULT_MATRIX_AUTO_UPDATE=!0,zA.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const BA=new Oj,VA=new Oj,HA=new Oj,WA=new Oj,GA=new Oj,qA=new Oj,XA=new Oj,YA=new Oj,ZA=new Oj,JA=new Oj;class KA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Oj;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),BA.subVectors(e,t),r.cross(BA);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){BA.subVectors(r,t),VA.subVectors(n,t),HA.subVectors(e,t);const s=BA.dot(BA),a=BA.dot(VA),o=BA.dot(HA),l=VA.dot(VA),c=VA.dot(HA),d=s*l-a*a;if(0===d)return i.set(0,0,0),null;const u=1/d,h=(l*o-a*c)*u,p=(s*c-a*o)*u;return i.set(1-h-p,p,h)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,WA)&&(WA.x>=0&&WA.y>=0&&WA.x+WA.y<=1)}static getInterpolation(e,t,n,r,i,s,a,o){return null===this.getBarycoord(e,t,n,r,WA)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(i,WA.x),o.addScaledVector(s,WA.y),o.addScaledVector(a,WA.z),o)}static isFrontFacing(e,t,n,r){return BA.subVectors(n,t),VA.subVectors(e,t),BA.cross(VA).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return BA.subVectors(this.c,this.b),VA.subVectors(this.a,this.b),.5*BA.cross(VA).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return KA.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return KA.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return KA.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return KA.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return KA.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let s,a;GA.subVectors(r,n),qA.subVectors(i,n),YA.subVectors(e,n);const o=GA.dot(YA),l=qA.dot(YA);if(o<=0&&l<=0)return t.copy(n);ZA.subVectors(e,r);const c=GA.dot(ZA),d=qA.dot(ZA);if(c>=0&&d<=c)return t.copy(r);const u=o*d-c*l;if(u<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(n).addScaledVector(GA,s);JA.subVectors(e,i);const h=GA.dot(JA),p=qA.dot(JA);if(p>=0&&h<=p)return t.copy(i);const m=h*l-o*p;if(m<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(n).addScaledVector(qA,a);const f=c*p-h*d;if(f<=0&&d-c>=0&&h-p>=0)return XA.subVectors(i,r),a=(d-c)/(d-c+(h-p)),t.copy(r).addScaledVector(XA,a);const g=1/(f+m+u);return s=m*g,a=u*g,t.copy(n).addScaledVector(GA,s).addScaledVector(qA,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const QA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$A={h:0,s:0,l:0},eM={h:0,s:0,l:0};function tM(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class nM{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nN;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,yj.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yj.workingColorSpace;return this.r=e,this.g=t,this.b=n,yj.toWorkingColorSpace(this,r),this}setHSL(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yj.workingColorSpace;if(e=ej(e,1),t=$N(t,0,1),n=$N(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=tM(i,r,e+1/3),this.g=tM(i,r,e),this.b=tM(i,r,e-1/3)}return yj.toWorkingColorSpace(this,r),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nN;function r(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const s=t[1],a=t[2];switch(s){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,n);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=t[1],i=r.length;if(3===i)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,n);if(6===i)return this.setHex(parseInt(r,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nN;const n=QA[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=bj(e.r),this.g=bj(e.g),this.b=bj(e.b),this}copyLinearToSRGB(e){return this.r=wj(e.r),this.g=wj(e.g),this.b=wj(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nN;return yj.fromWorkingColorSpace(rM.copy(this),e),65536*Math.round($N(255*rM.r,0,255))+256*Math.round($N(255*rM.g,0,255))+Math.round($N(255*rM.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nN;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yj.workingColorSpace;yj.fromWorkingColorSpace(rM.copy(this),t);const n=rM.r,r=rM.g,i=rM.b,s=Math.max(n,r,i),a=Math.min(n,r,i);let o,l;const c=(a+s)/2;if(a===s)o=0,l=0;else{const e=s-a;switch(l=c<=.5?e/(s+a):e/(2-s-a),s){case n:o=(r-i)/e+(r<i?6:0);break;case r:o=(i-n)/e+2;break;case i:o=(n-r)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yj.workingColorSpace;return yj.fromWorkingColorSpace(rM.copy(this),t),e.r=rM.r,e.g=rM.g,e.b=rM.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nN;yj.fromWorkingColorSpace(rM.copy(this),e);const t=rM.r,n=rM.g,r=rM.b;return e!==nN?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}offsetHSL(e,t,n){return this.getHSL($A),this.setHSL($A.h+e,$A.s+t,$A.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL($A),e.getHSL(eM);const n=tj($A.h,eM.h,t),r=tj($A.s,eM.s,t),i=tj($A.l,eM.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const rM=new nM;nM.NAMES=QA;let iM=0;class sM extends XN{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:iM++}),this.uuid=QN(),this.name="",this.type="Material",this.blending=Nw,this.side=bw,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Dw,this.blendDst=Uw,this.blendEquation=Cw,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new nM(0,0,0),this.blendAlpha=0,this.depthFunc=Qw,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=jN,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=uN,this.stencilZFail=uN,this.stencilZPass=uN,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Nw&&(n.blending=this.blending),this.side!==bw&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==Dw&&(n.blendSrc=this.blendSrc),this.blendDst!==Uw&&(n.blendDst=this.blendDst),this.blendEquation!==Cw&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Qw&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==jN&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==uN&&(n.stencilFail=this.stencilFail),this.stencilZFail!==uN&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==uN&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class aM extends sM{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new nM(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new SA,this.combine=r_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const oM=lM();function lM(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(r[l]=0,r[256|l]=32768,i[l]=24,i[256|l]=24):e<-14?(r[l]=1024>>-e-14,r[256|l]=1024>>-e-14|32768,i[l]=-e-1,i[256|l]=-e-1):e<=15?(r[l]=e+15<<10,r[256|l]=e+15<<10|32768,i[l]=13,i[256|l]=13):e<128?(r[l]=31744,r[256|l]=64512,i[l]=24,i[256|l]=24):(r[l]=31744,r[256|l]=64512,i[l]=13,i[256|l]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:o}}function cM(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=$N(e,-65504,65504),oM.floatView[0]=e;const t=oM.uint32View[0],n=t>>23&511;return oM.baseTable[n]+((8388607&t)>>oM.shiftTable[n])}function dM(e){const t=e>>10;return oM.uint32View[0]=oM.mantissaTable[oM.offsetTable[t]+(1023&e)]+oM.exponentTable[t],oM.floatView[0]}const uM={toHalfFloat:cM,fromHalfFloat:dM},hM=new Oj,pM=new sj;class mM{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=RN,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=B_,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return mj("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)pM.fromBufferAttribute(this,t),pM.applyMatrix3(e),this.setXY(t,pM.x,pM.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)hM.fromBufferAttribute(this,t),hM.applyMatrix3(e),this.setXYZ(t,hM.x,hM.y,hM.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)hM.fromBufferAttribute(this,t),hM.applyMatrix4(e),this.setXYZ(t,hM.x,hM.y,hM.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)hM.fromBufferAttribute(this,t),hM.applyNormalMatrix(e),this.setXYZ(t,hM.x,hM.y,hM.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)hM.fromBufferAttribute(this,t),hM.transformDirection(e),this.setXYZ(t,hM.x,hM.y,hM.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=nj(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=rj(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=nj(t,this.array)),t}setX(e,t){return this.normalized&&(t=rj(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=nj(t,this.array)),t}setY(e,t){return this.normalized&&(t=rj(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=nj(t,this.array)),t}setZ(e,t){return this.normalized&&(t=rj(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=nj(t,this.array)),t}setW(e,t){return this.normalized&&(t=rj(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array),r=rj(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array),r=rj(r,this.array),i=rj(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==RN&&(e.usage=this.usage),e}}class fM extends mM{constructor(e,t,n){super(new Int8Array(e),t,n)}}class gM extends mM{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class xM extends mM{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class vM extends mM{constructor(e,t,n){super(new Int16Array(e),t,n)}}class yM extends mM{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class bM extends mM{constructor(e,t,n){super(new Int32Array(e),t,n)}}class wM extends mM{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class _M extends mM{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=dM(this.array[e*this.itemSize]);return this.normalized&&(t=nj(t,this.array)),t}setX(e,t){return this.normalized&&(t=rj(t,this.array)),this.array[e*this.itemSize]=cM(t),this}getY(e){let t=dM(this.array[e*this.itemSize+1]);return this.normalized&&(t=nj(t,this.array)),t}setY(e,t){return this.normalized&&(t=rj(t,this.array)),this.array[e*this.itemSize+1]=cM(t),this}getZ(e){let t=dM(this.array[e*this.itemSize+2]);return this.normalized&&(t=nj(t,this.array)),t}setZ(e,t){return this.normalized&&(t=rj(t,this.array)),this.array[e*this.itemSize+2]=cM(t),this}getW(e){let t=dM(this.array[e*this.itemSize+3]);return this.normalized&&(t=nj(t,this.array)),t}setW(e,t){return this.normalized&&(t=rj(t,this.array)),this.array[e*this.itemSize+3]=cM(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array)),this.array[e+0]=cM(t),this.array[e+1]=cM(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array),r=rj(r,this.array)),this.array[e+0]=cM(t),this.array[e+1]=cM(n),this.array[e+2]=cM(r),this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array),r=rj(r,this.array),i=rj(i,this.array)),this.array[e+0]=cM(t),this.array[e+1]=cM(n),this.array[e+2]=cM(r),this.array[e+3]=cM(i),this}}class SM extends mM{constructor(e,t,n){super(new Float32Array(e),t,n)}}let NM=0;const jM=new pA,AM=new zA,MM=new Oj,EM=new zj,CM=new zj,kM=new Oj;class TM extends XN{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:NM++}),this.uuid=QN(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(lj(e)?wM:yM)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new aj).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return jM.makeRotationFromQuaternion(e),this.applyMatrix4(jM),this}rotateX(e){return jM.makeRotationX(e),this.applyMatrix4(jM),this}rotateY(e){return jM.makeRotationY(e),this.applyMatrix4(jM),this}rotateZ(e){return jM.makeRotationZ(e),this.applyMatrix4(jM),this}translate(e,t,n){return jM.makeTranslation(e,t,n),this.applyMatrix4(jM),this}scale(e,t,n){return jM.makeScale(e,t,n),this.applyMatrix4(jM),this}lookAt(e){return AM.lookAt(e),AM.updateMatrix(),this.applyMatrix4(AM.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(MM).negate(),this.translate(MM.x,MM.y,MM.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new SM(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new zj);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Oj(-1/0,-1/0,-1/0),new Oj(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const e=t[n];EM.setFromBufferAttribute(e),this.morphTargetsRelative?(kM.addVectors(this.boundingBox.min,EM.min),this.boundingBox.expandByPoint(kM),kM.addVectors(this.boundingBox.max,EM.max),this.boundingBox.expandByPoint(kM)):(this.boundingBox.expandByPoint(EM.min),this.boundingBox.expandByPoint(EM.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new iA);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Oj,1/0);if(e){const n=this.boundingSphere.center;if(EM.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const n=t[e];CM.setFromBufferAttribute(n),this.morphTargetsRelative?(kM.addVectors(EM.min,CM.min),EM.expandByPoint(kM),kM.addVectors(EM.max,CM.max),EM.expandByPoint(kM)):(EM.expandByPoint(CM.min),EM.expandByPoint(CM.max))}EM.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)kM.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(kM));if(t)for(let i=0,s=t.length;i<s;i++){const s=t[i],a=this.morphTargetsRelative;for(let t=0,i=s.count;t<i;t++)kM.fromBufferAttribute(s,t),a&&(MM.fromBufferAttribute(e,t),kM.add(MM)),r=Math.max(r,n.distanceToSquared(kM))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new mM(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),a=[],o=[];for(let S=0;S<n.count;S++)a[S]=new Oj,o[S]=new Oj;const l=new Oj,c=new Oj,d=new Oj,u=new sj,h=new sj,p=new sj,m=new Oj,f=new Oj;function g(e,t,r){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),d.fromBufferAttribute(n,r),u.fromBufferAttribute(i,e),h.fromBufferAttribute(i,t),p.fromBufferAttribute(i,r),c.sub(l),d.sub(l),h.sub(u),p.sub(u);const s=1/(h.x*p.y-p.x*h.y);isFinite(s)&&(m.copy(c).multiplyScalar(p.y).addScaledVector(d,-h.y).multiplyScalar(s),f.copy(d).multiplyScalar(h.x).addScaledVector(c,-p.x).multiplyScalar(s),a[e].add(m),a[t].add(m),a[r].add(m),o[e].add(f),o[t].add(f),o[r].add(f))}let x=this.groups;0===x.length&&(x=[{start:0,count:e.count}]);for(let S=0,N=x.length;S<N;++S){const t=x[S],n=t.start;for(let r=n,i=n+t.count;r<i;r+=3)g(e.getX(r+0),e.getX(r+1),e.getX(r+2))}const v=new Oj,y=new Oj,b=new Oj,w=new Oj;function _(e){b.fromBufferAttribute(r,e),w.copy(b);const t=a[e];v.copy(t),v.sub(b.multiplyScalar(b.dot(t))).normalize(),y.crossVectors(w,t);const n=y.dot(o[e])<0?-1:1;s.setXYZW(e,v.x,v.y,v.z,n)}for(let S=0,N=x.length;S<N;++S){const t=x[S],n=t.start;for(let r=n,i=n+t.count;r<i;r+=3)_(e.getX(r+0)),_(e.getX(r+1)),_(e.getX(r+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new mM(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new Oj,i=new Oj,s=new Oj,a=new Oj,o=new Oj,l=new Oj,c=new Oj,d=new Oj;if(e)for(let u=0,h=e.count;u<h;u+=3){const h=e.getX(u+0),p=e.getX(u+1),m=e.getX(u+2);r.fromBufferAttribute(t,h),i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),c.subVectors(s,i),d.subVectors(r,i),c.cross(d),a.fromBufferAttribute(n,h),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),a.add(c),o.add(c),l.add(c),n.setXYZ(h,a.x,a.y,a.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(m,l.x,l.y,l.z)}else for(let e=0,u=t.count;e<u;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,i),d.subVectors(r,i),c.cross(d),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)kM.fromBufferAttribute(e,t),kM.normalize(),e.setXYZ(t,kM.x,kM.y,kM.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,s=new n.constructor(t.length*r);let a=0,o=0;for(let l=0,c=t.length;l<c;l++){a=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(let e=0;e<r;e++)s[o++]=n[a++]}return new mM(s,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new TM,n=this.index.array,r=this.attributes;for(const a in r){const i=e(r[a],n);t.setAttribute(a,i)}const i=this.morphAttributes;for(const a in i){const r=[],s=i[a];for(let t=0,i=s.length;t<i;t++){const i=e(s[t],n);r.push(i)}t.morphAttributes[a]=r}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const e=s[a];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const r={};let i=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];n.push(i.toJSON(e.data))}n.length>0&&(r[o]=n,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const l in r){const e=r[l];this.setAttribute(l,e.clone(t))}const i=e.morphAttributes;for(const l in i){const e=[],n=i[l];for(let r=0,i=n.length;r<i;r++)e.push(n[r].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const PM=new pA,LM=new hA,RM=new iA,IM=new Oj,FM=new Oj,OM=new Oj,DM=new Oj,UM=new Oj,zM=new Oj,BM=new sj,VM=new sj,HM=new sj,WM=new Oj,GM=new Oj,qM=new Oj,XM=new Oj,YM=new Oj;class ZM extends zA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new TM,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new aM;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(i&&a){zM.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=a[n],o=i[n];0!==r&&(UM.fromBufferAttribute(o,e),s?zM.addScaledVector(UM,r):zM.addScaledVector(UM.sub(t),r))}t.add(zM)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),RM.copy(n.boundingSphere),RM.applyMatrix4(i),LM.copy(e.ray).recast(e.near),!1===RM.containsPoint(LM.origin)){if(null===LM.intersectSphere(RM,IM))return;if(LM.origin.distanceToSquared(IM)>(e.far-e.near)**2)return}PM.copy(i).invert(),LM.copy(e.ray).applyMatrix4(PM),null!==n.boundingBox&&!1===LM.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,LM)}}_computeIntersections(e,t,n){let r;const i=this.geometry,s=this.material,a=i.index,o=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,d=i.attributes.normal,u=i.groups,h=i.drawRange;if(null!==a)if(Array.isArray(s))for(let p=0,m=u.length;p<m;p++){const i=u[p],o=s[i.materialIndex];for(let s=Math.max(i.start,h.start),u=Math.min(a.count,Math.min(i.start+i.count,h.start+h.count));s<u;s+=3){r=JM(this,o,e,n,l,c,d,a.getX(s),a.getX(s+1),a.getX(s+2)),r&&(r.faceIndex=Math.floor(s/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,h.start),o=Math.min(a.count,h.start+h.count);i<o;i+=3){r=JM(this,s,e,n,l,c,d,a.getX(i),a.getX(i+1),a.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}else if(void 0!==o)if(Array.isArray(s))for(let p=0,m=u.length;p<m;p++){const i=u[p],a=s[i.materialIndex];for(let s=Math.max(i.start,h.start),u=Math.min(o.count,Math.min(i.start+i.count,h.start+h.count));s<u;s+=3){r=JM(this,a,e,n,l,c,d,s,s+1,s+2),r&&(r.faceIndex=Math.floor(s/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,h.start),a=Math.min(o.count,h.start+h.count);i<a;i+=3){r=JM(this,s,e,n,l,c,d,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}}}function JM(e,t,n,r,i,s,a,o,l,c){e.getVertexPosition(o,FM),e.getVertexPosition(l,OM),e.getVertexPosition(c,DM);const d=function(e,t,n,r,i,s,a,o){let l;if(l=t.side===ww?r.intersectTriangle(a,s,i,!0,o):r.intersectTriangle(i,s,a,t.side===bw,o),null===l)return null;YM.copy(o),YM.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(YM);return c<n.near||c>n.far?null:{distance:c,point:YM.clone(),object:e}}(e,t,n,r,FM,OM,DM,XM);if(d){i&&(BM.fromBufferAttribute(i,o),VM.fromBufferAttribute(i,l),HM.fromBufferAttribute(i,c),d.uv=KA.getInterpolation(XM,FM,OM,DM,BM,VM,HM,new sj)),s&&(BM.fromBufferAttribute(s,o),VM.fromBufferAttribute(s,l),HM.fromBufferAttribute(s,c),d.uv1=KA.getInterpolation(XM,FM,OM,DM,BM,VM,HM,new sj)),a&&(WM.fromBufferAttribute(a,o),GM.fromBufferAttribute(a,l),qM.fromBufferAttribute(a,c),d.normal=KA.getInterpolation(XM,FM,OM,DM,WM,GM,qM,new Oj),d.normal.dot(r.direction)>0&&d.normal.multiplyScalar(-1));const e={a:o,b:l,c:c,normal:new Oj,materialIndex:0};KA.getNormal(FM,OM,DM,e.normal),d.face=e}return d}class KM extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:s};const a=this;r=Math.floor(r),i=Math.floor(i),s=Math.floor(s);const o=[],l=[],c=[],d=[];let u=0,h=0;function p(e,t,n,r,i,s,p,m,f,g,x){const v=s/f,y=p/g,b=s/2,w=p/2,_=m/2,S=f+1,N=g+1;let j=0,A=0;const M=new Oj;for(let a=0;a<N;a++){const s=a*y-w;for(let o=0;o<S;o++){const u=o*v-b;M[e]=u*r,M[t]=s*i,M[n]=_,l.push(M.x,M.y,M.z),M[e]=0,M[t]=0,M[n]=m>0?1:-1,c.push(M.x,M.y,M.z),d.push(o/f),d.push(1-a/g),j+=1}}for(let a=0;a<g;a++)for(let e=0;e<f;e++){const t=u+e+S*a,n=u+e+S*(a+1),r=u+(e+1)+S*(a+1),i=u+(e+1)+S*a;o.push(t,n,i),o.push(n,r,i),A+=6}a.addGroup(h,A,x),h+=A,u+=j}p("z","y","x",-1,-1,n,t,e,s,i,0),p("z","y","x",1,-1,n,t,-e,s,i,1),p("x","z","y",1,1,e,n,t,r,s,2),p("x","z","y",1,-1,e,n,-t,r,s,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(o),this.setAttribute("position",new SM(l,3)),this.setAttribute("normal",new SM(c,3)),this.setAttribute("uv",new SM(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new KM(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function QM(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function $M(e){const t={};for(let n=0;n<e.length;n++){const r=QM(e[n]);for(const e in r)t[e]=r[e]}return t}function eE(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:yj.workingColorSpace}const tE={clone:QM,merge:$M};class nE extends sM{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=QM(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class rE extends zA{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new pA,this.projectionMatrix=new pA,this.projectionMatrixInverse=new pA,this.coordinateSystem=GN}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const iE=new Oj,sE=new sj,aE=new sj;class oE extends rE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*KN*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*JN*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*KN*Math.atan(Math.tan(.5*JN*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){iE.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(iE.x,iE.y).multiplyScalar(-e/iE.z),iE.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(iE.x,iE.y).multiplyScalar(-e/iE.z)}getViewSize(e,t){return this.getViewBounds(e,sE,aE),t.subVectors(aE,sE)}setViewOffset(e,t,n,r,i,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*JN*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,a=s.fullHeight;i+=s.offsetX*r/e,t-=s.offsetY*n/a,r*=s.width/e,n*=s.height/a}const a=this.filmOffset;0!==a&&(i+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const lE=-90;class cE extends zA{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new oE(lE,1,e,t);r.layers=this.layers,this.add(r);const i=new oE(lE,1,e,t);i.layers=this.layers,this.add(i);const s=new oE(lE,1,e,t);s.layers=this.layers,this.add(s);const a=new oE(lE,1,e,t);a.layers=this.layers,this.add(a);const o=new oE(lE,1,e,t);o.layers=this.layers,this.add(o);const l=new oE(lE,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,s,a,o]=t;for(const l of t)this.remove(l);if(e===GN)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(e!==qN)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,s,a,o,l,c]=this.children,d=e.getRenderTarget(),u=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const m=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,s),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,o),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=m,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(d,u,h),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class dE extends Ej{constructor(e,t,n,r,i,s,a,o,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:x_,n,r,i,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class uE extends Tj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new dE(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:k_}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",s=new KM(5,5,5),a=new nE({name:"CubemapFromEquirect",uniforms:QM(n),vertexShader:r,fragmentShader:i,side:ww,blending:Sw});a.uniforms.tEquirect.value=t;const o=new ZM(s,a),l=t.minFilter;t.minFilter===L_&&(t.minFilter=k_);return new cE(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,r);e.setRenderTarget(i)}}const hE=new Oj,pE=new Oj,mE=new aj;class fE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=hE.subVectors(n,t).cross(pE.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(hE),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||mE.getNormalMatrix(e),r=this.coplanarPoint(hE).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const gE=new iA,xE=new Oj;class vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fE,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new fE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new fE,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new fE,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new fE;this.planes=[e,t,n,r,i,s]}set(e,t,n,r,i,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GN;const n=this.planes,r=e.elements,i=r[0],s=r[1],a=r[2],o=r[3],l=r[4],c=r[5],d=r[6],u=r[7],h=r[8],p=r[9],m=r[10],f=r[11],g=r[12],x=r[13],v=r[14],y=r[15];if(n[0].setComponents(o-i,u-l,f-h,y-g).normalize(),n[1].setComponents(o+i,u+l,f+h,y+g).normalize(),n[2].setComponents(o+s,u+c,f+p,y+x).normalize(),n[3].setComponents(o-s,u-c,f-p,y-x).normalize(),n[4].setComponents(o-a,u-d,f-m,y-v).normalize(),t===GN)n[5].setComponents(o+a,u+d,f+m,y+v).normalize();else{if(t!==qN)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(a,d,m,v).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),gE.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),gE.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(gE)}intersectsSprite(e){return gE.center.set(0,0,0),gE.radius=.7071067811865476,gE.applyMatrix4(e.matrixWorld),this.intersectsSphere(gE)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(xE.x=r.normal.x>0?e.max.x:e.min.x,xE.y=r.normal.y>0?e.max.y:e.min.y,xE.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(xE)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function yE(){let e=null,t=!1,n=null,r=null;function i(t,s){n(t,s),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function bE(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}n.isInterleavedBufferAttribute&&(n=n.data);const i=t.get(n);if(void 0===i)t.set(n,function(t,n){const r=t.array,i=t.usage,s=r.byteLength,a=e.createBuffer();let o;if(e.bindBuffer(n,a),e.bufferData(n,r,i),t.onUploadCallback(),r instanceof Float32Array)o=e.FLOAT;else if(r instanceof Uint16Array)o=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)o=e.SHORT;else if(r instanceof Uint32Array)o=e.UNSIGNED_INT;else if(r instanceof Int32Array)o=e.INT;else if(r instanceof Int8Array)o=e.BYTE;else if(r instanceof Uint8Array)o=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);o=e.UNSIGNED_BYTE}return{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:s}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const i=n.array,s=n._updateRange,a=n.updateRanges;if(e.bindBuffer(r,t),-1===s.count&&0===a.length&&e.bufferSubData(r,0,i),0!==a.length){for(let t=0,n=a.length;t<n;t++){const n=a[t];e.bufferSubData(r,n.start*i.BYTES_PER_ELEMENT,i,n.start,n.count)}n.clearUpdateRanges()}-1!==s.count&&(e.bufferSubData(r,s.offset*i.BYTES_PER_ELEMENT,i,s.offset,s.count),s.count=-1),n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}class wE extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,s=t/2,a=Math.floor(n),o=Math.floor(r),l=a+1,c=o+1,d=e/a,u=t/o,h=[],p=[],m=[],f=[];for(let g=0;g<c;g++){const e=g*u-s;for(let t=0;t<l;t++){const n=t*d-i;p.push(n,-e,0),m.push(0,0,1),f.push(t/a),f.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<a;e++){const t=e+l*g,n=e+l*(g+1),r=e+1+l*(g+1),i=e+1+l*g;h.push(t,n,i),h.push(n,r,i)}this.setIndex(h),this.setAttribute("position",new SM(p,3)),this.setAttribute("normal",new SM(m,3)),this.setAttribute("uv",new SM(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wE(e.width,e.height,e.widthSegments,e.heightSegments)}}const _E={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[MORPHTARGETS_COUNT];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t#endif\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\t#ifndef USE_INSTANCING_MORPH\n\t\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\t#endif\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},SE={common:{diffuse:{value:new nM(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new aj},alphaMap:{value:null},alphaMapTransform:{value:new aj},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new aj}},envmap:{envMap:{value:null},envMapRotation:{value:new aj},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new aj}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new aj}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new aj},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new aj},normalScale:{value:new sj(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new aj},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new aj}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new aj}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new aj}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nM(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new nM(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new aj},alphaTest:{value:0},uvTransform:{value:new aj}},sprite:{diffuse:{value:new nM(16777215)},opacity:{value:1},center:{value:new sj(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new aj},alphaMap:{value:null},alphaMapTransform:{value:new aj},alphaTest:{value:0}}},NE={basic:{uniforms:$M([SE.common,SE.specularmap,SE.envmap,SE.aomap,SE.lightmap,SE.fog]),vertexShader:_E.meshbasic_vert,fragmentShader:_E.meshbasic_frag},lambert:{uniforms:$M([SE.common,SE.specularmap,SE.envmap,SE.aomap,SE.lightmap,SE.emissivemap,SE.bumpmap,SE.normalmap,SE.displacementmap,SE.fog,SE.lights,{emissive:{value:new nM(0)}}]),vertexShader:_E.meshlambert_vert,fragmentShader:_E.meshlambert_frag},phong:{uniforms:$M([SE.common,SE.specularmap,SE.envmap,SE.aomap,SE.lightmap,SE.emissivemap,SE.bumpmap,SE.normalmap,SE.displacementmap,SE.fog,SE.lights,{emissive:{value:new nM(0)},specular:{value:new nM(1118481)},shininess:{value:30}}]),vertexShader:_E.meshphong_vert,fragmentShader:_E.meshphong_frag},standard:{uniforms:$M([SE.common,SE.envmap,SE.aomap,SE.lightmap,SE.emissivemap,SE.bumpmap,SE.normalmap,SE.displacementmap,SE.roughnessmap,SE.metalnessmap,SE.fog,SE.lights,{emissive:{value:new nM(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:_E.meshphysical_vert,fragmentShader:_E.meshphysical_frag},toon:{uniforms:$M([SE.common,SE.aomap,SE.lightmap,SE.emissivemap,SE.bumpmap,SE.normalmap,SE.displacementmap,SE.gradientmap,SE.fog,SE.lights,{emissive:{value:new nM(0)}}]),vertexShader:_E.meshtoon_vert,fragmentShader:_E.meshtoon_frag},matcap:{uniforms:$M([SE.common,SE.bumpmap,SE.normalmap,SE.displacementmap,SE.fog,{matcap:{value:null}}]),vertexShader:_E.meshmatcap_vert,fragmentShader:_E.meshmatcap_frag},points:{uniforms:$M([SE.points,SE.fog]),vertexShader:_E.points_vert,fragmentShader:_E.points_frag},dashed:{uniforms:$M([SE.common,SE.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:_E.linedashed_vert,fragmentShader:_E.linedashed_frag},depth:{uniforms:$M([SE.common,SE.displacementmap]),vertexShader:_E.depth_vert,fragmentShader:_E.depth_frag},normal:{uniforms:$M([SE.common,SE.bumpmap,SE.normalmap,SE.displacementmap,{opacity:{value:1}}]),vertexShader:_E.meshnormal_vert,fragmentShader:_E.meshnormal_frag},sprite:{uniforms:$M([SE.sprite,SE.fog]),vertexShader:_E.sprite_vert,fragmentShader:_E.sprite_frag},background:{uniforms:{uvTransform:{value:new aj},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:_E.background_vert,fragmentShader:_E.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new aj}},vertexShader:_E.backgroundCube_vert,fragmentShader:_E.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:_E.cube_vert,fragmentShader:_E.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:_E.equirect_vert,fragmentShader:_E.equirect_frag},distanceRGBA:{uniforms:$M([SE.common,SE.displacementmap,{referencePosition:{value:new Oj},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:_E.distanceRGBA_vert,fragmentShader:_E.distanceRGBA_frag},shadow:{uniforms:$M([SE.lights,SE.fog,{color:{value:new nM(0)},opacity:{value:1}}]),vertexShader:_E.shadow_vert,fragmentShader:_E.shadow_frag}};NE.physical={uniforms:$M([NE.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new aj},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new aj},clearcoatNormalScale:{value:new sj(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new aj},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new aj},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new aj},sheen:{value:0},sheenColor:{value:new nM(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new aj},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new aj},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new aj},transmissionSamplerSize:{value:new sj},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new aj},attenuationDistance:{value:0},attenuationColor:{value:new nM(0)},specularColor:{value:new nM(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new aj},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new aj},anisotropyVector:{value:new sj},anisotropyMap:{value:null},anisotropyMapTransform:{value:new aj}}]),vertexShader:_E.meshphysical_vert,fragmentShader:_E.meshphysical_frag};const jE={r:0,b:0,g:0},AE=new SA,ME=new pA;function EE(e,t,n,r,i,s,a){const o=new nM(0);let l,c,d=!0===s?0:1,u=null,h=0,p=null;function m(e){let r=!0===e.isScene?e.background:null;if(r&&r.isTexture){r=(e.backgroundBlurriness>0?n:t).get(r)}return r}function f(t,n){t.getRGB(jE,eE(e)),r.buffers.color.setClear(jE.r,jE.g,jE.b,n,a)}return{getClearColor:function(){return o},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;o.set(e),d=t,f(o,d)},getClearAlpha:function(){return d},setClearAlpha:function(e){d=e,f(o,d)},render:function(t){let n=!1;const i=m(t);null===i?f(o,d):i&&i.isColor&&(f(i,1),n=!0);const s=e.xr.getEnvironmentBlendMode();"additive"===s?r.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===s&&r.buffers.color.setClear(0,0,0,0,a),(e.autoClear||n)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)},addToRenderList:function(t,n){const r=m(n);r&&(r.isCubeTexture||r.mapping===w_)?(void 0===c&&(c=new ZM(new KM(1,1,1),new nE({name:"BackgroundCubeMaterial",uniforms:QM(NE.backgroundCube.uniforms),vertexShader:NE.backgroundCube.vertexShader,fragmentShader:NE.backgroundCube.fragmentShader,side:ww,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),AE.copy(n.backgroundRotation),AE.x*=-1,AE.y*=-1,AE.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(AE.y*=-1,AE.z*=-1),c.material.uniforms.envMap.value=r,c.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(ME.makeRotationFromEuler(AE)),c.material.toneMapped=yj.getTransfer(r.colorSpace)!==oN,u===r&&h===r.version&&p===e.toneMapping||(c.material.needsUpdate=!0,u=r,h=r.version,p=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):r&&r.isTexture&&(void 0===l&&(l=new ZM(new wE(2,2),new nE({name:"BackgroundMaterial",uniforms:QM(NE.background.uniforms),vertexShader:NE.background.vertexShader,fragmentShader:NE.background.fragmentShader,side:bw,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=r,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=yj.getTransfer(r.colorSpace)!==oN,!0===r.matrixAutoUpdate&&r.updateMatrix(),l.material.uniforms.uvTransform.value.copy(r.matrix),u===r&&h===r.version&&p===e.toneMapping||(l.material.needsUpdate=!0,u=r,h=r.version,p=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))}}}function CE(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=c(null);let s=i,a=!1;function o(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],r=[],i=[];for(let s=0;s<n;s++)t[s]=0,r[s]=0,i[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function d(){const e=s.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function u(e){h(e,0)}function h(t,n){const r=s.newAttributes,i=s.enabledAttributes,a=s.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),a[t]!==n&&(e.vertexAttribDivisor(t,n),a[t]=n)}function p(){const t=s.newAttributes,n=s.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function m(t,n,r,i,s,a,o){!0===o?e.vertexAttribIPointer(t,n,r,s,a):e.vertexAttribPointer(t,n,r,i,s,a)}function f(){g(),a=!0,s!==i&&(s=i,o(s.object))}function g(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,l,f,g){let x=!1;const v=function(t,n,i){const s=!0===i.wireframe;let a=r[t.id];void 0===a&&(a={},r[t.id]=a);let o=a[n.id];void 0===o&&(o={},a[n.id]=o);let l=o[s];void 0===l&&(l=c(e.createVertexArray()),o[s]=l);return l}(f,l,i);s!==v&&(s=v,o(s.object)),x=function(e,t,n,r){const i=s.attributes,a=t.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){const t=i[s];let n=a[s];if(void 0===n&&("instanceMatrix"===s&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;o++}}return s.attributesNum!==o||s.index!==r}(n,f,l,g),x&&function(e,t,n,r){const i={},a=t.attributes;let o=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){let t=a[s];void 0===t&&("instanceMatrix"===s&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),i[s]=n,o++}}s.attributes=i,s.attributesNum=o,s.index=r}(n,f,l,g),null!==g&&t.update(g,e.ELEMENT_ARRAY_BUFFER),(x||a)&&(a=!1,function(n,r,i,s){d();const a=s.attributes,o=i.getAttributes(),l=r.defaultAttributeValues;for(const c in o){const r=o[c];if(r.location>=0){let i=a[c];if(void 0===i&&("instanceMatrix"===c&&n.instanceMatrix&&(i=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(i=n.instanceColor)),void 0!==i){const a=i.normalized,o=i.itemSize,l=t.get(i);if(void 0===l)continue;const c=l.buffer,d=l.type,p=l.bytesPerElement,f=d===e.INT||d===e.UNSIGNED_INT||i.gpuType===U_;if(i.isInterleavedBufferAttribute){const t=i.data,l=t.stride,g=i.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<r.locationSize;e++)h(r.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<r.locationSize;e++)u(r.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<r.locationSize;e++)m(r.location+e,o/r.locationSize,d,a,l*p,(g+o/r.locationSize*e)*p,f)}else{if(i.isInstancedBufferAttribute){for(let e=0;e<r.locationSize;e++)h(r.location+e,i.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let e=0;e<r.locationSize;e++)u(r.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<r.locationSize;e++)m(r.location+e,o/r.locationSize,d,a,o*p,o/r.locationSize*e*p,f)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(r.location,t);break;case 3:e.vertexAttrib3fv(r.location,t);break;case 4:e.vertexAttrib4fv(r.location,t);break;default:e.vertexAttrib1fv(r.location,t)}}}}p()}(n,i,l,f),null!==g&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(g).buffer))},reset:f,resetDefaultState:g,dispose:function(){f();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0===r[e.id])return;const t=r[e.id];for(const n in t){const e=t[n];for(const t in e)l(e[t].object),delete e[t];delete t[n]}delete r[e.id]},releaseStatesOfProgram:function(e){for(const t in r){const n=r[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)l(i[e].object),delete i[e];delete n[e.id]}},initAttributes:d,enableAttribute:u,disableUnusedAttributes:p}}function kE(e,t,n){let r;function i(t,i,s){0!==s&&(e.drawArraysInstanced(r,t,i,s),n.update(i,r,s))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,s){if(0===s)return;const a=t.get("WEBGL_multi_draw");if(null===a)for(let t=0;t<s;t++)this.render(e[t],i[t]);else{a.multiDrawArraysWEBGL(r,e,0,i,0,s);let t=0;for(let e=0;e<s;e++)t+=i[e];n.update(t,r,1)}},this.renderMultiDrawInstances=function(e,s,a,o){if(0===a)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)i(e[t],s[t],o[t]);else{l.multiDrawArraysInstancedWEBGL(r,e,0,s,0,o,0,a);let t=0;for(let e=0;e<a;e++)t+=s[e];for(let e=0;e<o.length;e++)n.update(t,r,o[e])}}}function TE(e,t,n,r){let i;function s(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a=void 0!==n.precision?n.precision:"highp";const o=s(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);const l=!0===n.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,textureFormatReadable:function(t){return t===Z_||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const i=n===V_&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==I_&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==B_&&!i)},precision:a,logarithmicDepthBuffer:l,maxTextures:c,maxVertexTextures:d,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:d>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function PE(e){const t=this;let n=null,r=0,i=!1,s=!1;const a=new fE,o=new aj,l={value:null,needsUpdate:!1};function c(e,n,r,i){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==i||null===c){const t=r+4*s,i=n.matrixWorldInverse;o.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=r;n!==s;++n,l+=4)a.copy(e[n]).applyMatrix4(i,o),a.normal.toArray(c,l),c[l+3]=a.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(a,o,d){const u=a.clippingPlanes,h=a.clipIntersection,p=a.clipShadows,m=e.get(a);if(!i||null===u||0===u.length||s&&!p)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{const e=s?0:r,t=4*e;let i=m.clippingState||null;l.value=i,i=c(u,o,t,d);for(let r=0;r!==t;++r)i[r]=n[r];m.clippingState=i,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function LE(e){let t=new WeakMap;function n(e,t){return t===y_?e.mapping=x_:t===b_&&(e.mapping=v_),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const s=i.mapping;if(s===y_||s===b_){if(t.has(i)){return n(t.get(i).texture,i.mapping)}{const s=i.image;if(s&&s.height>0){const a=new uE(s.height);return a.fromEquirectangularTexture(e,i),t.set(i,a),i.addEventListener("dispose",r),n(a.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}class RE extends rE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,s=n+e,a=r+t,o=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,s=i+e*this.view.width,a-=t*this.view.offsetY,o=a-t*this.view.height}this.projectionMatrix.makeOrthographic(i,s,a,o,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const IE=[.125,.215,.35,.446,.526,.582],FE=20,OE=new RE,DE=new nM;let UE=null,zE=0,BE=0,VE=!1;const HE=(1+Math.sqrt(5))/2,WE=1/HE,GE=[new Oj(-HE,WE,0),new Oj(HE,WE,0),new Oj(-WE,0,HE),new Oj(WE,0,HE),new Oj(0,HE,-WE),new Oj(0,HE,WE),new Oj(-1,1,-1),new Oj(1,1,-1),new Oj(-1,1,1),new Oj(1,1,1)];class qE{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;UE=this._renderer.getRenderTarget(),zE=this._renderer.getActiveCubeFace(),BE=this._renderer.getActiveMipmapLevel(),VE=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=JE(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=ZE(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(UE,zE,BE),this._renderer.xr.enabled=VE,e.scissorTest=!1,YE(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===x_||e.mapping===v_?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),UE=this._renderer.getRenderTarget(),zE=this._renderer.getActiveCubeFace(),BE=this._renderer.getActiveMipmapLevel(),VE=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:k_,minFilter:k_,generateMipmaps:!1,type:V_,format:Z_,colorSpace:rN,depthBuffer:!1},r=XE(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=XE(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const s=e-4+1+IE.length;for(let a=0;a<s;a++){const s=Math.pow(2,i);n.push(s);let o=1/s;a>e-4?o=IE[a-e+4-1]:0===a&&(o=0),r.push(o);const l=1/(s-2),c=-l,d=1+l,u=[c,c,d,c,d,d,c,c,d,d,c,d],h=6,p=6,m=3,f=2,g=1,x=new Float32Array(m*p*h),v=new Float32Array(f*p*h),y=new Float32Array(g*p*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];x.set(r,m*p*e),v.set(u,f*p*e);const i=[e,e,e,e,e,e];y.set(i,g*p*e)}const b=new TM;b.setAttribute("position",new mM(x,m)),b.setAttribute("uv",new mM(v,f)),b.setAttribute("faceIndex",new mM(y,g)),t.push(b),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(FE),i=new Oj(0,1,0),s=new nE({name:"SphericalGaussianBlur",defines:{n:FE,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Sw,depthTest:!1,depthWrite:!1});return s}(r,e,t)}return r}_compileMaterial(e){const t=new ZM(this._lodPlanes[0],e);this._renderer.compile(t,OE)}_sceneToCubeUV(e,t,n,r){const i=new oE(90,1,t,n),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(DE),o.toneMapping=a_,o.autoClear=!1;const d=new aM({name:"PMREM.Background",side:ww,depthWrite:!1,depthTest:!1}),u=new ZM(new KM,d);let h=!1;const p=e.background;p?p.isColor&&(d.color.copy(p),e.background=null,h=!0):(d.color.copy(DE),h=!0);for(let m=0;m<6;m++){const t=m%3;0===t?(i.up.set(0,s[m],0),i.lookAt(a[m],0,0)):1===t?(i.up.set(0,0,s[m]),i.lookAt(0,a[m],0)):(i.up.set(0,s[m],0),i.lookAt(0,0,a[m]));const n=this._cubeSize;YE(r,t*n,m>2?n:0,n,n),o.setRenderTarget(r),h&&o.render(u,i),o.render(e,i)}u.geometry.dispose(),u.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===x_||e.mapping===v_;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=JE()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=ZE());const i=r?this._cubemapMaterial:this._equirectMaterial,s=new ZM(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const a=this._cubeSize;YE(t,0,0,3*a,2*a),n.setRenderTarget(t),n.render(s,OE)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const t=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=GE[(r-i-1)%GE.length];this._blur(e,i-1,i,t,n)}t.autoClear=n}_blur(e,t,n,r,i){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,r,"latitudinal",i),this._halfBlur(s,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,s,a){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new ZM(this._lodPlanes[r],l),d=l.uniforms,u=this._sizeLods[n]-1,h=isFinite(i)?Math.PI/(2*u):2*Math.PI/39,p=i/h,m=isFinite(i)?1+Math.floor(3*p):FE;m>FE&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(m," samples when the maximum is set to ").concat(FE));const f=[];let g=0;for(let y=0;y<FE;++y){const e=y/p,t=Math.exp(-e*e/2);f.push(t),0===y?g+=t:y<m&&(g+=2*t)}for(let y=0;y<f.length;y++)f[y]=f[y]/g;d.envMap.value=e.texture,d.samples.value=m,d.weights.value=f,d.latitudinal.value="latitudinal"===s,a&&(d.poleAxis.value=a);const{_lodMax:x}=this;d.dTheta.value=h,d.mipInt.value=x-n;const v=this._sizeLods[r];YE(t,3*v*(r>x-4?r-x+4:0),4*(this._cubeSize-v),3*v,2*v),o.setRenderTarget(t),o.render(c,OE)}}function XE(e,t,n){const r=new Tj(e,t,n);return r.texture.mapping=w_,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function YE(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function ZE(){return new nE({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Sw,depthTest:!1,depthWrite:!1})}function JE(){return new nE({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Sw,depthTest:!1,depthWrite:!1})}function KE(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const s=i.mapping,a=s===y_||s===b_,o=s===x_||s===v_;if(a||o){let s=t.get(i);const l=void 0!==s?s.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===n&&(n=new qE(e)),s=a?n.fromEquirectangular(i,s):n.fromCubemap(i,s),s.texture.pmremVersion=i.pmremVersion,t.set(i,s),s.texture;if(void 0!==s)return s.texture;{const l=i.image;return a&&l&&l.height>0||o&&l&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(l)?(null===n&&(n=new qE(e)),s=a?n.fromEquirectangular(i):n.fromCubemap(i),s.texture.pmremVersion=i.pmremVersion,t.set(i,s),i.addEventListener("dispose",r),s.texture):null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function QE(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function $E(e,t,n,r){const i={},s=new WeakMap;function a(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const n in o.attributes)t.remove(o.attributes[n]);for(const n in o.morphAttributes){const e=o.morphAttributes[n];for(let n=0,r=e.length;n<r;n++)t.remove(e[n])}o.removeEventListener("dispose",a),delete i[o.id];const l=s.get(o);l&&(t.remove(l),s.delete(o)),r.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){const n=[],r=e.index,i=e.attributes.position;let a=0;if(null!==r){const e=r.array;a=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],s=e[t+2];n.push(r,i,i,s,s,r)}}else{if(void 0===i)return;{const e=i.array;a=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}}const o=new(lj(n)?wM:yM)(n,1);o.version=a;const l=s.get(e);l&&t.remove(l),s.set(e,o)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",a),i[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const s in r)t.update(r[s],e.ARRAY_BUFFER);const i=n.morphAttributes;for(const s in i){const n=i[s];for(let r=0,i=n.length;r<i;r++)t.update(n[r],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){const t=s.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return s.get(e)}}}function eC(e,t,n){let r,i,s;function a(t,a,o){0!==o&&(e.drawElementsInstanced(r,a,i,t*s,o),n.update(a,r,o))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,s=e.bytesPerElement},this.render=function(t,a){e.drawElements(r,a,i,t*s),n.update(a,r,1)},this.renderInstances=a,this.renderMultiDraw=function(e,a,o){if(0===o)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<o;t++)this.render(e[t]/s,a[t]);else{l.multiDrawElementsWEBGL(r,a,0,i,e,0,o);let t=0;for(let e=0;e<o;e++)t+=a[e];n.update(t,r,1)}},this.renderMultiDrawInstances=function(e,o,l,c){if(0===l)return;const d=t.get("WEBGL_multi_draw");if(null===d)for(let t=0;t<e.length;t++)a(e[t]/s,o[t],c[t]);else{d.multiDrawElementsInstancedWEBGL(r,o,0,i,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=o[e];for(let e=0;e<c.length;e++)n.update(t,r,c[e])}}}function tC(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function nC(e,t,n){const r=new WeakMap,i=new Cj;return{update:function(s,a,o){const l=s.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=void 0!==c?c.length:0;let u=r.get(a);if(void 0===u||u.count!==d){void 0!==u&&u.texture.dispose();const h=void 0!==a.morphAttributes.position,p=void 0!==a.morphAttributes.normal,m=void 0!==a.morphAttributes.color,f=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],x=a.morphAttributes.color||[];let v=0;!0===h&&(v=1),!0===p&&(v=2),!0===m&&(v=3);let y=a.attributes.position.count*v,b=1;y>t.maxTextureSize&&(b=Math.ceil(y/t.maxTextureSize),y=t.maxTextureSize);const w=new Float32Array(y*b*4*d),_=new Pj(w,y,b,d);_.type=B_,_.needsUpdate=!0;const S=4*v;for(let j=0;j<d;j++){const A=f[j],M=g[j],E=x[j],C=y*b*4*j;for(let k=0;k<A.count;k++){const T=k*S;!0===h&&(i.fromBufferAttribute(A,k),w[C+T+0]=i.x,w[C+T+1]=i.y,w[C+T+2]=i.z,w[C+T+3]=0),!0===p&&(i.fromBufferAttribute(M,k),w[C+T+4]=i.x,w[C+T+5]=i.y,w[C+T+6]=i.z,w[C+T+7]=0),!0===m&&(i.fromBufferAttribute(E,k),w[C+T+8]=i.x,w[C+T+9]=i.y,w[C+T+10]=i.z,w[C+T+11]=4===E.itemSize?i.w:1)}}function N(){_.dispose(),r.delete(a),a.removeEventListener("dispose",N)}u={count:d,texture:_,size:new sj(y,b)},r.set(a,u),a.addEventListener("dispose",N)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)o.getUniforms().setValue(e,"morphTexture",s.morphTexture,n);else{let P=0;for(let R=0;R<l.length;R++)P+=l[R];const L=a.morphTargetsRelative?1:1-P;o.getUniforms().setValue(e,"morphTargetBaseInfluence",L),o.getUniforms().setValue(e,"morphTargetInfluences",l)}o.getUniforms().setValue(e,"morphTargetsTexture",u.texture,n),o.getUniforms().setValue(e,"morphTargetsTextureSize",u.size)}}}function rC(e,t,n,r){let i=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(a){const o=r.render.frame,l=a.geometry,c=t.get(a,l);if(i.get(c)!==o&&(t.update(c),i.set(c,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),i.get(a)!==o&&(n.update(a.instanceMatrix,e.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,e.ARRAY_BUFFER),i.set(a,o))),a.isSkinnedMesh){const e=a.skeleton;i.get(e)!==o&&(e.update(),i.set(e,o))}return c},dispose:function(){i=new WeakMap}}}class iC extends Ej{constructor(e,t,n,r,i,s,a,o,l,c){if((c=void 0!==c?c:Q_)!==Q_&&c!==$_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Q_&&(n=z_),void 0===n&&c===$_&&(n=G_),super(null,r,i,s,a,o,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:j_,this.minFilter=void 0!==o?o:j_,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const sC=new Ej,aC=new iC(1,1);aC.compareFunction=CN;const oC=new Pj,lC=new Rj,cC=new dE,dC=[],uC=[],hC=new Float32Array(16),pC=new Float32Array(9),mC=new Float32Array(4);function fC(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let s=dC[i];if(void 0===s&&(s=new Float32Array(i),dC[i]=s),0!==t){r.toArray(s,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(s,i)}return s}function gC(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function xC(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function vC(e,t){let n=uC[t];void 0===n&&(n=new Int32Array(t),uC[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function yC(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function bC(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(gC(n,t))return;e.uniform2fv(this.addr,t),xC(n,t)}}function wC(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(gC(n,t))return;e.uniform3fv(this.addr,t),xC(n,t)}}function _C(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(gC(n,t))return;e.uniform4fv(this.addr,t),xC(n,t)}}function SC(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(gC(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),xC(n,t)}else{if(gC(n,r))return;mC.set(r),e.uniformMatrix2fv(this.addr,!1,mC),xC(n,r)}}function NC(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(gC(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),xC(n,t)}else{if(gC(n,r))return;pC.set(r),e.uniformMatrix3fv(this.addr,!1,pC),xC(n,r)}}function jC(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(gC(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),xC(n,t)}else{if(gC(n,r))return;hC.set(r),e.uniformMatrix4fv(this.addr,!1,hC),xC(n,r)}}function AC(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function MC(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(gC(n,t))return;e.uniform2iv(this.addr,t),xC(n,t)}}function EC(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(gC(n,t))return;e.uniform3iv(this.addr,t),xC(n,t)}}function CC(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(gC(n,t))return;e.uniform4iv(this.addr,t),xC(n,t)}}function kC(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function TC(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(gC(n,t))return;e.uniform2uiv(this.addr,t),xC(n,t)}}function PC(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(gC(n,t))return;e.uniform3uiv(this.addr,t),xC(n,t)}}function LC(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(gC(n,t))return;e.uniform4uiv(this.addr,t),xC(n,t)}}function RC(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i);const s=this.type===e.SAMPLER_2D_SHADOW?aC:sC;n.setTexture2D(t||s,i)}function IC(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||lC,i)}function FC(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||cC,i)}function OC(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||oC,i)}function DC(e,t){e.uniform1fv(this.addr,t)}function UC(e,t){const n=fC(t,this.size,2);e.uniform2fv(this.addr,n)}function zC(e,t){const n=fC(t,this.size,3);e.uniform3fv(this.addr,n)}function BC(e,t){const n=fC(t,this.size,4);e.uniform4fv(this.addr,n)}function VC(e,t){const n=fC(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function HC(e,t){const n=fC(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function WC(e,t){const n=fC(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function GC(e,t){e.uniform1iv(this.addr,t)}function qC(e,t){e.uniform2iv(this.addr,t)}function XC(e,t){e.uniform3iv(this.addr,t)}function YC(e,t){e.uniform4iv(this.addr,t)}function ZC(e,t){e.uniform1uiv(this.addr,t)}function JC(e,t){e.uniform2uiv(this.addr,t)}function KC(e,t){e.uniform3uiv(this.addr,t)}function QC(e,t){e.uniform4uiv(this.addr,t)}function $C(e,t,n){const r=this.cache,i=t.length,s=vC(n,i);gC(r,s)||(e.uniform1iv(this.addr,s),xC(r,s));for(let a=0;a!==i;++a)n.setTexture2D(t[a]||sC,s[a])}function ek(e,t,n){const r=this.cache,i=t.length,s=vC(n,i);gC(r,s)||(e.uniform1iv(this.addr,s),xC(r,s));for(let a=0;a!==i;++a)n.setTexture3D(t[a]||lC,s[a])}function tk(e,t,n){const r=this.cache,i=t.length,s=vC(n,i);gC(r,s)||(e.uniform1iv(this.addr,s),xC(r,s));for(let a=0;a!==i;++a)n.setTextureCube(t[a]||cC,s[a])}function nk(e,t,n){const r=this.cache,i=t.length,s=vC(n,i);gC(r,s)||(e.uniform1iv(this.addr,s),xC(r,s));for(let a=0;a!==i;++a)n.setTexture2DArray(t[a]||oC,s[a])}class rk{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return yC;case 35664:return bC;case 35665:return wC;case 35666:return _C;case 35674:return SC;case 35675:return NC;case 35676:return jC;case 5124:case 35670:return AC;case 35667:case 35671:return MC;case 35668:case 35672:return EC;case 35669:case 35673:return CC;case 5125:return kC;case 36294:return TC;case 36295:return PC;case 36296:return LC;case 35678:case 36198:case 36298:case 36306:case 35682:return RC;case 35679:case 36299:case 36307:return IC;case 35680:case 36300:case 36308:case 36293:return FC;case 36289:case 36303:case 36311:case 36292:return OC}}(t.type)}}class ik{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return DC;case 35664:return UC;case 35665:return zC;case 35666:return BC;case 35674:return VC;case 35675:return HC;case 35676:return WC;case 5124:case 35670:return GC;case 35667:case 35671:return qC;case 35668:case 35672:return XC;case 35669:case 35673:return YC;case 5125:return ZC;case 36294:return JC;case 36295:return KC;case 36296:return QC;case 35678:case 36198:case 36298:case 36306:case 35682:return $C;case 35679:case 36299:case 36307:return ek;case 35680:case 36300:case 36308:case 36293:return tk;case 36289:case 36303:case 36311:case 36292:return nk}}(t.type)}}class sk{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,s=r.length;i!==s;++i){const s=r[i];s.setValue(e,t[s.id],n)}}}const ak=/(\w+)(\])?(\[|\.)?/g;function ok(e,t){e.seq.push(t),e.map[t.id]=t}function lk(e,t,n){const r=e.name,i=r.length;for(ak.lastIndex=0;;){const s=ak.exec(r),a=ak.lastIndex;let o=s[1];const l="]"===s[2],c=s[3];if(l&&(o|=0),void 0===c||"["===c&&a+2===i){ok(n,void 0===c?new rk(o,e,t):new ik(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new sk(o),ok(n,e)),n=e}}}class ck{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);lk(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,s=t.length;i!==s;++i){const s=t[i],a=n[s.id];!1!==a.needsUpdate&&s.setValue(e,a.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function dk(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let uk=0;function hk(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const r=parseInt(s[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let a=i;a<s;a++){const e=a+1;r.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[a]))}return r.join("\n")}(e.getShaderSource(t),r)}return i}function pk(e,t){const n=function(e){const t=yj.getPrimaries(yj.workingColorSpace),n=yj.getPrimaries(e);let r;switch(t===n?r="":t===cN&&n===lN?r="LinearDisplayP3ToLinearSRGB":t===lN&&n===cN&&(r="LinearSRGBToLinearDisplayP3"),e){case rN:case sN:return[r,"LinearTransferOETF"];case nN:case iN:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),[r,"LinearTransferOETF"]}}(t);return"vec4 ".concat(e,"( vec4 value ) { return ").concat(n[0],"( ").concat(n[1],"( value ) ); }")}function mk(e,t){let n;switch(t){case o_:n="Linear";break;case l_:n="Reinhard";break;case c_:n="OptimizedCineon";break;case d_:n="ACESFilmic";break;case h_:n="AgX";break;case p_:n="Neutral";break;case u_:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function fk(e){return""!==e}function gk(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function xk(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const vk=/^[ \t]*#include +<([\w\d./]+)>/gm;function yk(e){return e.replace(vk,wk)}const bk=new Map;function wk(e,t){let n=_E[t];if(void 0===n){const e=bk.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=_E[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return yk(n)}const _k=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Sk(e){return e.replace(_k,Nk)}function Nk(e,t,n,r){let i="";for(let s=parseInt(t);s<parseInt(n);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function jk(e){let t="precision ".concat(e.precision," float;\n\tprecision ").concat(e.precision," int;\n\tprecision ").concat(e.precision," sampler2D;\n\tprecision ").concat(e.precision," samplerCube;\n\tprecision ").concat(e.precision," sampler3D;\n\tprecision ").concat(e.precision," sampler2DArray;\n\tprecision ").concat(e.precision," sampler2DShadow;\n\tprecision ").concat(e.precision," samplerCubeShadow;\n\tprecision ").concat(e.precision," sampler2DArrayShadow;\n\tprecision ").concat(e.precision," isampler2D;\n\tprecision ").concat(e.precision," isampler3D;\n\tprecision ").concat(e.precision," isamplerCube;\n\tprecision ").concat(e.precision," isampler2DArray;\n\tprecision ").concat(e.precision," usampler2D;\n\tprecision ").concat(e.precision," usampler3D;\n\tprecision ").concat(e.precision," usamplerCube;\n\tprecision ").concat(e.precision," usampler2DArray;\n\t");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ak(e,t,n,r){const i=e.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===xw?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===vw?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===yw&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case x_:case v_:t="ENVMAP_TYPE_CUBE";break;case w_:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===v_&&(t="ENVMAP_MODE_REFRACTION");return t}(n),u=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case r_:t="ENVMAP_BLENDING_MULTIPLY";break;case i_:t="ENVMAP_BLENDING_MIX";break;case s_:t="ENVMAP_BLENDING_ADD"}return t}(n),h=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),p=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(fk).join("\n")}(n),m=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),f=i.createProgram();let g,x,v=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(fk).join("\n"),g.length>0&&(g+="\n"),x=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(fk).join("\n"),x.length>0&&(x+="\n")):(g=[jk(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(fk).join("\n"),x=[jk(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+d:"",n.envMap?"#define "+u:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==a_?"#define TONE_MAPPING":"",n.toneMapping!==a_?_E.tonemapping_pars_fragment:"",n.toneMapping!==a_?mk("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",_E.colorspace_pars_fragment,pk("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(fk).join("\n")),a=yk(a),a=gk(a,n),a=xk(a,n),o=yk(o),o=gk(o,n),o=xk(o,n),a=Sk(a),o=Sk(o),!0!==n.isRawShaderMaterial&&(v="#version 300 es\n",g=[p,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,x=["#define varying in",n.glslVersion===WN?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===WN?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x);const y=v+g+a,b=v+x+o,w=dk(i,i.VERTEX_SHADER,y),_=dk(i,i.FRAGMENT_SHADER,b);function S(t){if(e.debug.checkShaderErrors){const n=i.getProgramInfoLog(f).trim(),r=i.getShaderInfoLog(w).trim(),s=i.getShaderInfoLog(_).trim();let a=!0,o=!0;if(!1===i.getProgramParameter(f,i.LINK_STATUS))if(a=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(i,f,w,_);else{const e=hk(i,w,"vertex"),r=hk(i,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(f,i.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+n+"\n"+e+"\n"+r)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==r&&""!==s||(o=!1);o&&(t.diagnostics={runnable:a,programLog:n,vertexShader:{log:r,prefix:g},fragmentShader:{log:s,prefix:x}})}i.deleteShader(w),i.deleteShader(_),N=new ck(i,f),j=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),s=r.name;let a=1;r.type===e.FLOAT_MAT2&&(a=2),r.type===e.FLOAT_MAT3&&(a=3),r.type===e.FLOAT_MAT4&&(a=4),n[s]={type:r.type,location:e.getAttribLocation(t,s),locationSize:a}}return n}(i,f)}let N,j;i.attachShader(f,w),i.attachShader(f,_),void 0!==n.index0AttributeName?i.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(f,0,"position"),i.linkProgram(f),this.getUniforms=function(){return void 0===N&&S(this),N},this.getAttributes=function(){return void 0===j&&S(this),j};let A=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===A&&(A=i.getProgramParameter(f,37297)),A},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(f),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=uk++,this.cacheKey=t,this.usedTimes=1,this.program=f,this.vertexShader=w,this.fragmentShader=_,this}let Mk=0;class Ek{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(r)&&(s.add(r),r.usedTimes++),!1===s.has(i)&&(s.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new Ck(e),t.set(e,n)),n}}class Ck{constructor(e){this.id=Mk++,this.code=e,this.usedTimes=0}}function kk(e,t,n,r,i,s,a){const o=new NA,l=new Ek,c=new Set,d=[],u=i.logarithmicDepthBuffer,h=i.vertexTextures;let p=i.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function f(e){return c.add(e),0===e?"uv":"uv".concat(e)}return{getParameters:function(s,o,d,g,x){const v=g.fog,y=x.geometry,b=s.isMeshStandardMaterial?g.environment:null,w=(s.isMeshStandardMaterial?n:t).get(s.envMap||b),_=w&&w.mapping===w_?w.image.height:null,S=m[s.type];null!==s.precision&&(p=i.getMaxPrecision(s.precision),p!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",p,"instead."));const N=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,j=void 0!==N?N.length:0;let A,M,E,C,k=0;if(void 0!==y.morphAttributes.position&&(k=1),void 0!==y.morphAttributes.normal&&(k=2),void 0!==y.morphAttributes.color&&(k=3),S){const e=NE[S];A=e.vertexShader,M=e.fragmentShader}else A=s.vertexShader,M=s.fragmentShader,l.update(s),E=l.getVertexShaderID(s),C=l.getFragmentShaderID(s);const T=e.getRenderTarget(),P=!0===x.isInstancedMesh,L=!0===x.isBatchedMesh,R=!!s.map,I=!!s.matcap,F=!!w,O=!!s.aoMap,D=!!s.lightMap,U=!!s.bumpMap,z=!!s.normalMap,B=!!s.displacementMap,V=!!s.emissiveMap,H=!!s.metalnessMap,W=!!s.roughnessMap,G=s.anisotropy>0,q=s.clearcoat>0,X=s.dispersion>0,Y=s.iridescence>0,Z=s.sheen>0,J=s.transmission>0,K=G&&!!s.anisotropyMap,Q=q&&!!s.clearcoatMap,$=q&&!!s.clearcoatNormalMap,ee=q&&!!s.clearcoatRoughnessMap,te=Y&&!!s.iridescenceMap,ne=Y&&!!s.iridescenceThicknessMap,re=Z&&!!s.sheenColorMap,ie=Z&&!!s.sheenRoughnessMap,se=!!s.specularMap,ae=!!s.specularColorMap,oe=!!s.specularIntensityMap,le=J&&!!s.transmissionMap,ce=J&&!!s.thicknessMap,de=!!s.gradientMap,ue=!!s.alphaMap,he=s.alphaTest>0,pe=!!s.alphaHash,me=!!s.extensions;let fe=a_;s.toneMapped&&(null!==T&&!0!==T.isXRRenderTarget||(fe=e.toneMapping));const ge={shaderID:S,shaderType:s.type,shaderName:s.name,vertexShader:A,fragmentShader:M,defines:s.defines,customVertexShaderID:E,customFragmentShaderID:C,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:p,batching:L,instancing:P,instancingColor:P&&null!==x.instanceColor,instancingMorph:P&&null!==x.morphTexture,supportsVertexTextures:h,outputColorSpace:null===T?e.outputColorSpace:!0===T.isXRRenderTarget?T.texture.colorSpace:rN,alphaToCoverage:!!s.alphaToCoverage,map:R,matcap:I,envMap:F,envMapMode:F&&w.mapping,envMapCubeUVHeight:_,aoMap:O,lightMap:D,bumpMap:U,normalMap:z,displacementMap:h&&B,emissiveMap:V,normalMapObjectSpace:z&&s.normalMapType===eN,normalMapTangentSpace:z&&s.normalMapType===$S,metalnessMap:H,roughnessMap:W,anisotropy:G,anisotropyMap:K,clearcoat:q,clearcoatMap:Q,clearcoatNormalMap:$,clearcoatRoughnessMap:ee,dispersion:X,iridescence:Y,iridescenceMap:te,iridescenceThicknessMap:ne,sheen:Z,sheenColorMap:re,sheenRoughnessMap:ie,specularMap:se,specularColorMap:ae,specularIntensityMap:oe,transmission:J,transmissionMap:le,thicknessMap:ce,gradientMap:de,opaque:!1===s.transparent&&s.blending===Nw&&!1===s.alphaToCoverage,alphaMap:ue,alphaTest:he,alphaHash:pe,combine:s.combine,mapUv:R&&f(s.map.channel),aoMapUv:O&&f(s.aoMap.channel),lightMapUv:D&&f(s.lightMap.channel),bumpMapUv:U&&f(s.bumpMap.channel),normalMapUv:z&&f(s.normalMap.channel),displacementMapUv:B&&f(s.displacementMap.channel),emissiveMapUv:V&&f(s.emissiveMap.channel),metalnessMapUv:H&&f(s.metalnessMap.channel),roughnessMapUv:W&&f(s.roughnessMap.channel),anisotropyMapUv:K&&f(s.anisotropyMap.channel),clearcoatMapUv:Q&&f(s.clearcoatMap.channel),clearcoatNormalMapUv:$&&f(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ee&&f(s.clearcoatRoughnessMap.channel),iridescenceMapUv:te&&f(s.iridescenceMap.channel),iridescenceThicknessMapUv:ne&&f(s.iridescenceThicknessMap.channel),sheenColorMapUv:re&&f(s.sheenColorMap.channel),sheenRoughnessMapUv:ie&&f(s.sheenRoughnessMap.channel),specularMapUv:se&&f(s.specularMap.channel),specularColorMapUv:ae&&f(s.specularColorMap.channel),specularIntensityMapUv:oe&&f(s.specularIntensityMap.channel),transmissionMapUv:le&&f(s.transmissionMap.channel),thicknessMapUv:ce&&f(s.thicknessMap.channel),alphaMapUv:ue&&f(s.alphaMap.channel),vertexTangents:!!y.attributes.tangent&&(z||G),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,pointsUvs:!0===x.isPoints&&!!y.attributes.uv&&(R||ue),fog:!!v,useFog:!0===s.fog,fogExp2:!!v&&v.isFogExp2,flatShading:!0===s.flatShading,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===x.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:j,morphTextureStride:k,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:fe,useLegacyLights:e._useLegacyLights,decodeVideoTexture:R&&!0===s.map.isVideoTexture&&yj.getTransfer(s.map.colorSpace)===oN,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===_w,flipSided:s.side===ww,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionClipCullDistance:me&&!0===s.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:me&&!0===s.extensions.multiDraw&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return ge.vertexUv1s=c.has(1),ge.vertexUv2s=c.has(2),ge.vertexUv3s=c.has(3),c.clear(),ge},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.supportsVertexTextures&&o.enable(0);t.instancing&&o.enable(1);t.instancingColor&&o.enable(2);t.instancingMorph&&o.enable(3);t.matcap&&o.enable(4);t.envMap&&o.enable(5);t.normalMapObjectSpace&&o.enable(6);t.normalMapTangentSpace&&o.enable(7);t.clearcoat&&o.enable(8);t.iridescence&&o.enable(9);t.alphaTest&&o.enable(10);t.vertexColors&&o.enable(11);t.vertexAlphas&&o.enable(12);t.vertexUv1s&&o.enable(13);t.vertexUv2s&&o.enable(14);t.vertexUv3s&&o.enable(15);t.vertexTangents&&o.enable(16);t.anisotropy&&o.enable(17);t.alphaHash&&o.enable(18);t.batching&&o.enable(19);t.dispersion&&o.enable(20);e.push(o.mask),o.disableAll(),t.fog&&o.enable(0);t.useFog&&o.enable(1);t.flatShading&&o.enable(2);t.logarithmicDepthBuffer&&o.enable(3);t.skinning&&o.enable(4);t.morphTargets&&o.enable(5);t.morphNormals&&o.enable(6);t.morphColors&&o.enable(7);t.premultipliedAlpha&&o.enable(8);t.shadowMapEnabled&&o.enable(9);t.useLegacyLights&&o.enable(10);t.doubleSided&&o.enable(11);t.flipSided&&o.enable(12);t.useDepthPacking&&o.enable(13);t.dithering&&o.enable(14);t.transmission&&o.enable(15);t.sheen&&o.enable(16);t.opaque&&o.enable(17);t.pointsUvs&&o.enable(18);t.decodeVideoTexture&&o.enable(19);t.alphaToCoverage&&o.enable(20);e.push(o.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=m[e.type];let n;if(t){const e=NE[t];n=tE.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,i=d.length;e<i;e++){const t=d[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new Ak(e,n,t,s),d.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){const t=d.indexOf(e);d[t]=d[d.length-1],d.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:d,dispose:function(){l.dispose()}}}function Tk(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Pk(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Lk(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Rk(){const e=[];let t=0;const n=[],r=[],i=[];function s(n,r,i,s,a,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,a,o,l,c){const d=s(e,t,a,o,l,c);a.transmission>0?r.push(d):!0===a.transparent?i.push(d):n.push(d)},unshift:function(e,t,a,o,l,c){const d=s(e,t,a,o,l,c);a.transmission>0?r.unshift(d):!0===a.transparent?i.unshift(d):n.unshift(d)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||Pk),r.length>1&&r.sort(t||Lk),i.length>1&&i.sort(t||Lk)}}}function Ik(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new Rk,e.set(t,[i])):n>=r.length?(i=new Rk,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function Fk(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Oj,color:new nM};break;case"SpotLight":n={position:new Oj,direction:new Oj,color:new nM,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Oj,color:new nM,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Oj,skyColor:new nM,groundColor:new nM};break;case"RectAreaLight":n={color:new nM,position:new Oj,halfWidth:new Oj,halfHeight:new Oj}}return e[t.id]=n,n}}}let Ok=0;function Dk(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Uk(e){const t=new Fk,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new sj};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new sj,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)r.probe.push(new Oj);const i=new Oj,s=new pA,a=new pA;return{setup:function(i,s){let a=0,o=0,l=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let c=0,d=0,u=0,h=0,p=0,m=0,f=0,g=0,x=0,v=0,y=0;i.sort(Dk);const b=!0===s?Math.PI:1;for(let e=0,_=i.length;e<_;e++){const s=i[e],w=s.color,_=s.intensity,S=s.distance,N=s.shadow&&s.shadow.map?s.shadow.map.texture:null;if(s.isAmbientLight)a+=w.r*_*b,o+=w.g*_*b,l+=w.b*_*b;else if(s.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(s.sh.coefficients[e],_);y++}else if(s.isDirectionalLight){const e=t.get(s);if(e.color.copy(s.color).multiplyScalar(s.intensity*b),s.castShadow){const e=s.shadow,t=n.get(s);t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,r.directionalShadow[c]=t,r.directionalShadowMap[c]=N,r.directionalShadowMatrix[c]=s.shadow.matrix,m++}r.directional[c]=e,c++}else if(s.isSpotLight){const e=t.get(s);e.position.setFromMatrixPosition(s.matrixWorld),e.color.copy(w).multiplyScalar(_*b),e.distance=S,e.coneCos=Math.cos(s.angle),e.penumbraCos=Math.cos(s.angle*(1-s.penumbra)),e.decay=s.decay,r.spot[u]=e;const i=s.shadow;if(s.map&&(r.spotLightMap[x]=s.map,x++,i.updateMatrices(s),s.castShadow&&v++),r.spotLightMatrix[u]=i.matrix,s.castShadow){const e=n.get(s);e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,r.spotShadow[u]=e,r.spotShadowMap[u]=N,g++}u++}else if(s.isRectAreaLight){const e=t.get(s);e.color.copy(w).multiplyScalar(_),e.halfWidth.set(.5*s.width,0,0),e.halfHeight.set(0,.5*s.height,0),r.rectArea[h]=e,h++}else if(s.isPointLight){const e=t.get(s);if(e.color.copy(s.color).multiplyScalar(s.intensity*b),e.distance=s.distance,e.decay=s.decay,s.castShadow){const e=s.shadow,t=n.get(s);t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,r.pointShadow[d]=t,r.pointShadowMap[d]=N,r.pointShadowMatrix[d]=s.shadow.matrix,f++}r.point[d]=e,d++}else if(s.isHemisphereLight){const e=t.get(s);e.skyColor.copy(s.color).multiplyScalar(_*b),e.groundColor.copy(s.groundColor).multiplyScalar(_*b),r.hemi[p]=e,p++}}h>0&&(!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=SE.LTC_FLOAT_1,r.rectAreaLTC2=SE.LTC_FLOAT_2):(r.rectAreaLTC1=SE.LTC_HALF_1,r.rectAreaLTC2=SE.LTC_HALF_2)),r.ambient[0]=a,r.ambient[1]=o,r.ambient[2]=l;const w=r.hash;w.directionalLength===c&&w.pointLength===d&&w.spotLength===u&&w.rectAreaLength===h&&w.hemiLength===p&&w.numDirectionalShadows===m&&w.numPointShadows===f&&w.numSpotShadows===g&&w.numSpotMaps===x&&w.numLightProbes===y||(r.directional.length=c,r.spot.length=u,r.rectArea.length=h,r.point.length=d,r.hemi.length=p,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=f,r.pointShadowMap.length=f,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=f,r.spotLightMatrix.length=g+x-v,r.spotLightMap.length=x,r.numSpotLightShadowsWithMaps=v,r.numLightProbes=y,w.directionalLength=c,w.pointLength=d,w.spotLength=u,w.rectAreaLength=h,w.hemiLength=p,w.numDirectionalShadows=m,w.numPointShadows=f,w.numSpotShadows=g,w.numSpotMaps=x,w.numLightProbes=y,r.version=Ok++)},setupView:function(e,t){let n=0,o=0,l=0,c=0,d=0;const u=t.matrixWorldInverse;for(let h=0,p=e.length;h<p;h++){const t=e[h];if(t.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),i.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(u),n++}else if(t.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),e.direction.setFromMatrixPosition(t.matrixWorld),i.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(u),l++}else if(t.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),a.identity(),s.copy(t.matrixWorld),s.premultiply(u),a.extractRotation(s),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(t.isPointLight){const e=r.point[o];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(u),o++}else if(t.isHemisphereLight){const e=r.hemi[d];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(u),d++}}},state:r}}function zk(e){const t=new Uk(e),n=[],r=[];const i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(e){t.setup(n,e)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function Bk(e){let t=new WeakMap;return{get:function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=t.get(n);let s;return void 0===i?(s=new zk(e),t.set(n,[s])):r>=i.length?(s=new zk(e),i.push(s)):s=i[r],s},dispose:function(){t=new WeakMap}}}class Vk extends sM{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=KS,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Hk extends sM{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Wk(e,t,n){let r=new vE;const i=new sj,s=new sj,a=new Cj,o=new Vk({depthPacking:QS}),l=new Hk,c={},d=n.maxTextureSize,u={[bw]:ww,[ww]:bw,[_w]:_w},h=new nE({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new sj},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=h.clone();p.defines.HORIZONTAL_PASS=1;const m=new TM;m.setAttribute("position",new mM(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const f=new ZM(m,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=xw;let x=this.type;function v(n,r){const s=t.update(f);h.defines.VSM_SAMPLES!==n.blurSamples&&(h.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Tj(i.x,i.y)),h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,s,h,f,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,s,p,f,null)}function y(t,n,r,i){let s=null;const a=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===r.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const e=s.uuid,t=n.uuid;let r=c[e];void 0===r&&(r={},c[e]=r);let i=r[t];void 0===i&&(i=s.clone(),r[t]=i,n.addEventListener("dispose",w)),s=i}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=i===yw?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:u[n.side],s.alphaMap=n.alphaMap,s.alphaTest=n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===r.isPointLight&&!0===s.isMeshDistanceMaterial){e.properties.get(s).light=r}return s}function b(n,i,s,a,o){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&o===yw)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const r=t.update(n),l=n.material;if(Array.isArray(l)){const t=r.groups;for(let c=0,d=t.length;c<d;c++){const d=t[c],u=l[d.materialIndex];if(u&&u.visible){const t=y(n,u,a,o);n.onBeforeShadow(e,n,i,s,r,t,d),e.renderBufferDirect(s,null,r,t,n,d),n.onAfterShadow(e,n,i,s,r,t,d)}}}else if(l.visible){const t=y(n,l,a,o);n.onBeforeShadow(e,n,i,s,r,t,null),e.renderBufferDirect(s,null,r,t,n,null),n.onAfterShadow(e,n,i,s,r,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],i,s,a,o)}function w(e){e.target.removeEventListener("dispose",w);for(const t in c){const n=c[t],r=e.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(t,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),h=e.state;h.setBlending(Sw),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);const p=x!==yw&&this.type===yw,m=x===yw&&this.type!==yw;for(let f=0,g=t.length;f<g;f++){const l=t[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const u=c.getFrameExtents();if(i.multiply(u),s.copy(c.mapSize),(i.x>d||i.y>d)&&(i.x>d&&(s.x=Math.floor(d/u.x),i.x=s.x*u.x,c.mapSize.x=s.x),i.y>d&&(s.y=Math.floor(d/u.y),i.y=s.y*u.y,c.mapSize.y=s.y)),null===c.map||!0===p||!0===m){const e=this.type!==yw?{minFilter:j_,magFilter:j_}:{};null!==c.map&&c.map.dispose(),c.map=new Tj(i.x,i.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const g=c.getViewportCount();for(let e=0;e<g;e++){const t=c.getViewport(e);a.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),h.viewport(a),c.updateMatrices(l,e),r=c.getFrustum(),b(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===yw&&v(c,o),c.needsUpdate=!1}x=this.type,g.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function Gk(e){const t=new function(){let t=!1;const n=new Cj;let r=null;const i=new Cj(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,s,a,o){!0===o&&(t*=a,r*=a,s*=a),n.set(t,r,s,a),!1===i.equals(n)&&(e.clearColor(t,r,s,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},n=new function(){let t=!1,n=null,r=null,i=null;return{setTest:function(t){t?U(e.DEPTH_TEST):z(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){switch(t){case Zw:e.depthFunc(e.NEVER);break;case Jw:e.depthFunc(e.ALWAYS);break;case Kw:e.depthFunc(e.LESS);break;case Qw:e.depthFunc(e.LEQUAL);break;case $w:e.depthFunc(e.EQUAL);break;case e_:e.depthFunc(e.GEQUAL);break;case t_:e.depthFunc(e.GREATER);break;case n_:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},r=new function(){let t=!1,n=null,r=null,i=null,s=null,a=null,o=null,l=null,c=null;return{setTest:function(n){t||(n?U(e.STENCIL_TEST):z(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&s===a||(e.stencilFunc(t,n,a),r=t,i=n,s=a)},setOp:function(t,n,r){a===t&&o===n&&l===r||(e.stencilOp(t,n,r),a=t,o=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,s=null,a=null,o=null,l=null,c=null}}},i=new WeakMap,s=new WeakMap;let a={},o={},l=new WeakMap,c=[],d=null,u=!1,h=null,p=null,m=null,f=null,g=null,x=null,v=null,y=new nM(0,0,0),b=0,w=!1,_=null,S=null,N=null,j=null,A=null;const M=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let E=!1,C=0;const k=e.getParameter(e.VERSION);-1!==k.indexOf("WebGL")?(C=parseFloat(/^WebGL (\d)/.exec(k)[1]),E=C>=1):-1!==k.indexOf("OpenGL ES")&&(C=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]),E=C>=2);let T=null,P={};const L=e.getParameter(e.SCISSOR_BOX),R=e.getParameter(e.VIEWPORT),I=(new Cj).fromArray(L),F=(new Cj).fromArray(R);function O(t,n,r,i){const s=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<r;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,s):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s);return a}const D={};function U(t){!0!==a[t]&&(e.enable(t),a[t]=!0)}function z(t){!1!==a[t]&&(e.disable(t),a[t]=!1)}D[e.TEXTURE_2D]=O(e.TEXTURE_2D,e.TEXTURE_2D,1),D[e.TEXTURE_CUBE_MAP]=O(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),D[e.TEXTURE_2D_ARRAY]=O(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),D[e.TEXTURE_3D]=O(e.TEXTURE_3D,e.TEXTURE_3D,1,1),t.setClear(0,0,0,1),n.setClear(1),r.setClear(0),U(e.DEPTH_TEST),n.setFunc(Qw),W(!1),G(pw),U(e.CULL_FACE),H(Sw);const B={[Cw]:e.FUNC_ADD,[kw]:e.FUNC_SUBTRACT,[Tw]:e.FUNC_REVERSE_SUBTRACT};B[Pw]=e.MIN,B[Lw]=e.MAX;const V={[Rw]:e.ZERO,[Iw]:e.ONE,[Fw]:e.SRC_COLOR,[Dw]:e.SRC_ALPHA,[Ww]:e.SRC_ALPHA_SATURATE,[Vw]:e.DST_COLOR,[zw]:e.DST_ALPHA,[Ow]:e.ONE_MINUS_SRC_COLOR,[Uw]:e.ONE_MINUS_SRC_ALPHA,[Hw]:e.ONE_MINUS_DST_COLOR,[Bw]:e.ONE_MINUS_DST_ALPHA,[Gw]:e.CONSTANT_COLOR,[qw]:e.ONE_MINUS_CONSTANT_COLOR,[Xw]:e.CONSTANT_ALPHA,[Yw]:e.ONE_MINUS_CONSTANT_ALPHA};function H(t,n,r,i,s,a,o,l,c,d){if(t!==Sw){if(!1===u&&(U(e.BLEND),u=!0),t===Ew)s=s||n,a=a||r,o=o||i,n===p&&s===g||(e.blendEquationSeparate(B[n],B[s]),p=n,g=s),r===m&&i===f&&a===x&&o===v||(e.blendFuncSeparate(V[r],V[i],V[a],V[o]),m=r,f=i,x=a,v=o),!1!==l.equals(y)&&c===b||(e.blendColor(l.r,l.g,l.b,c),y.copy(l),b=c),h=t,w=!1;else if(t!==h||d!==w){if(p===Cw&&g===Cw||(e.blendEquation(e.FUNC_ADD),p=Cw,g=Cw),d)switch(t){case Nw:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case jw:e.blendFunc(e.ONE,e.ONE);break;case Aw:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case Mw:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case Nw:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case jw:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case Aw:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case Mw:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}m=null,f=null,x=null,v=null,y.set(0,0,0),b=0,h=t,w=d}}else!0===u&&(z(e.BLEND),u=!1)}function W(t){_!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),_=t)}function G(t){t!==hw?(U(e.CULL_FACE),t!==S&&(t===pw?e.cullFace(e.BACK):t===mw?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):z(e.CULL_FACE),S=t}function q(t,n,r){t?(U(e.POLYGON_OFFSET_FILL),j===n&&A===r||(e.polygonOffset(n,r),j=n,A=r)):z(e.POLYGON_OFFSET_FILL)}return{buffers:{color:t,depth:n,stencil:r},enable:U,disable:z,bindFramebuffer:function(t,n){return o[t]!==n&&(e.bindFramebuffer(t,n),o[t]=n,t===e.DRAW_FRAMEBUFFER&&(o[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(o[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=c,i=!1;if(t){r=l.get(n),void 0===r&&(r=[],l.set(n,r));const s=t.textures;if(r.length!==s.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=s.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=s.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:H,setMaterial:function(i,s){i.side===_w?z(e.CULL_FACE):U(e.CULL_FACE);let a=i.side===ww;s&&(a=!a),W(a),i.blending===Nw&&!1===i.transparent?H(Sw):H(i.blending,i.blendEquation,i.blendSrc,i.blendDst,i.blendEquationAlpha,i.blendSrcAlpha,i.blendDstAlpha,i.blendColor,i.blendAlpha,i.premultipliedAlpha),n.setFunc(i.depthFunc),n.setTest(i.depthTest),n.setMask(i.depthWrite),t.setMask(i.colorWrite);const o=i.stencilWrite;r.setTest(o),o&&(r.setMask(i.stencilWriteMask),r.setFunc(i.stencilFunc,i.stencilRef,i.stencilFuncMask),r.setOp(i.stencilFail,i.stencilZFail,i.stencilZPass)),q(i.polygonOffset,i.polygonOffsetFactor,i.polygonOffsetUnits),!0===i.alphaToCoverage?U(e.SAMPLE_ALPHA_TO_COVERAGE):z(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:W,setCullFace:G,setLineWidth:function(t){t!==N&&(E&&e.lineWidth(t),N=t)},setPolygonOffset:q,setScissorTest:function(t){t?U(e.SCISSOR_TEST):z(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+M-1),T!==t&&(e.activeTexture(t),T=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===T?e.TEXTURE0+M-1:T);let i=P[r];void 0===i&&(i={type:void 0,texture:void 0},P[r]=i),i.type===t&&i.texture===n||(T!==r&&(e.activeTexture(r),T=r),e.bindTexture(t,n||D[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=P[T];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);i.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),i.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(nU){console.error("THREE.WebGLState:",nU)}},scissor:function(t){!1===I.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),I.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),a={},T=null,P={},o={},l=new WeakMap,c=[],d=null,u=!1,h=null,p=null,m=null,f=null,g=null,x=null,v=null,y=new nM(0,0,0),b=0,w=!1,_=null,S=null,N=null,j=null,A=null,I.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),t.reset(),n.reset(),r.reset()}}}function qk(e,t,n,r,i,s,a){const o=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new sj,d=new WeakMap;let u;const h=new WeakMap;let p=!1;try{p="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(z){}function m(e,t){return p?new OffscreenCanvas(e,t):uj("canvas")}function f(e,t,n){let r=1;const i=U(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*i.width),s=Math.floor(r*i.height);void 0===u&&(u=m(n,s));const a=t?m(n,s):u;a.width=n,a.height=s;return a.getContext("2d").drawImage(e,0,0,n,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+s+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),e}return e}function g(e){return e.generateMipmaps&&e.minFilter!==j_&&e.minFilter!==k_}function x(t){e.generateMipmap(t)}function v(n,r,i,s){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=r;if(r===e.RED&&(i===e.FLOAT&&(o=e.R32F),i===e.HALF_FLOAT&&(o=e.R16F),i===e.UNSIGNED_BYTE&&(o=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.R8UI),i===e.UNSIGNED_SHORT&&(o=e.R16UI),i===e.UNSIGNED_INT&&(o=e.R32UI),i===e.BYTE&&(o=e.R8I),i===e.SHORT&&(o=e.R16I),i===e.INT&&(o=e.R32I)),r===e.RG&&(i===e.FLOAT&&(o=e.RG32F),i===e.HALF_FLOAT&&(o=e.RG16F),i===e.UNSIGNED_BYTE&&(o=e.RG8)),r===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RG8UI),i===e.UNSIGNED_SHORT&&(o=e.RG16UI),i===e.UNSIGNED_INT&&(o=e.RG32UI),i===e.BYTE&&(o=e.RG8I),i===e.SHORT&&(o=e.RG16I),i===e.INT&&(o=e.RG32I)),r===e.RGB&&i===e.UNSIGNED_INT_5_9_9_9_REV&&(o=e.RGB9_E5),r===e.RGBA){const t=a?aN:yj.getTransfer(s);i===e.FLOAT&&(o=e.RGBA32F),i===e.HALF_FLOAT&&(o=e.RGBA16F),i===e.UNSIGNED_BYTE&&(o=t===oN?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(o=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(o=e.RGB5_A1)}return o!==e.R16F&&o!==e.R32F&&o!==e.RG16F&&o!==e.RG32F&&o!==e.RGBA16F&&o!==e.RGBA32F||t.get("EXT_color_buffer_float"),o}function y(e,t){return!0===g(e)||e.isFramebufferTexture&&e.minFilter!==j_&&e.minFilter!==k_?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function b(e){const t=e.target;t.removeEventListener("dispose",b),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=h.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&_(e),0===Object.keys(i).length&&h.delete(n)}r.remove(e)}(t),t.isVideoTexture&&d.delete(t)}function w(t){const n=t.target;n.removeEventListener("dispose",w),function(t){const n=r.get(t);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let r=0;r<6;r++){if(Array.isArray(n.__webglFramebuffer[r]))for(let t=0;t<n.__webglFramebuffer[r].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[r][t]);else e.deleteFramebuffer(n.__webglFramebuffer[r]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[r])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const i=t.textures;for(let s=0,o=i.length;s<o;s++){const t=r.get(i[s]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),a.memory.textures--),r.remove(i[s])}r.remove(t)}(n)}function _(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete h.get(i)[n.__cacheKey],a.memory.textures--}let S=0;function N(t,i){const s=r.get(t);if(t.isVideoTexture&&function(e){const t=a.render.frame;d.get(e)!==t&&(d.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void k(s,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+i)}const j={[__]:e.REPEAT,[S_]:e.CLAMP_TO_EDGE,[N_]:e.MIRRORED_REPEAT},A={[j_]:e.NEAREST,[A_]:e.NEAREST_MIPMAP_NEAREST,[E_]:e.NEAREST_MIPMAP_LINEAR,[k_]:e.LINEAR,[T_]:e.LINEAR_MIPMAP_NEAREST,[L_]:e.LINEAR_MIPMAP_LINEAR},M={[AN]:e.NEVER,[LN]:e.ALWAYS,[MN]:e.LESS,[CN]:e.LEQUAL,[EN]:e.EQUAL,[PN]:e.GEQUAL,[kN]:e.GREATER,[TN]:e.NOTEQUAL};function E(n,s){if(s.type!==B_||!1!==t.has("OES_texture_float_linear")||s.magFilter!==k_&&s.magFilter!==T_&&s.magFilter!==E_&&s.magFilter!==L_&&s.minFilter!==k_&&s.minFilter!==T_&&s.minFilter!==E_&&s.minFilter!==L_||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,j[s.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,j[s.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,j[s.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,A[s.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,A[s.minFilter]),s.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,M[s.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(s.magFilter===j_)return;if(s.minFilter!==E_&&s.minFilter!==L_)return;if(s.type===B_&&!1===t.has("OES_texture_float_linear"))return;if(s.anisotropy>1||r.get(s).__currentAnisotropy){const a=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),r.get(s).__currentAnisotropy=s.anisotropy}}}function C(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",b));const i=n.source;let s=h.get(i);void 0===s&&(s={},h.set(i,s));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===s[o]&&(s[o]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,r=!0),s[o].usedTimes++;const i=s[t.__cacheKey];void 0!==i&&(s[t.__cacheKey].usedTimes--,0===i.usedTimes&&_(n)),t.__cacheKey=o,t.__webglTexture=s[o].texture}return r}function k(t,a,o){let l=e.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),a.isData3DTexture&&(l=e.TEXTURE_3D);const c=C(t,a),d=a.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+o);const u=r.get(d);if(d.version!==u.__version||!0===c){n.activeTexture(e.TEXTURE0+o);const t=yj.getPrimaries(yj.workingColorSpace),r=a.colorSpace===tN?null:yj.getPrimaries(a.colorSpace),h=a.colorSpace===tN||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);let p=f(a.image,!1,i.maxTextureSize);p=D(a,p);const m=s.convert(a.format,a.colorSpace),b=s.convert(a.type);let w,_=v(a.internalFormat,m,b,a.colorSpace,a.isVideoTexture);E(l,a);const S=a.mipmaps,N=!0!==a.isVideoTexture,j=void 0===u.__version||!0===c,A=d.dataReady,M=y(a,p);if(a.isDepthTexture)_=e.DEPTH_COMPONENT16,a.type===B_?_=e.DEPTH_COMPONENT32F:a.type===z_?_=e.DEPTH_COMPONENT24:a.type===G_&&(_=e.DEPTH24_STENCIL8),j&&(N?n.texStorage2D(e.TEXTURE_2D,1,_,p.width,p.height):n.texImage2D(e.TEXTURE_2D,0,_,p.width,p.height,0,m,b,null));else if(a.isDataTexture)if(S.length>0){N&&j&&n.texStorage2D(e.TEXTURE_2D,M,_,S[0].width,S[0].height);for(let t=0,r=S.length;t<r;t++)w=S[t],N?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,w.width,w.height,m,b,w.data):n.texImage2D(e.TEXTURE_2D,t,_,w.width,w.height,0,m,b,w.data);a.generateMipmaps=!1}else N?(j&&n.texStorage2D(e.TEXTURE_2D,M,_,p.width,p.height),A&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p.width,p.height,m,b,p.data)):n.texImage2D(e.TEXTURE_2D,0,_,p.width,p.height,0,m,b,p.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){N&&j&&n.texStorage3D(e.TEXTURE_2D_ARRAY,M,_,S[0].width,S[0].height,p.depth);for(let t=0,r=S.length;t<r;t++)w=S[t],a.format!==Z_?null!==m?N?A&&n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,w.width,w.height,p.depth,m,w.data,0,0):n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,_,w.width,w.height,p.depth,0,w.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):N?A&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,w.width,w.height,p.depth,m,b,w.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,_,w.width,w.height,p.depth,0,m,b,w.data)}else{N&&j&&n.texStorage2D(e.TEXTURE_2D,M,_,S[0].width,S[0].height);for(let t=0,r=S.length;t<r;t++)w=S[t],a.format!==Z_?null!==m?N?A&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,w.width,w.height,m,w.data):n.compressedTexImage2D(e.TEXTURE_2D,t,_,w.width,w.height,0,w.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):N?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,w.width,w.height,m,b,w.data):n.texImage2D(e.TEXTURE_2D,t,_,w.width,w.height,0,m,b,w.data)}else if(a.isDataArrayTexture)N?(j&&n.texStorage3D(e.TEXTURE_2D_ARRAY,M,_,p.width,p.height,p.depth),A&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,m,b,p.data)):n.texImage3D(e.TEXTURE_2D_ARRAY,0,_,p.width,p.height,p.depth,0,m,b,p.data);else if(a.isData3DTexture)N?(j&&n.texStorage3D(e.TEXTURE_3D,M,_,p.width,p.height,p.depth),A&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,m,b,p.data)):n.texImage3D(e.TEXTURE_3D,0,_,p.width,p.height,p.depth,0,m,b,p.data);else if(a.isFramebufferTexture){if(j)if(N)n.texStorage2D(e.TEXTURE_2D,M,_,p.width,p.height);else{let t=p.width,r=p.height;for(let i=0;i<M;i++)n.texImage2D(e.TEXTURE_2D,i,_,t,r,0,m,b,null),t>>=1,r>>=1}}else if(S.length>0){if(N&&j){const t=U(S[0]);n.texStorage2D(e.TEXTURE_2D,M,_,t.width,t.height)}for(let t=0,r=S.length;t<r;t++)w=S[t],N?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,m,b,w):n.texImage2D(e.TEXTURE_2D,t,_,m,b,w);a.generateMipmaps=!1}else if(N){if(j){const t=U(p);n.texStorage2D(e.TEXTURE_2D,M,_,t.width,t.height)}A&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,m,b,p)}else n.texImage2D(e.TEXTURE_2D,0,_,m,b,p);g(a)&&x(l),u.__version=d.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}function T(t,i,a,l,c,d){const u=s.convert(a.format,a.colorSpace),h=s.convert(a.type),p=v(a.internalFormat,u,h,a.colorSpace);if(!r.get(i).__hasExternalTextures){const t=Math.max(1,i.width>>d),r=Math.max(1,i.height>>d);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,d,p,t,r,i.depth,0,u,h,null):n.texImage2D(c,d,p,t,r,0,u,h,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),O(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,r.get(a).__webglTexture,0,F(i)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,r.get(a).__webglTexture,d),n.bindFramebuffer(e.FRAMEBUFFER,null)}function P(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){let i=e.DEPTH_COMPONENT24;if(r||O(n)){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===B_?i=e.DEPTH_COMPONENT32F:t.type===z_&&(i=e.DEPTH_COMPONENT24));const r=F(n);O(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,r,i,n.width,n.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,r,i,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,i,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){const i=F(n);r&&!1===O(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,i,e.DEPTH24_STENCIL8,n.width,n.height):O(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,i,e.DEPTH24_STENCIL8,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{const t=n.textures;for(let i=0;i<t.length;i++){const a=t[i],l=s.convert(a.format,a.colorSpace),c=s.convert(a.type),d=v(a.internalFormat,l,c,a.colorSpace),u=F(n);r&&!1===O(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,u,d,n.width,n.height):O(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,u,d,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,d,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function L(t){const i=r.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),N(i.depthTexture,0);const s=r.get(i.depthTexture).__webglTexture,a=F(i);if(i.depthTexture.format===Q_)O(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,a):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(i.depthTexture.format!==$_)throw new Error("Unknown depthTexture format");O(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,a):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}(i.__webglFramebuffer,t)}else if(s){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=e.createRenderbuffer(),P(i.__webglDepthbuffer[r],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),P(i.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}const R=[],I=[];function F(e){return Math.min(i.maxSamples,e.samples)}function O(e){const n=r.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function D(e,t){const n=e.colorSpace,r=e.format,i=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==rN&&n!==tN&&(yj.getTransfer(n)===oN?r===Z_&&i===I_||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function U(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!==typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=S;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),S+=1,e},this.resetTextureUnits=function(){S=0},this.setTexture2D=N,this.setTexture2DArray=function(t,i){const s=r.get(t);t.version>0&&s.__version!==t.version?k(s,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){const s=r.get(t);t.version>0&&s.__version!==t.version?k(s,t,i):n.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,a){const o=r.get(t);t.version>0&&o.__version!==t.version?function(t,a,o){if(6!==a.image.length)return;const l=C(t,a),c=a.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);const d=r.get(c);if(c.version!==d.__version||!0===l){n.activeTexture(e.TEXTURE0+o);const t=yj.getPrimaries(yj.workingColorSpace),r=a.colorSpace===tN?null:yj.getPrimaries(a.colorSpace),u=a.colorSpace===tN||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,u);const h=a.isCompressedTexture||a.image[0].isCompressedTexture,p=a.image[0]&&a.image[0].isDataTexture,m=[];for(let e=0;e<6;e++)m[e]=h||p?p?a.image[e].image:a.image[e]:f(a.image[e],!0,i.maxCubemapSize),m[e]=D(a,m[e]);const b=m[0],w=s.convert(a.format,a.colorSpace),_=s.convert(a.type),S=v(a.internalFormat,w,_,a.colorSpace),N=!0!==a.isVideoTexture,j=void 0===d.__version||!0===l,A=c.dataReady;let M,C=y(a,b);if(E(e.TEXTURE_CUBE_MAP,a),h){N&&j&&n.texStorage2D(e.TEXTURE_CUBE_MAP,C,S,b.width,b.height);for(let t=0;t<6;t++){M=m[t].mipmaps;for(let r=0;r<M.length;r++){const i=M[r];a.format!==Z_?null!==w?N?A&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,w,i.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,S,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):N?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,w,_,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,S,i.width,i.height,0,w,_,i.data)}}}else{if(M=a.mipmaps,N&&j){M.length>0&&C++;const t=U(m[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,C,S,t.width,t.height)}for(let t=0;t<6;t++)if(p){N?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,m[t].width,m[t].height,w,_,m[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,S,m[t].width,m[t].height,0,w,_,m[t].data);for(let r=0;r<M.length;r++){const i=M[r].image[t].image;N?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,i.width,i.height,w,_,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,S,i.width,i.height,0,w,_,i.data)}}else{N?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,w,_,m[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,S,w,_,m[t]);for(let r=0;r<M.length;r++){const i=M[r];N?A&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,w,_,i.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,S,w,_,i.image[t])}}}g(a)&&x(e.TEXTURE_CUBE_MAP),d.__version=c.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}(o,t,a):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+a)},this.rebindTextures=function(t,n,i){const s=r.get(t);void 0!==n&&T(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&L(t)},this.setupRenderTarget=function(t){const i=t.texture,o=r.get(t),l=r.get(i);t.addEventListener("dispose",w);const c=t.textures,d=!0===t.isWebGLCubeRenderTarget,u=c.length>1;if(u||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=i.version,a.memory.textures++),d){o.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer[t]=[];for(let n=0;n<i.mipmaps.length;n++)o.__webglFramebuffer[t][n]=e.createFramebuffer()}else o.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(u)for(let t=0,n=c.length;t<n;t++){const n=r.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),a.memory.textures++)}if(t.samples>0&&!1===O(t)){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];o.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const i=s.convert(r.format,r.colorSpace),a=s.convert(r.type),l=v(r.internalFormat,i,a,r.colorSpace,!0===t.isXRRenderTarget),d=F(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,d,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,o.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),P(o.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(d){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),E(e.TEXTURE_CUBE_MAP,i);for(let n=0;n<6;n++)if(i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)T(o.__webglFramebuffer[n][r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else T(o.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(i)&&x(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(u){for(let i=0,s=c.length;i<s;i++){const s=c[i],a=r.get(s);n.bindTexture(e.TEXTURE_2D,a.__webglTexture),E(e.TEXTURE_2D,s),T(o.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0+i,e.TEXTURE_2D,0),g(s)&&x(e.TEXTURE_2D)}n.unbindTexture()}else{let r=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(r,l.__webglTexture),E(r,i),i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)T(o.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,r,n);else T(o.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,r,0);g(i)&&x(r),n.unbindTexture()}t.depthBuffer&&L(t)},this.updateRenderTargetMipmap=function(t){const i=t.textures;for(let s=0,a=i.length;s<a;s++){const a=i[s];if(g(a)){const i=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,s=r.get(a).__webglTexture;n.bindTexture(i,s),x(i),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===O(t)){const i=t.textures,s=t.width,a=t.height;let o=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,d=r.get(t),u=i.length>1;if(u)for(let t=0;t<i.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,d.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglFramebuffer);for(let n=0;n<i.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),u){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,d.__webglColorRenderbuffer[n]);const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,a,0,0,s,a,o,e.NEAREST),!0===l&&(R.length=0,I.length=0,R.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(R.push(c),I.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,I)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,R))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),u)for(let t=0;t<i.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,d.__webglColorRenderbuffer[t]);const s=r.get(i[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=L,this.setupFrameBufferTexture=T,this.useMultisampledRTT=O}function Xk(e,t){return{convert:function(n){let r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tN;const s=yj.getTransfer(i);if(n===I_)return e.UNSIGNED_BYTE;if(n===H_)return e.UNSIGNED_SHORT_4_4_4_4;if(n===W_)return e.UNSIGNED_SHORT_5_5_5_1;if(n===q_)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===F_)return e.BYTE;if(n===O_)return e.SHORT;if(n===D_)return e.UNSIGNED_SHORT;if(n===U_)return e.INT;if(n===z_)return e.UNSIGNED_INT;if(n===B_)return e.FLOAT;if(n===V_)return e.HALF_FLOAT;if(n===X_)return e.ALPHA;if(n===Y_)return e.RGB;if(n===Z_)return e.RGBA;if(n===J_)return e.LUMINANCE;if(n===K_)return e.LUMINANCE_ALPHA;if(n===Q_)return e.DEPTH_COMPONENT;if(n===$_)return e.DEPTH_STENCIL;if(n===eS)return e.RED;if(n===tS)return e.RED_INTEGER;if(n===nS)return e.RG;if(n===rS)return e.RG_INTEGER;if(n===iS)return e.RGBA_INTEGER;if(n===sS||n===aS||n===oS||n===lS)if(s===oN){if(r=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(n===sS)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===aS)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===oS)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===lS)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===sS)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===aS)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===oS)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===lS)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===cS||n===dS||n===uS||n===hS){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(n===cS)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===dS)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===uS)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===hS)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===pS||n===mS||n===fS){if(r=t.get("WEBGL_compressed_texture_etc"),null===r)return null;if(n===pS||n===mS)return s===oN?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===fS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(n===gS||n===xS||n===vS||n===yS||n===bS||n===wS||n===_S||n===SS||n===NS||n===jS||n===AS||n===MS||n===ES||n===CS){if(r=t.get("WEBGL_compressed_texture_astc"),null===r)return null;if(n===gS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===xS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===vS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===yS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===bS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===wS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===_S)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===SS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===NS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===jS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===AS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===MS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===ES)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===CS)return s===oN?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===kS||n===TS||n===PS){if(r=t.get("EXT_texture_compression_bptc"),null===r)return null;if(n===kS)return s===oN?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===TS)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===PS)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===LS||n===RS||n===IS||n===FS){if(r=t.get("EXT_texture_compression_rgtc"),null===r)return null;if(n===kS)return r.COMPRESSED_RED_RGTC1_EXT;if(n===RS)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===IS)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===FS)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===G_?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class Yk extends oE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.cameras=e}}class Zk extends zA{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Jk={type:"move"};class Kk{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Zk,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Zk,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Oj,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Oj),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Zk,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Oj,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Oj),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const s of e.hand.values()){const e=t.getJointPose(s,n),r=this._getHandJoint(l,s);null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=e.radius),r.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],a=r.position.distanceTo(i.position),o=.02,c=.005;l.inputState.pinching&&a>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Jk)))}return null!==a&&(a.visible=null!==r),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Zk;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Qk{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(null===this.texture){const r=new Ej;e.properties.get(r).__webglTexture=t.texture,t.depthNear==n.depthNear&&t.depthFar==n.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}render(e,t){if(null!==this.texture){if(null===this.mesh){const e=t.cameras[0].viewport,n=new nE({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:e.z},depthHeight:{value:e.w}}});this.mesh=new ZM(new wE(20,20),n)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class $k extends XN{constructor(e,t){super();const n=this;let r=null,i=1,s=null,a="local-floor",o=1,l=null,c=null,d=null,u=null,h=null,p=null;const m=new Qk,f=t.getContextAttributes();let g=null,x=null;const v=[],y=[],b=new sj;let w=null;const _=new oE;_.layers.enable(1),_.viewport=new Cj;const S=new oE;S.layers.enable(2),S.viewport=new Cj;const N=[_,S],j=new Yk;j.layers.enable(1),j.layers.enable(2);let A=null,M=null;function E(e){const t=y.indexOf(e.inputSource);if(-1===t)return;const n=v[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function C(){r.removeEventListener("select",E),r.removeEventListener("selectstart",E),r.removeEventListener("selectend",E),r.removeEventListener("squeeze",E),r.removeEventListener("squeezestart",E),r.removeEventListener("squeezeend",E),r.removeEventListener("end",C),r.removeEventListener("inputsourceschange",k);for(let e=0;e<v.length;e++){const t=y[e];null!==t&&(y[e]=null,v[e].disconnect(t))}A=null,M=null,m.reset(),e.setRenderTarget(g),h=null,u=null,d=null,r=null,x=null,I.stop(),n.isPresenting=!1,e.setPixelRatio(w),e.setSize(b.width,b.height,!1),n.dispatchEvent({type:"sessionend"})}function k(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=y.indexOf(n);r>=0&&(y[r]=null,v[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=y.indexOf(n);if(-1===r){for(let e=0;e<v.length;e++){if(e>=y.length){y.push(n),r=e;break}if(null===y[e]){y[e]=n,r=e;break}}if(-1===r)break}const i=v[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=v[e];return void 0===t&&(t=new Kk,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new Kk,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new Kk,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(c){if(r=c,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",E),r.addEventListener("selectstart",E),r.addEventListener("selectend",E),r.addEventListener("squeeze",E),r.addEventListener("squeezestart",E),r.addEventListener("squeezeend",E),r.addEventListener("end",C),r.addEventListener("inputsourceschange",k),!0!==f.xrCompatible&&await t.makeXRCompatible(),w=e.getPixelRatio(),e.getSize(b),void 0===r.renderState.layers){const n={antialias:f.antialias,alpha:!0,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),x=new Tj(h.framebufferWidth,h.framebufferHeight,{format:Z_,type:I_,colorSpace:e.outputColorSpace,stencilBuffer:f.stencil})}else{let n=null,s=null,a=null;f.depth&&(a=f.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=f.stencil?$_:Q_,s=f.stencil?G_:z_);const o={colorFormat:t.RGBA8,depthFormat:a,scaleFactor:i};d=new XRWebGLBinding(r,t),u=d.createProjectionLayer(o),r.updateRenderState({layers:[u]}),e.setPixelRatio(1),e.setSize(u.textureWidth,u.textureHeight,!1),x=new Tj(u.textureWidth,u.textureHeight,{format:Z_,type:I_,depthTexture:new iC(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,colorSpace:e.outputColorSpace,samples:f.antialias?4:0,resolveDepthBuffer:!1===u.ignoreDepthValues})}x.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await r.requestReferenceSpace(a),I.setContext(r),I.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const T=new Oj,P=new Oj;function L(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;null!==m.texture&&(e.near=m.depthNear,e.far=m.depthFar),j.near=S.near=_.near=e.near,j.far=S.far=_.far=e.far,A===j.near&&M===j.far||(r.updateRenderState({depthNear:j.near,depthFar:j.far}),A=j.near,M=j.far,_.near=A,_.far=M,S.near=A,S.far=M,_.updateProjectionMatrix(),S.updateProjectionMatrix(),e.updateProjectionMatrix());const t=e.parent,n=j.cameras;L(j,t);for(let r=0;r<n.length;r++)L(n[r],t);2===n.length?function(e,t,n){T.setFromMatrixPosition(t.matrixWorld),P.setFromMatrixPosition(n.matrixWorld);const r=T.distanceTo(P),i=t.projectionMatrix.elements,s=n.projectionMatrix.elements,a=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],d=(i[8]-1)/i[0],u=(s[8]+1)/s[0],h=a*d,p=a*u,m=r/(-d+u),f=m*-d;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(m),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=a+m,x=o+m,v=h-f,y=p+(r-f),b=l*o/x*g,w=c*o/x*g;e.projectionMatrix.makePerspective(v,y,b,w,g,x),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(j,_,S):j.projectionMatrix.copy(_.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*KN*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,j,t)},this.getCamera=function(){return j},this.getFoveation=function(){if(null!==u||null!==h)return o},this.setFoveation=function(e){o=e,null!==u&&(u.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==m.texture};let R=null;const I=new yE;I.setAnimationLoop(function(t,i){if(c=i.getViewerPose(l||s),p=i,null!==c){const t=c.views;null!==h&&(e.setRenderTargetFramebuffer(x,h.framebuffer),e.setRenderTarget(x));let n=!1;t.length!==j.cameras.length&&(j.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const i=t[r];let s=null;if(null!==h)s=h.getViewport(i);else{const t=d.getViewSubImage(u,i);s=t.viewport,0===r&&(e.setRenderTargetTextures(x,t.colorTexture,u.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(x))}let a=N[r];void 0===a&&(a=new oE,a.layers.enable(r),a.viewport=new Cj,N[r]=a),a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(i.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===r&&(j.matrix.copy(a.matrix),j.matrix.decompose(j.position,j.quaternion,j.scale)),!0===n&&j.cameras.push(a)}const i=r.enabledFeatures;if(i&&i.includes("depth-sensing")){const n=d.getDepthInformation(t[0]);n&&n.isValid&&n.texture&&m.init(e,n,r.renderState)}}for(let e=0;e<v.length;e++){const t=y[e],n=v[e];null!==t&&void 0!==n&&n.update(t,i,l||s)}m.render(e,j),R&&R(t,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),p=null}),this.setAnimationLoop=function(e){R=e},this.dispose=function(){}}}const eT=new SA,tT=new pA;function nT(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(r,i){r.opacity.value=i.opacity,i.color&&r.diffuse.value.copy(i.color),i.emissive&&r.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(r.map.value=i.map,n(i.map,r.mapTransform)),i.alphaMap&&(r.alphaMap.value=i.alphaMap,n(i.alphaMap,r.alphaMapTransform)),i.bumpMap&&(r.bumpMap.value=i.bumpMap,n(i.bumpMap,r.bumpMapTransform),r.bumpScale.value=i.bumpScale,i.side===ww&&(r.bumpScale.value*=-1)),i.normalMap&&(r.normalMap.value=i.normalMap,n(i.normalMap,r.normalMapTransform),r.normalScale.value.copy(i.normalScale),i.side===ww&&r.normalScale.value.negate()),i.displacementMap&&(r.displacementMap.value=i.displacementMap,n(i.displacementMap,r.displacementMapTransform),r.displacementScale.value=i.displacementScale,r.displacementBias.value=i.displacementBias),i.emissiveMap&&(r.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,r.emissiveMapTransform)),i.specularMap&&(r.specularMap.value=i.specularMap,n(i.specularMap,r.specularMapTransform)),i.alphaTest>0&&(r.alphaTest.value=i.alphaTest);const s=t.get(i),a=s.envMap,o=s.envMapRotation;if(a&&(r.envMap.value=a,eT.copy(o),eT.x*=-1,eT.y*=-1,eT.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(eT.y*=-1,eT.z*=-1),r.envMapRotation.value.setFromMatrix4(tT.makeRotationFromEuler(eT)),r.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,r.reflectivity.value=i.reflectivity,r.ior.value=i.ior,r.refractionRatio.value=i.refractionRatio),i.lightMap){r.lightMap.value=i.lightMap;const t=!0===e._useLegacyLights?Math.PI:1;r.lightMapIntensity.value=i.lightMapIntensity*t,n(i.lightMap,r.lightMapTransform)}i.aoMap&&(r.aoMap.value=i.aoMap,r.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,r.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,eE(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,s,a,o){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===ww&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,o)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,s,a):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function rT(e,t,n,r){let i={},s={},a=[];const o=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,r){const i=e.value,s=t+"_"+n;if(void 0===r[s])return r[s]="number"===typeof i||"boolean"===typeof i?i:i.clone(),!0;{const e=r[s];if("number"===typeof i||"boolean"===typeof i){if(e!==i)return r[s]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function d(t){const n=t.target;n.removeEventListener("dispose",d);const r=a.indexOf(n.__bindingPointIndex);a.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete s[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,u){let h=i[n.id];void 0===h&&(!function(e){const t=e.uniforms;let n=0;const r=16;for(let s=0,a=t.length;s<a;s++){const e=Array.isArray(t[s])?t[s]:[t[s]];for(let t=0,i=e.length;t<i;t++){const i=e[t],s=Array.isArray(i.value)?i.value:[i.value];for(let e=0,t=s.length;e<t;e++){const t=c(s[e]),a=n%r;0!==a&&r-a<t.boundary&&(n+=r-a),i.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),i.__offset=n,n+=t.storage}}}const i=n%r;i>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),h=function(t){const n=function(){for(let e=0;e<o;e++)if(-1===a.indexOf(e))return a.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=h,n.addEventListener("dispose",d));const p=u.program;r.updateUBOMapping(n,p);const m=t.render.frame;s[n.id]!==m&&(!function(t){const n=i[t.id],r=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let i=0,a=r.length;i<a;i++){const t=Array.isArray(r[i])?r[i]:[r[i]];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(!0===l(r,i,n,s)){const t=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let s=0;s<n.length;s++){const a=n[s],o=c(a);"number"===typeof a||"boolean"===typeof a?(r.__data[0]=a,e.bufferSubData(e.UNIFORM_BUFFER,t+i,r.__data)):a.isMatrix3?(r.__data[0]=a.elements[0],r.__data[1]=a.elements[1],r.__data[2]=a.elements[2],r.__data[3]=0,r.__data[4]=a.elements[3],r.__data[5]=a.elements[4],r.__data[6]=a.elements[5],r.__data[7]=0,r.__data[8]=a.elements[6],r.__data[9]=a.elements[7],r.__data[10]=a.elements[8],r.__data[11]=0):(a.toArray(r.__data,i),i+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,r.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),s[n.id]=m)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);a=[],i={},s={}}}}class iT{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:t=hj(),context:n=null,depth:r=!0,stencil:i=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:d=!1}=e;let u;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");u=n.getContextAttributes().alpha}else u=s;const h=new Uint32Array(4),p=new Int32Array(4);let m=null,f=null;const g=[],x=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=nN,this._useLegacyLights=!1,this.toneMapping=a_,this.toneMappingExposure=1;const v=this;let y=!1,b=0,w=0,_=null,S=-1,N=null;const j=new Cj,A=new Cj;let M=null;const E=new nM(0);let C=0,k=t.width,T=t.height,P=1,L=null,R=null;const I=new Cj(0,0,k,T),F=new Cj(0,0,k,T);let O=!1;const D=new vE;let U=!1,z=!1;const B=new pA,V=new Oj,H={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return null===_?P:1}let G,q,X,Y,Z,J,K,Q,$,ee,te,ne,re,ie,se,ae,oe,le,ce,de,ue,he,pe,me,fe=n;function ge(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:r,stencil:i,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(cw)),t.addEventListener("webglcontextlost",ye,!1),t.addEventListener("webglcontextrestored",be,!1),t.addEventListener("webglcontextcreationerror",we,!1),null===fe){const t="webgl2";if(fe=ge(t,e),null===fe)throw ge(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(nU){throw console.error("THREE.WebGLRenderer: "+nU.message),nU}function xe(){G=new QE(fe),G.init(),he=new Xk(fe,G),q=new TE(fe,G,e,he),X=new Gk(fe),Y=new tC(fe),Z=new Tk,J=new qk(fe,G,X,Z,q,he,Y),K=new LE(v),Q=new KE(v),$=new bE(fe),pe=new CE(fe,$),ee=new $E(fe,$,Y,pe),te=new rC(fe,ee,$,Y),ce=new nC(fe,q,J),ae=new PE(Z),ne=new kk(v,K,Q,G,q,pe,ae),re=new nT(v,Z),ie=new Ik,se=new Bk(G),le=new EE(v,K,Q,X,te,u,o),oe=new Wk(v,te,q),me=new rT(fe,Y,q,X),de=new kE(fe,G,Y),ue=new eC(fe,G,Y),Y.programs=ne.programs,v.capabilities=q,v.extensions=G,v.properties=Z,v.renderLists=ie,v.shadowMap=oe,v.state=X,v.info=Y}xe();const ve=new $k(v,fe);function ye(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function be(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const e=Y.autoReset,t=oe.enabled,n=oe.autoUpdate,r=oe.needsUpdate,i=oe.type;xe(),Y.autoReset=e,oe.enabled=t,oe.autoUpdate=n,oe.needsUpdate=r,oe.type=i}function we(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function _e(e){const t=e.target;t.removeEventListener("dispose",_e),function(e){(function(e){const t=Z.get(e).programs;void 0!==t&&(t.forEach(function(e){ne.releaseProgram(e)}),e.isShaderMaterial&&ne.releaseShaderCache(e))})(e),Z.remove(e)}(t)}function Se(e,t,n){!0===e.transparent&&e.side===_w&&!1===e.forceSinglePass?(e.side=ww,e.needsUpdate=!0,Le(e,t,n),e.side=bw,e.needsUpdate=!0,Le(e,t,n),e.side=_w):Le(e,t,n)}this.xr=ve,this.getContext=function(){return fe},this.getContextAttributes=function(){return fe.getContextAttributes()},this.forceContextLoss=function(){const e=G.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=G.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(e){void 0!==e&&(P=e,this.setSize(k,T,!1))},this.getSize=function(e){return e.set(k,T)},this.setSize=function(e,n){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ve.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(k=e,T=n,t.width=Math.floor(e*P),t.height=Math.floor(n*P),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(k*P,T*P).floor()},this.setDrawingBufferSize=function(e,n,r){k=e,T=n,P=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(j)},this.getViewport=function(e){return e.copy(I)},this.setViewport=function(e,t,n,r){e.isVector4?I.set(e.x,e.y,e.z,e.w):I.set(e,t,n,r),X.viewport(j.copy(I).multiplyScalar(P).round())},this.getScissor=function(e){return e.copy(F)},this.setScissor=function(e,t,n,r){e.isVector4?F.set(e.x,e.y,e.z,e.w):F.set(e,t,n,r),X.scissor(A.copy(F).multiplyScalar(P).round())},this.getScissorTest=function(){return O},this.setScissorTest=function(e){X.setScissorTest(O=e)},this.setOpaqueSort=function(e){L=e},this.setTransparentSort=function(e){R=e},this.getClearColor=function(e){return e.copy(le.getClearColor())},this.setClearColor=function(){le.setClearColor.apply(le,arguments)},this.getClearAlpha=function(){return le.getClearAlpha()},this.setClearAlpha=function(){le.setClearAlpha.apply(le,arguments)},this.clear=function(){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let e=!1;if(null!==_){const t=_.texture.format;e=t===iS||t===rS||t===tS}if(e){const e=_.texture.type,t=e===I_||e===z_||e===D_||e===G_||e===H_||e===W_,n=le.getClearColor(),r=le.getClearAlpha(),i=n.r,s=n.g,a=n.b;t?(h[0]=i,h[1]=s,h[2]=a,h[3]=r,fe.clearBufferuiv(fe.COLOR,0,h)):(p[0]=i,p[1]=s,p[2]=a,p[3]=r,fe.clearBufferiv(fe.COLOR,0,p))}else n|=fe.COLOR_BUFFER_BIT}e&&(n|=fe.DEPTH_BUFFER_BIT),t&&(n|=fe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),fe.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ye,!1),t.removeEventListener("webglcontextrestored",be,!1),t.removeEventListener("webglcontextcreationerror",we,!1),ie.dispose(),se.dispose(),Z.dispose(),K.dispose(),Q.dispose(),te.dispose(),pe.dispose(),me.dispose(),ne.dispose(),ve.dispose(),ve.removeEventListener("sessionstart",je),ve.removeEventListener("sessionend",Ae),Me.stop()},this.renderBufferDirect=function(e,t,n,r,i,s){null===t&&(t=H);const a=i.isMesh&&i.matrixWorld.determinant()<0,o=function(e,t,n,r,i){!0!==t.isScene&&(t=H);J.resetTextureUnits();const s=t.fog,a=r.isMeshStandardMaterial?t.environment:null,o=null===_?v.outputColorSpace:!0===_.isXRRenderTarget?_.texture.colorSpace:rN,l=(r.isMeshStandardMaterial?Q:K).get(r.envMap||a),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,d=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),u=!!n.morphAttributes.position,h=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let m=a_;r.toneMapped&&(null!==_&&!0!==_.isXRRenderTarget||(m=v.toneMapping));const g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,x=void 0!==g?g.length:0,y=Z.get(r),b=f.state.lights;if(!0===U&&(!0===z||e!==N)){const t=e===N&&r.id===S;ae.setState(r,e,t)}let w=!1;r.version===y.__version?y.needsLights&&y.lightsStateVersion!==b.state.version||y.outputColorSpace!==o||i.isBatchedMesh&&!1===y.batching?w=!0:i.isBatchedMesh||!0!==y.batching?i.isInstancedMesh&&!1===y.instancing?w=!0:i.isInstancedMesh||!0!==y.instancing?i.isSkinnedMesh&&!1===y.skinning?w=!0:i.isSkinnedMesh||!0!==y.skinning?i.isInstancedMesh&&!0===y.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===y.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===y.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===y.instancingMorph&&null!==i.morphTexture||y.envMap!==l||!0===r.fog&&y.fog!==s?w=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===ae.numPlanes&&y.numIntersection===ae.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==d||y.morphTargets!==u||y.morphNormals!==h||y.morphColors!==p||y.toneMapping!==m||y.morphTargetsCount!==x)&&(w=!0):w=!0:w=!0:w=!0:w=!0:(w=!0,y.__version=r.version);let j=y.currentProgram;!0===w&&(j=Le(r,t,i));let A=!1,M=!1,E=!1;const C=j.getUniforms(),k=y.uniforms;X.useProgram(j.program)&&(A=!0,M=!0,E=!0);r.id!==S&&(S=r.id,M=!0);if(A||N!==e){C.setValue(fe,"projectionMatrix",e.projectionMatrix),C.setValue(fe,"viewMatrix",e.matrixWorldInverse);const t=C.map.cameraPosition;void 0!==t&&t.setValue(fe,V.setFromMatrixPosition(e.matrixWorld)),q.logarithmicDepthBuffer&&C.setValue(fe,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&C.setValue(fe,"isOrthographic",!0===e.isOrthographicCamera),N!==e&&(N=e,M=!0,E=!0)}if(i.isSkinnedMesh){C.setOptional(fe,i,"bindMatrix"),C.setOptional(fe,i,"bindMatrixInverse");const e=i.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),C.setValue(fe,"boneTexture",e.boneTexture,J))}i.isBatchedMesh&&(C.setOptional(fe,i,"batchingTexture"),C.setValue(fe,"batchingTexture",i._matricesTexture,J));const L=n.morphAttributes;void 0===L.position&&void 0===L.normal&&void 0===L.color||ce.update(i,n,j);(M||y.receiveShadow!==i.receiveShadow)&&(y.receiveShadow=i.receiveShadow,C.setValue(fe,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(k.envMap.value=l,k.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(k.envMapIntensity.value=t.environmentIntensity);M&&(C.setValue(fe,"toneMappingExposure",v.toneMappingExposure),y.needsLights&&(I=E,(R=k).ambientLightColor.needsUpdate=I,R.lightProbe.needsUpdate=I,R.directionalLights.needsUpdate=I,R.directionalLightShadows.needsUpdate=I,R.pointLights.needsUpdate=I,R.pointLightShadows.needsUpdate=I,R.spotLights.needsUpdate=I,R.spotLightShadows.needsUpdate=I,R.rectAreaLights.needsUpdate=I,R.hemisphereLights.needsUpdate=I),s&&!0===r.fog&&re.refreshFogUniforms(k,s),re.refreshMaterialUniforms(k,r,P,T,f.state.transmissionRenderTarget[e.id]),ck.upload(fe,Re(y),k,J));var R,I;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(ck.upload(fe,Re(y),k,J),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&C.setValue(fe,"center",i.center);if(C.setValue(fe,"modelViewMatrix",i.modelViewMatrix),C.setValue(fe,"normalMatrix",i.normalMatrix),C.setValue(fe,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];me.update(n,j),me.bind(n,j)}}return j}(e,t,n,r,i);X.setMaterial(r,a);let l=n.index,c=1;if(!0===r.wireframe){if(l=ee.getWireframeAttribute(n),void 0===l)return;c=2}const d=n.drawRange,u=n.attributes.position;let h=d.start*c,p=(d.start+d.count)*c;null!==s&&(h=Math.max(h,s.start*c),p=Math.min(p,(s.start+s.count)*c)),null!==l?(h=Math.max(h,0),p=Math.min(p,l.count)):void 0!==u&&null!==u&&(h=Math.max(h,0),p=Math.min(p,u.count));const m=p-h;if(m<0||m===1/0)return;let g;pe.setup(i,r,o,n,l);let x=de;if(null!==l&&(g=$.get(l),x=ue,x.setIndex(g)),i.isMesh)!0===r.wireframe?(X.setLineWidth(r.wireframeLinewidth*W()),x.setMode(fe.LINES)):x.setMode(fe.TRIANGLES);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),X.setLineWidth(e*W()),i.isLineSegments?x.setMode(fe.LINES):i.isLineLoop?x.setMode(fe.LINE_LOOP):x.setMode(fe.LINE_STRIP)}else i.isPoints?x.setMode(fe.POINTS):i.isSprite&&x.setMode(fe.TRIANGLES);if(i.isBatchedMesh)null!==i._multiDrawInstances?x.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances):x.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else if(i.isInstancedMesh)x.renderInstances(h,m,i.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);x.renderInstances(h,m,t)}else x.render(h,m)},this.compile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),f=se.get(n),f.init(t),x.push(f),n.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))}),e!==n&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))}),f.setupLights(v._useLegacyLights);const r=new Set;return e.traverse(function(e){const t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){const s=t[i];Se(s,n,e),r.add(s)}else Se(t,n,e),r.add(t)}),x.pop(),f=null,r},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=this.compile(e,t,n);return new Promise(t=>{function n(){r.forEach(function(e){Z.get(e).currentProgram.isReady()&&r.delete(e)}),0!==r.size?setTimeout(n,10):t(e)}null!==G.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let Ne=null;function je(){Me.stop()}function Ae(){Me.start()}const Me=new yE;function Ee(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||D.intersectsSprite(e)){r&&V.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);const t=te.update(e),i=e.material;i.visible&&m.push(e,t,i,n,V.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||D.intersectsObject(e))){const t=te.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),V.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),V.copy(t.boundingSphere.center)),V.applyMatrix4(e.matrixWorld).applyMatrix4(B)),Array.isArray(i)){const r=t.groups;for(let s=0,a=r.length;s<a;s++){const a=r[s],o=i[a.materialIndex];o&&o.visible&&m.push(e,t,o,n,V.z,a)}}else i.visible&&m.push(e,t,i,n,V.z,null)}const i=e.children;for(let s=0,a=i.length;s<a;s++)Ee(i[s],t,n,r)}function Ce(e,t,n,r){const i=e.opaque,s=e.transmissive,a=e.transparent;f.setupLightsView(n),!0===U&&ae.setGlobalState(v.clippingPlanes,n),r&&X.viewport(j.copy(r)),i.length>0&&Te(i,t,n),s.length>0&&Te(s,t,n),a.length>0&&Te(a,t,n),X.buffers.depth.setTest(!0),X.buffers.depth.setMask(!0),X.buffers.color.setMask(!0),X.setPolygonOffset(!1)}function ke(e,t,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===f.state.transmissionRenderTarget[r.id]&&(f.state.transmissionRenderTarget[r.id]=new Tj(1,1,{generateMipmaps:!0,type:G.has("EXT_color_buffer_half_float")||G.has("EXT_color_buffer_float")?V_:I_,minFilter:L_,samples:4,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const s=f.state.transmissionRenderTarget[r.id],a=r.viewport||j;s.setSize(a.z,a.w);const o=v.getRenderTarget();v.setRenderTarget(s),v.getClearColor(E),C=v.getClearAlpha(),C<1&&v.setClearColor(16777215,.5),v.clear();const l=v.toneMapping;v.toneMapping=a_;const c=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),f.setupLightsView(r),!0===U&&ae.setGlobalState(v.clippingPlanes,r),Te(e,n,r),J.updateMultisampleRenderTarget(s),J.updateRenderTargetMipmap(s),!1===G.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let i=0,s=t.length;i<s;i++){const s=t[i],a=s.object,o=s.geometry,l=s.material,c=s.group;if(l.side===_w&&a.layers.test(r.layers)){const t=l.side;l.side=ww,l.needsUpdate=!0,Pe(a,n,r,o,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(J.updateMultisampleRenderTarget(s),J.updateRenderTargetMipmap(s))}v.setRenderTarget(o),v.setClearColor(E,C),void 0!==c&&(r.viewport=c),v.toneMapping=l}function Te(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,s=e.length;i<s;i++){const s=e[i],a=s.object,o=s.geometry,l=null===r?s.material:r,c=s.group;a.layers.test(n.layers)&&Pe(a,t,n,o,l,c)}}function Pe(e,t,n,r,i,s){e.onBeforeRender(v,t,n,r,i,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(v,t,n,r,e,s),!0===i.transparent&&i.side===_w&&!1===i.forceSinglePass?(i.side=ww,i.needsUpdate=!0,v.renderBufferDirect(n,t,r,i,e,s),i.side=bw,i.needsUpdate=!0,v.renderBufferDirect(n,t,r,i,e,s),i.side=_w):v.renderBufferDirect(n,t,r,i,e,s),e.onAfterRender(v,t,n,r,i,s)}function Le(e,t,n){!0!==t.isScene&&(t=H);const r=Z.get(e),i=f.state.lights,s=f.state.shadowsArray,a=i.state.version,o=ne.getParameters(e,i.state,s,t,n),l=ne.getProgramCacheKey(o);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?Q:K).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",_e),c=new Map,r.programs=c);let d=c.get(l);if(void 0!==d){if(r.currentProgram===d&&r.lightsStateVersion===a)return Ie(e,o),d}else o.uniforms=ne.getUniforms(e),e.onBuild(n,o,v),e.onBeforeCompile(o,v),d=ne.acquireProgram(o,l),c.set(l,d),r.uniforms=o.uniforms;const u=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(u.clippingPlanes=ae.uniform),Ie(e,o),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=a,r.needsLights&&(u.ambientLightColor.value=i.state.ambient,u.lightProbe.value=i.state.probe,u.directionalLights.value=i.state.directional,u.directionalLightShadows.value=i.state.directionalShadow,u.spotLights.value=i.state.spot,u.spotLightShadows.value=i.state.spotShadow,u.rectAreaLights.value=i.state.rectArea,u.ltc_1.value=i.state.rectAreaLTC1,u.ltc_2.value=i.state.rectAreaLTC2,u.pointLights.value=i.state.point,u.pointLightShadows.value=i.state.pointShadow,u.hemisphereLights.value=i.state.hemi,u.directionalShadowMap.value=i.state.directionalShadowMap,u.directionalShadowMatrix.value=i.state.directionalShadowMatrix,u.spotShadowMap.value=i.state.spotShadowMap,u.spotLightMatrix.value=i.state.spotLightMatrix,u.spotLightMap.value=i.state.spotLightMap,u.pointShadowMap.value=i.state.pointShadowMap,u.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=d,r.uniformsList=null,d}function Re(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=ck.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function Ie(e,t){const n=Z.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Me.setAnimationLoop(function(e){Ne&&Ne(e)}),"undefined"!==typeof self&&Me.setContext(self),this.setAnimationLoop=function(e){Ne=e,ve.setAnimationLoop(e),null===e?Me.stop():Me.start()},ve.addEventListener("sessionstart",je),ve.addEventListener("sessionend",Ae),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===y)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===ve.enabled&&!0===ve.isPresenting&&(!0===ve.cameraAutoUpdate&&ve.updateCamera(t),t=ve.getCamera()),!0===e.isScene&&e.onBeforeRender(v,e,t,_),f=se.get(e,x.length),f.init(t),x.push(f),B.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),D.setFromProjectionMatrix(B),z=this.localClippingEnabled,U=ae.init(this.clippingPlanes,z),m=ie.get(e,g.length),m.init(),g.push(m),Ee(e,t,0,v.sortObjects),m.finish(),!0===v.sortObjects&&m.sort(L,R);const n=!1===ve.enabled||!1===ve.isPresenting||!1===ve.hasDepthSensing();n&&le.addToRenderList(m,e),this.info.render.frame++,!0===U&&ae.beginShadows();const r=f.state.shadowsArray;oe.render(r,e,t),!0===U&&ae.endShadows(),!0===this.info.autoReset&&this.info.reset();const i=m.opaque,s=m.transmissive;if(f.setupLights(v._useLegacyLights),t.isArrayCamera){const r=t.cameras;if(s.length>0)for(let t=0,n=r.length;t<n;t++){ke(i,s,e,r[t])}n&&le.render(e);for(let t=0,n=r.length;t<n;t++){const n=r[t];Ce(m,e,n,n.viewport)}}else s.length>0&&ke(i,s,e,t),n&&le.render(e),Ce(m,e,t);null!==_&&(J.updateMultisampleRenderTarget(_),J.updateRenderTargetMipmap(_)),!0===e.isScene&&e.onAfterRender(v,e,t),pe.resetDefaultState(),S=-1,N=null,x.pop(),x.length>0?(f=x[x.length-1],!0===U&&ae.setGlobalState(v.clippingPlanes,f.state.camera)):f=null,g.pop(),m=g.length>0?g[g.length-1]:null},this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(e,t,n){Z.get(e.texture).__webglTexture=t,Z.get(e.depthTexture).__webglTexture=n;const r=Z.get(e);r.__hasExternalTextures=!0,r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===G.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(e,t){const n=Z.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_=e,b=t,w=n;let r=!0,i=null,s=!1,a=!1;if(e){const o=Z.get(e);void 0!==o.__useDefaultFramebuffer?(X.bindFramebuffer(fe.FRAMEBUFFER,null),r=!1):void 0===o.__webglFramebuffer?J.setupRenderTarget(e):o.__hasExternalTextures&&J.rebindTextures(e,Z.get(e.texture).__webglTexture,Z.get(e.depthTexture).__webglTexture);const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const c=Z.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(c[t])?c[t][n]:c[t],s=!0):i=e.samples>0&&!1===J.useMultisampledRTT(e)?Z.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,j.copy(e.viewport),A.copy(e.scissor),M=e.scissorTest}else j.copy(I).multiplyScalar(P).floor(),A.copy(F).multiplyScalar(P).floor(),M=O;if(X.bindFramebuffer(fe.FRAMEBUFFER,i)&&r&&X.drawBuffers(e,i),X.viewport(j),X.scissor(A),X.setScissorTest(M),s){const r=Z.get(e.texture);fe.framebufferTexture2D(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(a){const r=Z.get(e.texture),i=t||0;fe.framebufferTextureLayer(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,r.__webglTexture,n||0,i)}S=-1},this.readRenderTargetPixels=function(e,t,n,r,i,s,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let o=Z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){X.bindFramebuffer(fe.FRAMEBUFFER,o);try{const a=e.texture,o=a.format,l=a.type;if(!q.textureFormatReadable(o))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!q.textureTypeReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&fe.readPixels(t,n,r,i,he.convert(o),he.convert(l),s)}finally{const e=null!==_?Z.get(_).__webglFramebuffer:null;X.bindFramebuffer(fe.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Math.pow(2,-n),i=Math.floor(t.image.width*r),s=Math.floor(t.image.height*r);J.setTexture2D(t,0),fe.copyTexSubImage2D(fe.TEXTURE_2D,n,0,0,e.x,e.y,i,s),X.unbindTexture()},this.copyTextureToTexture=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=t.image.width,s=t.image.height,a=he.convert(n.format),o=he.convert(n.type);J.setTexture2D(n,0),fe.pixelStorei(fe.UNPACK_FLIP_Y_WEBGL,n.flipY),fe.pixelStorei(fe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),fe.pixelStorei(fe.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?fe.texSubImage2D(fe.TEXTURE_2D,r,e.x,e.y,i,s,a,o,t.image.data):t.isCompressedTexture?fe.compressedTexSubImage2D(fe.TEXTURE_2D,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):fe.texSubImage2D(fe.TEXTURE_2D,r,e.x,e.y,a,o,t.image),0===r&&n.generateMipmaps&&fe.generateMipmap(fe.TEXTURE_2D),X.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const s=e.max.x-e.min.x,a=e.max.y-e.min.y,o=e.max.z-e.min.z,l=he.convert(r.format),c=he.convert(r.type);let d;if(r.isData3DTexture)J.setTexture3D(r,0),d=fe.TEXTURE_3D;else{if(!r.isDataArrayTexture&&!r.isCompressedArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(r,0),d=fe.TEXTURE_2D_ARRAY}fe.pixelStorei(fe.UNPACK_FLIP_Y_WEBGL,r.flipY),fe.pixelStorei(fe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),fe.pixelStorei(fe.UNPACK_ALIGNMENT,r.unpackAlignment);const u=fe.getParameter(fe.UNPACK_ROW_LENGTH),h=fe.getParameter(fe.UNPACK_IMAGE_HEIGHT),p=fe.getParameter(fe.UNPACK_SKIP_PIXELS),m=fe.getParameter(fe.UNPACK_SKIP_ROWS),f=fe.getParameter(fe.UNPACK_SKIP_IMAGES),g=n.isCompressedTexture?n.mipmaps[i]:n.image;fe.pixelStorei(fe.UNPACK_ROW_LENGTH,g.width),fe.pixelStorei(fe.UNPACK_IMAGE_HEIGHT,g.height),fe.pixelStorei(fe.UNPACK_SKIP_PIXELS,e.min.x),fe.pixelStorei(fe.UNPACK_SKIP_ROWS,e.min.y),fe.pixelStorei(fe.UNPACK_SKIP_IMAGES,e.min.z),n.isDataTexture||n.isData3DTexture?fe.texSubImage3D(d,i,t.x,t.y,t.z,s,a,o,l,c,g.data):r.isCompressedArrayTexture?fe.compressedTexSubImage3D(d,i,t.x,t.y,t.z,s,a,o,l,g.data):fe.texSubImage3D(d,i,t.x,t.y,t.z,s,a,o,l,c,g),fe.pixelStorei(fe.UNPACK_ROW_LENGTH,u),fe.pixelStorei(fe.UNPACK_IMAGE_HEIGHT,h),fe.pixelStorei(fe.UNPACK_SKIP_PIXELS,p),fe.pixelStorei(fe.UNPACK_SKIP_ROWS,m),fe.pixelStorei(fe.UNPACK_SKIP_IMAGES,f),0===i&&r.generateMipmaps&&fe.generateMipmap(d),X.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?J.setTextureCube(e,0):e.isData3DTexture?J.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?J.setTexture2DArray(e,0):J.setTexture2D(e,0),X.unbindTexture()},this.resetState=function(){b=0,w=0,_=null,X.reset(),pe.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return GN}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===iN?"display-p3":"srgb",t.unpackColorSpace=yj.workingColorSpace===sN?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class sT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new nM(e),this.density=t}clone(){return new sT(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class aT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new nM(e),this.near=t,this.far=n}clone(){return new aT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class oT extends zA{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new SA,this.environmentIntensity=1,this.environmentRotation=new SA,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class lT{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=RN,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=QN()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return mj("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=QN()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=QN()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const cT=new Oj;class dT{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)cT.fromBufferAttribute(this,t),cT.applyMatrix4(e),this.setXYZ(t,cT.x,cT.y,cT.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)cT.fromBufferAttribute(this,t),cT.applyNormalMatrix(e),this.setXYZ(t,cT.x,cT.y,cT.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)cT.fromBufferAttribute(this,t),cT.transformDirection(e),this.setXYZ(t,cT.x,cT.y,cT.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=nj(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=rj(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=rj(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=rj(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=rj(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=rj(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=nj(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=nj(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=nj(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=nj(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array),r=rj(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=rj(t,this.array),n=rj(n,this.array),r=rj(r,this.array),i=rj(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new mM(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new dT(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class uT extends sM{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new nM(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let hT;const pT=new Oj,mT=new Oj,fT=new Oj,gT=new sj,xT=new sj,vT=new pA,yT=new Oj,bT=new Oj,wT=new Oj,_T=new sj,ST=new sj,NT=new sj;class jT extends zA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new uT;if(super(),this.isSprite=!0,this.type="Sprite",void 0===hT){hT=new TM;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new lT(e,5);hT.setIndex([0,1,2,0,2,3]),hT.setAttribute("position",new dT(t,3,0,!1)),hT.setAttribute("uv",new dT(t,2,3,!1))}this.geometry=hT,this.material=e,this.center=new sj(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),mT.setFromMatrixScale(this.matrixWorld),vT.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),fT.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&mT.multiplyScalar(-fT.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const s=this.center;AT(yT.set(-.5,-.5,0),fT,s,mT,r,i),AT(bT.set(.5,-.5,0),fT,s,mT,r,i),AT(wT.set(.5,.5,0),fT,s,mT,r,i),_T.set(0,0),ST.set(1,0),NT.set(1,1);let a=e.ray.intersectTriangle(yT,bT,wT,!1,pT);if(null===a&&(AT(bT.set(-.5,.5,0),fT,s,mT,r,i),ST.set(0,1),a=e.ray.intersectTriangle(yT,wT,bT,!1,pT),null===a))return;const o=e.ray.origin.distanceTo(pT);o<e.near||o>e.far||t.push({distance:o,point:pT.clone(),uv:KA.getInterpolation(pT,yT,bT,wT,_T,ST,NT,new sj),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function AT(e,t,n,r,i,s){gT.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(xT.x=s*gT.x-i*gT.y,xT.y=i*gT.x+s*gT.y):xT.copy(gT),e.copy(t),e.x+=xT.x,e.y+=xT.y,e.applyMatrix4(vT)}const MT=new Oj,ET=new Oj;class CT extends zA{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=Math.abs(t);const r=this.levels;let i;for(i=0;i<r.length&&!(t<r[i].distance);i++);return r.splice(i,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){MT.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(MT);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){MT.setFromMatrixPosition(e.matrixWorld),ET.setFromMatrixPosition(this.matrixWorld);const n=MT.distanceTo(ET)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i;r++){let e=t[r].distance;if(t[r].object.visible&&(e-=e*t[r].hysteresis),!(n>=e))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const e=n[r];t.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return t}}const kT=new Oj,TT=new Cj,PT=new Cj,LT=new Oj,RT=new pA,IT=new Oj,FT=new iA,OT=new pA,DT=new hA;class UT extends ZM{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=m_,this.bindMatrix=new pA,this.bindMatrixInverse=new pA,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new zj),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,IT),this.boundingBox.expandByPoint(IT)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new iA),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,IT),this.boundingSphere.expandByPoint(IT)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),FT.copy(this.boundingSphere),FT.applyMatrix4(r),!1!==e.ray.intersectsSphere(FT)&&(OT.copy(r).invert(),DT.copy(e.ray).applyMatrix4(OT),null!==this.boundingBox&&!1===DT.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,DT)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Cj,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===m_?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===f_?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;TT.fromBufferAttribute(r.attributes.skinIndex,e),PT.fromBufferAttribute(r.attributes.skinWeight,e),kT.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const e=PT.getComponent(i);if(0!==e){const r=TT.getComponent(i);RT.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),t.addScaledVector(LT.copy(kT).applyMatrix4(RT),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class zT extends zA{constructor(){super(),this.isBone=!0,this.type="Bone"}}class BT extends Ej{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:j_,arguments.length>9&&void 0!==arguments[9]?arguments[9]:j_,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const VT=new pA,HT=new pA;class WT{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=QN(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new pA)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new pA;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,s=e.length;i<s;i++){const r=e[i]?e[i].matrixWorld:HT;VT.multiplyMatrices(r,t[i]),VT.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new WT(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new BT(t,e,e,Z_,B_);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let i=t[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new zT),this.bones.push(i),this.boneInverses.push((new pA).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const i=t[r];e.bones.push(i.uuid);const s=n[r];e.boneInverses.push(s.toArray())}return e}}class GT extends mM{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const qT=new pA,XT=new pA,YT=[],ZT=new zj,JT=new pA,KT=new ZM,QT=new iA;class $T extends ZM{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new GT(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,JT)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new zj),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,qT),ZT.copy(e.boundingBox).applyMatrix4(qT),this.boundingBox.union(ZT)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new iA),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,qT),QT.copy(e.boundingSphere).applyMatrix4(qT),this.boundingSphere.union(QT)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,i=e*(n.length+1)+1;for(let s=0;s<n.length;s++)n[s]=r[i+s]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(KT.geometry=this.geometry,KT.material=this.material,void 0!==KT.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),QT.copy(this.boundingSphere),QT.applyMatrix4(n),!1!==e.ray.intersectsSphere(QT)))for(let i=0;i<r;i++){this.getMatrixAt(i,qT),XT.multiplyMatrices(n,qT),KT.matrixWorld=XT,KT.raycast(e,YT);for(let e=0,n=YT.length;e<n;e++){const n=YT[e];n.instanceId=i,n.object=this,t.push(n)}YT.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new GT(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;null===this.morphTexture&&(this.morphTexture=new BT(new Float32Array(r*this.count),r,this.count,eS,B_));const i=this.morphTexture.source.data.data;let s=0;for(let l=0;l<n.length;l++)s+=n[l];const a=this.geometry.morphTargetsRelative?1:1-s,o=r*e;i[o]=a,i.set(n,o+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function eP(e,t){return e.z-t.z}function tP(e,t){return t.z-e.z}class nP{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const n=this.pool,r=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});const i=n[this.index];r.push(i),this.index++,i.start=e.start,i.count=e.count,i.z=t}reset(){this.list.length=0,this.index=0}}const rP="batchId",iP=new pA,sP=new pA,aP=new pA,oP=new pA,lP=new vE,cP=new zj,dP=new iA,uP=new Oj,hP=new nP,pP=new ZM,mP=[];function fP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const i=e.count;for(let s=0;s<i;s++)for(let i=0;i<r;i++)t.setComponent(s+n,i,e.getComponent(s,i))}else t.array.set(e.array,n*r);t.needsUpdate=!0}class gP extends ZM{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*t,r=arguments.length>3?arguments[3]:void 0;super(new TM,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(4*this._maxGeometryCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new BT(t,e,e,Z_,B_);this._matricesTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxGeometryCount,i=this._maxIndexCount;if(!1===this._geometryInitialized){for(const r in e.attributes){const i=e.getAttribute(r),{array:s,itemSize:a,normalized:o}=i,l=new s.constructor(n*a),c=new mM(l,a,o);t.setAttribute(r,c)}if(null!==e.getIndex()){const e=n>65536?new Uint32Array(i):new Uint16Array(i);t.setIndex(new mM(e,1))}const s=r>65536?new Uint32Array(n):new Uint16Array(n);t.setAttribute(rP,new mM(s,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(rP))throw new Error('BatchedMesh: Geometry cannot use attribute "'.concat(rP,'"'));const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(n===rP)continue;if(!e.hasAttribute(n))throw new Error('BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));const r=e.getAttribute(n),i=t.getAttribute(n);if(r.itemSize!==i.itemSize||r.normalized!==i.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new zj);const e=this._geometryCount,t=this.boundingBox,n=this._active;t.makeEmpty();for(let r=0;r<e;r++)!1!==n[r]&&(this.getMatrixAt(r,iP),this.getBoundingBoxAt(r,cP).applyMatrix4(iP),t.union(cP))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new iA);const e=this._geometryCount,t=this.boundingSphere,n=this._active;t.makeEmpty();for(let r=0;r<e;r++)!1!==n[r]&&(this.getMatrixAt(r,iP),this.getBoundingSphereAt(r,dP).applyMatrix4(iP),t.union(dP))}addGeometry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let i=null;const s=this._reservedRanges,a=this._drawRanges,o=this._bounds;0!==this._geometryCount&&(i=s[s.length-1]),r.vertexCount=-1===t?e.getAttribute("position").count:t,r.vertexStart=null===i?0:i.vertexStart+i.vertexCount;const l=e.getIndex(),c=null!==l;if(c&&(r.indexCount=-1===n?l.count:n,r.indexStart=null===i?0:i.indexStart+i.indexCount),-1!==r.indexStart&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const d=this._visibility,u=this._active,h=this._matricesTexture,p=this._matricesTexture.image.data;d.push(!0),u.push(!0);const m=this._geometryCount;this._geometryCount++,aP.toArray(p,16*m),h.needsUpdate=!0,s.push(r),a.push({start:c?r.indexStart:r.vertexStart,count:-1}),o.push({boxInitialized:!1,box:new zj,sphereInitialized:!1,sphere:new iA});const f=this.geometry.getAttribute(rP);for(let g=0;g<r.vertexCount;g++)f.setX(r.vertexStart+g,m);return f.needsUpdate=!0,this.setGeometryAt(m,e),m}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=null!==n.getIndex(),i=n.getIndex(),s=t.getIndex(),a=this._reservedRanges[e];if(r&&s.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const o=a.vertexStart,l=a.vertexCount;for(const h in n.attributes){if(h===rP)continue;const e=t.getAttribute(h),r=n.getAttribute(h);fP(e,r,o);const i=e.itemSize;for(let t=e.count,n=l;t<n;t++){const e=o+t;for(let t=0;t<i;t++)r.setComponent(e,t,0)}r.needsUpdate=!0,r.addUpdateRange(o*i,l*i)}if(r){const e=a.indexStart;for(let t=0;t<s.count;t++)i.setX(e+t,o+s.getX(t));for(let t=s.count,n=a.indexCount;t<n;t++)i.setX(e+t,o);i.needsUpdate=!0,i.addUpdateRange(e,a.indexCount)}const c=this._bounds[e];null!==t.boundingBox?(c.box.copy(t.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,null!==t.boundingSphere?(c.sphere.copy(t.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;const d=this._drawRanges[e],u=t.getAttribute("position");return d.count=r?s.count:u.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||!1===t[e]||(t[e]=!1,this._visibilityChanged=!0),this}getInstanceCountAt(e){return null===this._multiDrawInstances?null:this._multiDrawInstances[e]}setInstanceCountAt(e,t){return null===this._multiDrawInstances&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[e]=t,e}getBoundingBoxAt(e,t){if(!1===this._active[e])return null;const n=this._bounds[e],r=n.box,i=this.geometry;if(!1===n.boxInitialized){r.makeEmpty();const t=i.index,s=i.attributes.position,a=this._drawRanges[e];for(let e=a.start,n=a.start+a.count;e<n;e++){let n=e;t&&(n=t.getX(n)),r.expandByPoint(uP.fromBufferAttribute(s,n))}n.boxInitialized=!0}return t.copy(r),t}getBoundingSphereAt(e,t){if(!1===this._active[e])return null;const n=this._bounds[e],r=n.sphere,i=this.geometry;if(!1===n.sphereInitialized){r.makeEmpty(),this.getBoundingBoxAt(e,cP),cP.getCenter(r.center);const t=i.index,s=i.attributes.position,a=this._drawRanges[e];let o=0;for(let e=a.start,n=a.start+a.count;e<n;e++){let n=e;t&&(n=t.getX(n)),uP.fromBufferAttribute(s,n),o=Math.max(o,r.center.distanceToSquared(uP))}r.radius=Math.sqrt(o),n.sphereInitialized=!0}return t.copy(r),t}setMatrixAt(e,t){const n=this._active,r=this._matricesTexture,i=this._matricesTexture.image.data;return e>=this._geometryCount||!1===n[e]||(t.toArray(i,16*e),r.needsUpdate=!0),this}getMatrixAt(e,t){const n=this._active,r=this._matricesTexture.image.data;return e>=this._geometryCount||!1===n[e]?null:t.fromArray(r,16*e)}setVisibleAt(e,t){const n=this._visibility,r=this._active;return e>=this._geometryCount||!1===r[e]||n[e]===t||(n[e]=t,this._visibilityChanged=!0),this}getVisibleAt(e){const t=this._visibility,n=this._active;return!(e>=this._geometryCount||!1===n[e])&&t[e]}raycast(e,t){const n=this._visibility,r=this._active,i=this._drawRanges,s=this._geometryCount,a=this.matrixWorld,o=this.geometry;pP.material=this.material,pP.geometry.index=o.index,pP.geometry.attributes=o.attributes,null===pP.geometry.boundingBox&&(pP.geometry.boundingBox=new zj),null===pP.geometry.boundingSphere&&(pP.geometry.boundingSphere=new iA);for(let l=0;l<s;l++){if(!n[l]||!r[l])continue;const s=i[l];pP.geometry.setDrawRange(s.start,s.count),this.getMatrixAt(l,pP.matrixWorld).premultiply(a),this.getBoundingBoxAt(l,pP.geometry.boundingBox),this.getBoundingSphereAt(l,pP.geometry.boundingSphere),pP.raycast(e,mP);for(let e=0,n=mP.length;e<n;e++){const n=mP[e];n.object=this,n.batchId=l,t.push(n)}mP.length=0}pP.material=null,pP.geometry.index=null,pP.geometry.attributes={},pP.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(e=>qe({},e)),this._reservedRanges=e._reservedRanges.map(e=>qe({},e)),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(e=>({boxInitialized:e.boxInitialized,box:e.box.clone(),sphereInitialized:e.sphereInitialized,sphere:e.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,n,r,i){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const s=r.getIndex(),a=null===s?1:s.array.BYTES_PER_ELEMENT,o=this._active,l=this._visibility,c=this._multiDrawStarts,d=this._multiDrawCounts,u=this._drawRanges,h=this.perObjectFrustumCulled;h&&(oP.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),lP.setFromProjectionMatrix(oP,e.coordinateSystem));let p=0;if(this.sortObjects){sP.copy(this.matrixWorld).invert(),uP.setFromMatrixPosition(n.matrixWorld).applyMatrix4(sP);for(let n=0,r=l.length;n<r;n++)if(l[n]&&o[n]){this.getMatrixAt(n,iP),this.getBoundingSphereAt(n,dP).applyMatrix4(iP);let e=!1;if(h&&(e=!lP.intersectsSphere(dP)),!e){const e=uP.distanceTo(dP.center);hP.push(u[n],e)}}const e=hP.list,t=this.customSort;null===t?e.sort(i.transparent?tP:eP):t.call(this,e,n);for(let n=0,r=e.length;n<r;n++){const t=e[n];c[p]=t.start*a,d[p]=t.count,p++}hP.reset()}else for(let m=0,f=l.length;m<f;m++)if(l[m]&&o[m]){let e=!1;if(h&&(this.getMatrixAt(m,iP),this.getBoundingSphereAt(m,dP).applyMatrix4(iP),e=!lP.intersectsSphere(dP)),!e){const e=u[m];c[p]=e.start*a,d[p]=e.count,p++}}this._multiDrawCount=p,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,i,s){this.onBeforeRender(e,null,r,i,s)}}class xP extends sM{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new nM(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const vP=new Oj,yP=new Oj,bP=new pA,wP=new hA,_P=new iA,SP=new Oj,NP=new Oj;class jP extends zA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new TM,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xP;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)vP.fromBufferAttribute(t,e-1),yP.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=vP.distanceTo(yP);e.setAttribute("lineDistance",new SM(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),_P.copy(n.boundingSphere),_P.applyMatrix4(r),_P.radius+=i,!1===e.ray.intersectsSphere(_P))return;bP.copy(r).invert(),wP.copy(e.ray).applyMatrix4(bP);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=this.isLineSegments?2:1,c=n.index,d=n.attributes.position;if(null!==c){const n=Math.max(0,s.start),r=Math.min(c.count,s.start+s.count);for(let i=n,s=r-1;i<s;i+=l){const n=c.getX(i),r=c.getX(i+1),s=AP(this,e,wP,o,n,r);s&&t.push(s)}if(this.isLineLoop){const i=c.getX(r-1),s=c.getX(n),a=AP(this,e,wP,o,i,s);a&&t.push(a)}}else{const n=Math.max(0,s.start),r=Math.min(d.count,s.start+s.count);for(let i=n,s=r-1;i<s;i+=l){const n=AP(this,e,wP,o,i,i+1);n&&t.push(n)}if(this.isLineLoop){const i=AP(this,e,wP,o,r-1,n);i&&t.push(i)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function AP(e,t,n,r,i,s){const a=e.geometry.attributes.position;vP.fromBufferAttribute(a,i),yP.fromBufferAttribute(a,s);if(n.distanceSqToSegment(vP,yP,SP,NP)>r)return;SP.applyMatrix4(e.matrixWorld);const o=t.ray.origin.distanceTo(SP);return o<t.near||o>t.far?void 0:{distance:o,point:NP.clone().applyMatrix4(e.matrixWorld),index:i,face:null,faceIndex:null,object:e}}const MP=new Oj,EP=new Oj;class CP extends jP{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)MP.fromBufferAttribute(t,e),EP.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+MP.distanceTo(EP);e.setAttribute("lineDistance",new SM(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kP extends jP{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class TP extends sM{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new nM(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const PP=new pA,LP=new hA,RP=new iA,IP=new Oj;class FP extends zA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new TM,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new TP;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),RP.copy(n.boundingSphere),RP.applyMatrix4(r),RP.radius+=i,!1===e.ray.intersectsSphere(RP))return;PP.copy(r).invert(),LP.copy(e.ray).applyMatrix4(PP);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,s.start),i=Math.min(l.count,s.start+s.count);n<i;n++){const i=l.getX(n);IP.fromBufferAttribute(c,i),OP(IP,i,o,r,e,t,this)}}else{for(let n=Math.max(0,s.start),i=Math.min(c.count,s.start+s.count);n<i;n++)IP.fromBufferAttribute(c,n),OP(IP,n,o,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function OP(e,t,n,r,i,s,a){const o=LP.distanceSqToPoint(e);if(o<n){const n=new Oj;LP.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:t,face:null,object:a})}}class DP extends Ej{constructor(e,t,n,r,i,s,a,o,l){super(e,t,n,r,i,s,a,o,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:k_,this.magFilter=void 0!==i?i:k_,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class UP extends Ej{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=j_,this.minFilter=j_,this.generateMipmaps=!1,this.needsUpdate=!0}}class zP extends Ej{constructor(e,t,n,r,i,s,a,o,l,c,d,u){super(null,s,a,o,l,c,r,i,d,u),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class BP extends zP{constructor(e,t,n,r,i,s){super(e,t,n,i,s),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=S_}}class VP extends zP{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,x_),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class HP extends Ej{constructor(e,t,n,r,i,s,a,o,l){super(e,t,n,r,i,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class WP{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const i=n.length;let s;s=t||e*n[i-1];let a,o=0,l=i-1;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),a=n[r]-s,a<0)o=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(r=l,n[r]===s)return r/(i-1);const c=n[r];return(r+(s-c)/(n[r+1]-c))/(i-1)}getTangent(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const s=this.getPoint(r),a=this.getPoint(i),o=t||(s.isVector2?new sj:new Oj);return o.copy(a).sub(s).normalize(),o}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Oj,r=[],i=[],s=[],a=new Oj,o=new pA;for(let h=0;h<=e;h++){const t=h/e;r[h]=this.getTangentAt(t,new Oj)}i[0]=new Oj,s[0]=new Oj;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),d=Math.abs(r[0].y),u=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),d<=l&&(l=d,n.set(0,1,0)),u<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),s[0].crossVectors(r[0],i[0]);for(let h=1;h<=e;h++){if(i[h]=i[h-1].clone(),s[h]=s[h-1].clone(),a.crossVectors(r[h-1],r[h]),a.length()>Number.EPSILON){a.normalize();const e=Math.acos($N(r[h-1].dot(r[h]),-1,1));i[h].applyMatrix4(o.makeRotationAxis(a,e))}s[h].crossVectors(r[h],i[h])}if(!0===t){let t=Math.acos($N(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(a.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(o.makeRotationAxis(r[n],t*n)),s[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class GP extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj,n=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const i=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=i?0:n),!0!==this.aClockwise||i||(r===n?r=-n:r-=n);const s=this.aStartAngle+e*r;let a=this.aX+this.xRadius*Math.cos(s),o=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=a-this.aX,r=o-this.aY;a=n*e-r*t+this.aX,o=n*t+r*e+this.aY}return t.set(a,o)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class qP extends GP{constructor(e,t,n,r,i,s){super(e,t,n,n,r,i,s),this.isArcCurve=!0,this.type="ArcCurve"}}function XP(){let e=0,t=0,n=0,r=0;function i(i,s,a,o){e=i,t=a,n=-3*i+3*s-2*a-o,r=2*i-2*s+a+o}return{initCatmullRom:function(e,t,n,r,s){i(t,n,s*(n-e),s*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,s,a,o){let l=(t-e)/s-(n-e)/(s+a)+(n-t)/a,c=(n-t)/a-(r-t)/(a+o)+(r-n)/o;l*=a,c*=a,i(t,n,l,c)},calc:function(i){const s=i*i;return e+t*i+n*s+r*(s*i)}}}const YP=new Oj,ZP=new XP,JP=new XP,KP=new XP;class QP extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj,n=this.points,r=n.length,i=(r-(this.closed?0:1))*e;let s,a,o=Math.floor(i),l=i-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:0===l&&o===r-1&&(o=r-2,l=1),this.closed||o>0?s=n[(o-1)%r]:(YP.subVectors(n[0],n[1]).add(n[0]),s=YP);const c=n[o%r],d=n[(o+1)%r];if(this.closed||o+2<r?a=n[(o+2)%r]:(YP.subVectors(n[r-1],n[r-2]).add(n[r-1]),a=YP),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(d),e),r=Math.pow(d.distanceToSquared(a),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),ZP.initNonuniformCatmullRom(s.x,c.x,d.x,a.x,t,n,r),JP.initNonuniformCatmullRom(s.y,c.y,d.y,a.y,t,n,r),KP.initNonuniformCatmullRom(s.z,c.z,d.z,a.z,t,n,r)}else"catmullrom"===this.curveType&&(ZP.initCatmullRom(s.x,c.x,d.x,a.x,this.tension),JP.initCatmullRom(s.y,c.y,d.y,a.y,this.tension),KP.initCatmullRom(s.z,c.z,d.z,a.z,this.tension));return t.set(ZP.calc(l),JP.calc(l),KP.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Oj).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function $P(e,t,n,r,i){const s=.5*(r-t),a=.5*(i-n),o=e*e;return(2*n-2*r+s+a)*(e*o)+(-3*n+3*r-2*s-a)*o+s*e+n}function eL(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function tL(e,t,n,r,i){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}class nL extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new sj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new sj,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new sj;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj,n=this.v0,r=this.v1,i=this.v2,s=this.v3;return t.set(tL(e,n.x,r.x,i.x,s.x),tL(e,n.y,r.y,i.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class rL extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Oj,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Oj;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj,n=this.v0,r=this.v1,i=this.v2,s=this.v3;return t.set(tL(e,n.x,r.x,i.x,s.x),tL(e,n.y,r.y,i.y,s.y),tL(e,n.z,r.z,i.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class iL extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new sj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class sL extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class aL extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new sj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new sj;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj,n=this.v0,r=this.v1,i=this.v2;return t.set(eL(e,n.x,r.x,i.x),eL(e,n.y,r.y,i.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class oL extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Oj;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj,n=this.v0,r=this.v1,i=this.v2;return t.set(eL(e,n.x,r.x,i.x),eL(e,n.y,r.y,i.y),eL(e,n.z,r.z,i.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class lL extends WP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj,n=this.points,r=(n.length-1)*e,i=Math.floor(r),s=r-i,a=n[0===i?i:i-1],o=n[i],l=n[i>n.length-2?n.length-1:i+1],c=n[i>n.length-3?n.length-1:i+2];return t.set($P(s,a.x,o.x,l.x,c.x),$P(s,a.y,o.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new sj).fromArray(n))}return this}}var cL=Object.freeze({__proto__:null,ArcCurve:qP,CatmullRomCurve3:QP,CubicBezierCurve:nL,CubicBezierCurve3:rL,EllipseCurve:GP,LineCurve:iL,LineCurve3:sL,QuadraticBezierCurve:aL,QuadraticBezierCurve3:oL,SplineCurve:lL});class dL extends WP{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new cL[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const e=r[i]-n,s=this.curves[i],a=s.getLength(),o=0===a?0:1-e/a;return s.getPointAt(o,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const s=i[r],a=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let e=0;e<o.length;e++){const r=o[e];n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new cL[n.type]).fromJSON(n))}return this}}class uL extends dL{constructor(e){super(),this.type="Path",this.currentPoint=new sj,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new iL(this.currentPoint.clone(),new sj(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const i=new aL(this.currentPoint.clone(),new sj(e,t),new sj(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,s){const a=new nL(this.currentPoint.clone(),new sj(e,t),new sj(n,r),new sj(i,s));return this.curves.push(a),this.currentPoint.set(i,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new lL(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,i,s){const a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,n,r,i,s),this}absarc(e,t,n,r,i,s){return this.absellipse(e,t,n,n,r,i,s),this}ellipse(e,t,n,r,i,s,a,o){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,i,s,a,o),this}absellipse(e,t,n,r,i,s,a,o){const l=new GP(e,t,n,r,i,s,a,o);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class hL extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new sj(0,-.5),new sj(.5,0),new sj(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=$N(r,0,2*Math.PI);const i=[],s=[],a=[],o=[],l=[],c=1/t,d=new Oj,u=new sj,h=new Oj,p=new Oj,m=new Oj;let f=0,g=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:f=e[x+1].x-e[x].x,g=e[x+1].y-e[x].y,h.x=1*g,h.y=-f,h.z=0*g,m.copy(h),h.normalize(),o.push(h.x,h.y,h.z);break;case e.length-1:o.push(m.x,m.y,m.z);break;default:f=e[x+1].x-e[x].x,g=e[x+1].y-e[x].y,h.x=1*g,h.y=-f,h.z=0*g,p.copy(h),h.x+=m.x,h.y+=m.y,h.z+=m.z,h.normalize(),o.push(h.x,h.y,h.z),m.copy(p)}for(let x=0;x<=t;x++){const i=n+x*c*r,h=Math.sin(i),p=Math.cos(i);for(let n=0;n<=e.length-1;n++){d.x=e[n].x*h,d.y=e[n].y,d.z=e[n].x*p,s.push(d.x,d.y,d.z),u.x=x/t,u.y=n/(e.length-1),a.push(u.x,u.y);const r=o[3*n+0]*h,i=o[3*n+1],c=o[3*n+0]*p;l.push(r,i,c)}}for(let x=0;x<t;x++)for(let t=0;t<e.length-1;t++){const n=t+x*e.length,r=n,s=n+e.length,a=n+e.length+1,o=n+1;i.push(r,s,o),i.push(a,o,s)}this.setIndex(i),this.setAttribute("position",new SM(s,3)),this.setAttribute("uv",new SM(a,2)),this.setAttribute("normal",new SM(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hL(e.points,e.segments,e.phiStart,e.phiLength)}}class pL extends hL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;const i=new uL;i.absarc(0,-t/2,e,1.5*Math.PI,0),i.absarc(0,t/2,e,0,.5*Math.PI),super(i.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:r}}static fromJSON(e){return new pL(e.radius,e.length,e.capSegments,e.radialSegments)}}class mL extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],s=[],a=[],o=[],l=new Oj,c=new sj;s.push(0,0,0),a.push(0,0,1),o.push(.5,.5);for(let d=0,u=3;d<=t;d++,u+=3){const i=n+d/t*r;l.x=e*Math.cos(i),l.y=e*Math.sin(i),s.push(l.x,l.y,l.z),a.push(0,0,1),c.x=(s[u]/e+1)/2,c.y=(s[u+1]/e+1)/2,o.push(c.x,c.y)}for(let d=1;d<=t;d++)i.push(d,d+1,0);this.setIndex(i),this.setAttribute("position",new SM(s,3)),this.setAttribute("normal",new SM(a,3)),this.setAttribute("uv",new SM(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mL(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class fL extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],d=[],u=[],h=[];let p=0;const m=[],f=n/2;let g=0;function x(n){const i=p,s=new sj,m=new Oj;let x=0;const v=!0===n?e:t,y=!0===n?1:-1;for(let e=1;e<=r;e++)d.push(0,f*y,0),u.push(0,y,0),h.push(.5,.5),p++;const b=p;for(let e=0;e<=r;e++){const t=e/r*o+a,n=Math.cos(t),i=Math.sin(t);m.x=v*i,m.y=f*y,m.z=v*n,d.push(m.x,m.y,m.z),u.push(0,y,0),s.x=.5*n+.5,s.y=.5*i*y+.5,h.push(s.x,s.y),p++}for(let e=0;e<r;e++){const t=i+e,r=b+e;!0===n?c.push(r,r+1,t):c.push(r+1,r,t),x+=3}l.addGroup(g,x,!0===n?1:2),g+=x}!function(){const s=new Oj,x=new Oj;let v=0;const y=(t-e)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,v=g*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,i=t*o+a,l=Math.sin(i),m=Math.cos(i);x.x=v*l,x.y=-g*n+f,x.z=v*m,d.push(x.x,x.y,x.z),s.set(l,y,m).normalize(),u.push(s.x,s.y,s.z),h.push(t,1-g),c.push(p++)}m.push(c)}for(let e=0;e<r;e++)for(let t=0;t<i;t++){const n=m[t][e],r=m[t+1][e],i=m[t+1][e+1],s=m[t][e+1];c.push(n,r,s),c.push(r,i,s),v+=6}l.addGroup(g,v,0),g+=v}(),!1===s&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(c),this.setAttribute("position",new SM(d,3)),this.setAttribute("normal",new SM(u,3)),this.setAttribute("uv",new SM(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fL(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class gL extends fL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,r,i,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:s,thetaLength:a}}static fromJSON(e){return new gL(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class xL extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],s=[];function a(e,t,n,r){const i=r+1,s=[];for(let a=0;a<=i;a++){s[a]=[];const r=e.clone().lerp(n,a/i),o=t.clone().lerp(n,a/i),l=i-a;for(let e=0;e<=l;e++)s[a][e]=0===e&&a===i?r:r.clone().lerp(o,e/l)}for(let a=0;a<i;a++)for(let e=0;e<2*(i-a)-1;e++){const t=Math.floor(e/2);e%2===0?(o(s[a][t+1]),o(s[a+1][t]),o(s[a][t])):(o(s[a][t+1]),o(s[a+1][t+1]),o(s[a+1][t]))}}function o(e){i.push(e.x,e.y,e.z)}function l(t,n){const r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function c(e,t,n,r){r<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=r/2/Math.PI+.5)}function d(e){return Math.atan2(e.z,-e.x)}function u(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){const n=new Oj,r=new Oj,i=new Oj;for(let s=0;s<t.length;s+=3)l(t[s+0],n),l(t[s+1],r),l(t[s+2],i),a(n,r,i,e)}(r),function(e){const t=new Oj;for(let n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){const e=new Oj;for(let t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];const n=d(e)/2/Math.PI+.5,r=u(e)/Math.PI+.5;s.push(n,1-r)}(function(){const e=new Oj,t=new Oj,n=new Oj,r=new Oj,a=new sj,o=new sj,l=new sj;for(let u=0,h=0;u<i.length;u+=9,h+=6){e.set(i[u+0],i[u+1],i[u+2]),t.set(i[u+3],i[u+4],i[u+5]),n.set(i[u+6],i[u+7],i[u+8]),a.set(s[h+0],s[h+1]),o.set(s[h+2],s[h+3]),l.set(s[h+4],s[h+5]),r.copy(e).add(t).add(n).divideScalar(3);const p=d(r);c(a,h+0,e,p),c(o,h+2,t,p),c(l,h+4,n,p)}})(),function(){for(let e=0;e<s.length;e+=6){const t=s[e+0],n=s[e+2],r=s[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),r<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new SM(i,3)),this.setAttribute("normal",new SM(i.slice(),3)),this.setAttribute("uv",new SM(s,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xL(e.vertices,e.indices,e.radius,e.details)}}class vL extends xL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vL(e.radius,e.detail)}}const yL=new Oj,bL=new Oj,wL=new Oj,_L=new KA;class SL extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,r=Math.pow(10,n),i=Math.cos(JN*t),s=e.getIndex(),a=e.getAttribute("position"),o=s?s.count:a.count,l=[0,0,0],c=["a","b","c"],d=new Array(3),u={},h=[];for(let e=0;e<o;e+=3){s?(l[0]=s.getX(e),l[1]=s.getX(e+1),l[2]=s.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:o}=_L;if(t.fromBufferAttribute(a,l[0]),n.fromBufferAttribute(a,l[1]),o.fromBufferAttribute(a,l[2]),_L.getNormal(wL),d[0]="".concat(Math.round(t.x*r),",").concat(Math.round(t.y*r),",").concat(Math.round(t.z*r)),d[1]="".concat(Math.round(n.x*r),",").concat(Math.round(n.y*r),",").concat(Math.round(n.z*r)),d[2]="".concat(Math.round(o.x*r),",").concat(Math.round(o.y*r),",").concat(Math.round(o.z*r)),d[0]!==d[1]&&d[1]!==d[2]&&d[2]!==d[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=d[e],r=d[t],s=_L[c[e]],a=_L[c[t]],o="".concat(n,"_").concat(r),p="".concat(r,"_").concat(n);p in u&&u[p]?(wL.dot(u[p].normal)<=i&&(h.push(s.x,s.y,s.z),h.push(a.x,a.y,a.z)),u[p]=null):o in u||(u[o]={index0:l[e],index1:l[t],normal:wL.clone()})}}for(const e in u)if(u[e]){const{index0:t,index1:n}=u[e];yL.fromBufferAttribute(a,t),bL.fromBufferAttribute(a,n),h.push(yL.x,yL.y,yL.z),h.push(bL.x,bL.y,bL.z)}this.setAttribute("position",new SM(h,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class NL extends uL{constructor(e){super(e),this.uuid=QN(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new uL).fromJSON(n))}return this}}const jL=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=t&&t.length,i=r?t[0]*n:e.length;let s=AL(e,0,i,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c,d,u,h,p;if(r&&(s=function(e,t,n,r){const i=[];let s,a,o,l,c;for(s=0,a=t.length;s<a;s++)o=t[s]*r,l=s<a-1?t[s+1]*r:e.length,c=AL(e,o,l,r,!1),c===c.next&&(c.steiner=!0),i.push(OL(c));for(i.sort(LL),s=0;s<i.length;s++)n=RL(i[s],n);return n}(e,t,s,n)),e.length>80*n){o=c=e[0],l=d=e[1];for(let t=n;t<i;t+=n)u=e[t],h=e[t+1],u<o&&(o=u),h<l&&(l=h),u>c&&(c=u),h>d&&(d=h);p=Math.max(c-o,d-l),p=0!==p?32767/p:0}return EL(s,a,n,o,l,p,0),a};function AL(e,t,n,r,i){let s,a;if(i===function(e,t,n,r){let i=0;for(let s=t,a=n-r;s<n;s+=r)i+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return i}(e,t,n,r)>0)for(s=t;s<n;s+=r)a=XL(s,e[s],e[s+1],a);else for(s=n-r;s>=t;s-=r)a=XL(s,e[s],e[s+1],a);return a&&BL(a,a.next)&&(YL(a),a=a.next),a}function ML(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!BL(r,r.next)&&0!==zL(r.prev,r,r.next))r=r.next;else{if(YL(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function EL(e,t,n,r,i,s,a){if(!e)return;!a&&s&&function(e,t,n,r){let i=e;do{0===i.z&&(i.z=FL(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n,r,i,s,a,o,l,c=1;do{for(n=e,e=null,s=null,a=0;n;){for(a++,r=n,o=0,t=0;t<c&&(o++,r=r.nextZ,r);t++);for(l=c;o>0||l>0&&r;)0!==o&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(a>1)}(i)}(e,r,i,s);let o,l,c=e;for(;e.prev!==e.next;)if(o=e.prev,l=e.next,s?kL(e,r,i,s):CL(e))t.push(o.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),YL(e),e=l.next,c=l.next;else if((e=l)===c){a?1===a?EL(e=TL(ML(e),t,n),t,n,r,i,s,2):2===a&&PL(e,t,n,r,i,s):EL(ML(e),t,n,r,i,s,1);break}}function CL(e){const t=e.prev,n=e,r=e.next;if(zL(t,n,r)>=0)return!1;const i=t.x,s=n.x,a=r.x,o=t.y,l=n.y,c=r.y,d=i<s?i<a?i:a:s<a?s:a,u=o<l?o<c?o:c:l<c?l:c,h=i>s?i>a?i:a:s>a?s:a,p=o>l?o>c?o:c:l>c?l:c;let m=r.next;for(;m!==t;){if(m.x>=d&&m.x<=h&&m.y>=u&&m.y<=p&&DL(i,o,s,l,a,c,m.x,m.y)&&zL(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function kL(e,t,n,r){const i=e.prev,s=e,a=e.next;if(zL(i,s,a)>=0)return!1;const o=i.x,l=s.x,c=a.x,d=i.y,u=s.y,h=a.y,p=o<l?o<c?o:c:l<c?l:c,m=d<u?d<h?d:h:u<h?u:h,f=o>l?o>c?o:c:l>c?l:c,g=d>u?d>h?d:h:u>h?u:h,x=FL(p,m,t,n,r),v=FL(f,g,t,n,r);let y=e.prevZ,b=e.nextZ;for(;y&&y.z>=x&&b&&b.z<=v;){if(y.x>=p&&y.x<=f&&y.y>=m&&y.y<=g&&y!==i&&y!==a&&DL(o,d,l,u,c,h,y.x,y.y)&&zL(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,b.x>=p&&b.x<=f&&b.y>=m&&b.y<=g&&b!==i&&b!==a&&DL(o,d,l,u,c,h,b.x,b.y)&&zL(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;y&&y.z>=x;){if(y.x>=p&&y.x<=f&&y.y>=m&&y.y<=g&&y!==i&&y!==a&&DL(o,d,l,u,c,h,y.x,y.y)&&zL(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=f&&b.y>=m&&b.y<=g&&b!==i&&b!==a&&DL(o,d,l,u,c,h,b.x,b.y)&&zL(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function TL(e,t,n){let r=e;do{const i=r.prev,s=r.next.next;!BL(i,s)&&VL(i,r,r.next,s)&&GL(i,s)&&GL(s,i)&&(t.push(i.i/n|0),t.push(r.i/n|0),t.push(s.i/n|0),YL(r),YL(r.next),r=e=s),r=r.next}while(r!==e);return ML(r)}function PL(e,t,n,r,i,s){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&UL(a,e)){let o=qL(a,e);return a=ML(a,a.next),o=ML(o,o.next),EL(a,t,n,r,i,s,0),void EL(o,t,n,r,i,s,0)}e=e.next}a=a.next}while(a!==e)}function LL(e,t){return e.x-t.x}function RL(e,t){const n=function(e,t){let n,r=t,i=-1/0;const s=e.x,a=e.y;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){const e=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=s&&e>i&&(i=e,n=r.x<r.next.x?r:r.next,e===s))return n}r=r.next}while(r!==t);if(!n)return null;const o=n,l=n.x,c=n.y;let d,u=1/0;r=n;do{s>=r.x&&r.x>=l&&s!==r.x&&DL(a<c?s:i,a,l,c,a<c?i:s,a,r.x,r.y)&&(d=Math.abs(a-r.y)/(s-r.x),GL(r,e)&&(d<u||d===u&&(r.x>n.x||r.x===n.x&&IL(n,r)))&&(n=r,u=d)),r=r.next}while(r!==o);return n}(e,t);if(!n)return t;const r=qL(n,e);return ML(r,r.next),ML(n,n.next)}function IL(e,t){return zL(e.prev,e,t.prev)<0&&zL(t.next,e,e.next)<0}function FL(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function OL(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function DL(e,t,n,r,i,s,a,o){return(i-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(r-o)>=(n-a)*(t-o)&&(n-a)*(s-o)>=(i-a)*(r-o)}function UL(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&VL(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(GL(e,t)&&GL(t,e)&&function(e,t){let n=e,r=!1;const i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(zL(e.prev,e,t.prev)||zL(e,t.prev,t))||BL(e,t)&&zL(e.prev,e,e.next)>0&&zL(t.prev,t,t.next)>0)}function zL(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function BL(e,t){return e.x===t.x&&e.y===t.y}function VL(e,t,n,r){const i=WL(zL(e,t,n)),s=WL(zL(e,t,r)),a=WL(zL(n,r,e)),o=WL(zL(n,r,t));return i!==s&&a!==o||(!(0!==i||!HL(e,n,t))||(!(0!==s||!HL(e,r,t))||(!(0!==a||!HL(n,e,r))||!(0!==o||!HL(n,t,r)))))}function HL(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function WL(e){return e>0?1:e<0?-1:0}function GL(e,t){return zL(e.prev,e,e.next)<0?zL(e,t,e.next)>=0&&zL(e,e.prev,t)>=0:zL(e,t,e.prev)<0||zL(e,e.next,t)<0}function qL(e,t){const n=new ZL(e.i,e.x,e.y),r=new ZL(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function XL(e,t,n,r){const i=new ZL(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function YL(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ZL(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class JL{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}static isClockWise(e){return JL.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];KL(e),QL(n,e);let s=e.length;t.forEach(KL);for(let o=0;o<t.length;o++)r.push(s),s+=t[o].length,QL(n,t[o]);const a=jL(n,r);for(let o=0;o<a.length;o+=3)i.push(a.slice(o,o+3));return i}}function KL(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function QL(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class $L extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new NL([new sj(.5,.5),new sj(-.5,.5),new sj(-.5,-.5),new sj(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let a=0,o=e.length;a<o;a++){s(e[a])}function s(e){const s=[],a=void 0!==t.curveSegments?t.curveSegments:12,o=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,d=void 0!==t.bevelThickness?t.bevelThickness:.2,u=void 0!==t.bevelSize?t.bevelSize:d-.1,h=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const m=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:eR;let g,x,v,y,b,w=!1;m&&(g=m.getSpacedPoints(o),w=!0,c=!1,x=m.computeFrenetFrames(o,!1),v=new Oj,y=new Oj,b=new Oj),c||(p=0,d=0,u=0,h=0);const _=e.extractPoints(a);let S=_.shape;const N=_.holes;if(!JL.isClockWise(S)){S=S.reverse();for(let e=0,t=N.length;e<t;e++){const t=N[e];JL.isClockWise(t)&&(N[e]=t.reverse())}}const j=JL.triangulateShape(S,N),A=S;for(let t=0,n=N.length;t<n;t++){const e=N[t];S=S.concat(e)}function M(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}const E=S.length,C=j.length;function k(e,t,n){let r,i,s;const a=e.x-t.x,o=e.y-t.y,l=n.x-e.x,c=n.y-e.y,d=a*a+o*o,u=a*c-o*l;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(d),h=Math.sqrt(l*l+c*c),p=t.x-o/u,m=t.y+a/u,f=((n.x-c/h-p)*c-(n.y+l/h-m)*l)/(a*c-o*l);r=p+a*f-e.x,i=m+o*f-e.y;const g=r*r+i*i;if(g<=2)return new sj(r,i);s=Math.sqrt(g/2)}else{let e=!1;a>Number.EPSILON?l>Number.EPSILON&&(e=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(c)&&(e=!0),e?(r=-o,i=a,s=Math.sqrt(d)):(r=a,i=o,s=Math.sqrt(d/2))}return new sj(r/s,i/s)}const T=[];for(let t=0,n=A.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),T[t]=k(A[t],A[r],A[i]);const P=[];let L,R=T.concat();for(let t=0,n=N.length;t<n;t++){const e=N[t];L=[];for(let t=0,n=e.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),L[t]=k(e[t],e[r],e[i]);P.push(L),R=R.concat(L)}for(let t=0;t<p;t++){const e=t/p,n=d*Math.cos(e*Math.PI/2),r=u*Math.sin(e*Math.PI/2)+h;for(let t=0,i=A.length;t<i;t++){const e=M(A[t],T[t],r);O(e.x,e.y,-n)}for(let t=0,i=N.length;t<i;t++){const e=N[t];L=P[t];for(let t=0,i=e.length;t<i;t++){const i=M(e[t],L[t],r);O(i.x,i.y,-n)}}}const I=u+h;for(let t=0;t<E;t++){const e=c?M(S[t],R[t],I):S[t];w?(y.copy(x.normals[0]).multiplyScalar(e.x),v.copy(x.binormals[0]).multiplyScalar(e.y),b.copy(g[0]).add(y).add(v),O(b.x,b.y,b.z)):O(e.x,e.y,0)}for(let t=1;t<=o;t++)for(let e=0;e<E;e++){const n=c?M(S[e],R[e],I):S[e];w?(y.copy(x.normals[t]).multiplyScalar(n.x),v.copy(x.binormals[t]).multiplyScalar(n.y),b.copy(g[t]).add(y).add(v),O(b.x,b.y,b.z)):O(n.x,n.y,l/o*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=d*Math.cos(e*Math.PI/2),r=u*Math.sin(e*Math.PI/2)+h;for(let t=0,i=A.length;t<i;t++){const e=M(A[t],T[t],r);O(e.x,e.y,l+n)}for(let t=0,i=N.length;t<i;t++){const e=N[t];L=P[t];for(let t=0,i=e.length;t<i;t++){const i=M(e[t],L[t],r);w?O(i.x,i.y+g[o-1].y,g[o-1].x+n):O(i.x,i.y,l+n)}}}function F(e,t){let n=e.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=e.length-1);for(let e=0,n=o+2*p;e<n;e++){const n=E*e,s=E*(e+1);U(t+r+n,t+i+n,t+i+s,t+r+s)}}}function O(e,t,n){s.push(e),s.push(t),s.push(n)}function D(e,t,i){z(e),z(t),z(i);const s=r.length/3,a=f.generateTopUV(n,r,s-3,s-2,s-1);B(a[0]),B(a[1]),B(a[2])}function U(e,t,i,s){z(e),z(t),z(s),z(t),z(i),z(s);const a=r.length/3,o=f.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);B(o[0]),B(o[1]),B(o[3]),B(o[1]),B(o[2]),B(o[3])}function z(e){r.push(s[3*e+0]),r.push(s[3*e+1]),r.push(s[3*e+2])}function B(e){i.push(e.x),i.push(e.y)}!function(){const e=r.length/3;if(c){let e=0,t=E*e;for(let n=0;n<C;n++){const e=j[n];D(e[2]+t,e[1]+t,e[0]+t)}e=o+2*p,t=E*e;for(let n=0;n<C;n++){const e=j[n];D(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<C;e++){const t=j[e];D(t[2],t[1],t[0])}for(let e=0;e<C;e++){const t=j[e];D(t[0]+E*o,t[1]+E*o,t[2]+E*o)}}n.addGroup(e,r.length/3-e,0)}(),function(){const e=r.length/3;let t=0;F(A,t),t+=A.length;for(let n=0,r=N.length;n<r;n++){const e=N[n];F(e,t),t+=e.length}n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new SM(r,3)),this.setAttribute("uv",new SM(i,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let r=0,i=e.length;r<i;r++){const t=e[r];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const r=t[e.shapes[i]];n.push(r)}const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new cL[r.type]).fromJSON(r)),new $L(n,e.options)}}const eR={generateTopUV:function(e,t,n,r,i){const s=t[3*n],a=t[3*n+1],o=t[3*r],l=t[3*r+1],c=t[3*i],d=t[3*i+1];return[new sj(s,a),new sj(o,l),new sj(c,d)]},generateSideWallUV:function(e,t,n,r,i,s){const a=t[3*n],o=t[3*n+1],l=t[3*n+2],c=t[3*r],d=t[3*r+1],u=t[3*r+2],h=t[3*i],p=t[3*i+1],m=t[3*i+2],f=t[3*s],g=t[3*s+1],x=t[3*s+2];return Math.abs(o-d)<Math.abs(a-c)?[new sj(a,1-l),new sj(c,1-u),new sj(h,1-m),new sj(f,1-x)]:[new sj(o,1-l),new sj(d,1-u),new sj(p,1-m),new sj(g,1-x)]}};class tR extends xL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new tR(e.radius,e.detail)}}class nR extends xL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new nR(e.radius,e.detail)}}class rR extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:s},n=Math.max(3,n),r=Math.max(1,r);const a=[],o=[],l=[],c=[];let d=e;const u=(t-e)/r,h=new Oj,p=new sj;for(let m=0;m<=r;m++){for(let e=0;e<=n;e++){const r=i+e/n*s;h.x=d*Math.cos(r),h.y=d*Math.sin(r),o.push(h.x,h.y,h.z),l.push(0,0,1),p.x=(h.x/t+1)/2,p.y=(h.y/t+1)/2,c.push(p.x,p.y)}d+=u}for(let m=0;m<r;m++){const e=m*(n+1);for(let t=0;t<n;t++){const r=t+e,i=r,s=r+n+1,o=r+n+2,l=r+1;a.push(i,s,l),a.push(s,o,l)}}this.setIndex(a),this.setAttribute("position",new SM(o,3)),this.setAttribute("normal",new SM(l,3)),this.setAttribute("uv",new SM(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rR(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class iR extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new NL([new sj(0,.5),new sj(-.5,-.5),new sj(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],i=[],s=[];let a=0,o=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(a,o,c),a+=o,o=0;function l(e){const a=r.length/3,l=e.extractPoints(t);let c=l.shape;const d=l.holes;!1===JL.isClockWise(c)&&(c=c.reverse());for(let t=0,n=d.length;t<n;t++){const e=d[t];!0===JL.isClockWise(e)&&(d[t]=e.reverse())}const u=JL.triangulateShape(c,d);for(let t=0,n=d.length;t<n;t++){const e=d[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];r.push(e.x,e.y,0),i.push(0,0,1),s.push(e.x,e.y)}for(let t=0,r=u.length;t<r;t++){const e=u[t],r=e[0]+a,i=e[1]+a,s=e[2]+a;n.push(r,i,s),o+=3}}this.setIndex(n),this.setAttribute("position",new SM(r,3)),this.setAttribute("normal",new SM(i,3)),this.setAttribute("uv",new SM(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,i=e.shapes.length;r<i;r++){const i=t[e.shapes[r]];n.push(i)}return new iR(n,e.curveSegments)}}class sR extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const o=Math.min(s+a,Math.PI);let l=0;const c=[],d=new Oj,u=new Oj,h=[],p=[],m=[],f=[];for(let g=0;g<=n;g++){const h=[],x=g/n;let v=0;0===g&&0===s?v=.5/t:g===n&&o===Math.PI&&(v=-.5/t);for(let n=0;n<=t;n++){const o=n/t;d.x=-e*Math.cos(r+o*i)*Math.sin(s+x*a),d.y=e*Math.cos(s+x*a),d.z=e*Math.sin(r+o*i)*Math.sin(s+x*a),p.push(d.x,d.y,d.z),u.copy(d).normalize(),m.push(u.x,u.y,u.z),f.push(o+v,1-x),h.push(l++)}c.push(h)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=c[g][e+1],r=c[g][e],i=c[g+1][e],a=c[g+1][e+1];(0!==g||s>0)&&h.push(t,r,a),(g!==n-1||o<Math.PI)&&h.push(r,i,a)}this.setIndex(h),this.setAttribute("position",new SM(p,3)),this.setAttribute("normal",new SM(m,3)),this.setAttribute("uv",new SM(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sR(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class aR extends xL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new aR(e.radius,e.detail)}}class oR extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const s=[],a=[],o=[],l=[],c=new Oj,d=new Oj,u=new Oj;for(let h=0;h<=n;h++)for(let s=0;s<=r;s++){const p=s/r*i,m=h/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(p),d.y=(e+t*Math.cos(m))*Math.sin(p),d.z=t*Math.sin(m),a.push(d.x,d.y,d.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),u.subVectors(d,c).normalize(),o.push(u.x,u.y,u.z),l.push(s/r),l.push(h/n)}for(let h=1;h<=n;h++)for(let e=1;e<=r;e++){const t=(r+1)*h+e-1,n=(r+1)*(h-1)+e-1,i=(r+1)*(h-1)+e,a=(r+1)*h+e;s.push(t,n,a),s.push(n,i,a)}this.setIndex(s),this.setAttribute("position",new SM(a,3)),this.setAttribute("normal",new SM(o,3)),this.setAttribute("uv",new SM(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new oR(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class lR extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:s},n=Math.floor(n),r=Math.floor(r);const a=[],o=[],l=[],c=[],d=new Oj,u=new Oj,h=new Oj,p=new Oj,m=new Oj,f=new Oj,g=new Oj;for(let v=0;v<=n;++v){const a=v/n*i*Math.PI*2;x(a,i,s,e,h),x(a+.01,i,s,e,p),f.subVectors(p,h),g.addVectors(p,h),m.crossVectors(f,g),g.crossVectors(m,f),m.normalize(),g.normalize();for(let e=0;e<=r;++e){const i=e/r*Math.PI*2,s=-t*Math.cos(i),a=t*Math.sin(i);d.x=h.x+(s*g.x+a*m.x),d.y=h.y+(s*g.y+a*m.y),d.z=h.z+(s*g.z+a*m.z),o.push(d.x,d.y,d.z),u.subVectors(d,h).normalize(),l.push(u.x,u.y,u.z),c.push(v/n),c.push(e/r)}}for(let v=1;v<=n;v++)for(let e=1;e<=r;e++){const t=(r+1)*(v-1)+(e-1),n=(r+1)*v+(e-1),i=(r+1)*v+e,s=(r+1)*(v-1)+e;a.push(t,n,s),a.push(n,i,s)}function x(e,t,n,r,i){const s=Math.cos(e),a=Math.sin(e),o=n/t*e,l=Math.cos(o);i.x=r*(2+l)*.5*s,i.y=r*(2+l)*a*.5,i.z=r*Math.sin(o)*.5}this.setIndex(a),this.setAttribute("position",new SM(o,3)),this.setAttribute("normal",new SM(l,3)),this.setAttribute("uv",new SM(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lR(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class cR extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new oL(new Oj(-1,-1,0),new Oj(-1,1,0),new Oj(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};const s=e.computeFrenetFrames(t,i);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const a=new Oj,o=new Oj,l=new sj;let c=new Oj;const d=[],u=[],h=[],p=[];function m(i){c=e.getPointAt(i/t,c);const l=s.normals[i],h=s.binormals[i];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,i=Math.sin(t),s=-Math.cos(t);o.x=s*l.x+i*h.x,o.y=s*l.y+i*h.y,o.z=s*l.z+i*h.z,o.normalize(),u.push(o.x,o.y,o.z),a.x=c.x+n*o.x,a.y=c.y+n*o.y,a.z=c.z+n*o.z,d.push(a.x,a.y,a.z)}}!function(){for(let e=0;e<t;e++)m(e);m(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)l.x=e/t,l.y=n/r,h.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),s=(r+1)*e+t,a=(r+1)*(e-1)+t;p.push(n,i,a),p.push(i,s,a)}}()}(),this.setIndex(p),this.setAttribute("position",new SM(d,3)),this.setAttribute("normal",new SM(u,3)),this.setAttribute("uv",new SM(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new cR((new cL[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class dR extends TM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new Oj,i=new Oj;if(null!==e.index){const s=e.attributes.position,a=e.index;let o=e.groups;0===o.length&&(o=[{start:0,count:a.count,materialIndex:0}]);for(let e=0,l=o.length;e<l;++e){const l=o[e],c=l.start;for(let e=c,o=c+l.count;e<o;e+=3)for(let l=0;l<3;l++){const o=a.getX(e+l),c=a.getX(e+(l+1)%3);r.fromBufferAttribute(s,o),i.fromBufferAttribute(s,c),!0===uR(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{const s=e.attributes.position;for(let e=0,a=s.count/3;e<a;e++)for(let o=0;o<3;o++){const a=3*e+o,l=3*e+(o+1)%3;r.fromBufferAttribute(s,a),i.fromBufferAttribute(s,l),!0===uR(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new SM(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function uR(e,t,n){const r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var hR=Object.freeze({__proto__:null,BoxGeometry:KM,CapsuleGeometry:pL,CircleGeometry:mL,ConeGeometry:gL,CylinderGeometry:fL,DodecahedronGeometry:vL,EdgesGeometry:SL,ExtrudeGeometry:$L,IcosahedronGeometry:tR,LatheGeometry:hL,OctahedronGeometry:nR,PlaneGeometry:wE,PolyhedronGeometry:xL,RingGeometry:rR,ShapeGeometry:iR,SphereGeometry:sR,TetrahedronGeometry:aR,TorusGeometry:oR,TorusKnotGeometry:lR,TubeGeometry:cR,WireframeGeometry:dR});class pR extends sM{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new nM(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class mR extends nE{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class fR extends sM{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new nM(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nM(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$S,this.normalScale=new sj(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new SA,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class gR extends fR{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new sj(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return $N(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new nM(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new nM(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new nM(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!==e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class xR extends sM{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new nM(16777215),this.specular=new nM(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nM(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$S,this.normalScale=new sj(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new SA,this.combine=r_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class vR extends sM{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new nM(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nM(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$S,this.normalScale=new sj(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class yR extends sM{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$S,this.normalScale=new sj(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class bR extends sM{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new nM(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nM(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$S,this.normalScale=new sj(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new SA,this.combine=r_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class wR extends sM{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new nM(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$S,this.normalScale=new sj(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class _R extends xP{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function SR(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function NR(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function jR(e){const t=e.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function(t,n){return e[t]-e[n]}),n}function AR(e,t,n){const r=e.length,i=new e.constructor(r);for(let s=0,a=0;a!==r;++s){const r=n[s]*t;for(let n=0;n!==t;++n)i[a++]=e[r+n]}return i}function MR(e,t,n,r){let i=1,s=e[0];for(;void 0!==s&&void 0===s[r];)s=e[i++];if(void 0===s)return;let a=s[r];if(void 0!==a)if(Array.isArray(a))do{a=s[r],void 0!==a&&(t.push(s.time),n.push.apply(n,a)),s=e[i++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[r],void 0!==a&&(t.push(s.time),a.toArray(n,n.length)),s=e[i++]}while(void 0!==s);else do{a=s[r],void 0!==a&&(t.push(s.time),n.push(a)),s=e[i++]}while(void 0!==s)}const ER={convertArray:SR,isTypedArray:NR,getKeyframeOrder:jR,sortedArray:AR,flattenJSON:MR,subclip:function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const s=e.clone();s.name=t;const a=[];for(let l=0;l<s.tracks.length;++l){const e=s.tracks[l],t=e.getValueSize(),o=[],c=[];for(let s=0;s<e.times.length;++s){const a=e.times[s]*i;if(!(a<n||a>=r)){o.push(e.times[s]);for(let n=0;n<t;++n)c.push(e.values[s*t+n])}}0!==o.length&&(e.times=SR(o,e.times.constructor),e.values=SR(c,e.values.constructor),a.push(e))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s},makeClipAdditive:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);const i=n.tracks.length,s=t/r;for(let a=0;a<i;++a){const t=n.tracks[a],r=t.ValueTypeName;if("bool"===r||"string"===r)continue;const i=e.tracks.find(function(e){return e.name===t.name&&e.ValueTypeName===r});if(void 0===i)continue;let o=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=l/3);let c=0;const d=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=d/3);const u=t.times.length-1;let h;if(s<=t.times[0]){const e=o,n=l-o;h=t.values.slice(e,n)}else if(s>=t.times[u]){const e=u*l+o,n=e+l-o;h=t.values.slice(e,n)}else{const e=t.createInterpolant(),n=o,r=l-o;e.evaluate(s),h=e.resultBuffer.slice(n,r)}if("quaternion"===r){(new Fj).fromArray(h).normalize().conjugate().toArray(h)}const p=i.times.length;for(let e=0;e<p;++e){const t=e*d+c;if("quaternion"===r)Fj.multiplyQuaternionsFlat(i.values,t,h,0,i.values,t);else{const e=d-2*c;for(let n=0;n<e;++n)i.values[t+n]-=h[n]}}}return e.blendMode=XS,e}};class CR{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let s;n:{r:if(!(e<r)){for(let s=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(i=r,r=t[++n],e<r)break t}s=t.length;break n}if(!(e>=i)){const a=t[1];e<a&&(n=2,i=a);for(let s=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(r=i,i=t[--n-1],e>=i)break t}s=n,n=0;break n}break e}for(;n<s;){const r=n+s>>>1;e<t[r]?s=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let s=0;s!==r;++s)t[s]=n[i+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class kR extends CR{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:HS,endingEnd:HS}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,s=e+1,a=r[i],o=r[s];if(void 0===a)switch(this.getSettings_().endingStart){case WS:i=e,a=2*t-n;break;case GS:i=r.length-2,a=t+r[i]-r[i+1];break;default:i=e,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case WS:s=e,o=2*n-t;break;case GS:s=1,o=n+r[1]-r[0];break;default:s=e-1,o=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-n),this._offsetPrev=i*c,this._offsetNext=s*c}interpolate_(e,t,n,r){const i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,d=this._offsetNext,u=this._weightPrev,h=this._weightNext,p=(n-t)/(r-t),m=p*p,f=m*p,g=-u*f+2*u*m-u*p,x=(1+u)*f+(-1.5-2*u)*m+(-.5+u)*p+1,v=(-1-h)*f+(1.5+h)*m+.5*p,y=h*f-h*m;for(let b=0;b!==a;++b)i[b]=g*s[c+b]+x*s[l+b]+v*s[o+b]+y*s[d+b];return i}}class TR extends CR{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(n-t)/(r-t),d=1-c;for(let u=0;u!==a;++u)i[u]=s[l+u]*d+s[o+u]*c;return i}}class PR extends CR{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class LR{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=SR(t,this.TimeBufferType),this.values=SR(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:SR(e.times,Array),values:SR(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new PR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new TR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new kR(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case zS:t=this.InterpolantFactoryMethodDiscrete;break;case BS:t=this.InterpolantFactoryMethodLinear;break;case VS:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return zS;case this.InterpolantFactoryMethodLinear:return BS;case this.InterpolantFactoryMethodSmooth:return VS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,s=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==i||s!==r){i>=s&&(s=Math.max(s,1),i=s-1);const e=this.getValueSize();this.times=n.slice(i,s),this.values=this.values.slice(i*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==i;a++){const t=n[a];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,t,s),e=!1;break}s=t}if(void 0!==r&&NR(r))for(let a=0,o=r.length;a!==o;++a){const t=r[a];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===VS,i=e.length-1;let s=1;for(let a=1;a<i;++a){let i=!1;const o=e[a];if(o!==e[a+1]&&(1!==a||o!==e[0]))if(r)i=!0;else{const e=a*n,r=e-n,s=e+n;for(let a=0;a!==n;++a){const n=t[e+a];if(n!==t[r+a]||n!==t[s+a]){i=!0;break}}}if(i){if(a!==s){e[s]=e[a];const r=a*n,i=s*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++s}}if(i>0){e[s]=e[i];for(let e=i*n,r=s*n,a=0;a!==n;++a)t[r+a]=t[e+a];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}LR.prototype.TimeBufferType=Float32Array,LR.prototype.ValueBufferType=Float32Array,LR.prototype.DefaultInterpolation=BS;class RR extends LR{}RR.prototype.ValueTypeName="bool",RR.prototype.ValueBufferType=Array,RR.prototype.DefaultInterpolation=zS,RR.prototype.InterpolantFactoryMethodLinear=void 0,RR.prototype.InterpolantFactoryMethodSmooth=void 0;class IR extends LR{}IR.prototype.ValueTypeName="color";class FR extends LR{}FR.prototype.ValueTypeName="number";class OR extends CR{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-t)/(r-t);let l=e*a;for(let c=l+a;l!==c;l+=4)Fj.slerpFlat(i,0,s,l-a,s,l,o);return i}}class DR extends LR{InterpolantFactoryMethodLinear(e){return new OR(this.times,this.values,this.getValueSize(),e)}}DR.prototype.ValueTypeName="quaternion",DR.prototype.DefaultInterpolation=BS,DR.prototype.InterpolantFactoryMethodSmooth=void 0;class UR extends LR{}UR.prototype.ValueTypeName="string",UR.prototype.ValueBufferType=Array,UR.prototype.DefaultInterpolation=zS,UR.prototype.InterpolantFactoryMethodLinear=void 0,UR.prototype.InterpolantFactoryMethodSmooth=void 0;class zR extends LR{}zR.prototype.ValueTypeName="vector";class BR{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qS;this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=QN(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let s=0,a=n.length;s!==a;++s)t.push(VR(n[s]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,s=n.length;i!==s;++i)t.push(LR.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,s=[];for(let a=0;a<i;a++){let e=[],o=[];e.push((a+i-1)%i,a,(a+1)%i),o.push(0,1,0);const l=jR(e);e=AR(e,1,l),o=AR(o,1,l),r||0!==e[0]||(e.push(i),o.push(o[0])),s.push(new FR(".morphTargetInfluences["+t[a].name+"]",e,o).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){const t=e[a],n=t.name.match(i);if(n&&n.length>1){const e=n[1];let i=r[e];i||(r[e]=i=[]),i.push(t)}}const s=[];for(const a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,i){if(0!==n.length){const s=[],a=[];MR(n,s,a,r),0!==s.length&&i.push(new e(t,s,a))}},r=[],i=e.name||"default",s=e.fps||30,a=e.blendMode;let o=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let r=0;r<e[n].morphTargets.length;r++)t[e[n].morphTargets[r]]=-1;for(const i in t){const t=[],s=[];for(let r=0;r!==e[n].morphTargets.length;++r){const r=e[n];t.push(r.time),s.push(r.morphTarget===i?1:0)}r.push(new FR(".morphTargetInfluence["+i+"]",t,s))}o=t.length*s}else{const i=".bones["+t[c].name+"]";n(zR,i+".position",e,"pos",r),n(DR,i+".quaternion",e,"rot",r),n(zR,i+".scale",e,"scl",r)}}if(0===r.length)return null;return new this(i,o,r,a)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function VR(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return FR;case"vector":case"vector2":case"vector3":case"vector4":return zR;case"color":return IR;case"quaternion":return DR;case"bool":case"boolean":return RR;case"string":return UR}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];MR(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const HR={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class WR{constructor(e,t,n){const r=this;let i,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===s&&void 0!==r.onStart&&r.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}}const GR=new WR;class qR{constructor(e){this.manager=void 0!==e?e:GR,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,i){n.load(e,r,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}qR.DEFAULT_MATERIAL_NAME="__DEFAULT";const XR={};class YR extends Error{constructor(e,t){super(e),this.response=t}}class ZR extends qR{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=HR.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(void 0!==XR[e])return void XR[e].push({onLoad:t,onProgress:n,onError:r});XR[e]=[],XR[e].push({onLoad:t,onProgress:n,onError:r});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=XR[e],r=t.body.getReader(),i=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),s=i?parseInt(i):0,a=0!==s;let o=0;const l=new ReadableStream({start(e){!function t(){r.read().then(r=>{let{done:i,value:l}=r;if(i)e.close();else{o+=l.byteLength;const r=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(l),t()}})}()}});return new Response(l)}throw new YR('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)}).then(e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>(new DOMParser).parseFromString(e,a));case"json":return e.json();default:if(void 0===a)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(a),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{HR.add(e,t);const n=XR[e];delete XR[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}}).catch(t=>{const n=XR[e];if(void 0===n)throw this.manager.itemError(e),t;delete XR[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class JR extends qR{constructor(e){super(e)}load(e,t,n,r){const i=this,s=new ZR(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(AB){r?r(AB):console.error(AB),i.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=BR.parse(e[n]);t.push(r)}return t}}class KR extends qR{constructor(e){super(e)}load(e,t,n,r){const i=this,s=[],a=new zP,o=new ZR(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials);let l=0;function c(c){o.load(e[c],function(e){const n=i.parse(e,!0);s[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(a.minFilter=k_),a.image=s,a.format=n.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let d=0,u=e.length;d<u;++d)c(d);else o.load(e,function(e){const n=i.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){s[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)s[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),s[t].format=n.format,s[t].width=n.width,s[t].height=n.height}a.image=s}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=k_),a.format=n.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}}class QR extends qR{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,s=HR.get(e);if(void 0!==s)return i.manager.itemStart(e),setTimeout(function(){t&&t(s),i.manager.itemEnd(e)},0),s;const a=uj("img");function o(){c(),HR.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a}}class $R extends qR{constructor(e){super(e)}load(e,t,n,r){const i=new dE;i.colorSpace=nN;const s=new QR(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function o(n){s.load(e[n],function(e){i.images[n]=e,a++,6===a&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(let l=0;l<e.length;++l)o(l);return i}}class eI extends qR{constructor(e){super(e)}load(e,t,n,r){const i=this,s=new BT,a=new ZR(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(i.withCredentials),a.load(e,function(e){let n;try{n=i.parse(e)}catch(nU){if(void 0===r)return void console.error(nU);r(nU)}void 0!==n.image?s.image=n.image:void 0!==n.data&&(s.image.width=n.width,s.image.height=n.height,s.image.data=n.data),s.wrapS=void 0!==n.wrapS?n.wrapS:S_,s.wrapT=void 0!==n.wrapT?n.wrapT:S_,s.magFilter=void 0!==n.magFilter?n.magFilter:k_,s.minFilter=void 0!==n.minFilter?n.minFilter:k_,s.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(s.colorSpace=n.colorSpace),void 0!==n.flipY&&(s.flipY=n.flipY),void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.mipmaps&&(s.mipmaps=n.mipmaps,s.minFilter=L_),1===n.mipmapCount&&(s.minFilter=k_),void 0!==n.generateMipmaps&&(s.generateMipmaps=n.generateMipmaps),s.needsUpdate=!0,t&&t(s,n)},n,r),s}}class tI extends qR{constructor(e){super(e)}load(e,t,n,r){const i=new Ej,s=new QR(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)},n,r),i}}class nI extends zA{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new nM(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class rI extends nI{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(zA.DEFAULT_UP),this.updateMatrix(),this.groundColor=new nM(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const iI=new pA,sI=new Oj,aI=new Oj;class oI{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new sj(512,512),this.map=null,this.mapPass=null,this.matrix=new pA,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vE,this._frameExtents=new sj(1,1),this._viewportCount=1,this._viewports=[new Cj(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;sI.setFromMatrixPosition(e.matrixWorld),t.position.copy(sI),aI.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(aI),t.updateMatrixWorld(),iI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iI),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(iI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class lI extends oI{constructor(){super(new oE(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*KN*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class cI extends nI{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(zA.DEFAULT_UP),this.updateMatrix(),this.target=new zA,this.distance=n,this.angle=r,this.penumbra=i,this.decay=s,this.map=null,this.shadow=new lI}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const dI=new pA,uI=new Oj,hI=new Oj;class pI extends oI{constructor(){super(new oE(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new sj(4,2),this._viewportCount=6,this._viewports=[new Cj(2,1,1,1),new Cj(0,1,1,1),new Cj(3,1,1,1),new Cj(1,1,1,1),new Cj(3,0,1,1),new Cj(1,0,1,1)],this._cubeDirections=[new Oj(1,0,0),new Oj(-1,0,0),new Oj(0,0,1),new Oj(0,0,-1),new Oj(0,1,0),new Oj(0,-1,0)],this._cubeUps=[new Oj(0,1,0),new Oj(0,1,0),new Oj(0,1,0),new Oj(0,1,0),new Oj(0,0,1),new Oj(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),uI.setFromMatrixPosition(e.matrixWorld),n.position.copy(uI),hI.copy(n.position),hI.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(hI),n.updateMatrixWorld(),r.makeTranslation(-uI.x,-uI.y,-uI.z),dI.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(dI)}}class mI extends nI{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new pI}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class fI extends oI{constructor(){super(new RE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class gI extends nI{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(zA.DEFAULT_UP),this.updateMatrix(),this.target=new zA,this.shadow=new fI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class xI extends nI{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class vI extends nI{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class yI{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Oj)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*r),t.addScaledVector(s[2],.488603*i),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],n*r*1.092548),t.addScaledVector(s[5],r*i*1.092548),t.addScaledVector(s[6],.315392*(3*i*i-1)),t.addScaledVector(s[7],n*i*1.092548),t.addScaledVector(s[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*r),t.addScaledVector(s[2],1.023328*i),t.addScaledVector(s[3],1.023328*n),t.addScaledVector(s[4],.858086*n*r),t.addScaledVector(s[5],.858086*r*i),t.addScaledVector(s[6],.743125*i*i-.247708),t.addScaledVector(s[7],.858086*n*i),t.addScaledVector(s[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class bI extends nI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yI;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class wI extends qR{constructor(e){super(e),this.textures={}}load(e,t,n,r){const i=this,s=new ZR(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(AB){r?r(AB):console.error(AB),i.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const r=wI.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new nM).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(r.dispersion=e.dispersion),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(r.depthFunc=e.depthFunc),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(r.blendSrc=e.blendSrc),void 0!==e.blendDst&&(r.blendDst=e.blendDst),void 0!==e.blendEquation&&(r.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(r.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(r.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(r.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(r.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),void 0!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const i in e.uniforms){const t=e.uniforms[i];switch(r.uniforms[i]={},t.type){case"t":r.uniforms[i].value=n(t.value);break;case"c":r.uniforms[i].value=(new nM).setHex(t.value);break;case"v2":r.uniforms[i].value=(new sj).fromArray(t.value);break;case"v3":r.uniforms[i].value=(new Oj).fromArray(t.value);break;case"v4":r.uniforms[i].value=(new Cj).fromArray(t.value);break;case"m3":r.uniforms[i].value=(new aj).fromArray(t.value);break;case"m4":r.uniforms[i].value=(new pA).fromArray(t.value);break;default:r.uniforms[i].value=t.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const i in e.extensions)r.extensions[i]=e.extensions[i];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=(new sj).fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapRotation&&r.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new sj).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new{ShadowMaterial:pR,SpriteMaterial:uT,RawShaderMaterial:mR,ShaderMaterial:nE,PointsMaterial:TP,MeshPhysicalMaterial:gR,MeshStandardMaterial:fR,MeshPhongMaterial:xR,MeshToonMaterial:vR,MeshNormalMaterial:yR,MeshLambertMaterial:bR,MeshDepthMaterial:Vk,MeshDistanceMaterial:Hk,MeshBasicMaterial:aM,MeshMatcapMaterial:wR,LineDashedMaterial:_R,LineBasicMaterial:xP,Material:sM}[e]}}class _I{static decodeText(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(AB){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class SI extends TM{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class NI extends qR{constructor(e){super(e)}load(e,t,n,r){const i=this,s=new ZR(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(AB){r?r(AB):console.error(AB),i.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(e,r){if(void 0!==t[r])return t[r];const i=e.interleavedBuffers[r],s=function(e,t){if(void 0!==n[t])return n[t];const r=e.arrayBuffers,i=r[t],s=new Uint32Array(i).buffer;return n[t]=s,s}(e,i.buffer),a=dj(i.type,s),o=new lT(a,i.stride);return o.uuid=i.uuid,t[r]=o,o}const i=e.isInstancedBufferGeometry?new SI:new TM,s=e.data.index;if(void 0!==s){const e=dj(s.type,s.array);i.setIndex(new mM(e,1))}const a=e.data.attributes;for(const d in a){const t=a[d];let n;if(t.isInterleavedBufferAttribute){const i=r(e.data,t.data);n=new dT(i,t.itemSize,t.offset,t.normalized)}else{const e=dj(t.type,t.array);n=new(t.isInstancedBufferAttribute?GT:mM)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),i.setAttribute(d,n)}const o=e.data.morphAttributes;if(o)for(const d in o){const t=o[d],n=[];for(let i=0,s=t.length;i<s;i++){const s=t[i];let a;if(s.isInterleavedBufferAttribute){const t=r(e.data,s.data);a=new dT(t,s.itemSize,s.offset,s.normalized)}else{const e=dj(s.type,s.array);a=new mM(e,s.itemSize,s.normalized)}void 0!==s.name&&(a.name=s.name),n.push(a)}i.morphAttributes[d]=n}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let d=0,u=l.length;d!==u;++d){const e=l[d];i.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new Oj;void 0!==c.center&&e.fromArray(c.center),i.boundingSphere=new iA(e,c.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}class jI extends qR{constructor(e){super(e)}load(e,t,n,r){const i=this,s=""===this.path?_I.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const a=new ZR(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(n){let s=null;try{s=JSON.parse(n)}catch(nU){return void 0!==r&&r(nU),void console.error("THREE:ObjectLoader: Can't parse "+e+".",nU.message)}const a=s.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);i.parse(s,t)},n,r)}async loadAsync(e,t){const n=""===this.path?_I.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new ZR(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(e,t),s=JSON.parse(i),a=s.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=this.parseImages(e.images,function(){void 0!==t&&t(l)}),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,i,o,a,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in s)if(s[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,s),o=this.parseObject(e.object,r,a,s,t),l=this.parseSkeletons(e.skeletons,o);return this.bindSkeletons(o,l),o}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const r=(new NL).fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(e){e.isBone&&(r[e.uuid]=e)}),void 0!==e)for(let i=0,s=e.length;i<s;i++){const t=(new WT).fromJSON(e[i],r);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new NI;for(let i=0,s=e.length;i<s;i++){let s;const a=e[i];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":s=r.parse(a);break;default:a.type in hR?s=hR[a.type].fromJSON(a,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(a.type,'"'))}s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.userData&&(s.userData=a.userData),n[a.uuid]=s}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const i=new wI;i.setTextures(t);for(let t=0,s=e.length;t<s;t++){const s=e[t];void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const r=e[n],i=BR.parse(r);t[i.uuid]=i}return t}parseImages(e,t){const n=this,r={};let i;function s(e){if("string"===typeof e){const t=e;return function(e){return n.manager.itemStart(e),i.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:dj(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new WR(t);i=new QR(n),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const n=e[t],i=n.url;if(Array.isArray(i)){const e=[];for(let t=0,n=i.length;t<n;t++){const n=s(i[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new BT(n.data,n.width,n.height)))}r[n.uuid]=new jj(e)}else{const e=s(n.url);r[n.uuid]=new jj(e)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function i(e){if("string"===typeof e){const n=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await r.loadAsync(i)}return e.data?{data:dj(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){r=new QR(this.manager),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],s=r.url;if(Array.isArray(s)){const e=[];for(let t=0,n=s.length;t<n;t++){const n=s[t],r=await i(n);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new BT(r.data,r.width,r.height)))}n[r.uuid]=new jj(e)}else{const e=await i(r.url);n[r.uuid]=new jj(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const r={};if(void 0!==e)for(let i=0,s=e.length;i<s;i++){const s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const a=t[s.image],o=a.data;let l;Array.isArray(o)?(l=new dE,6===o.length&&(l.needsUpdate=!0)):(l=o&&o.data?new BT:new Ej,o&&(l.needsUpdate=!0)),l.source=a,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=n(s.mapping,AI)),void 0!==s.channel&&(l.channel=s.channel),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=n(s.wrap[0],MI),l.wrapT=n(s.wrap[1],MI)),void 0!==s.format&&(l.format=s.format),void 0!==s.internalFormat&&(l.internalFormat=s.internalFormat),void 0!==s.type&&(l.type=s.type),void 0!==s.colorSpace&&(l.colorSpace=s.colorSpace),void 0!==s.minFilter&&(l.minFilter=n(s.minFilter,EI)),void 0!==s.magFilter&&(l.magFilter=n(s.magFilter,EI)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.generateMipmaps&&(l.generateMipmaps=s.generateMipmaps),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.compareFunction&&(l.compareFunction=s.compareFunction),void 0!==s.userData&&(l.userData=s.userData),r[s.uuid]=l}return r}parseObject(e,t,n,r,i){let s,a,o;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(n[i])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function d(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":s=new oT,void 0!==e.background&&(Number.isInteger(e.background)?s.background=new nM(e.background):s.background=d(e.background)),void 0!==e.environment&&(s.environment=d(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?s.fog=new aT(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new sT(e.fog.color,e.fog.density)),""!==e.fog.name&&(s.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(s.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(s.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&s.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(s.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&s.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":s=new oE(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(s.focus=e.focus),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.filmGauge&&(s.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(s.filmOffset=e.filmOffset),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new RE(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new xI(e.color,e.intensity);break;case"DirectionalLight":s=new gI(e.color,e.intensity);break;case"PointLight":s=new mI(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new vI(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new cI(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new rI(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=(new bI).fromJSON(e);break;case"SkinnedMesh":a=l(e.geometry),o=c(e.material),s=new UT(a,o),void 0!==e.bindMode&&(s.bindMode=e.bindMode),void 0!==e.bindMatrix&&s.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(s.skeleton=e.skeleton);break;case"Mesh":a=l(e.geometry),o=c(e.material),s=new ZM(a,o);break;case"InstancedMesh":a=l(e.geometry),o=c(e.material);const t=e.count,n=e.instanceMatrix,r=e.instanceColor;s=new $T(a,o,t),s.instanceMatrix=new GT(new Float32Array(n.array),16),void 0!==r&&(s.instanceColor=new GT(new Float32Array(r.array),r.itemSize));break;case"BatchedMesh":a=l(e.geometry),o=c(e.material),s=new gP(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,o),s.geometry=a,s.perObjectFrustumCulled=e.perObjectFrustumCulled,s.sortObjects=e.sortObjects,s._drawRanges=e.drawRanges,s._reservedRanges=e.reservedRanges,s._visibility=e.visibility,s._active=e.active,s._bounds=e.bounds.map(e=>{const t=new zj;t.min.fromArray(e.boxMin),t.max.fromArray(e.boxMax);const n=new iA;return n.radius=e.sphereRadius,n.center.fromArray(e.sphereCenter),{boxInitialized:e.boxInitialized,box:t,sphereInitialized:e.sphereInitialized,sphere:n}}),s._maxGeometryCount=e.maxGeometryCount,s._maxVertexCount=e.maxVertexCount,s._maxIndexCount=e.maxIndexCount,s._geometryInitialized=e.geometryInitialized,s._geometryCount=e.geometryCount,s._matricesTexture=d(e.matricesTexture.uuid);break;case"LOD":s=new CT;break;case"Line":s=new jP(l(e.geometry),c(e.material));break;case"LineLoop":s=new kP(l(e.geometry),c(e.material));break;case"LineSegments":s=new CP(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new FP(l(e.geometry),c(e.material));break;case"Sprite":s=new jT(c(e.material));break;case"Group":s=new Zk;break;case"Bone":s=new zT;break;default:s=new zA}if(s.uuid=e.uuid,void 0!==e.name&&(s.name=e.name),void 0!==e.matrix?(s.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==e.position&&s.position.fromArray(e.position),void 0!==e.rotation&&s.rotation.fromArray(e.rotation),void 0!==e.quaternion&&s.quaternion.fromArray(e.quaternion),void 0!==e.scale&&s.scale.fromArray(e.scale)),void 0!==e.up&&s.up.fromArray(e.up),void 0!==e.castShadow&&(s.castShadow=e.castShadow),void 0!==e.receiveShadow&&(s.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(s.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(s.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(s.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&s.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(s.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.frustumCulled&&(s.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(s.renderOrder=e.renderOrder),void 0!==e.userData&&(s.userData=e.userData),void 0!==e.layers&&(s.layers.mask=e.layers),void 0!==e.children){const a=e.children;for(let e=0;e<a.length;e++)s.add(this.parseObject(a[e],t,n,r,i))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];s.animations.push(i[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(s.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],r=s.getObjectByProperty("uuid",n.object);void 0!==r&&s.addLevel(r,n.distance,n.hysteresis)}}return s}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}})}}const AI={UVMapping:g_,CubeReflectionMapping:x_,CubeRefractionMapping:v_,EquirectangularReflectionMapping:y_,EquirectangularRefractionMapping:b_,CubeUVReflectionMapping:w_},MI={RepeatWrapping:__,ClampToEdgeWrapping:S_,MirroredRepeatWrapping:N_},EI={NearestFilter:j_,NearestMipmapNearestFilter:A_,NearestMipmapLinearFilter:E_,LinearFilter:k_,LinearMipmapNearestFilter:T_,LinearMipmapLinearFilter:L_};class CI extends qR{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,s=HR.get(e);if(void 0!==s)return i.manager.itemStart(e),s.then?void s.then(n=>{t&&t(n),i.manager.itemEnd(e)}).catch(e=>{r&&r(e)}):(setTimeout(function(){t&&t(s),i.manager.itemEnd(e)},0),s);const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader;const o=fetch(e,a).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(n){return HR.add(e,n),t&&t(n),i.manager.itemEnd(e),n}).catch(function(t){r&&r(t),HR.remove(e),i.manager.itemError(e),i.manager.itemEnd(e)});HR.add(e,o),i.manager.itemStart(e)}}let kI;class TI{static getContext(){return void 0===kI&&(kI=new(window.AudioContext||window.webkitAudioContext)),kI}static setContext(e){kI=e}}class PI extends qR{constructor(e){super(e)}load(e,t,n,r){const i=this,s=new ZR(this.manager);function a(t){r?r(t):console.error(t),i.manager.itemError(e)}s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(e){try{const n=e.slice(0);TI.getContext().decodeAudioData(n,function(e){t(e)}).catch(a)}catch(AB){a(AB)}},n,r)}}const LI=new pA,RI=new pA,II=new pA;class FI{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new oE,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new oE,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,II.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,i=t.near*Math.tan(JN*t.fov*.5)/t.zoom;let s,a;RI.elements[12]=-n,LI.elements[12]=n,s=-i*t.aspect+r,a=i*t.aspect+r,II.elements[0]=2*t.near/(a-s),II.elements[8]=(a+s)/(a-s),this.cameraL.projectionMatrix.copy(II),s=-i*t.aspect-r,a=i*t.aspect-r,II.elements[0]=2*t.near/(a-s),II.elements[8]=(a+s)/(a-s),this.cameraR.projectionMatrix.copy(II)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(RI),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(LI)}}class OI{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=DI(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=DI();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function DI(){return("undefined"===typeof performance?Date:performance).now()}const UI=new Oj,zI=new Fj,BI=new Oj,VI=new Oj;class HI extends zA{constructor(){super(),this.type="AudioListener",this.context=TI.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new OI}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(UI,zI,BI),VI.set(0,0,-1).applyQuaternion(zI),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(UI.x,e),t.positionY.linearRampToValueAtTime(UI.y,e),t.positionZ.linearRampToValueAtTime(UI.z,e),t.forwardX.linearRampToValueAtTime(VI.x,e),t.forwardY.linearRampToValueAtTime(VI.y,e),t.forwardZ.linearRampToValueAtTime(VI.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(UI.x,UI.y,UI.z),t.setOrientation(VI.x,VI.y,VI.z,n.x,n.y,n.z)}}class WI extends zA{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const GI=new Oj,qI=new Fj,XI=new Oj,YI=new Oj;class ZI extends WI{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(GI,qI,XI),YI.set(0,0,1).applyQuaternion(qI);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(GI.x,e),t.positionY.linearRampToValueAtTime(GI.y,e),t.positionZ.linearRampToValueAtTime(GI.z,e),t.orientationX.linearRampToValueAtTime(YI.x,e),t.orientationY.linearRampToValueAtTime(YI.y,e),t.orientationZ.linearRampToValueAtTime(YI.z,e)}else t.setPosition(GI.x,GI.y,GI.z),t.setOrientation(YI.x,YI.y,YI.z)}}class JI{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class KI{constructor(e,t,n){let r,i,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==r;++e)n[i+e]=n[e];s=t}else{s+=t;const e=t/s;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}s>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(n[o]!==n[o+t]){a.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,s=r;i!==s;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let s=0;s!==i;++s)e[t+s]=e[n+s]}_slerp(e,t,n,r){Fj.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const s=this._workIndex*i;Fj.multiplyQuaternionsFlat(e,s,e,t,e,n),Fj.slerpFlat(e,t,e,t,e,s,r)}_lerp(e,t,n,r,i){const s=1-r;for(let a=0;a!==i;++a){const i=t+a;e[i]=e[i]*s+e[n+a]*r}}_lerpAdditive(e,t,n,r,i){for(let s=0;s!==i;++s){const i=t+s;e[i]=e[i]+e[n+s]*r}}}const QI="\\[\\]\\.:\\/",$I=new RegExp("["+QI+"]","g"),eF="[^"+QI+"]",tF="[^"+QI.replace("\\.","")+"]",nF=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",eF)+/(WCOD+)?/.source.replace("WCOD",tF)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",eF)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",eF)+"$"),rF=["material","materials","bones","map"];class iF{constructor(e,t,n){this.path=t,this.parsedPath=n||iF.parseTrackName(t),this.node=iF.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new iF.Composite(e,t,n):new iF(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace($I,"")}static parseTrackName(e){const t=nF.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==rF.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const s=n(i.children);if(s)return s}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=iF.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const s=e[r];if(void 0===s){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}iF.Composite=class{constructor(e,t,n){const r=n||iF.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},iF.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},iF.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},iF.prototype.GetterByBindingType=[iF.prototype._getValue_direct,iF.prototype._getValue_array,iF.prototype._getValue_arrayElement,iF.prototype._getValue_toArray],iF.prototype.SetterByBindingTypeAndVersioning=[[iF.prototype._setValue_direct,iF.prototype._setValue_direct_setNeedsUpdate,iF.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[iF.prototype._setValue_array,iF.prototype._setValue_array_setNeedsUpdate,iF.prototype._setValue_array_setMatrixWorldNeedsUpdate],[iF.prototype._setValue_arrayElement,iF.prototype._setValue_arrayElement_setNeedsUpdate,iF.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[iF.prototype._setValue_fromArray,iF.prototype._setValue_fromArray_setNeedsUpdate,iF.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class sF{constructor(){this.isAnimationObjectGroup=!0,this.uuid=QN(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,s=i.length;let a,o=e.length,l=this.nCachedObjects_;for(let c=0,d=arguments.length;c!==d;++c){const d=arguments[c],u=d.uuid;let h=t[u];if(void 0===h){h=o++,t[u]=h,e.push(d);for(let e=0,t=s;e!==t;++e)i[e].push(new iF(d,n[e],r[e]))}else if(h<l){a=e[h];const o=--l,c=e[o];t[c.uuid]=h,e[h]=c,t[u]=o,e[o]=d;for(let e=0,t=s;e!==t;++e){const t=i[e],s=t[o];let a=t[h];t[h]=s,void 0===a&&(a=new iF(d,n[e],r[e])),t[o]=a}}else e[h]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let s=0,a=arguments.length;s!==a;++s){const a=arguments[s],o=a.uuid,l=t[o];if(void 0!==l&&l>=i){const s=i++,c=e[s];t[c.uuid]=l,e[l]=c,t[o]=s,e[s]=a;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[s],i=t[l];t[l]=r,t[s]=i}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,s=e.length;for(let a=0,o=arguments.length;a!==o;++a){const o=arguments[a].uuid,l=t[o];if(void 0!==l)if(delete t[o],l<i){const a=--i,o=e[a],c=--s,d=e[c];t[o.uuid]=l,e[l]=o,t[d.uuid]=a,e[a]=d,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[a],i=t[c];t[l]=r,t[a]=i,t.pop()}}else{const i=--s,a=e[i];i>0&&(t[a.uuid]=l),e[l]=a,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[l]=t[i],t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const i=this._bindings;if(void 0!==r)return i[r];const s=this._paths,a=this._parsedPaths,o=this._objects,l=o.length,c=this.nCachedObjects_,d=new Array(l);r=i.length,n[e]=r,s.push(e),a.push(t),i.push(d);for(let u=c,h=o.length;u!==h;++u){const n=o[u];d[u]=new iF(n,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length-1,o=s[a];t[e[a]]=n,s[n]=o,s.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}class aF{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,s=i.length,a=new Array(s),o={endingStart:HS,endingEnd:HS};for(let l=0;l!==s;++l){const e=i[l].createInterpolant(null);a[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=DS,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,r=e._clip.duration,i=r/n,s=n/r;e.warp(1,i,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,s=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=i,o[1]=i+n,l[0]=e/s,l[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const r=(e-i)*n;r<0||0===n?t=0:(this._startTime=null,t=n*r)}t*=this._updateTimeScale(e);const s=this._updateTime(t),a=this._updateWeight(e);if(a>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===XS)for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(s),t[n].accumulateAdditive(a);else for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(s),t[n].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const s=n===US;if(0===e)return-1===i?r:s&&1===(1&i)?t-r:r;if(n===OS){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);const a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(s&&1===(1&i))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=WS,r.endingEnd=WS):(r.endingStart=e?this.zeroSlopeAtStart?WS:HS:GS,r.endingEnd=t?this.zeroSlopeAtEnd?WS:HS:GS)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let s=this._weightInterpolant;null===s&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,o=s.sampleValues;return a[0]=i,o[0]=t,a[1]=i+e,o[1]=n,this}}const oF=new Float32Array(1);class lF extends XN{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,s=e._propertyBindings,a=e._interpolants,o=n.uuid,l=this._bindingsByRootAndName;let c=l[o];void 0===c&&(c={},l[o]=c);for(let d=0;d!==i;++d){const e=r[d],i=e.name;let l=c[i];if(void 0!==l)++l.referenceCount,s[d]=l;else{if(l=s[d],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,i));continue}const r=t&&t._propertyBindings[d].binding.parsedPath;l=new KI(iF.create(n,i,r),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,i),s[d]=l}a[d].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let s=i[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,s=this._actionsByClip,a=s[i],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;delete a.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete s[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let s=r[t];void 0===s&&(s={},r[t]=s),s[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,s=this._bindingsByRootAndName,a=s[r],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[i],0===Object.keys(a).length&&delete s[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new TR(new Float32Array(2),new Float32Array(2),1,oF),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let s="string"===typeof e?BR.findByName(r,e):e;const a=null!==s?s.uuid:e,o=this._actionsByClip[a];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:qS),void 0!==o){const e=o.actionByRoot[i];if(void 0!==e&&e.blendMode===n)return e;l=o.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new aF(this,s,t,n);return this._bindAction(c,l),this._addInactiveAction(c,a,i),c}existingAction(e,t){const n=t||this._root,r=n.uuid,i="string"===typeof e?BR.findByName(n,e):e,s=i?i.uuid:e,a=this._actionsByClip[s];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(r,e,i,s)}const a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const i=r._cacheIndex,s=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,s._cacheIndex=i,t[i]=s,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const i in n){const e=n[i].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const i in r){const e=r[i];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class cF{constructor(e){this.value=e}clone(){return new cF(void 0===this.value.clone?this.value:this.value.clone())}}let dF=0;class uF extends XN{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:dF++}),this.name="",this.usage=RN,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const e=Array.isArray(t[n])?t[n]:[t[n]];for(let t=0;t<e.length;t++)this.uniforms.push(e[t].clone())}return this}clone(){return(new this.constructor).copy(this)}}class hF extends lT{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class pF{constructor(e,t,n,r,i){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const mF=new pA;class fF{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new hA(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new NA,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return mF.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(mF),this}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return xF(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(gF),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let r=0,i=e.length;r<i;r++)xF(e[r],this,n,t);return n.sort(gF),n}}function gF(e,t){return e.distance-t.distance}function xF(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)xF(r[e],t,n,!0)}}class vF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos($N(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class yF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const bF=new sj;class wF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new sj(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sj(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=bF.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,bF).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const _F=new Oj,SF=new Oj;class NF{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){_F.subVectors(e,this.start),SF.subVectors(this.end,this.start);const n=SF.dot(SF);let r=SF.dot(_F)/n;return t&&(r=$N(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const jF=new Oj;class AF extends zA{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new TM,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){const e=s/o*Math.PI*2,t=a/o*Math.PI*2;r.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new SM(r,3));const i=new xP({fog:!1,toneMapped:!1});this.cone=new CP(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),jF.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(jF),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const MF=new Oj,EF=new pA,CF=new pA;class kF extends CP{constructor(e){const t=TF(e),n=new TM,r=[],i=[],s=new nM(0,0,1),a=new nM(0,1,0);for(let o=0;o<t.length;o++){const e=t[o];e.parent&&e.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(s.r,s.g,s.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new SM(r,3)),n.setAttribute("color",new SM(i,3));super(n,new xP({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");CF.copy(this.root.matrixWorld).invert();for(let i=0,s=0;i<t.length;i++){const e=t[i];e.parent&&e.parent.isBone&&(EF.multiplyMatrices(CF,e.matrixWorld),MF.setFromMatrixPosition(EF),r.setXYZ(s,MF.x,MF.y,MF.z),EF.multiplyMatrices(CF,e.parent.matrixWorld),MF.setFromMatrixPosition(EF),r.setXYZ(s+1,MF.x,MF.y,MF.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function TF(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,TF(e.children[n]));return t}class PF extends ZM{constructor(e,t,n){super(new sR(t,4,2),new aM({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const LF=new Oj,RF=new nM,IF=new nM;class FF extends zA{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new nR(t);r.rotateY(.5*Math.PI),this.material=new aM({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),s=new Float32Array(3*i.count);r.setAttribute("color",new mM(s,3)),this.add(new ZM(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");RF.copy(this.light.color),IF.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?RF:IF;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(LF.setFromMatrixPosition(this.light.matrixWorld).negate())}}class OF extends CP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new nM(n),r=new nM(r);const i=t/2,s=e/t,a=e/2,o=[],l=[];for(let d=0,u=0,h=-a;d<=t;d++,h+=s){o.push(-a,0,h,a,0,h),o.push(h,0,-a,h,0,a);const e=d===i?n:r;e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3,e.toArray(l,u),u+=3}const c=new TM;c.setAttribute("position",new SM(o,3)),c.setAttribute("color",new SM(l,3));super(c,new xP({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class DF extends CP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;i=new nM(i),s=new nM(s);const a=[],o=[];if(t>1)for(let c=0;c<t;c++){const n=c/t*(2*Math.PI),r=Math.sin(n)*e,l=Math.cos(n)*e;a.push(0,0,0),a.push(r,0,l);const d=1&c?i:s;o.push(d.r,d.g,d.b),o.push(d.r,d.g,d.b)}for(let c=0;c<n;c++){const t=1&c?i:s,l=e-e/n*c;for(let e=0;e<r;e++){let n=e/r*(2*Math.PI),i=Math.sin(n)*l,s=Math.cos(n)*l;a.push(i,0,s),o.push(t.r,t.g,t.b),n=(e+1)/r*(2*Math.PI),i=Math.sin(n)*l,s=Math.cos(n)*l,a.push(i,0,s),o.push(t.r,t.g,t.b)}}const l=new TM;l.setAttribute("position",new SM(a,3)),l.setAttribute("color",new SM(o,3));super(l,new xP({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const UF=new Oj,zF=new Oj,BF=new Oj;class VF extends zA{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new TM;r.setAttribute("position",new SM([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new xP({fog:!1,toneMapped:!1});this.lightPlane=new jP(r,i),this.add(this.lightPlane),r=new TM,r.setAttribute("position",new SM([0,0,0,0,0,1],3)),this.targetLine=new jP(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),UF.setFromMatrixPosition(this.light.matrixWorld),zF.setFromMatrixPosition(this.light.target.matrixWorld),BF.subVectors(zF,UF),this.lightPlane.lookAt(zF),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(zF),this.targetLine.scale.z=BF.length()}}const HF=new Oj,WF=new rE;class GF extends CP{constructor(e){const t=new TM,n=new xP({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],s={};function a(e,t){o(e),o(t)}function o(e){r.push(0,0,0),i.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(r.length/3-1)}a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4"),t.setAttribute("position",new SM(r,3)),t.setAttribute("color",new SM(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const l=new nM(16755200),c=new nM(16711680),d=new nM(43775),u=new nM(16777215),h=new nM(3355443);this.setColors(l,c,d,u,h)}setColors(e,t,n,r,i){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,r.r,r.g,r.b),s.setXYZ(39,r.r,r.g,r.b),s.setXYZ(40,i.r,i.g,i.b),s.setXYZ(41,i.r,i.g,i.b),s.setXYZ(42,i.r,i.g,i.b),s.setXYZ(43,i.r,i.g,i.b),s.setXYZ(44,i.r,i.g,i.b),s.setXYZ(45,i.r,i.g,i.b),s.setXYZ(46,i.r,i.g,i.b),s.setXYZ(47,i.r,i.g,i.b),s.setXYZ(48,i.r,i.g,i.b),s.setXYZ(49,i.r,i.g,i.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;WF.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),qF("c",t,e,WF,0,0,-1),qF("t",t,e,WF,0,0,1),qF("n1",t,e,WF,-1,-1,-1),qF("n2",t,e,WF,1,-1,-1),qF("n3",t,e,WF,-1,1,-1),qF("n4",t,e,WF,1,1,-1),qF("f1",t,e,WF,-1,-1,1),qF("f2",t,e,WF,1,-1,1),qF("f3",t,e,WF,-1,1,1),qF("f4",t,e,WF,1,1,1),qF("u1",t,e,WF,.7,1.1,-1),qF("u2",t,e,WF,-.7,1.1,-1),qF("u3",t,e,WF,0,2,-1),qF("cf1",t,e,WF,-1,0,1),qF("cf2",t,e,WF,1,0,1),qF("cf3",t,e,WF,0,-1,1),qF("cf4",t,e,WF,0,1,1),qF("cn1",t,e,WF,-1,0,-1),qF("cn2",t,e,WF,1,0,-1),qF("cn3",t,e,WF,0,-1,-1),qF("cn4",t,e,WF,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function qF(e,t,n,r,i,s,a){HF.set(i,s,a).unproject(r);const o=t[e];if(void 0!==o){const e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],HF.x,HF.y,HF.z)}}const XF=new zj;class YF extends CP{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new TM;i.setIndex(new mM(n,1)),i.setAttribute("position",new mM(r,3)),super(i,new xP({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&XF.setFromObject(this.object),XF.isEmpty())return;const t=XF.min,n=XF.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ZF extends CP{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new TM;r.setIndex(new mM(n,1)),r.setAttribute("position",new SM([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new xP({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class JF extends jP{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,r=new TM;r.setAttribute("position",new SM([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new xP({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const i=new TM;i.setAttribute("position",new SM([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new ZM(i,new aM({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const KF=new Oj;let QF,$F;class eO extends zA{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Oj(0,0,1),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oj(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*i;super(),this.type="ArrowHelper",void 0===QF&&(QF=new TM,QF.setAttribute("position",new SM([0,0,0,0,1,0],3)),$F=new fL(0,.5,1,5,1),$F.translate(0,-.5,0)),this.position.copy(t),this.line=new jP(QF,new xP({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ZM($F,new aM({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{KF.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(KF,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class tO extends CP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new TM;n.setAttribute("position",new SM(t,3)),n.setAttribute("color",new SM([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new xP({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new nM,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class nO{constructor(){this.type="ShapePath",this.color=new nM,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new uL,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,s){return this.currentPath.bezierCurveTo(e,t,n,r,i,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let r=!1;for(let i=n-1,s=0;s<n;i=s++){let n=t[i],a=t[s],o=a.x-n.x,l=a.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[s],o=-o,a=t[i],l=-l),e.y<n.y||e.y>a.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-o*(e.y-n.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(a.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=a.x)return!0}}return r}const n=JL.isClockWise,r=this.subPaths;if(0===r.length)return[];let i,s,a;const o=[];if(1===r.length)return s=r[0],a=new NL,a.curves=s.curves,o.push(a),o;let l=!n(r[0].getPoints());l=e?!l:l;const c=[],d=[];let u,h,p=[],m=0;d[m]=void 0,p[m]=[];for(let f=0,g=r.length;f<g;f++)s=r[f],u=s.getPoints(),i=n(u),i=e?!i:i,i?(!l&&d[m]&&m++,d[m]={s:new NL,p:u},d[m].s.curves=s.curves,l&&m++,p[m]=[]):p[m].push({h:s,p:u[0]});if(!d[0])return function(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],i=new NL;i.curves=r.curves,t.push(i)}return t}(r);if(d.length>1){let e=!1,n=0;for(let t=0,r=d.length;t<r;t++)c[t]=[];for(let r=0,i=d.length;r<i;r++){const i=p[r];for(let s=0;s<i.length;s++){const a=i[s];let o=!0;for(let i=0;i<d.length;i++)t(a.p,d[i].p)&&(r!==i&&n++,o?(o=!1,c[i].push(a)):e=!0);o&&c[r].push(a)}}n>0&&!1===e&&(p=c)}for(let f=0,g=d.length;f<g;f++){a=d[f].s,o.push(a),h=p[f];for(let e=0,t=h.length;e<t;e++)a.holes.push(h[e].h)}return o}}class rO extends Tj{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,qe(qe({},r),{},{count:n})),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:cw}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=cw);var iO=n(7205);function sO(e){let t;const n=new Set,r=(e,r)=>{const i="function"===typeof e?e(t):e;if(i!==t){const e=t;t=r?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,s={setState:r,getState:i,subscribe:(e,r,s)=>r||s?function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let a=r(t);function o(){const n=r(t);if(!s(a,n)){const t=a;e(a=n,t)}}return n.add(o),()=>n.delete(o)}(e,r,s):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(r,i,s),s}const aO="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?i.useEffect:i.useLayoutEffect;const oO=[];function lO(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let i=0;i<r;i++)if(!n(e[i],t[i]))return!1;return!0}function cO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};null===t&&(t=[e]);for(const a of oO)if(lO(t,a.keys,a.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(a,"error"))throw a.error;if(Object.prototype.hasOwnProperty.call(a,"response"))return r.lifespan&&r.lifespan>0&&(a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.remove,r.lifespan)),a.response;if(!n)throw a.promise}const i={keys:t,equal:r.equal,remove:()=>{const e=oO.indexOf(i);-1!==e&&oO.splice(e,1)},promise:(s=e,"object"===typeof s&&"function"===typeof s.then?e:e(...t)).then(e=>{i.response=e,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(e=>i.error=e)};var s;if(oO.push(i),!n)throw i.promise}var dO=n(2016),uO=n.n(dO),hO=n(8853);const pO=["args","attach"],mO=["args","children"],fO=["args","children"],gO=["children","key","ref"],xO=["children","key","ref"],vO=["params"];const yO={};var bO,wO;const _O=e=>"colorSpace"in e||"outputColorSpace"in e,SO=()=>{var e;return null!=(e=yO.ColorManagement)?e:null},NO=e=>e&&e.isOrthographicCamera,jO="undefined"!==typeof window&&(null!=(bO=window.document)&&bO.createElement||"ReactNative"===(null==(wO=window.navigator)?void 0:wO.product))?i.useLayoutEffect:i.useEffect;function AO(e){const t=i.useRef(e);return jO(()=>{t.current=e},[e]),t}function MO(e){let{set:t}=e;return jO(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class EO extends i.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}EO.getDerivedStateFromError=()=>({error:!0});const CO="__default",kO=new Map,TO=e=>e&&!!e.memoized&&!!e.changes;function PO(e){var t;const n="undefined"!==typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const LO=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function RO(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const IO={obj:e=>e===Object(e)&&!IO.arr(e)&&"function"!==typeof e,fun:e=>"function"===typeof e,str:e=>"string"===typeof e,num:e=>"number"===typeof e,boo:e=>"boolean"===typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let{arrays:n="shallow",objects:r="reference",strict:i=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!==typeof t||!!e!==!!t)return!1;if(IO.str(e)||IO.num(e)||IO.boo(e))return e===t;const s=IO.obj(e);if(s&&"reference"===r)return e===t;const a=IO.arr(e);if(a&&"reference"===n)return e===t;if((a||s)&&e===t)return!0;let o;for(o in e)if(!(o in t))return!1;if(s&&"shallow"===n&&"shallow"===r){for(o in i?t:e)if(!IO.equ(e[o],t[o],{strict:i,objects:"reference"}))return!1}else for(o in i?t:e)if(e[o]!==t[o])return!1;if(IO.und(o)){if(a&&0===e.length&&0===t.length)return!0;if(s&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function FO(e){const t={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)}),t}function OO(e,t){return e.__r3f=qe({type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null},t),e}function DO(e,t){let n=e;if(t.includes("-")){const r=t.split("-"),i=r.pop();return n=r.reduce((e,t)=>e[t],e),{target:n,key:i}}return{target:n,key:t}}const UO=/-\d+$/;function zO(e,t,n){if(IO.str(n)){if(UO.test(n)){const t=n.replace(UO,""),{target:r,key:i}=DO(e,t);Array.isArray(r[i])||(r[i]=[])}const{target:r,key:i}=DO(e,n);t.__r3f.previousAttach=r[i],r[i]=t}else t.__r3f.previousAttach=n(e,t)}function BO(e,t,n){var r,i;if(IO.str(n)){const{target:r,key:i}=DO(e,n),s=t.__r3f.previousAttach;void 0===s?delete r[i]:r[i]=s}else null==(r=t.__r3f)||null==r.previousAttach||r.previousAttach(e,t);null==(i=t.__r3f)||delete i.previousAttach}function VO(e,t){let{children:n,key:r,ref:i}=t,s=Ie(t,gO),a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{children:o,key:l,ref:c}=a,d=Ie(a,xO),u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const h=e.__r3f,p=Object.entries(s),m=[];if(u){const e=Object.keys(d);for(let t=0;t<e.length;t++)s.hasOwnProperty(e[t])||p.unshift([e[t],CO+"remove"])}p.forEach(t=>{let[n,r]=t;var i;if(null!=(i=e.__r3f)&&i.primitive&&"object"===n)return;if(IO.equ(r,d[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return m.push([n,r,!0,[]]);let a=[];n.includes("-")&&(a=n.split("-")),m.push([n,r,!1,a]);for(const e in s){const t=s[e];e.startsWith("".concat(n,"-"))&&m.push([e,t,!1,e.split("-")])}});const f=qe({},s);return null!=h&&h.memoizedProps&&null!=h&&h.memoizedProps.args&&(f.args=h.memoizedProps.args),null!=h&&h.memoizedProps&&null!=h&&h.memoizedProps.attach&&(f.attach=h.memoizedProps.attach),{memoized:f,changes:m}}const HO="undefined"!==typeof process&&!1;function WO(e,t){var n;const r=e.__r3f,i=null==r?void 0:r.root,s=null==i||null==i.getState?void 0:i.getState(),{memoized:a,changes:o}=TO(t)?t:VO(e,t),l=null==r?void 0:r.eventCount;e.__r3f&&(e.__r3f.memoizedProps=a);for(let u=0;u<o.length;u++){let[t,n,i,a]=o[u];if(_O(e)){const e=3001,r="srgb",i="srgb-linear";"encoding"===t?(t="colorSpace",n=n===e?r:i):"outputEncoding"===t&&(t="outputColorSpace",n=n===e?r:i)}let l=e,h=l[t];if(a.length&&(h=a.reduce((e,t)=>e[t],e),!h||!h.set)){const[n,...r]=a.reverse();l=r.reverse().reduce((e,t)=>e[t],e),t=n}if(n===CO+"remove")if(l.constructor){let e=kO.get(l.constructor);e||(e=new l.constructor,kO.set(l.constructor,e)),n=e[t]}else n=0;if(i&&r)n?r.handlers[t]=n:delete r.handlers[t],r.eventCount=Object.keys(r.handlers).length;else if(h&&h.set&&(h.copy||h instanceof NA)){if(Array.isArray(n))h.fromArray?h.fromArray(n):h.set(...n);else if(h.copy&&n&&n.constructor&&(HO?h.constructor.name===n.constructor.name:h.constructor===n.constructor))h.copy(n);else if(void 0!==n){var c;const e=null==(c=h)?void 0:c.isColor;!e&&h.setScalar?h.setScalar(n):h instanceof NA&&n instanceof NA?h.mask=n.mask:h.set(n),!SO()&&s&&!s.linear&&e&&h.convertSRGBToLinear()}}else{var d;if(l[t]=n,null!=(d=l[t])&&d.isTexture&&l[t].format===Z_&&l[t].type===I_&&s){const e=l[t];_O(e)&&_O(s.gl)?e.colorSpace=s.gl.outputColorSpace:e.encoding=s.gl.outputEncoding}}GO(e)}if(r&&r.parent&&e.raycast&&l!==r.eventCount){const t=RO(e).getState().internal,n=t.interaction.indexOf(e);n>-1&&t.interaction.splice(n,1),r.eventCount&&t.interaction.push(e)}return!(1===o.length&&"onUpdate"===o[0][0])&&o.length&&null!=(n=e.__r3f)&&n.parent&&qO(e),e}function GO(e){var t,n;const r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function qO(e){null==e.onUpdate||e.onUpdate(e)}function XO(e,t){e.manual||(NO(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function YO(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function ZO(e,t,n,r){const i=n.get(t);i&&(n.delete(t),0===n.size&&(e.delete(r),i.target.releasePointerCapture(r)))}function JO(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){const r=e.eventObject.__r3f,i=null==r?void 0:r.handlers;if(n.hovered.delete(YO(e)),null!=r&&r.eventCount){const n=qe(qe({},e),{},{intersections:t});null==i.onPointerOut||i.onPointerOut(n),null==i.onPointerLeave||i.onPointerLeave(n)}}}function r(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))})}}return function(s){const{onPointerMissed:a,internal:o}=e.getState();o.lastEvent.current=s;const l="onPointerMove"===i,c="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,d=function(t,n){const r=e.getState(),i=new Set,s=[],a=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<a.length;e++){const t=LO(a[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let o=a.flatMap(function(e){const n=LO(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r}).sort((e,t)=>{const n=LO(e.object),r=LO(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance}).filter(e=>{const t=YO(e);return!i.has(t)&&(i.add(t),!0)});r.events.filter&&(o=r.events.filter(o,r));for(const e of o){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&s.push(qe(qe({},e),{},{eventObject:t})),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())i.has(YO(e.intersection))||s.push(e.intersection);return s}(s,l?t:void 0),u=c?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],i=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+i*i))}(s):0;"onPointerDown"===i&&(o.initialClick=[s.offsetX,s.offsetY],o.initialHits=d.map(e=>e.eventObject)),c&&!d.length&&u<=2&&(r(s,o.interaction),a&&a(s)),l&&n(d),function(t,r,i,s){const a=e.getState();if(t.length){const e={stopped:!1};for(const o of t){const l=LO(o.object)||a,{raycaster:c,pointer:d,camera:u,internal:h}=l,p=new Oj(d.x,d.y,0).unproject(u),m=e=>{var t,n;return null!=(t=null==(n=h.capturedMap.get(e))?void 0:n.has(o.eventObject))&&t},f=e=>{const t={intersection:o,target:r.target};h.capturedMap.has(e)?h.capturedMap.get(e).set(o.eventObject,t):h.capturedMap.set(e,new Map([[o.eventObject,t]])),r.target.setPointerCapture(e)},g=e=>{const t=h.capturedMap.get(e);t&&ZO(h.capturedMap,o.eventObject,t,e)};let x={};for(let e in r){let t=r[e];"function"!==typeof t&&(x[e]=t)}let v=qe(qe(qe({},o),x),{},{pointer:d,intersections:t,stopped:e.stopped,delta:i,unprojectedPoint:p,ray:c.ray,camera:u,stopPropagation(){const i="pointerId"in r&&h.capturedMap.get(r.pointerId);(!i||i.has(o.eventObject))&&(v.stopped=e.stopped=!0,h.hovered.size&&Array.from(h.hovered.values()).find(e=>e.eventObject===o.eventObject))&&n([...t.slice(0,t.indexOf(o)),o])},target:{hasPointerCapture:m,setPointerCapture:f,releasePointerCapture:g},currentTarget:{hasPointerCapture:m,setPointerCapture:f,releasePointerCapture:g},nativeEvent:r});if(s(v),!0===e.stopped)break}}}(d,s,u,function(e){const t=e.eventObject,n=t.__r3f,a=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(a.onPointerOver||a.onPointerEnter||a.onPointerOut||a.onPointerLeave){const t=YO(e),n=o.hovered.get(t);n?n.stopped&&e.stopPropagation():(o.hovered.set(t,e),null==a.onPointerOver||a.onPointerOver(e),null==a.onPointerEnter||a.onPointerEnter(e))}null==a.onPointerMove||a.onPointerMove(e)}else{const n=a[i];n?c&&!o.initialHits.includes(t)||(r(s,o.interaction.filter(e=>!o.initialHits.includes(e))),n(e)):c&&o.initialHits.includes(t)&&r(s,o.interaction.filter(e=>!o.initialHits.includes(e)))}})}}}}const KO=e=>!(null==e||!e.render),QO=i.createContext(null),$O=(e,t)=>{const n=function(e){const t="function"===typeof e?sO(e):e,n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;const[,r]=(0,i.useReducer)(e=>e+1,0),s=t.getState(),a=(0,i.useRef)(s),o=(0,i.useRef)(e),l=(0,i.useRef)(n),c=(0,i.useRef)(!1),d=(0,i.useRef)();let u;void 0===d.current&&(d.current=e(s));let h=!1;(a.current!==s||o.current!==e||l.current!==n||c.current)&&(u=e(s),h=!n(d.current,u)),aO(()=>{h&&(d.current=u),a.current=s,o.current=e,l.current=n,c.current=!1});const p=(0,i.useRef)(s);aO(()=>{const e=()=>{try{const e=t.getState(),n=o.current(e);l.current(d.current,n)||(a.current=e,d.current=n,r())}catch(nU){c.current=!0,r()}},n=t.subscribe(e);return t.getState()!==p.current&&e(),n},[]);const m=h?u:d.current;return(0,i.useDebugValue)(m),m};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[n,t];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},n}((n,r)=>{const s=new Oj,a=new Oj,o=new Oj;function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r().size;const{width:i,height:l,top:c,left:d}=n,u=i/l;t.isVector3?o.copy(t):o.set(...t);const h=e.getWorldPosition(s).distanceTo(o);if(NO(e))return{width:i/e.zoom,height:l/e.zoom,top:c,left:d,factor:1,distance:h,aspect:u};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*h,r=n*(i/l);return{width:r,height:n,top:c,left:d,factor:i/r,distance:h,aspect:u}}}let c;const d=e=>n(t=>({performance:qe(qe({},t.performance),{},{current:e})})),u=new sj,h={set:n,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(r(),t)},advance:(e,n)=>t(e,n,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new OI,pointer:u,mouse:u,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=r();c&&clearTimeout(c),e.performance.current!==e.performance.min&&d(e.performance.min),c=setTimeout(()=>d(r().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>n(t=>qe(qe({},t),{},{events:qe(qe({},t.events),e)})),setSize:(e,t,i,s,o)=>{const c=r().camera,d={width:e,height:t,top:s||0,left:o||0,updateStyle:i};n(e=>({size:d,viewport:qe(qe({},e.viewport),l(c,a,d))}))},setDpr:e=>n(t=>{const n=PO(e);return{viewport:qe(qe({},t.viewport),{},{dpr:n,initialDpr:t.viewport.initialDpr||n})}}),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),n(()=>({frameloop:e}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:i.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const i=r().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:n}),i.subscribers=i.subscribers.sort((e,t)=>e.priority-t.priority),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter(t=>t.ref!==e))}}}};return h}),r=n.getState();let s=r.size,a=r.viewport.dpr,o=r.camera;return n.subscribe(()=>{const{camera:e,size:t,viewport:r,gl:i,set:l}=n.getState();if(t.width!==s.width||t.height!==s.height||r.dpr!==a){var c;s=t,a=r.dpr,XO(e,t),i.setPixelRatio(r.dpr);const n=null!=(c=t.updateStyle)?c:"undefined"!==typeof HTMLCanvasElement&&i.domElement instanceof HTMLCanvasElement;i.setSize(t.width,t.height,n)}e!==o&&(o=e,l(t=>({viewport:qe(qe({},t.viewport),t.viewport.getCurrentViewport(e))})))}),n.subscribe(t=>e(t)),n};let eD,tD=new Set,nD=new Set,rD=new Set;function iD(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function sD(e,t){switch(e){case"before":return iD(tD,t);case"after":return iD(nD,t);case"tail":return iD(rD,t)}}let aD,oD;function lD(e,t,n){let r=t.clock.getDelta();for("never"===t.frameloop&&"number"===typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),aD=t.internal.subscribers,eD=0;eD<aD.length;eD++)oD=aD[eD],oD.ref.current(oD.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function cD(){const e=i.useContext(QO);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function dD(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return cD()(e,t)}function uD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=cD(),r=n.getState().internal.subscribe,i=AO(e);return jO(()=>r(i,t,n),[t,r,n]),null}const hD=new WeakMap;function pD(e,t){return function(n){let r=hD.get(n);r||(r=new n,hD.set(n,r)),e&&e(r);for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return Promise.all(s.map(e=>new Promise((n,i)=>r.load(e,e=>{e.scene&&Object.assign(e,FO(e.scene)),n(e)},t,t=>i(new Error("Could not load ".concat(e,": ").concat(null==t?void 0:t.message)))))))}}function mD(e,t,n,r){const i=Array.isArray(t)?t:[t],s=((e,t,n)=>cO(e,t,!1,n))(pD(n,r),[e,...i],{equal:IO.equ});return Array.isArray(t)?s:s[0]}mD.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return((e,t,n)=>{cO(e,t,!0,n)})(pD(n),[e,...r])},mD.clear=function(e,t){return(e=>{if(void 0===e||0===e.length)oO.splice(0,oO.length);else{const t=oO.find(t=>lO(e,t.keys,t.equal));t&&t.remove()}})([e,...Array.isArray(t)?t:[t]])};const fD=new Map,{invalidate:gD,advance:xD}=function(e){let t,n,r,i=!1,s=!1;function a(o){n=requestAnimationFrame(a),i=!0,t=0,sD("before",o),s=!0;for(const n of e.values()){var l;r=n.store.getState(),!r.internal.active||!("always"===r.frameloop||r.internal.frames>0)||null!=(l=r.gl.xr)&&l.isPresenting||(t+=lD(o,r))}if(s=!1,sD("after",o),0===t)return sD("tail",o),i=!1,cancelAnimationFrame(n)}return{loop:a,invalidate:function t(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var o;if(!n)return e.forEach(e=>t(e.store.getState(),r));null!=(o=n.gl.xr)&&o.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=r>1?Math.min(60,n.internal.frames+r):s?2:1,i||(i=!0,requestAnimationFrame(a)))},advance:function(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(n&&sD("before",t),r)lD(t,r,i);else for(const s of e.values())lD(t,s.store.getState());n&&sD("after",t)}}}(fD),{reconciler:vD,applyProps:yD}=function(e,t){function n(e,t,n){let r,{args:i=[],attach:s}=t,a=Ie(t,pO),o="".concat(e[0].toUpperCase()).concat(e.slice(1));if("primitive"===e){if(void 0===a.object)throw new Error("R3F: Primitives without 'object' are invalid!");r=OO(a.object,{type:e,root:n,attach:s,primitive:!0})}else{const t=yO[o];if(!t)throw new Error("R3F: ".concat(o," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if(!Array.isArray(i))throw new Error("R3F: The args prop must be an array!");r=OO(new t(...i),{type:e,root:n,attach:s,memoizedProps:{args:i}})}return void 0===r.__r3f.attach&&(r.isBufferGeometry?r.__r3f.attach="geometry":r.isMaterial&&(r.__r3f.attach="material")),"inject"!==o&&WO(r,a),r}function r(e,t){let n=!1;var r,i;t&&(null!=(r=t.__r3f)&&r.attach?zO(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(i=e.__r3f)||i.objects.push(t),t.__r3f||OO(t,{}),t.__r3f.parent=e,qO(t),GO(t))}function i(e,t,n){let r=!1;if(t){var i,s;if(null!=(i=t.__r3f)&&i.attach)zO(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"}),e.dispatchEvent({type:"childadded",child:t});const i=e.children.filter(e=>e!==t),s=i.indexOf(n);e.children=[...i.slice(0,s),t,...i.slice(s)],r=!0}r||null==(s=e.__r3f)||s.objects.push(t),t.__r3f||OO(t,{}),t.__r3f.parent=e,qO(t),GO(t)}}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach(e=>a(t,e,n))}function a(e,t,n){if(t){var r,i,a;if(t.__r3f&&(t.__r3f.parent=null),null!=(r=e.__r3f)&&r.objects&&(e.__r3f.objects=e.__r3f.objects.filter(e=>e!==t)),null!=(i=t.__r3f)&&i.attach)BO(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var o;e.remove(t),null!=(o=t.__r3f)&&o.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(e=>e!==t),n.initialHits=n.initialHits.filter(e=>e!==t),n.hovered.forEach((e,r)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(r)}),n.capturedMap.forEach((e,r)=>{ZO(n.capturedMap,t,e,r)})}(RO(t),t)}const c=null==(a=t.__r3f)?void 0:a.primitive,d=!c&&(void 0===n?null!==t.dispose:n);var l;if(!c)s(null==(l=t.__r3f)?void 0:l.objects,t,d),s(t.children,t,d);if(delete t.__r3f,d&&t.dispose&&"Scene"!==t.type){const e=()=>{try{t.dispose()}catch(AB){}};"undefined"===typeof IS_REACT_ACT_ENVIRONMENT?(0,hO.unstable_scheduleCallback)(hO.unstable_IdlePriority,e):e()}GO(e)}}const o=()=>{};return{reconciler:uO()({createInstance:n,removeChild:a,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,r(n,t))},removeChildFromContainer:(e,t)=>{t&&a(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const r=e.getState().scene;r.__r3f&&i(r,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,r){var i;if((null!=(i=null==e?void 0:e.__r3f)?i:{}).primitive&&r.object&&r.object!==e)return[!0];{const{args:t=[],children:i}=r,s=Ie(r,mO),{args:a=[],children:o}=n,l=Ie(n,fO);if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some((e,t)=>e!==a[t]))return[!0];const c=VO(e,s,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,t,i,s,o,l){let[c,d]=t;c?function(e,t,i,s){var o;const l=null==(o=e.__r3f)?void 0:o.parent;if(!l)return;const c=n(t,i,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&r(c,t);e.children=e.children.filter(e=>!e.__r3f)}e.__r3f.objects.forEach(e=>r(c,e)),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||a(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),r(l,c),c.raycast&&c.__r3f.eventCount&&RO(c).getState().internal.interaction.push(c);[s,s.alternate].forEach(e=>{null!==e&&(e.stateNode=c,e.ref&&("function"===typeof e.ref?e.ref(c):e.ref.current=c))})}(e,i,o,l):WO(e,d)},commitMount(e,t,n,r){var i;const s=null!=(i=e.__r3f)?i:{};e.raycast&&s.handlers&&s.eventCount&&RO(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>OO(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:r}=null!=(t=e.__r3f)?t:{};n&&r&&BO(r,e,n),e.isObject3D&&(e.visible=!1),GO(e)},unhideInstance(e,t){var n;const{attach:r,parent:i}=null!=(n=e.__r3f)?n:{};r&&i&&zO(i,e,r),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),GO(e)},createTextInstance:o,hideTextInstance:o,unhideTextInstance:o,getCurrentEventPriority:()=>t?t():iO.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!==typeof performance&&IO.fun(performance.now)?performance.now:IO.fun(Date.now)?Date.now:()=>0,scheduleTimeout:IO.fun(setTimeout)?setTimeout:void 0,cancelTimeout:IO.fun(clearTimeout)?clearTimeout:void 0}),applyProps:WO}}(0,function(){var e;const t="undefined"!==typeof self&&self||"undefined"!==typeof window&&window;if(!t)return iO.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return iO.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return iO.ContinuousEventPriority;default:return iO.DefaultEventPriority}}),bD={objects:"shallow",strict:!1},wD=(e,t)=>{const n="function"===typeof e?e(t):e;return KO(n)?n:new iT(qe({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0},e))};function _D(e){const t=fD.get(e),n=null==t?void 0:t.fiber,r=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const i="function"===typeof reportError?reportError:console.error,s=r||$O(gD,xD),a=n||vD.createContainer(s,iO.ConcurrentRoot,null,!1,null,"",i,null);let o;t||fD.set(e,{fiber:a,store:s});let l,c=!1;return{configure(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:n,size:r,scene:i,events:a,onCreated:d,shadows:u=!1,linear:h=!1,flat:p=!1,legacy:m=!1,orthographic:f=!1,frameloop:g="always",dpr:x=[1,2],performance:v,raycaster:y,camera:b,onPointerMissed:w}=t,_=s.getState(),S=_.gl;_.gl||_.set({gl:S=wD(n,e)});let N=_.raycaster;N||_.set({raycaster:N=new fF});const j=y||{},{params:A}=j,M=Ie(j,vO);if(IO.equ(M,N,bD)||yD(N,qe({},M)),IO.equ(A,N.params,bD)||yD(N,{params:qe(qe({},N.params),A)}),!_.camera||_.camera===l&&!IO.equ(l,b,bD)){l=b;const e=b instanceof rE,t=e?b:f?new RE(0,0,0,0,.1,1e3):new oE(75,0,.1,1e3);e||(t.position.z=5,b&&(yD(t,b),("aspect"in b||"left"in b||"right"in b||"bottom"in b||"top"in b)&&(t.manual=!0,t.updateProjectionMatrix())),_.camera||null!=b&&b.rotation||t.lookAt(0,0,0)),_.set({camera:t}),N.camera=t}if(!_.scene){let e;null!=i&&i.isScene?e=i:(e=new oT,i&&yD(e,i)),_.set({scene:OO(e)})}if(!_.xr){var E;const e=(e,t)=>{const n=s.getState();"never"!==n.frameloop&&xD(e,!0,n,t)},t=()=>{const t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||gD(t)},n={connect(){const e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"===typeof(null==(E=S.xr)?void 0:E.addEventListener)&&n.connect(),_.set({xr:n})}if(S.shadowMap){const e=S.shadowMap.enabled,t=S.shadowMap.type;if(S.shadowMap.enabled=!!u,IO.boo(u))S.shadowMap.type=vw;else if(IO.str(u)){var C;const e={basic:gw,percentage:xw,soft:vw,variance:yw};S.shadowMap.type=null!=(C=e[u])?C:vw}else IO.obj(u)&&Object.assign(S.shadowMap,u);e===S.shadowMap.enabled&&t===S.shadowMap.type||(S.shadowMap.needsUpdate=!0)}const k=SO();if(k&&("enabled"in k?k.enabled=!m:"legacyMode"in k&&(k.legacyMode=m)),!c){yD(S,{outputEncoding:h?3e3:3001,toneMapping:p?a_:d_})}_.legacy!==m&&_.set(()=>({legacy:m})),_.linear!==h&&_.set(()=>({linear:h})),_.flat!==p&&_.set(()=>({flat:p})),!n||IO.fun(n)||KO(n)||IO.equ(n,S,bD)||yD(S,n),a&&!_.events.handlers&&_.set({events:a(s)});const T=function(e,t){const n="undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement;if(t){const{width:e,height:r,top:i,left:s,updateStyle:a=n}=t;return{width:e,height:r,top:i,left:s,updateStyle:a}}if("undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:r,top:i,left:s}=e.parentElement.getBoundingClientRect();return{width:t,height:r,top:i,left:s,updateStyle:n}}return"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:n}:{width:0,height:0,top:0,left:0}}(e,r);return IO.equ(T,_.size,bD)||_.setSize(T.width,T.height,T.updateStyle,T.top,T.left),x&&_.viewport.dpr!==PO(x)&&_.setDpr(x),_.frameloop!==g&&_.setFrameloop(g),_.onPointerMissed||_.set({onPointerMissed:w}),v&&!IO.equ(v,_.performance,bD)&&_.set(e=>({performance:qe(qe({},e.performance),v)})),o=d,c=!0,this},render(t){return c||this.configure(),vD.updateContainer((0,Ue.jsx)(SD,{store:s,children:t,onCreated:o,rootElement:e}),a,null,()=>{}),s},unmount(){ND(e)}}}function SD(e){let{store:t,children:n,onCreated:r,rootElement:i}=e;return jO(()=>{const e=t.getState();e.set(e=>({internal:qe(qe({},e.internal),{},{active:!0})})),r&&r(e),t.getState().events.connected||null==e.events.connect||e.events.connect(i)},[]),(0,Ue.jsx)(QO.Provider,{value:t,children:n})}function ND(e,t){const n=fD.get(e),r=null==n?void 0:n.fiber;if(r){const i=null==n?void 0:n.store.getState();i&&(i.internal.active=!1),vD.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var n,r,s,a;null==i.events.disconnect||i.events.disconnect(),null==(n=i.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(s=i.gl)||null==s.forceContextLoss||s.forceContextLoss(),null!=(a=i.gl)&&a.xr&&i.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(i),fD.delete(e),t&&t(e)}catch(AB){}},500)})}}vD.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:i.version});i.unstable_act;const jD={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function AD(e){const{handlePointer:t}=JO(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(jD).reduce((e,n)=>qe(qe({},e),{},{[n]:t(n)}),{}),update:()=>{var t;const{events:n,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var n;const{set:r,events:i}=e.getState();null==i.disconnect||i.disconnect(),r(e=>({events:qe(qe({},e.events),{},{connected:t})})),Object.entries(null!=(n=i.handlers)?n:[]).forEach(e=>{let[n,r]=e;const[i,s]=jD[n];t.addEventListener(i,r,{passive:s})})},disconnect:()=>{const{set:t,events:n}=e.getState();var r;n.connected&&(Object.entries(null!=(r=n.handlers)?r:[]).forEach(e=>{let[t,r]=e;if(n&&n.connected instanceof HTMLElement){const[e]=jD[t];n.connected.removeEventListener(e,r)}}),t(e=>({events:qe(qe({},e.events),{},{connected:void 0})})))}}}var MD=Object.defineProperty,ED=(e,t,n)=>(((e,t,n)=>{t in e?MD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n);class CD{constructor(){ED(this,"_listeners")}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}var kD=Object.defineProperty,TD=(e,t,n)=>(((e,t,n)=>{t in e?kD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n);const PD=new hA,LD=new fE,RD=Math.cos(Math.PI/180*70),ID=(e,t)=>(e%t+t)%t;class FD extends CD{constructor(e,t){super(),TD(this,"object"),TD(this,"domElement"),TD(this,"enabled",!0),TD(this,"target",new Oj),TD(this,"minDistance",0),TD(this,"maxDistance",1/0),TD(this,"minZoom",0),TD(this,"maxZoom",1/0),TD(this,"minPolarAngle",0),TD(this,"maxPolarAngle",Math.PI),TD(this,"minAzimuthAngle",-1/0),TD(this,"maxAzimuthAngle",1/0),TD(this,"enableDamping",!1),TD(this,"dampingFactor",.05),TD(this,"enableZoom",!0),TD(this,"zoomSpeed",1),TD(this,"enableRotate",!0),TD(this,"rotateSpeed",1),TD(this,"enablePan",!0),TD(this,"panSpeed",1),TD(this,"screenSpacePanning",!0),TD(this,"keyPanSpeed",7),TD(this,"zoomToCursor",!1),TD(this,"autoRotate",!1),TD(this,"autoRotateSpeed",2),TD(this,"reverseOrbit",!1),TD(this,"reverseHorizontalOrbit",!1),TD(this,"reverseVerticalOrbit",!1),TD(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),TD(this,"mouseButtons",{LEFT:dw.ROTATE,MIDDLE:dw.DOLLY,RIGHT:dw.PAN}),TD(this,"touches",{ONE:uw.ROTATE,TWO:uw.DOLLY_PAN}),TD(this,"target0"),TD(this,"position0"),TD(this,"zoom0"),TD(this,"_domElementKeyEvents",null),TD(this,"getPolarAngle"),TD(this,"getAzimuthalAngle"),TD(this,"setPolarAngle"),TD(this,"setAzimuthalAngle"),TD(this,"getDistance"),TD(this,"getZoomScale"),TD(this,"listenToKeyEvents"),TD(this,"stopListenToKeyEvents"),TD(this,"saveState"),TD(this,"reset"),TD(this,"update"),TD(this,"connect"),TD(this,"dispose"),TD(this,"dollyIn"),TD(this,"dollyOut"),TD(this,"getScale"),TD(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=ID(e,2*Math.PI),r=c.phi;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-r);2*Math.PI-i<i&&(t<r?t+=2*Math.PI:r+=2*Math.PI),d.phi=t-r,n.update()},this.setAzimuthalAngle=e=>{let t=ID(e,2*Math.PI),r=c.theta;r<0&&(r+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-r);2*Math.PI-i<i&&(t<r?t+=2*Math.PI:r+=2*Math.PI),d.theta=t-r,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",J),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",J),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(r),n.update(),o=a.NONE},this.update=(()=>{const t=new Oj,i=new Oj(0,1,0),s=(new Fj).setFromUnitVectors(e.up,i),p=s.clone().invert(),m=new Oj,f=new Fj,g=2*Math.PI;return function(){const x=n.object.position;s.setFromUnitVectors(e.up,i),p.copy(s).invert(),t.copy(x).sub(n.target),t.applyQuaternion(s),c.setFromVector3(t),n.autoRotate&&o===a.NONE&&E(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=d.theta*n.dampingFactor,c.phi+=d.phi*n.dampingFactor):(c.theta+=d.theta,c.phi+=d.phi);let v=n.minAzimuthAngle,y=n.maxAzimuthAngle;isFinite(v)&&isFinite(y)&&(v<-Math.PI?v+=g:v>Math.PI&&(v-=g),y<-Math.PI?y+=g:y>Math.PI&&(y-=g),c.theta=v<=y?Math.max(v,Math.min(y,c.theta)):c.theta>(v+y)/2?Math.max(v,c.theta):Math.min(y,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),n.zoomToCursor&&N||n.object.isOrthographicCamera?c.radius=O(c.radius):c.radius=O(c.radius*u),t.setFromSpherical(c),t.applyQuaternion(p),x.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),h.set(0,0,0));let b=!1;if(n.zoomToCursor&&N){let r=null;if(n.object instanceof oE&&n.object.isPerspectiveCamera){const e=t.length();r=O(e*u);const i=e-r;n.object.position.addScaledVector(_,i),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new Oj(S.x,S.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix(),b=!0;const i=new Oj(S.x,S.y,0);i.unproject(n.object),n.object.position.sub(i).add(e),n.object.updateMatrixWorld(),r=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==r&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(r).add(n.object.position):(PD.origin.copy(n.object.position),PD.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(PD.direction))<RD?e.lookAt(n.target):(LD.setFromNormalAndCoplanarPoint(n.object.up,n.target),PD.intersectPlane(LD,n.target))))}else n.object instanceof RE&&n.object.isOrthographicCamera&&(b=1!==u,b&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/u)),n.object.updateProjectionMatrix()));return u=1,N=!1,!!(b||m.distanceToSquared(n.object.position)>l||8*(1-f.dot(n.object.quaternion))>l)&&(n.dispatchEvent(r),m.copy(n.object.position),f.copy(n.object.quaternion),b=!1,!0)}})(),this.connect=e=>{n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",K),n.domElement.addEventListener("pointerdown",q),n.domElement.addEventListener("pointercancel",Y),n.domElement.addEventListener("wheel",Z)},this.dispose=()=>{var e,t,r,i,s,a;n.domElement&&(n.domElement.style.touchAction="auto"),null==(e=n.domElement)||e.removeEventListener("contextmenu",K),null==(t=n.domElement)||t.removeEventListener("pointerdown",q),null==(r=n.domElement)||r.removeEventListener("pointercancel",Y),null==(i=n.domElement)||i.removeEventListener("wheel",Z),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointermove",X),null==(a=n.domElement)||a.ownerDocument.removeEventListener("pointerup",Y),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",J)};const n=this,r={type:"change"},i={type:"start"},s={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=a.NONE;const l=1e-6,c=new vF,d=new vF;let u=1;const h=new Oj,p=new sj,m=new sj,f=new sj,g=new sj,x=new sj,v=new sj,y=new sj,b=new sj,w=new sj,_=new Oj,S=new sj;let N=!1;const j=[],A={};function M(){return Math.pow(.95,n.zoomSpeed)}function E(e){n.reverseOrbit||n.reverseHorizontalOrbit?d.theta+=e:d.theta-=e}function C(e){n.reverseOrbit||n.reverseVerticalOrbit?d.phi+=e:d.phi-=e}const k=(()=>{const e=new Oj;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),h.add(e)}})(),T=(()=>{const e=new Oj;return function(t,r){!0===n.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),h.add(e)}})(),P=(()=>{const e=new Oj;return function(t,r){const i=n.domElement;if(i&&n.object instanceof oE&&n.object.isPerspectiveCamera){const s=n.object.position;e.copy(s).sub(n.target);let a=e.length();a*=Math.tan(n.object.fov/2*Math.PI/180),k(2*t*a/i.clientHeight,n.object.matrix),T(2*r*a/i.clientHeight,n.object.matrix)}else i&&n.object instanceof RE&&n.object.isOrthographicCamera?(k(t*(n.object.right-n.object.left)/n.object.zoom/i.clientWidth,n.object.matrix),T(r*(n.object.top-n.object.bottom)/n.object.zoom/i.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function L(e){n.object instanceof oE&&n.object.isPerspectiveCamera||n.object instanceof RE&&n.object.isOrthographicCamera?u=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function R(e){L(u/e)}function I(e){L(u*e)}function F(e){if(!n.zoomToCursor||!n.domElement)return;N=!0;const t=n.domElement.getBoundingClientRect(),r=e.clientX-t.left,i=e.clientY-t.top,s=t.width,a=t.height;S.x=r/s*2-1,S.y=-i/a*2+1,_.set(S.x,S.y,1).unproject(n.object).sub(n.object.position).normalize()}function O(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function D(e){p.set(e.clientX,e.clientY)}function U(e){g.set(e.clientX,e.clientY)}function z(){if(1==j.length)p.set(j[0].pageX,j[0].pageY);else{const e=.5*(j[0].pageX+j[1].pageX),t=.5*(j[0].pageY+j[1].pageY);p.set(e,t)}}function B(){if(1==j.length)g.set(j[0].pageX,j[0].pageY);else{const e=.5*(j[0].pageX+j[1].pageX),t=.5*(j[0].pageY+j[1].pageY);g.set(e,t)}}function V(){const e=j[0].pageX-j[1].pageX,t=j[0].pageY-j[1].pageY,n=Math.sqrt(e*e+t*t);y.set(0,n)}function H(e){if(1==j.length)m.set(e.pageX,e.pageY);else{const t=$(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);m.set(n,r)}f.subVectors(m,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(E(2*Math.PI*f.x/t.clientHeight),C(2*Math.PI*f.y/t.clientHeight)),p.copy(m)}function W(e){if(1==j.length)x.set(e.pageX,e.pageY);else{const t=$(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);x.set(n,r)}v.subVectors(x,g).multiplyScalar(n.panSpeed),P(v.x,v.y),g.copy(x)}function G(e){const t=$(e),r=e.pageX-t.x,i=e.pageY-t.y,s=Math.sqrt(r*r+i*i);b.set(0,s),w.set(0,Math.pow(b.y/y.y,n.zoomSpeed)),R(w.y),y.copy(b)}function q(e){var t,r;!1!==n.enabled&&(0===j.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",X),null==(r=n.domElement)||r.ownerDocument.addEventListener("pointerup",Y)),function(e){j.push(e)}(e),"touch"===e.pointerType?function(e){switch(Q(e),j.length){case 1:switch(n.touches.ONE){case uw.ROTATE:if(!1===n.enableRotate)return;z(),o=a.TOUCH_ROTATE;break;case uw.PAN:if(!1===n.enablePan)return;B(),o=a.TOUCH_PAN;break;default:o=a.NONE}break;case 2:switch(n.touches.TWO){case uw.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&V(),n.enablePan&&B(),o=a.TOUCH_DOLLY_PAN;break;case uw.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&V(),n.enableRotate&&z(),o=a.TOUCH_DOLLY_ROTATE;break;default:o=a.NONE}break;default:o=a.NONE}o!==a.NONE&&n.dispatchEvent(i)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case dw.DOLLY:if(!1===n.enableZoom)return;!function(e){F(e),y.set(e.clientX,e.clientY)}(e),o=a.DOLLY;break;case dw.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;U(e),o=a.PAN}else{if(!1===n.enableRotate)return;D(e),o=a.ROTATE}break;case dw.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;D(e),o=a.ROTATE}else{if(!1===n.enablePan)return;U(e),o=a.PAN}break;default:o=a.NONE}o!==a.NONE&&n.dispatchEvent(i)}(e))}function X(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(Q(e),o){case a.TOUCH_ROTATE:if(!1===n.enableRotate)return;H(e),n.update();break;case a.TOUCH_PAN:if(!1===n.enablePan)return;W(e),n.update();break;case a.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&G(e),n.enablePan&&W(e)}(e),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&G(e),n.enableRotate&&H(e)}(e),n.update();break;default:o=a.NONE}}(e):function(e){if(!1===n.enabled)return;switch(o){case a.ROTATE:if(!1===n.enableRotate)return;!function(e){m.set(e.clientX,e.clientY),f.subVectors(m,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(E(2*Math.PI*f.x/t.clientHeight),C(2*Math.PI*f.y/t.clientHeight)),p.copy(m),n.update()}(e);break;case a.DOLLY:if(!1===n.enableZoom)return;!function(e){b.set(e.clientX,e.clientY),w.subVectors(b,y),w.y>0?R(M()):w.y<0&&I(M()),y.copy(b),n.update()}(e);break;case a.PAN:if(!1===n.enablePan)return;!function(e){x.set(e.clientX,e.clientY),v.subVectors(x,g).multiplyScalar(n.panSpeed),P(v.x,v.y),g.copy(x),n.update()}(e)}}(e))}function Y(e){var t,r,i;!function(e){delete A[e.pointerId];for(let t=0;t<j.length;t++)if(j[t].pointerId==e.pointerId)return void j.splice(t,1)}(e),0===j.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointermove",X),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointerup",Y)),n.dispatchEvent(s),o=a.NONE}function Z(e){!1===n.enabled||!1===n.enableZoom||o!==a.NONE&&o!==a.ROTATE||(e.preventDefault(),n.dispatchEvent(i),function(e){F(e),e.deltaY<0?I(M()):e.deltaY>0&&R(M()),n.update()}(e),n.dispatchEvent(s))}function J(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:P(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:P(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:P(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:P(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function K(e){!1!==n.enabled&&e.preventDefault()}function Q(e){let t=A[e.pointerId];void 0===t&&(t=new sj,A[e.pointerId]=t),t.set(e.pageX,e.pageY)}function $(e){const t=e.pointerId===j[0].pointerId?j[1]:j[0];return A[t.pointerId]}this.dollyIn=function(){I(arguments.length>0&&void 0!==arguments[0]?arguments[0]:M()),n.update()},this.dollyOut=function(){R(arguments.length>0&&void 0!==arguments[0]?arguments[0]:M()),n.update()},this.getScale=()=>u,this.setScale=e=>{L(e),n.update()},this.getZoomScale=()=>M(),void 0!==t&&this.connect(t),this.update()}}const OD=["makeDefault","camera","regress","domElement","enableDamping","keyEvents","onChange","onStart","onEnd"],DD=i.forwardRef((e,t)=>{let{makeDefault:n,camera:r,regress:s,domElement:a,enableDamping:o=!0,keyEvents:l=!1,onChange:c,onStart:d,onEnd:u}=e,h=Ie(e,OD);const p=dD(e=>e.invalidate),m=dD(e=>e.camera),f=dD(e=>e.gl),g=dD(e=>e.events),x=dD(e=>e.setEvents),v=dD(e=>e.set),y=dD(e=>e.get),b=dD(e=>e.performance),w=r||m,_=a||g.connected||f.domElement,S=i.useMemo(()=>new FD(w),[w]);return uD(()=>{S.enabled&&S.update()},-1),i.useEffect(()=>(l&&S.connect(!0===l?_:l),S.connect(_),()=>{S.dispose()}),[l,_,s,S,p]),i.useEffect(()=>{const e=e=>{p(),s&&b.regress(),c&&c(e)},t=e=>{d&&d(e)},n=e=>{u&&u(e)};return S.addEventListener("change",e),S.addEventListener("start",t),S.addEventListener("end",n),()=>{S.removeEventListener("start",t),S.removeEventListener("end",n),S.removeEventListener("change",e)}},[c,d,u,S,p,x]),i.useEffect(()=>{if(n){const e=y().controls;return v({controls:S}),()=>v({controls:e})}},[n,S]),i.createElement("primitive",lw({ref:t,object:S,enableDamping:o},h))});function UD(e,t){let n;return function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];window.clearTimeout(n),n=window.setTimeout(()=>e(...i),t)}}function zD(){let{debounce:e,scroll:t,polyfill:n,offsetSize:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debounce:0,scroll:!1,offsetSize:!1};const s=n||("undefined"==typeof window?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,o]=(0,i.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=(0,i.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),c=e?"number"==typeof e?e:e.scroll:null,d=e?"number"==typeof e?e:e.resize:null,u=(0,i.useRef)(!1);(0,i.useEffect)(()=>(u.current=!0,()=>{u.current=!1}));const[h,p,m]=(0,i.useMemo)(()=>{const e=()=>{if(!l.current.element)return;const{left:e,top:t,width:n,height:i,bottom:s,right:a,x:c,y:d}=l.current.element.getBoundingClientRect(),h={left:e,top:t,width:n,height:i,bottom:s,right:a,x:c,y:d};l.current.element instanceof HTMLElement&&r&&(h.height=l.current.element.offsetHeight,h.width=l.current.element.offsetWidth),Object.freeze(h),u.current&&!HD(l.current.lastBounds,h)&&o(l.current.lastBounds=h)};return[e,d?UD(e,d):e,c?UD(e,c):e]},[o,r,c,d]);function f(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",m,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null),l.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",l.current.orientationHandler))}function g(){l.current.element&&(l.current.resizeObserver=new s(m),l.current.resizeObserver.observe(l.current.element),t&&l.current.scrollContainers&&l.current.scrollContainers.forEach(e=>e.addEventListener("scroll",m,{capture:!0,passive:!0})),l.current.orientationHandler=()=>{m()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",l.current.orientationHandler))}return function(e,t){(0,i.useEffect)(()=>{if(t){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[e,t])}(m,!!t),function(e){(0,i.useEffect)(()=>{const t=e;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[e])}(p),(0,i.useEffect)(()=>{f(),g()},[t,m,p]),(0,i.useEffect)(()=>f,[]),[e=>{!e||e===l.current.element||(f(),l.current.element=e,l.current.scrollContainers=BD(e),g())},a,h]}function BD(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(e);return[n,r,i].some(e=>"auto"===e||"scroll"===e)&&t.push(e),[...t,...BD(e.parentElement)]}const VD=["x","y","top","bottom","left","right","width","height"],HD=(e,t)=>VD.every(n=>e[n]===t[n]);var WD,GD,qD=Object.defineProperty,XD=Object.defineProperties,YD=Object.getOwnPropertyDescriptors,ZD=Object.getOwnPropertySymbols,JD=Object.prototype.hasOwnProperty,KD=Object.prototype.propertyIsEnumerable,QD=(e,t,n)=>t in e?qD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$D=(e,t)=>{for(var n in t||(t={}))JD.call(t,n)&&QD(e,n,t[n]);if(ZD)for(var n of ZD(t))KD.call(t,n)&&QD(e,n,t[n]);return e};"undefined"===typeof window||!(null==(WD=window.document)?void 0:WD.createElement)&&"ReactNative"!==(null==(GD=window.navigator)?void 0:GD.product)?i.useEffect:i.useLayoutEffect;function eU(e,t,n){if(!e)return;if(!0===n(e))return e;let r=t?e.return:e.child;for(;r;){const e=eU(r,t,n);if(e)return e;r=t?null:r.sibling}}function tU(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(Jm){return e}}const nU=console.error;console.error=function(){const e=[...arguments].join("");if(!(null==e?void 0:e.startsWith("Warning:"))||!e.includes("useContext"))return nU.apply(this,arguments);console.error=nU};const rU=tU(i.createContext(null));class iU extends i.Component{render(){return i.createElement(rU.Provider,{value:this._reactInternals},this.props.children)}}function sU(){const e=i.useContext(rU);if(null===e)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=i.useId();return i.useMemo(()=>{for(const n of[e,null==e?void 0:e.alternate]){if(!n)continue;const e=eU(n,!1,e=>{let n=e.memoizedState;for(;n;){if(n.memoizedState===t)return!0;n=n.next}});if(e)return e}},[e,t])}function aU(){const e=function(){const e=sU(),[t]=i.useState(()=>new Map);t.clear();let n=e;for(;n;){if(n.type&&"object"===typeof n.type){const e=void 0===n.type._context&&n.type.Provider===n.type?n.type:n.type._context;e&&e!==rU&&!t.has(e)&&t.set(e,i.useContext(tU(e)))}n=n.return}return t}();return i.useMemo(()=>Array.from(e.keys()).reduce((t,n)=>r=>i.createElement(t,null,i.createElement(n.Provider,((e,t)=>XD(e,YD(t)))($D({},r),{value:e.get(n)}))),e=>i.createElement(iU,$D({},e))),[e])}const oU=["children","fallback","resize","style","gl","events","eventSource","eventPrefix","shadows","linear","flat","legacy","orthographic","frameloop","dpr","performance","raycaster","camera","scene","onPointerMissed","onCreated"],lU=i.forwardRef(function(e,n){let{children:r,fallback:s,resize:a,style:o,gl:l,events:c=AD,eventSource:d,eventPrefix:u,shadows:h,linear:p,flat:m,legacy:f,orthographic:g,frameloop:x,dpr:v,performance:y,raycaster:b,camera:w,scene:_,onPointerMissed:S,onCreated:N}=e,j=Ie(e,oU);i.useMemo(()=>{return e=t,void Object.assign(yO,e);var e},[]);const A=aU(),[M,E]=zD(qe({scroll:!0,debounce:{scroll:50,resize:0}},a)),C=i.useRef(null),k=i.useRef(null);i.useImperativeHandle(n,()=>C.current);const T=AO(S),[P,L]=i.useState(!1),[R,I]=i.useState(!1);if(P)throw P;if(R)throw R;const F=i.useRef(null);jO(()=>{const e=C.current;E.width>0&&E.height>0&&e&&(F.current||(F.current=_D(e)),F.current.configure({gl:l,events:c,shadows:h,linear:p,flat:m,legacy:f,orthographic:g,frameloop:x,dpr:v,performance:y,raycaster:b,camera:w,scene:_,size:E,onPointerMissed:function(){return null==T.current?void 0:T.current(...arguments)},onCreated:e=>{var t;null==e.events.connect||e.events.connect(d?(t=d)&&t.hasOwnProperty("current")?d.current:d:k.current),u&&e.setEvents({compute:(e,t)=>{const n=e[u+"X"],r=e[u+"Y"];t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==N||N(e)}}),F.current.render((0,Ue.jsx)(A,{children:(0,Ue.jsx)(EO,{set:I,children:(0,Ue.jsx)(i.Suspense,{fallback:(0,Ue.jsx)(MO,{set:L}),children:null!=r?r:null})})})))}),i.useEffect(()=>{const e=C.current;if(e)return()=>ND(e)},[]);const O=d?"none":"auto";return(0,Ue.jsx)("div",qe(qe({ref:k,style:qe({position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:O},o)},j),{},{children:(0,Ue.jsx)("div",{ref:M,style:{width:"100%",height:"100%"},children:(0,Ue.jsx)("canvas",{ref:C,style:{display:"block"},children:s})})}))}),cU=i.forwardRef(function(e,t){return(0,Ue.jsx)(iU,{children:(0,Ue.jsx)(lU,qe(qe({},e),{},{ref:t}))})});function dU(e){let{tiers:t=3,radius:n=2,height:r=1.2,shape:i="round",frostingColor:s="#FF69B4",customizations:a={},onAddToCart:o=null}=e;const l=r/t,c=(e,t)=>{switch(i){case"heart":const n=new fL(.3*e,1.8*e,t,64);return n.scale(1,1,.4),n;case"square":return new KM(2*e,t,2*e);case"rectangle":return new KM(2.5*e,t,1.5*e);default:return new fL(e,e,t,64)}},d=e=>{switch(i){case"heart":default:return new mL(1.05*e,64);case"square":return new wE(2.1*e,2.1*e);case"rectangle":return new wE(2.6*e,1.6*e)}};return(0,Ue.jsxs)("group",{children:[Array.from({length:t},(e,r)=>{const i=n*(1-.1*r);return(0,Ue.jsxs)("group",{children:[(0,Ue.jsxs)("mesh",{position:[0,l*r+l/2,0],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("primitive",{object:c(i,l)}),(0,Ue.jsx)("meshStandardMaterial",{color:"#8B4513",roughness:.9,metalness:0})]}),(0,Ue.jsxs)("mesh",{position:[0,l*(r+1)+.02,0],rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[(0,Ue.jsx)("primitive",{object:d(i)}),(0,Ue.jsx)("meshStandardMaterial",{color:s,roughness:.6,metalness:0})]}),r<t-1&&(0,Ue.jsxs)("mesh",{position:[0,l*r+l/2,0],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("primitive",{object:c(1.02*i,.1*l)}),(0,Ue.jsx)("meshStandardMaterial",{color:s,roughness:.6,metalness:0})]})]},r)}),Array.from({length:9},(e,t)=>{const i=t/9*Math.PI*2,s=.7*n,a=Math.cos(i)*s,o=Math.sin(i)*s,l=r+.1;return(0,Ue.jsxs)("mesh",{position:[a,l,o],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("sphereGeometry",{args:[.08,8,6]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#FFD700",roughness:.4,metalness:0})]},t)})]})}function uU(e){let{toppings:t=[],cakeRadius:n=2,cakeHeight:r=1.2,tiers:s=3}=e;const a=(0,i.useMemo)(()=>({sprinkles:new fL(.02,.02,.08,6),chocolate_chips:new sR(.06,8,6),nuts:new sR(.08,8,6),berries:new sR(.1,8,6),flowers:new sR(.12,8,6)}),[]),o=(0,i.useMemo)(()=>({sprinkles:new fR({color:"#FF6B6B",roughness:.7}),chocolate_chips:new fR({color:"#8B4513",roughness:.3}),nuts:new fR({color:"#A0522D",roughness:.8}),berries:new fR({color:"#FF1493",roughness:.6}),flowers:new fR({color:"#FF69B4",roughness:.5})}),[]);return(0,Ue.jsx)(Ue.Fragment,{children:t.map((e,t)=>{const i=((e,t)=>{const i=[],a=r/s;for(let r=0;r<t;r++){const e=Math.floor(Math.random()*s),t=Math.random()*Math.PI*2,r=Math.random()*n*.8,o=Math.cos(t)*r,l=Math.sin(t)*r,c=a*(e+1)+.05+.02*Math.random();i.push({x:o,y:c,z:l,rotX:Math.random()*Math.PI,rotY:Math.random()*Math.PI,rotZ:Math.random()*Math.PI,scale:.8+.4*Math.random()})}return i})(e.type,e.count||20),l=a[e.type],c=o[e.type];return l&&c?(0,Ue.jsx)("group",{children:i.map((e,t)=>(0,Ue.jsxs)("mesh",{position:[e.x,e.y,e.z],rotation:[e.rotX,e.rotY,e.rotZ],scale:[e.scale,e.scale,e.scale],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("primitive",{object:l}),(0,Ue.jsx)("primitive",{object:c})]},t))},t):null})})}function hU(e){var t,n;let{tiers:r=3,toppings:s=[],orderId:a="SB202509190067",onClose:o=null,customizations:l={},customizationOptions:c={},basePrice:d=0,onAddToCart:u=null}=e;const[h,p]=(0,i.useState)(r);console.log("\ud83c\udf82 BeautifulCakePreviewApp props:",{tiers:r,customizations:l,customizationOptions:c,basePrice:d});const m=()=>{var e,t;if(!l.shape)return"round";const n=null===(e=c.shapes)||void 0===e?void 0:e.find(e=>e.id===l.shape),r=(null===n||void 0===n||null===(t=n.name)||void 0===t?void 0:t.toLowerCase())||"round";return console.log("\ud83c\udf82 Shape:",l.shape,"Shape option:",n,"Final shape:",r),r};return(0,Ue.jsxs)("div",{style:{width:"100%",height:"600px",position:"relative"},children:[(0,Ue.jsxs)(cU,{shadows:!0,camera:{position:[0,4,8],fov:50},children:[(0,Ue.jsx)("ambientLight",{intensity:.4}),(0,Ue.jsx)("directionalLight",{position:[5,10,5],intensity:1.2,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-far":50,"shadow-camera-left":-10,"shadow-camera-right":10,"shadow-camera-top":10,"shadow-camera-bottom":-10}),(0,Ue.jsx)("pointLight",{position:[-8,6,-8],intensity:.6,color:"#FFF8DC"}),(0,Ue.jsx)("pointLight",{position:[8,4,8],intensity:.4,color:"#FFF8DC"}),(0,Ue.jsx)("spotLight",{position:[0,15,0],intensity:.8,angle:.3,penumbra:.5,castShadow:!0,color:"#FFF8DC"}),(0,Ue.jsxs)("group",{position:[0,0,0],children:[(0,Ue.jsx)(dU,{tiers:h,radius:2,height:1.8,shape:m(),frostingColor:(()=>{if(console.log("\ud83c\udf82 getFrostingColor called with customizations.frosting:",l.frosting,"customizations.color:",l.color),l.frosting){var e;const t=null===(e=c.frostings)||void 0===e?void 0:e.find(e=>e.id===l.frosting);console.log("\ud83c\udf82 Found frosting option:",t);let n="#FF69B4";switch(null===t||void 0===t?void 0:t.name){case"Buttercream":case"Cream Cheese":n="#FFF8DC";break;case"Chocolate Ganache":n="#8B4513";break;case"Whipped Cream":n="#FFFFFF";break;case"Red Velvet":n="#DC143C";break;default:n="#FF69B4"}return console.log("\ud83c\udf82 Using frosting color:",n),n}if(l.color){var t;const e=null===(t=c.colors)||void 0===t?void 0:t.find(e=>e.id===l.color);if(console.log("\ud83c\udf82 Found color option:",e),e)return console.log("\ud83c\udf82 Using selected color:",e.color),e.color}return console.log("\ud83c\udf82 No frosting or color selected, returning default pink"),"#FF69B4"})(),customizations:l,onAddToCart:u}),(0,Ue.jsx)(uU,{toppings:s,cakeRadius:2,cakeHeight:1.8,tiers:h})]}),(0,Ue.jsxs)("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.01,0],receiveShadow:!0,children:[(0,Ue.jsx)("planeGeometry",{args:[40,40]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#e6e6e6"})]}),(0,Ue.jsx)(DD,{enablePan:!0,enableZoom:!0,enableRotate:!0})]}),(0,Ue.jsxs)("div",{style:{position:"absolute",top:16,left:16,background:"rgba(255,255,255,0.9)",padding:12,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,Ue.jsx)("div",{style:{fontWeight:600,fontSize:14,color:"#333",marginBottom:8},children:"Cake Tiers"}),(0,Ue.jsx)("div",{style:{display:"flex",gap:8},children:[1,2,3].map(e=>(0,Ue.jsxs)("button",{onClick:()=>p(e),style:{padding:"6px 12px",borderRadius:"6px",border:h===e?"2px solid #FF69B4":"2px solid #ddd",background:h===e?"#FF69B4":"white",color:h===e?"white":"#333",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s"},children:[e," Tier",e>1?"s":""]},e))})]}),(0,Ue.jsxs)("div",{style:{position:"absolute",right:16,top:16,background:"rgba(255,255,255,0.9)",padding:12,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,Ue.jsxs)("div",{style:{fontWeight:600,fontSize:14,color:"#333"},children:["Order #",a]}),(0,Ue.jsxs)("div",{style:{fontSize:12,color:"#666",marginTop:4},children:[h," Tier",h>1?"s":""," Beautiful Cake"]}),(0,Ue.jsxs)("div",{style:{fontSize:11,color:"#888",marginTop:2},children:[m()," shape \u2022 ",(null===(t=c.frostings)||void 0===t||null===(n=t.find(e=>e.id===l.frosting))||void 0===n?void 0:n.name)||"Pink"," frosting"]}),l.message&&(0,Ue.jsxs)("div",{style:{fontSize:11,color:"#666",marginTop:4,fontStyle:"italic",maxWidth:"200px",wordWrap:"break-word"},children:['\ud83d\udc8c "',l.message,'"']}),(0,Ue.jsxs)("div",{style:{fontSize:12,color:"#e91e63",marginTop:4,fontWeight:"bold"},children:["RS ",(()=>{let e=d;if(console.log("\ud83c\udf82 Base price:",d,"Selected tiers:",h),2===h?(e+=1500,console.log("\ud83c\udf82 Added 2-tier cost: +1500, New price:",e)):3===h&&(e+=3e3,console.log("\ud83c\udf82 Added 3-tier cost: +3000, New price:",e)),l.size){var t;const n=null===(t=c.sizes)||void 0===t?void 0:t.find(e=>e.id===l.size);n&&(e+=n.priceModifier)}if(l.shape){var n;const t=null===(n=c.shapes)||void 0===n?void 0:n.find(e=>e.id===l.shape);t&&(e+=t.priceModifier)}if(l.frosting){var r;const t=null===(r=c.frostings)||void 0===r?void 0:r.find(e=>e.id===l.frosting);t&&(e+=t.priceModifier)}if(l.color){var i;const t=null===(i=c.colors)||void 0===i?void 0:i.find(e=>e.id===l.color);t&&(e+=t.priceModifier)}return l.toppings&&l.toppings.forEach(t=>{var n;const r=null===(n=c.toppings)||void 0===n?void 0:n.find(e=>e.id===t);r&&(e+=r.priceModifier)}),e})().toLocaleString()]})]}),(0,Ue.jsx)("div",{style:{position:"absolute",right:16,bottom:16},children:(0,Ue.jsx)("button",{onClick:u,style:{background:"linear-gradient(135deg, #e91e63, #f06292)",color:"white",border:"none",borderRadius:"25px",padding:"12px 24px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 15px rgba(233, 30, 99, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:e=>{e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 20px rgba(233, 30, 99, 0.4)"},onMouseOut:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 15px rgba(233, 30, 99, 0.3)"},children:"\ud83d\uded2 Add to Cart"})}),o&&(0,Ue.jsx)("button",{onClick:o,style:{position:"absolute",top:16,left:16,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"50%",width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",fontSize:"18px",color:"#666",zIndex:10},children:"\xd7"})]})}const pU=["children","eps","style","className","prepend","center","fullscreen","portal","distanceFactor","sprite","transform","occlude","onOcclude","castShadow","receiveShadow","material","geometry","zIndexRange","calculatePosition","as","wrapperClass","pointerEvents"],mU=new Oj,fU=new Oj,gU=new Oj,xU=new sj;function vU(e,t,n){const r=mU.setFromMatrixPosition(e.matrixWorld);r.project(t);const i=n.width/2,s=n.height/2;return[r.x*i+i,-r.y*s+s]}const yU=e=>Math.abs(e)<1e-10?0:e;function bU(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="matrix3d(";for(let i=0;16!==i;i++)r+=yU(t[i]*e.elements[i])+(15!==i?",":")");return n+r}const wU=(_U=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>bU(e,_U));var _U;const SU=(e,t)=>bU(e,(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1])(t),"translate(-50%,-50%)");const NU=i.forwardRef((e,t)=>{let{children:n,eps:r=.001,style:s,className:o,prepend:l,center:c,fullscreen:d,portal:u,distanceFactor:h,sprite:p=!1,transform:m=!1,occlude:f,onOcclude:g,castShadow:x,receiveShadow:v,material:y,geometry:b,zIndexRange:w=[16777271,0],calculatePosition:_=vU,as:S="div",wrapperClass:N,pointerEvents:j="auto"}=e,A=Ie(e,pU);const{gl:M,camera:E,scene:C,size:k,raycaster:T,events:P,viewport:L}=dD(),[R]=i.useState(()=>document.createElement(S)),I=i.useRef(),F=i.useRef(null),O=i.useRef(0),D=i.useRef([0,0]),U=i.useRef(null),z=i.useRef(null),B=(null==u?void 0:u.current)||P.connected||M.domElement.parentNode,V=i.useRef(null),H=i.useRef(!1),W=i.useMemo(()=>f&&"blending"!==f||Array.isArray(f)&&f.length&&function(e){return e&&"object"===typeof e&&"current"in e}(f[0]),[f]);i.useLayoutEffect(()=>{const e=M.domElement;f&&"blending"===f?(e.style.zIndex="".concat(Math.floor(w[0]/2)),e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)},[f]),i.useLayoutEffect(()=>{if(F.current){const e=I.current=a.createRoot(R);if(C.updateMatrixWorld(),m)R.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=_(F.current,E,k);R.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(e[0],"px,").concat(e[1],"px,0);transform-origin:0 0;")}return B&&(l?B.prepend(R):B.appendChild(R)),()=>{B&&B.removeChild(R),e.unmount()}}},[B,m]),i.useLayoutEffect(()=>{N&&(R.className=N)},[N]);const G=i.useMemo(()=>m?{position:"absolute",top:0,left:0,width:k.width,height:k.height,transformStyle:"preserve-3d",pointerEvents:"none"}:qe(qe({position:"absolute",transform:c?"translate3d(-50%,-50%,0)":"none"},d&&{top:-k.height/2,left:-k.width/2,width:k.width,height:k.height}),s),[s,c,d,k,m]),q=i.useMemo(()=>({position:"absolute",pointerEvents:j}),[j]);i.useLayoutEffect(()=>{var e,r;(H.current=!1,m)?null==(e=I.current)||e.render(i.createElement("div",{ref:U,style:G},i.createElement("div",{ref:z,style:q},i.createElement("div",{ref:t,className:o,style:s,children:n})))):null==(r=I.current)||r.render(i.createElement("div",{ref:t,style:G,className:o,children:n}))});const X=i.useRef(!0);uD(e=>{if(F.current){E.updateMatrixWorld(),F.current.updateWorldMatrix(!0,!1);const e=m?D.current:_(F.current,E,k);if(m||Math.abs(O.current-E.zoom)>r||Math.abs(D.current[0]-e[0])>r||Math.abs(D.current[1]-e[1])>r){const t=function(e,t){const n=mU.setFromMatrixPosition(e.matrixWorld),r=fU.setFromMatrixPosition(t.matrixWorld),i=n.sub(r),s=t.getWorldDirection(gU);return i.angleTo(s)>Math.PI/2}(F.current,E);let n=!1;W&&(Array.isArray(f)?n=f.map(e=>e.current):"blending"!==f&&(n=[C]));const r=X.current;if(n){const e=function(e,t,n,r){const i=mU.setFromMatrixPosition(e.matrixWorld),s=i.clone();s.project(t),xU.set(s.x,s.y),n.setFromCamera(xU,t);const a=n.intersectObjects(r,!0);if(a.length){const e=a[0].distance;return i.distanceTo(n.ray.origin)<e}return!0}(F.current,E,T,n);X.current=e&&!t}else X.current=!t;r!==X.current&&(g?g(!X.current):R.style.display=X.current?"block":"none");const i=Math.floor(w[0]/2),s=f?W?[w[0],i]:[i-1,0]:w;if(R.style.zIndex="".concat(function(e,t,n){if(t instanceof oE||t instanceof RE){const r=mU.setFromMatrixPosition(e.matrixWorld),i=fU.setFromMatrixPosition(t.matrixWorld),s=r.distanceTo(i),a=(n[1]-n[0])/(t.far-t.near),o=n[1]-a*t.far;return Math.round(a*s+o)}}(F.current,E,s)),m){const[e,t]=[k.width/2,k.height/2],n=E.projectionMatrix.elements[5]*t,{isOrthographicCamera:r,top:i,left:s,bottom:a,right:o}=E,l=wU(E.matrixWorldInverse),c=r?"scale(".concat(n,")translate(").concat(yU(-(o+s)/2),"px,").concat(yU((i+a)/2),"px)"):"translateZ(".concat(n,"px)");let d=F.current.matrixWorld;p&&(d=E.matrixWorldInverse.clone().transpose().copyPosition(d).scale(F.current.scale),d.elements[3]=d.elements[7]=d.elements[11]=0,d.elements[15]=1),R.style.width=k.width+"px",R.style.height=k.height+"px",R.style.perspective=r?"":"".concat(n,"px"),U.current&&z.current&&(U.current.style.transform="".concat(c).concat(l,"translate(").concat(e,"px,").concat(t,"px)"),z.current.style.transform=SU(d,1/((h||10)/400)))}else{const t=void 0===h?1:function(e,t){if(t instanceof RE)return t.zoom;if(t instanceof oE){const n=mU.setFromMatrixPosition(e.matrixWorld),r=fU.setFromMatrixPosition(t.matrixWorld),i=t.fov*Math.PI/180,s=n.distanceTo(r);return 1/(2*Math.tan(i/2)*s)}return 1}(F.current,E)*h;R.style.transform="translate3d(".concat(e[0],"px,").concat(e[1],"px,0) scale(").concat(t,")")}D.current=e,O.current=E.zoom}}if(!W&&V.current&&!H.current)if(m){if(U.current){const e=U.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=E;if(t||b)A.scale&&(Array.isArray(A.scale)?A.scale instanceof Oj?V.current.scale.copy(A.scale.clone().divideScalar(1)):V.current.scale.set(1/A.scale[0],1/A.scale[1],1/A.scale[2]):V.current.scale.setScalar(1/A.scale));else{const t=(h||10)/400,n=e.clientWidth*t,r=e.clientHeight*t;V.current.scale.set(n,r,1)}H.current=!0}}}else{const t=R.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/L.factor,n=t.clientWidth*e,r=t.clientHeight*e;V.current.scale.set(n,r,1),H.current=!0}V.current.lookAt(e.camera.position)}});const Y=i.useMemo(()=>({vertexShader:m?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "}),[m]);return i.createElement("group",lw({},A,{ref:F}),f&&!W&&i.createElement("mesh",{castShadow:x,receiveShadow:v,ref:V},b||i.createElement("planeGeometry",null),y||i.createElement("shaderMaterial",{side:_w,vertexShader:Y.vertexShader,fragmentShader:Y.fragmentShader})))}),jU=(e,t)=>e+Math.random()*(t-e),AU={sprinkles:{colors:["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD"],size:.02,shape:"cylinder",count:200},chocolate_chips:{colors:["#8B4513","#654321","#A0522D"],size:.08,shape:"sphere",count:80},nuts:{colors:["#8B4513","#A0522D","#D2691E"],size:.12,shape:"oval",count:60},berries:{colors:["#FF1493","#FF6347","#32CD32","#FFD700"],size:.15,shape:"sphere",count:40},coconut:{colors:["#F5F5DC","#FFF8DC","#F0E68C"],size:.06,shape:"flakes",count:120},flowers:{colors:["#FF69B4","#FFD700","#FF6347","#DA70D6","#98FB98"],size:.18,shape:"flower",count:25}};function MU(e){let{radius:t=2,height:n=1.2}=e;return(0,Ue.jsxs)("group",{children:[(0,Ue.jsxs)("mesh",{position:[0,n/2,0],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("cylinderGeometry",{args:[t,t,n,64]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#D4A574",roughness:.9,metalness:0,normalScale:[.5,.5]})]}),(0,Ue.jsxs)("mesh",{position:[0,.8*n,0],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("cylinderGeometry",{args:[.95*t,.95*t,.3*n,64]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#F5E6D3",roughness:.8,metalness:0})]}),(0,Ue.jsxs)("mesh",{position:[0,.5*n,0],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("cylinderGeometry",{args:[.95*t,.95*t,.3*n,64]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#8B4513",roughness:.8,metalness:0})]}),(0,Ue.jsxs)("mesh",{position:[0,.2*n,0],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("cylinderGeometry",{args:[.95*t,.95*t,.3*n,64]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#F5E6D3",roughness:.8,metalness:0})]}),(0,Ue.jsxs)("mesh",{position:[0,n/2,0],castShadow:!0,receiveShadow:!0,children:[(0,Ue.jsx)("cylinderGeometry",{args:[1.02*t,1.02*t,.05*n,64]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#FFF8DC",roughness:.7,metalness:0})]}),(0,Ue.jsxs)("mesh",{position:[0,n+.02,0],rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[(0,Ue.jsx)("circleGeometry",{args:[1.05*t,64]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#FFF8DC",roughness:.6,metalness:0})]}),(0,Ue.jsxs)("mesh",{position:[0,n+.01,0],rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[(0,Ue.jsx)("torusGeometry",{args:[.9*t,.08,16,64]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#FFF8DC",roughness:.5,metalness:0})]})]})}function EU(e){let{toppingType:t="sprinkles",distribution:n="full",cakeRadius:r=2,cakeHeight:s=1.2,orderId:a="67"}=e;const{viewport:o,camera:l,scene:c}=dD(),d=(0,i.useRef)(),u=(0,i.useMemo)(()=>function(e){const t=AU[e];switch(console.log("\ud83c\udf38 Creating geometry for",e,"with config:",t),t.shape){case"cylinder":return new fL(.5*t.size,.5*t.size,2*t.size,6);case"sphere":default:return new sR(t.size,8,6);case"oval":const e=new sR(t.size,8,6);return e.scale(1,.7,1.2),e;case"flakes":const n=new wE(t.size,1.5*t.size);return n.rotateX(.1*Math.PI),n;case"flower":const r=new sR(t.size,8,6);return r.scale(1,.3,1),r}}(t),[t]),h=(0,i.useMemo)(()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=AU[e],r=n.colors[t%n.colors.length];return console.log("\ud83c\udf38 Creating material for",e,"with color:",r),new fR({color:r,roughness:"coconut"===e?.9:"chocolate_chips"===e?.3:.7,metalness:"chocolate_chips"===e?.1:0,normalScale:new sj(.5,.5)})}(t),[t]),p=500,m=(0,i.useRef)(new Array(p).fill(0).map(()=>({active:!1,pos:new Oj,rot:new SA,scale:1,colorIndex:0}))),f=((0,i.useRef)(0),new pA);return(0,i.useEffect)(()=>{const e=AU[t];console.log("\ud83c\udf38 RealisticCakeToppings: Initializing",t,"with config:",e);const i=((e,t,n,r)=>{const i=[],a=AU[e];switch(t){case"full":for(let e=0;e<r;e++){const e=Math.random()*Math.PI*2,t=Math.sqrt(Math.random())*n*.85,r=Math.cos(e)*t,o=Math.sin(e)*t,l=s+.05+jU(-.01,.01);i.push({x:r,y:l,z:o,angle:jU(0,2*Math.PI),colorIndex:Math.floor(Math.random()*a.colors.length)})}break;case"border":for(let e=0;e<r;e++){const t=e/r*Math.PI*2,o=Math.cos(t)*n*.75,l=Math.sin(t)*n*.75,c=s+.05;i.push({x:o,y:c,z:l,angle:jU(0,2*Math.PI),colorIndex:Math.floor(Math.random()*a.colors.length)})}break;case"center":for(let e=0;e<r;e++){const t=e/r*Math.PI*2,o=Math.random()*n*.4,l=Math.cos(t)*o,c=Math.sin(t)*o,d=s+.05;i.push({x:l,y:d,z:c,angle:jU(0,2*Math.PI),colorIndex:Math.floor(Math.random()*a.colors.length)})}break;case"scattered":for(let e=0;e<r;e++){const e=Math.random()*Math.PI*2,t=Math.random()*n*.8,r=Math.cos(e)*t,o=Math.sin(e)*t,l=s+.05+jU(-.01,.01);i.push({x:r,y:l,z:o,angle:jU(0,2*Math.PI),colorIndex:Math.floor(Math.random()*a.colors.length)})}}return i})(t,n,r,e.count);console.log("\ud83c\udf38 Generated positions:",i.length,"for",t),i.forEach((e,t)=>{if(t<p){const n=m.current[t];n.active=!0,n.pos.set(e.x,e.y,e.z),n.rot.set(jU(0,Math.PI),e.angle,jU(0,Math.PI)),n.scale=jU(.8,1.2),n.colorIndex=e.colorIndex}})},[t,n,r,s]),uD((e,n)=>{const r=d.current;if(r){for(let i=0;i<p;i++){const s=m.current[i];s.active&&("sprinkles"===t?s.rot.y+=.01*n:"coconut"===t&&(s.rot.z+=.005*Math.sin(e.clock.elapsedTime+.1*i)*n),f.compose(s.pos,(new Fj).setFromEuler(s.rot),new Oj(s.scale,s.scale,s.scale)),r.setMatrixAt(i,f))}r.instanceMatrix.needsUpdate=!0}}),(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("instancedMesh",{ref:d,args:[u,h,p],castShadow:!0,receiveShadow:!0}),(0,Ue.jsx)(NU,{fullscreen:!0,children:(0,Ue.jsx)("div",{id:"topping-canvas-overlay",style:{position:"absolute",inset:0,cursor:"pointer"},children:(0,Ue.jsxs)("div",{style:{position:"absolute",right:16,top:16,background:"rgba(255,255,255,0.9)",padding:12,borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[(0,Ue.jsxs)("div",{style:{fontWeight:600,fontSize:14,color:"#333"},children:["Order #",a]}),(0,Ue.jsx)("div",{style:{fontSize:12,color:"#666",marginTop:4},children:"full"===n?"Full Topping Coverage":"border"===n?"Border Topping Arrangement":"center"===n?"Center Topping Design":"Scattered Topping Style"}),(0,Ue.jsxs)("div",{style:{fontSize:11,color:"#888",marginTop:2},children:[t.replace("_"," ")," toppings"]})]})})})]})}function CU(e){let{toppingType:t="sprinkles",distribution:n="full",orderId:r="SB202509190067"}=e;return console.log("\ud83c\udf38 RealisticCakeToppingsApp: Received props:",{toppingType:t,distribution:n,orderId:r}),(0,Ue.jsx)("div",{style:{width:"100%",height:"600px"},children:(0,Ue.jsxs)(cU,{shadows:!0,camera:{position:[0,3,6],fov:50},children:[(0,Ue.jsx)("ambientLight",{intensity:.4}),(0,Ue.jsx)("directionalLight",{position:[5,10,5],intensity:1.2,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-far":50,"shadow-camera-left":-10,"shadow-camera-right":10,"shadow-camera-top":10,"shadow-camera-bottom":-10}),(0,Ue.jsx)("pointLight",{position:[-8,6,-8],intensity:.6,color:"#FFF8DC"}),(0,Ue.jsx)("pointLight",{position:[8,4,8],intensity:.4,color:"#FFF8DC"}),(0,Ue.jsx)("spotLight",{position:[0,15,0],intensity:.8,angle:.3,penumbra:.5,castShadow:!0,color:"#FFF8DC"}),(0,Ue.jsxs)("group",{position:[0,0,0],children:[(0,Ue.jsx)(MU,{}),(0,Ue.jsx)(EU,{toppingType:t,distribution:n,cakeRadius:2,cakeHeight:1.2,orderId:r.split("#").pop?r.split("#").pop():r})]}),(0,Ue.jsxs)("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.01,0],receiveShadow:!0,children:[(0,Ue.jsx)("planeGeometry",{args:[40,40]}),(0,Ue.jsx)("meshStandardMaterial",{color:"#e6e6e6"})]}),(0,Ue.jsx)(DD,{enablePan:!0,enableZoom:!0,enableRotate:!0})]})})}const kU={sprinkles:{colors:["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD"],size:.02,shape:"cylinder",count:200},chocolate_chips:{colors:["#8B4513","#654321","#A0522D"],size:.08,shape:"sphere",count:80},nuts:{colors:["#8B4513","#A0522D","#D2691E"],size:.12,shape:"oval",count:60},berries:{colors:["#FF1493","#FF6347","#32CD32","#FFD700"],size:.15,shape:"sphere",count:40},coconut:{colors:["#F5F5DC","#FFF8DC","#F0E68C"],size:.06,shape:"flakes",count:120},flowers:{colors:["#FF69B4","#FFD700","#FF6347","#DA70D6","#98FB98"],size:.18,shape:"flower",count:25}},TU=e=>{let{isActive:t,customizationType:n,customizationData:r,onClose:s}=e;const[a,o]=(0,i.useState)("3d"),[l,c]=(0,i.useState)(!1);if(!t)return null;return(0,Ue.jsx)(tl.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,Ue.jsxs)(tl.div,{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{scale:.8,y:50},animate:{scale:1,y:0},exit:{scale:.8,y:50},transition:{type:"spring",stiffness:300,damping:30},children:[(0,Ue.jsx)("div",{className:"bg-gradient-to-r from-sweetbite-500 to-pink-500 p-6 text-white",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold",children:(()=>{switch(n){case"size":return"\ud83c\udf82 Size Preview";case"shape":return"\ud83d\udd37 Shape Preview";case"frosting":return"\ud83c\udfa8 Frosting Preview";case"color":return"\ud83c\udf08 Color Preview";case"message":return"\ud83d\udcac Message Preview";default:return"\ud83c\udfa8 3D Preview"}})()}),(0,Ue.jsx)("p",{className:"text-sweetbite-100 mt-1",children:(()=>{switch(n){case"size":return"See how your cake size looks in 3D";case"shape":return"Explore different cake shapes";case"frosting":return"Preview frosting styles and textures";case"color":return"Visualize color combinations";case"message":return"See how your message appears on the cake";default:return"\ud83c\udfa8 3D Preview"}})()})]}),(0,Ue.jsx)("button",{onClick:s,className:"text-white hover:text-gray-200 transition-colors",children:(0,Ue.jsx)(Dv,{className:"h-8 w-8"})})]})}),(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"3D Preview"}),(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("button",{onClick:()=>o("3d"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("3d"===a?"bg-sweetbite-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"\ud83c\udfa8 3D View"}),(0,Ue.jsx)("button",{onClick:()=>o("2d"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("2d"===a?"bg-sweetbite-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"\ud83d\udcf1 2D View"})]})]}),(0,Ue.jsx)("div",{className:"bg-gray-100 rounded-xl p-8 h-96 flex items-center justify-center",children:"3d"===a?(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udf82"}),(0,Ue.jsxs)("h4",{className:"text-xl font-semibold text-gray-700 mb-2",children:["size"===n&&"Size: "+(r.size||"Medium"),"shape"===n&&"Shape: "+(r.shape||"Round"),"frosting"===n&&"Frosting: "+(r.frosting||"Vanilla"),"color"===n&&"Color: "+(r.color||"Pink"),"message"===n&&"Message: "+(r.message||"Happy Birthday!")]}),(0,Ue.jsx)("p",{className:"text-gray-500",children:"3D preview coming soon!"})]}):(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"text-4xl mb-4",children:"\ud83d\udcf1"}),(0,Ue.jsx)("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"2D Preview"}),(0,Ue.jsx)("p",{className:"text-gray-500",children:"2D preview mode"})]})})]}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Customization Options"}),"size"===n&&(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"p-4 border-2 border-sweetbite-200 rounded-lg bg-sweetbite-50",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-sweetbite-800",children:"Current Size"}),(0,Ue.jsx)("p",{className:"text-sweetbite-600",children:r.size||"Medium"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["Small","Medium","Large","Extra Large"].map(e=>(0,Ue.jsx)("button",{className:"p-3 border border-gray-300 rounded-lg hover:border-sweetbite-400 hover:bg-sweetbite-50 transition-colors",children:e},e))})]}),"shape"===n&&(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"p-4 border-2 border-sweetbite-200 rounded-lg bg-sweetbite-50",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-sweetbite-800",children:"Current Shape"}),(0,Ue.jsx)("p",{className:"text-sweetbite-600",children:r.shape||"Round"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["Round","Square","Heart","Rectangle"].map(e=>(0,Ue.jsxs)("button",{className:"p-3 border border-gray-300 rounded-lg hover:border-sweetbite-400 hover:bg-sweetbite-50 transition-colors flex items-center justify-center",children:[(0,Ue.jsxs)("span",{className:"text-2xl mr-2",children:["Round"===e&&"\u2b55","Square"===e&&"\u2b1c","Heart"===e&&"\u2764\ufe0f","Rectangle"===e&&"\u25ac"]}),e]},e))})]}),"frosting"===n&&(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"p-4 border-2 border-sweetbite-200 rounded-lg bg-sweetbite-50",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-sweetbite-800",children:"Current Frosting"}),(0,Ue.jsx)("p",{className:"text-sweetbite-600",children:r.frosting||"Vanilla"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["Vanilla","Chocolate","Strawberry","Lemon"].map(e=>(0,Ue.jsx)("button",{className:"p-3 border border-gray-300 rounded-lg hover:border-sweetbite-400 hover:bg-sweetbite-50 transition-colors",children:e},e))})]}),"color"===n&&(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"p-4 border-2 border-sweetbite-200 rounded-lg bg-sweetbite-50",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-sweetbite-800",children:"Current Color"}),(0,Ue.jsx)("p",{className:"text-sweetbite-600",children:r.color||"Pink"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-4 gap-3",children:["Red","Blue","Green","Purple","Pink","Yellow","Orange","Teal"].map(e=>(0,Ue.jsxs)("button",{className:"p-3 border border-gray-300 rounded-lg hover:border-sweetbite-400 hover:bg-sweetbite-50 transition-colors",children:[(0,Ue.jsx)("div",{className:"w-6 h-6 rounded-full mx-auto mb-1 bg-".concat(e.toLowerCase(),"-400")}),e]},e))})]}),"message"===n&&(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"p-4 border-2 border-sweetbite-200 rounded-lg bg-sweetbite-50",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-sweetbite-800",children:"Current Message"}),(0,Ue.jsx)("p",{className:"text-sweetbite-600",children:r.message||"Happy Birthday!"})]}),(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsx)("textarea",{placeholder:"Enter your custom message...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent",rows:3}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["Happy Birthday!","Congratulations!","Happy Anniversary!","Custom Message"].map(e=>(0,Ue.jsx)("button",{className:"p-3 border border-gray-300 rounded-lg hover:border-sweetbite-400 hover:bg-sweetbite-50 transition-colors text-sm",children:e},e))})]})]})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-4 mt-6 pt-6 border-t border-gray-200",children:[(0,Ue.jsx)("button",{onClick:s,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,Ue.jsx)("button",{onClick:()=>{c(!0),setTimeout(()=>{c(!1),s()},1e3)},disabled:l,className:"px-6 py-3 bg-sweetbite-500 text-white rounded-lg hover:bg-sweetbite-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:l?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Applying..."]}):"Apply Changes"})]})]})]})})},PU=e=>{var t,n,r,i,s,a;let{cake:o,customizations:l,customizationOptions:c,totalPrice:d,isMainDisplay:u=!1}=e;const h=()=>{if(l.color)return"bg-".concat(l.color,"-400");if(!l.frosting)return"bg-yellow-200";const e=c.frostings.find(e=>e.id===l.frosting);switch(null===e||void 0===e?void 0:e.name){case"Vanilla":default:return"bg-yellow-200";case"Chocolate":return"bg-amber-800";case"Strawberry":return"bg-pink-300";case"Cream Cheese":return"bg-white";case"Buttercream":return"bg-yellow-100";case"Lemon":return"bg-yellow-300";case"Mint":return"bg-green-300";case"Orange":return"bg-orange-300";case"Raspberry":return"bg-red-400";case"Caramel":return"bg-amber-600"}},p=()=>{if(!l.shape)return"round-shape";const e=c.shapes.find(e=>e.id===l.shape);switch(null===e||void 0===e?void 0:e.name){case"Round":default:return"round-shape";case"Square":return"square-shape";case"Heart":return"heart-shape";case"Rectangle":return"rectangle-shape"}},m=()=>l.toppings&&0!==l.toppings.length?l.toppings.map(e=>{const t=c.toppings.find(t=>t.id===e);return t}).filter(Boolean):[];return(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("style",{jsx:!0,children:"\n        .heart-shape {\n          clip-path: path('M12,21.35l-1.45-1.32C5.4,15.36,2,12.28,2,8.5 C2,5.42,4.42,3,7.5,3c1.74,0,3.41,0.81,4.5,2.09C13.09,3.81,14.76,3,16.5,3 C19.58,3,22,5.42,22,8.5c0,3.78-3.4,6.86-8.55,11.54L12,21.35z');\n          transform: scale(3.0);\n        }\n        .square-shape {\n          clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%);\n        }\n        .rectangle-shape {\n          clip-path: polygon(10% 0%, 90% 0%, 100% 50%, 90% 100%, 10% 100%, 0% 50%);\n        }\n        .round-shape {\n          clip-path: circle(50%);\n        }\n        .cake-3d {\n          transform-style: preserve-3d;\n          perspective: 800px;\n          perspective-origin: center center;\n        }\n        .cake-layer {\n          transform: translateZ(15px);\n          box-shadow: \n            0 15px 30px rgba(0,0,0,0.4),\n            0 8px 16px rgba(0,0,0,0.3),\n            inset 0 3px 6px rgba(255,255,255,0.4),\n            inset 0 -2px 4px rgba(0,0,0,0.2);\n        }\n        .cake-shadow {\n          filter: drop-shadow(0 20px 35px rgba(0,0,0,0.5));\n        }\n        .topping-3d {\n          transform: translateZ(25px);\n          filter: drop-shadow(0 8px 15px rgba(0,0,0,0.4));\n        }\n        .cake-base-3d {\n          transform: translateZ(5px);\n          box-shadow: \n            0 20px 40px rgba(0,0,0,0.3),\n            0 10px 20px rgba(0,0,0,0.2),\n            inset 0 4px 8px rgba(255,255,255,0.3);\n        }\n      "}),(0,Ue.jsxs)(tl.div,{className:"".concat((()=>{if(!l.size)return u?"w-48 h-48":"w-32 h-32";const e=c.sizes.find(e=>e.id===l.size);switch(null===e||void 0===e?void 0:e.name){case"Small (6 inch)":return u?"w-36 h-36":"w-24 h-24";case"Medium (8 inch)":default:return u?"w-48 h-48":"w-32 h-32";case"Large (10 inch)":return u?"w-60 h-60":"w-40 h-40";case"Extra Large (12 inch)":return u?"w-72 h-72":"w-48 h-48"}})()," ").concat(h()," ").concat(p()," relative mx-auto cake-3d cake-base-3d cake-shadow border-4 border-white"),animate:{scale:[1,1.12,1],rotateY:[0,25,-25,0],rotateX:[0,12,-12,0],rotateZ:[0,5,-5,0],y:[0,-5,5,0],x:[0,3,-3,0]},transition:{duration:3,ease:"easeInOut",repeat:1/0,repeatType:"reverse"},children:[(0,Ue.jsx)(tl.div,{className:"absolute inset-2 bg-gradient-to-b from-amber-200 to-amber-300 opacity-90 ".concat(p()," cake-layer"),animate:{rotateY:[0,10,-10,0],rotateX:[0,5,-5,0],scale:[1,1.02,1]},transition:{duration:2.5,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:.2}}),(0,Ue.jsx)(tl.div,{className:"absolute inset-4 bg-gradient-to-b from-amber-800 to-amber-900 opacity-70 ".concat(p()," cake-layer"),animate:{rotateY:[0,-8,8,0],rotateX:[0,-3,3,0],scale:[1,1.01,1]},transition:{duration:2.8,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:.5}}),(0,Ue.jsx)(tl.div,{className:"absolute inset-6 bg-gradient-to-b from-amber-200 to-amber-300 opacity-60 ".concat(p()," cake-layer"),animate:{rotateY:[0,6,-6,0],rotateX:[0,2,-2,0],scale:[1,1.01,1]},transition:{duration:3,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:.8}}),(0,Ue.jsx)(tl.div,{className:"absolute inset-1 bg-gradient-to-b from-yellow-50 to-yellow-100 opacity-95 ".concat(p()," cake-layer"),style:{background:"linear-gradient(135deg, #FFF8DC 0%, #F5E6D3 50%, #FFF8DC 100%)",boxShadow:"inset 0 2px 4px rgba(255,255,255,0.3), inset 0 -2px 4px rgba(0,0,0,0.1)"},animate:{rotateZ:[0,2,-2,0],scale:[1,1.03,1]},transition:{duration:3.2,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:.8}}),(0,Ue.jsx)(tl.div,{className:"absolute inset-0 bg-gradient-to-b from-yellow-50 to-yellow-100 opacity-80 ".concat(p()," cake-layer"),style:{borderRadius:"50%",border:"3px solid #FFF8DC",boxShadow:"0 0 0 2px #F5E6D3, inset 0 0 0 1px rgba(255,255,255,0.5)"},animate:{scale:[1,1.01,1],opacity:[.8,.9,.8]},transition:{duration:2.5,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:1}}),l.frosting&&(0,Ue.jsx)(tl.div,{className:"absolute inset-2 ".concat(h()," opacity-30 ").concat(p()," cake-layer"),style:{background:"radial-gradient(circle at 30% 30%, ".concat(h().replace("bg-","")," 2px, transparent 2px),\n                          radial-gradient(circle at 70% 70%, ").concat(h().replace("bg-","")," 1px, transparent 1px)")},animate:{rotateY:[0,15,-15,0],opacity:[.3,.5,.3]},transition:{duration:2,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:1}}),l.size&&(0,Ue.jsx)(tl.div,{className:"absolute inset-3 border-2 border-white opacity-20 ".concat(p()," cake-layer"),animate:{rotateY:[0,8,-8,0],scale:[1,1.01,1],opacity:[.2,.4,.2]},transition:{duration:2.3,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:1.2}}),m().map((e,t)=>{let n,r;const i=e.name,s=m().filter(e=>e.name===i).length,a=m().slice(0,t+1).filter(e=>e.name===i).length-1;if("Sprinkles"===i){const e=Math.ceil(Math.sqrt(4*s)),t=Math.floor(a/e),i=10,o=15;n=15+a%e*i+(6*Math.random()-3),r=o+t*i+(6*Math.random()-3)}else if("Nuts"===i){const e=Math.ceil(Math.sqrt(3*s)),t=Math.floor(a/e),i=20,o=15;n=15+a%e*i+(8*Math.random()-4),r=o+t*i+(8*Math.random()-4)}else if("Chocolate Chips"===i){const e=Math.ceil(Math.sqrt(5*s)),t=Math.floor(a/e),i=12,o=10;n=10+a%e*i+(5*Math.random()-2.5),r=o+t*i+(5*Math.random()-2.5)}else if("Fresh Berries"===i){const e=Math.ceil(Math.sqrt(3*s)),t=Math.floor(a/e),i=18,o=20;n=20+a%e*i+(10*Math.random()-5),r=o+t*i+(10*Math.random()-5)}else if("Edible Flowers"===i){const e=Math.ceil(Math.sqrt(6*s)),t=Math.floor(a/e),i=12,o=10;n=10+a%e*i+(8*Math.random()-4),r=o+t*i+(8*Math.random()-4)}else{const e=Math.ceil(Math.sqrt(2.5*s)),t=Math.floor(a/e),i=20,o=15;n=15+a%e*i+(6*Math.random()-3),r=o+t*i+(6*Math.random()-3)}return n=Math.max(8,Math.min(92,n)),r=Math.max(8,Math.min(92,r)),(0,Ue.jsxs)(tl.div,{className:"absolute topping-3d",style:{top:"".concat(r,"%"),left:"".concat(n,"%"),transform:"translate(-50%, -50%)"},initial:{opacity:0,scale:0,rotateZ:-180,y:-20},animate:{opacity:1,scale:[1,1.1,1],rotateZ:[0,360,0],y:[0,-3,3,0],rotateY:[0,10,-10,0]},transition:{delay:.1*t,duration:.6,repeat:1/0,repeatType:"reverse",repeatDelay:2},children:["Fresh Berries"===e.name&&(0,Ue.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full shadow-lg border-2 border-red-600 animate-pulse"}),"Chocolate Chips"===e.name&&(0,Ue.jsx)("div",{className:"w-2 h-2 bg-amber-900 rounded-full shadow-lg border border-amber-950"}),"Sprinkles"===e.name&&(0,Ue.jsxs)("div",{className:"flex space-x-0.5",children:[(0,Ue.jsx)("div",{className:"w-1 h-3 bg-pink-500 rounded-full shadow-sm"}),(0,Ue.jsx)("div",{className:"w-1 h-3 bg-blue-500 rounded-full shadow-sm"}),(0,Ue.jsx)("div",{className:"w-1 h-3 bg-yellow-500 rounded-full shadow-sm"}),(0,Ue.jsx)("div",{className:"w-1 h-3 bg-white rounded-full shadow-sm"})]}),"Nuts"===e.name&&(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-amber-700 rounded-full shadow-lg border-2 border-amber-800"}),(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1 w-1.5 h-1.5 bg-amber-600 rounded-full shadow-sm border border-amber-700"}),(0,Ue.jsx)("div",{className:"absolute -bottom-1 -left-1 w-1 h-1 bg-amber-800 rounded-full shadow-sm"})]}),"Fruit Slices"===e.name&&(0,Ue.jsx)("div",{className:"w-3 h-3 bg-orange-400 rounded-full shadow-lg border-2 border-orange-500"}),"Candles"===e.name&&(0,Ue.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Ue.jsx)("div",{className:"w-1 h-4 bg-yellow-300 rounded-full shadow-lg"}),(0,Ue.jsx)("div",{className:"w-1 h-1 bg-red-500 rounded-full mt-1 animate-pulse"})]}),"Edible Flowers"===e.name&&(0,Ue.jsx)("div",{className:"relative",children:(0,Ue.jsxs)("div",{className:"w-4 h-4 relative",children:[(0,Ue.jsx)("div",{className:"absolute top-1/2 left-1/2 w-1.5 h-1.5 bg-yellow-300 rounded-full transform -translate-x-1/2 -translate-y-1/2 shadow-sm"}),(0,Ue.jsx)("div",{className:"absolute top-0 left-1/2 w-2 h-2 bg-pink-300 rounded-full transform -translate-x-1/2 -translate-y-1/2 rotate-0"}),(0,Ue.jsx)("div",{className:"absolute top-1/2 right-0 w-2 h-2 bg-pink-300 rounded-full transform translate-x-1/2 -translate-y-1/2 rotate-90"}),(0,Ue.jsx)("div",{className:"absolute bottom-0 left-1/2 w-2 h-2 bg-pink-300 rounded-full transform -translate-x-1/2 translate-y-1/2 rotate-180"}),(0,Ue.jsx)("div",{className:"absolute top-1/2 left-0 w-2 h-2 bg-pink-300 rounded-full transform -translate-x-1/2 -translate-y-1/2 rotate-270"}),(0,Ue.jsx)("div",{className:"absolute top-1 left-1 w-1.5 h-1.5 bg-pink-200 rounded-full transform rotate-45"}),(0,Ue.jsx)("div",{className:"absolute top-1 right-1 w-1.5 h-1.5 bg-pink-200 rounded-full transform -rotate-45"}),(0,Ue.jsx)("div",{className:"absolute bottom-1 left-1 w-1.5 h-1.5 bg-pink-200 rounded-full transform -rotate-45"}),(0,Ue.jsx)("div",{className:"absolute bottom-1 right-1 w-1.5 h-1.5 bg-pink-200 rounded-full transform rotate-45"})]})}),"Gold Leaf"===e.name&&(0,Ue.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full shadow-lg border-2 border-yellow-500 animate-pulse"}),"Coconut Flakes"===e.name&&(0,Ue.jsx)("div",{className:"w-2 h-2 bg-white rounded-full shadow-sm border border-gray-300"}),"Caramel Drizzle"===e.name&&(0,Ue.jsx)("div",{className:"w-4 h-1 bg-amber-600 rounded-full shadow-sm"}),"Whipped Cream"===e.name&&(0,Ue.jsx)("div",{className:"w-3 h-2 bg-white rounded-full shadow-sm border border-gray-200"}),"Mint Leaves"===e.name&&(0,Ue.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full shadow-sm"})]},t)}),l.toppings&&l.toppings.length>0&&(0,Ue.jsxs)(Ue.Fragment,{children:[Array.from({length:12},(e,t)=>(0,Ue.jsx)(tl.div,{className:"absolute w-1 h-1 bg-yellow-300 rounded-full opacity-70",style:{top:"".concat(20+5*t,"%"),left:"".concat(15+7*t,"%")},animate:{scale:[.5,1.5,.5],opacity:[.3,1,.3],rotateZ:[0,360],y:[0,-10,10,0]},transition:{duration:2+.1*t,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:.2*t}},"particle-".concat(t))),(0,Ue.jsx)(tl.div,{className:"absolute inset-0 pointer-events-none",animate:{scale:[1,1.1,1],opacity:[0,.3,0]},transition:{duration:.5,ease:"easeOut",repeat:1/0,repeatDelay:3},children:(0,Ue.jsx)("div",{className:"absolute top-1/2 left-1/2 w-20 h-20 bg-gradient-radial from-yellow-200 to-transparent rounded-full transform -translate-x-1/2 -translate-y-1/2"})})]}),(null===(t=l.toppings)||void 0===t?void 0:t.includes(null===(n=c.toppings.find(e=>"Edible Flowers"===e.name))||void 0===n?void 0:n.id))&&(0,Ue.jsxs)(Ue.Fragment,{children:[Array.from({length:8},(e,t)=>(0,Ue.jsx)(tl.div,{className:"absolute w-2 h-2 bg-pink-200 rounded-full opacity-60",style:{top:"".concat(15+10*t,"%"),left:"".concat(10+12*t,"%")},animate:{scale:[.8,1.2,.8],opacity:[.4,.8,.4],rotateZ:[0,180,360],y:[0,-8,8,0],x:[0,5,-5,0]},transition:{duration:3+.2*t,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:.3*t}},"flower-petal-".concat(t))),(0,Ue.jsx)(tl.div,{className:"absolute inset-0 pointer-events-none",animate:{opacity:[.1,.3,.1],scale:[1,1.05,1]},transition:{duration:2,ease:"easeInOut",repeat:1/0,repeatType:"reverse"},children:(0,Ue.jsx)("div",{className:"absolute inset-2 bg-gradient-radial from-pink-100 via-pink-50 to-transparent rounded-full"})})]}),l.message&&(0,Ue.jsx)(tl.div,{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 text-xs text-gray-700 font-semibold text-center px-2 bg-white bg-opacity-80 rounded-full py-1",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:l.message.length>15?l.message.substring(0,15)+"...":l.message}),m().some(e=>["Gold Leaf","Edible Flowers"].includes(e.name))&&(0,Ue.jsx)(tl.div,{className:"absolute inset-0 bg-gradient-to-r from-yellow-200 to-pink-200 opacity-20 rounded-full",animate:{opacity:[.2,.4,.2],scale:[1,1.05,1],rotateZ:[0,180,360]},transition:{duration:4,ease:"easeInOut",repeat:1/0,repeatType:"loop"}}),(null===(r=l.toppings)||void 0===r?void 0:r.includes(null===(i=c.toppings.find(e=>"Nuts"===e.name))||void 0===i?void 0:i.id))&&(0,Ue.jsx)(Ue.Fragment,{children:Array.from({length:8},(e,t)=>(0,Ue.jsx)(tl.div,{className:"absolute w-1.5 h-1.5 bg-amber-600 rounded-full shadow-sm border border-amber-700",style:{top:"".concat(20+8*t,"%"),left:"".concat(15+10*t,"%")},animate:{scale:[1,1.2,1],opacity:[.7,1,.7],rotateZ:[0,180,360]},transition:{duration:3+.2*t,ease:"easeInOut",repeat:1/0,repeatType:"reverse",delay:.3*t}},"extra-nut-".concat(t)))}),(0,Ue.jsxs)(tl.div,{className:"absolute inset-0 pointer-events-none",animate:{rotateZ:[0,360],scale:[1,1.02,1]},transition:{duration:8,ease:"linear",repeat:1/0,repeatType:"loop"},children:[(0,Ue.jsx)("div",{className:"absolute top-2 left-2 w-1 h-1 bg-yellow-300 rounded-full opacity-60"}),(0,Ue.jsx)("div",{className:"absolute top-4 right-3 w-1 h-1 bg-pink-300 rounded-full opacity-60"}),(0,Ue.jsx)("div",{className:"absolute bottom-3 left-4 w-1 h-1 bg-blue-300 rounded-full opacity-60"}),(0,Ue.jsx)("div",{className:"absolute bottom-2 right-2 w-1 h-1 bg-green-300 rounded-full opacity-60"})]})]}),!u&&(0,Ue.jsxs)("div",{className:"mt-4 text-center",children:[(0,Ue.jsxs)(tl.div,{className:"text-sm text-gray-600",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[l.size&&(0,Ue.jsx)("span",{className:"block",children:null===(s=c.sizes.find(e=>e.id===l.size))||void 0===s?void 0:s.name}),l.frosting&&(0,Ue.jsxs)("span",{className:"block",children:[null===(a=c.frostings.find(e=>e.id===l.frosting))||void 0===a?void 0:a.name," Frosting"]}),m().length>0&&(0,Ue.jsx)("span",{className:"block",children:m().map(e=>e.name).join(", ")})]},JSON.stringify(l)),(0,Ue.jsxs)(tl.div,{className:"mt-3 text-lg font-bold text-sweetbite-600",initial:{scale:1.2,color:"#059669"},animate:{scale:1,color:"#dc2626"},transition:{duration:.3},children:["RS ",d.toFixed(2)]},d)]})]})},LU=()=>{var e,t,n,r,s,a,o,l,c,d,u,h,p,m,f,g,x,v,y,b,w;const{cakeId:_}=re(),S=ne(),{addItem:N}=hl(),{isAuthenticated:j}=Be(),[A,M]=(0,i.useState)(null),[E,C]=(0,i.useState)([]),[k,T]=(0,i.useState)([]),[P,L]=(0,i.useState)(0),[R,I]=(0,i.useState)(!0),[F,O]=(0,i.useState)({size:null,shape:null,frosting:null,toppings:[],message:"",color:null,theme:null}),[D,U]=(0,i.useState)(0),[z,B]=(0,i.useState)(!1),[V,H]=(0,i.useState)({rating:0,comment:""}),[W,G]=(0,i.useState)(!1),[q,X]=(0,i.useState)({isActive:!1,type:null}),[Y,Z]=(0,i.useState)({isActive:!1,size:null}),[J,K]=(0,i.useState)({isActive:!1,shape:null}),[Q,$]=(0,i.useState)({isActive:!1,frosting:null}),[ee,te]=(0,i.useState)({isActive:!1,color:null}),[ie,se]=(0,i.useState)({isActive:!1,message:null}),[ae,oe]=(0,i.useState)({isActive:!1,flowerType:"rose",coverage:"full"}),[le,ce]=(0,i.useState)({isActive:!1,toppingType:"sprinkles",distribution:"full"}),[de,ue]=(0,i.useState)({isActive:!1,tiers:3}),he=(0,i.useCallback)(async()=>{try{console.log("Fetching cake details for ID:",_);const e=await ow.get("http://localhost:8000/api/cakes/".concat(_,"/"));console.log("Cake data received:",e.data),console.log("Cake image URL:",e.data.image),M(e.data),U(Number(e.data.price)||0),I(!1)}catch(nU){console.error("Error fetching cake details:",nU);const t=E.find(e=>e.id===parseInt(_));t&&(console.log("Using fallback cake data:",t),M(t),U(Number(t.price)||0)),I(!1)}},[_]),pe=(0,i.useCallback)(async()=>{try{const e=await ow.get("http://localhost:8000/api/cakes/".concat(_,"/reviews/"));if(T(e.data),e.data.length>0){const t=e.data.reduce((e,t)=>e+t.rating,0)/e.data.length;L(t)}else L(0)}catch(nU){console.error("Error fetching reviews:",nU),T([]),L(0)}},[_]),me=(0,i.useCallback)(()=>{if(!A)return 0;let e=parseFloat(A.price)||0;if(F.size){const t=jv.sizes.find(e=>e.id===F.size);t&&t.priceModifier&&(e+=parseFloat(t.priceModifier)||0)}if(F.shape){const t=jv.shapes.find(e=>e.id===F.shape);t&&t.priceModifier&&(e+=parseFloat(t.priceModifier)||0)}if(F.frosting){const t=jv.frostings.find(e=>e.id===F.frosting);t&&t.priceModifier&&(e+=parseFloat(t.priceModifier)||0)}if(F.color){var t;const n=null===(t=jv.colors)||void 0===t?void 0:t.find(e=>e.id===F.color);n&&n.priceModifier&&(e+=parseFloat(n.priceModifier)||0)}return F.toppings.forEach(t=>{const n=jv.toppings.find(e=>e.id===t);n&&n.priceModifier&&(e+=parseFloat(n.priceModifier)||0)}),Math.max(0,e)},[A,F]),fe=()=>jv.colors||[{id:1,name:"Pink",color:"#FF69B4",priceModifier:0},{id:2,name:"Red",color:"#DC143C",priceModifier:200},{id:3,name:"Blue",color:"#4169E1",priceModifier:200},{id:4,name:"Green",color:"#32CD32",priceModifier:200},{id:5,name:"Purple",color:"#8A2BE2",priceModifier:200},{id:6,name:"Yellow",color:"#FFD700",priceModifier:200},{id:7,name:"Orange",color:"#FF8C00",priceModifier:200},{id:8,name:"White",color:"#FFFFFF",priceModifier:0}];(0,i.useEffect)(()=>{(async()=>{try{const e=await _v();C(e)}catch(nU){console.error("Error loading cakes:",nU),C([])}})()},[]),(0,i.useEffect)(()=>{he(),pe()},[_,he,pe]),(0,i.useEffect)(()=>{A&&U(me())},[F,A,me]);const ge=(e,t)=>{O(n=>qe(qe({},n),{},{[e]:t}))},xe=()=>{if(!A)return;const e=Mv(F,jv,A.price),t=qe(qe({},A),{},{price:D,customizations:F,previewImage:e.image,previewData:e});N(t),S("/cart")};return R?(0,Ue.jsx)("div",{className:"min-h-screen gradient-bg flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"loading-spinner"})}):A?(0,Ue.jsxs)("div",{className:"min-h-screen gradient-bg py-8",children:[(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsx)("nav",{className:"mb-6",children:(0,Ue.jsx)("button",{onClick:()=>S(-1),className:"text-sweetbite-600 hover:text-sweetbite-700 font-medium",children:"\u2190 Back to Menu"})}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[(0,Ue.jsx)("div",{children:(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[(0,Ue.jsxs)("div",{className:"relative p-8 ".concat((()=>{if(F.frosting){const e=jv.frostings.find(e=>e.id===F.frosting);switch(null===e||void 0===e?void 0:e.name){case"Chocolate":case"Caramel":return"bg-gradient-to-br from-amber-50 to-amber-100";case"Strawberry":return"bg-gradient-to-br from-pink-50 to-pink-100";case"Lemon":return"bg-gradient-to-br from-yellow-50 to-yellow-100";case"Mint":return"bg-gradient-to-br from-green-50 to-green-100";case"Orange":return"bg-gradient-to-br from-orange-50 to-orange-100";case"Raspberry":return"bg-gradient-to-br from-red-50 to-red-100";default:return"bg-gradient-to-br from-pink-50 to-yellow-50"}}return"bg-gradient-to-br from-pink-50 to-yellow-50"})()),children:[(0,Ue.jsx)("div",{className:"flex justify-center items-center h-96",children:(0,Ue.jsx)(PU,{cake:A,customizations:F,customizationOptions:jv,totalPrice:D,isMainDisplay:!0})}),(0,Ue.jsxs)("div",{className:"absolute top-4 right-4 bg-sweetbite-600 text-white px-4 py-2 rounded-full font-semibold",children:["RS ",D.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:A.name}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:A.description}),(0,Ue.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ue.jsx)("div",{className:"flex items-center",children:[...Array(5)].map((e,t)=>{const n=t+1,r=n<=Math.floor(P),i=n===Math.ceil(P)&&P%1!==0;return(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),(r||i)&&(0,Ue.jsx)("svg",{className:"w-5 h-5 text-yellow-400 absolute top-0 left-0 ".concat(i?"clip-path-half":""),fill:"currentColor",viewBox:"0 0 20 20",style:i?{clipPath:"polygon(0 0, 50% 0, 50% 100%, 0% 100%)"}:{},children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})]},t)})}),(0,Ue.jsx)("span",{className:"ml-2 text-gray-600",children:k.length>0?"".concat(P.toFixed(1)," (").concat(k.length," review").concat(1!==k.length?"s":"",")"):"No reviews yet"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"Ingredients"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:A.ingredients&&Array.isArray(A.ingredients)?A.ingredients.join(", "):"Fresh ingredients used"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"Allergens"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:A.allergens&&Array.isArray(A.allergens)?A.allergens.join(", "):"Please contact us for allergen information"})]})]}),(0,Ue.jsxs)("div",{className:"flex gap-4",children:[(0,Ue.jsx)("button",{onClick:()=>B(!z),className:"flex-1 bg-sweetbite-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-sweetbite-700 transition-colors",children:z?"Hide Customization":"Customize Cake"}),(0,Ue.jsx)("button",{onClick:xe,className:"flex-1 border-2 border-sweetbite-600 text-sweetbite-600 py-3 px-6 rounded-lg font-semibold hover:bg-sweetbite-50 transition-colors",children:"Add to Cart"})]})]})]})}),(0,Ue.jsxs)("div",{className:"space-y-8",children:[z&&(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-2xl p-6 border border-gray-100",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-white text-sm",children:"\ufffd\ufffd"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-2xl font-bold text-gray-800",children:"Design Your Dream Cake"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Live 3D Preview \u2022 Real-time Updates"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsxs)("button",{onClick:()=>ue({isActive:!0,tiers:3}),className:"bg-pink-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-pink-600 transition-colors flex items-center space-x-2",children:[(0,Ue.jsx)("span",{children:"\ud83c\udf82"}),(0,Ue.jsx)("span",{children:"Beautiful Preview"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),(0,Ue.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"Live Preview"})]})]})]}),(0,Ue.jsx)("div",{className:"mb-8",children:(0,Ue.jsx)("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-xl",children:[{id:"size",label:"Size",icon:"\ud83d\udccf"},{id:"shape",label:"Shape",icon:"\ufffd\ufffd"},{id:"frosting",label:"Frosting",icon:"\ufffd\ufffd"},{id:"toppings",label:"Toppings",icon:"\ud83c\udf53"},{id:"color",label:"Color",icon:"\ufffd\ufffd"},{id:"message",label:"Message",icon:"\ud83d\udcac"}].map(e=>(0,Ue.jsxs)(tl.button,{className:"flex-1 py-3 px-4 rounded-lg text-sm font-medium transition-all ".concat(F[e.id]?"bg-white shadow-md text-sweetbite-600":"text-gray-600 hover:text-gray-800"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,Ue.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))})}),(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,Ue.jsx)("span",{className:"mr-2",children:"\ud83d\udccf"}),"Choose Your Size"]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsxs)("div",{className:"bg-blue-50 text-blue-600 px-3 py-1 rounded-full text-sm font-medium",children:[(null===(e=jv.sizes.find(e=>e.id===F.size))||void 0===e?void 0:e.servings)||6," Servings"]}),(0,Ue.jsxs)("button",{onClick:()=>Z({isActive:!0,size:F.size}),className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl",children:[(0,Ue.jsx)("span",{children:"\ud83c\udfa8"}),(0,Ue.jsx)("span",{children:"Interactive"})]})]})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-4",children:jv.sizes.map(e=>(0,Ue.jsxs)(tl.div,{className:"relative p-6 border-2 rounded-2xl cursor-pointer transition-all ".concat(F.size===e.id?"border-sweetbite-500 bg-gradient-to-br from-sweetbite-50 to-pink-50 shadow-lg":"border-gray-200 hover:border-sweetbite-300 hover:shadow-md"),onClick:()=>ge("size",e.id),whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h5",{className:"font-bold text-lg text-gray-800",children:e.name}),(0,Ue.jsxs)("p",{className:"text-gray-600 text-sm",children:["Perfect for ",e.servings," people"]}),e.priceModifier>0&&(0,Ue.jsxs)("p",{className:"text-green-600 font-semibold text-sm mt-1",children:["+RS ",e.priceModifier]})]}),(0,Ue.jsx)("div",{className:"text-right",children:(0,Ue.jsx)("div",{className:"w-6 h-6 rounded-full border-2 flex items-center justify-center ".concat(F.size===e.id?"bg-sweetbite-500 border-sweetbite-500":"border-gray-300"),children:F.size===e.id&&(0,Ue.jsx)(tl.span,{className:"text-white text-xs",initial:{scale:0},animate:{scale:1},transition:{duration:.2},children:"\u2713"})})})]}),F.size===e.id&&(0,Ue.jsx)(tl.div,{className:"absolute bottom-0 left-0 h-1 bg-gradient-to-r from-sweetbite-500 to-pink-500 rounded-full",initial:{width:0},animate:{width:"100%"},transition:{duration:.3}})]},e.id))})]}),(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,Ue.jsx)("span",{className:"mr-2",children:"\ud83d\udd37"}),"Pick Your Shape"]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"bg-purple-50 text-purple-600 px-3 py-1 rounded-full text-sm font-medium",children:(null===(t=jv.shapes.find(e=>e.id===F.shape))||void 0===t?void 0:t.name)||"Round"}),(0,Ue.jsxs)("button",{onClick:()=>K({isActive:!0,shape:F.shape}),className:"bg-gradient-to-r from-purple-500 to-pink-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-purple-600 hover:to-pink-700 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl",children:[(0,Ue.jsx)("span",{children:"\ud83c\udfa8"}),(0,Ue.jsx)("span",{children:"Interactive"})]})]})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-4 gap-4",children:jv.shapes.map(e=>(0,Ue.jsxs)(tl.div,{className:"relative p-6 border-2 rounded-2xl cursor-pointer text-center transition-all ".concat(F.shape===e.id?"border-sweetbite-500 bg-gradient-to-br from-sweetbite-50 to-purple-50 shadow-lg":"border-gray-200 hover:border-sweetbite-300 hover:shadow-md"),onClick:()=>ge("shape",e.id),whileHover:{scale:1.05,y:-3},whileTap:{scale:.95},children:[(0,Ue.jsxs)("div",{className:"text-4xl mb-3",children:["Round"===e.name&&"\u2b55","Square"===e.name&&"\u2b1c","Heart"===e.name&&"\u2764\ufe0f","Rectangle"===e.name&&"\u25ac"]}),(0,Ue.jsx)("h5",{className:"font-semibold text-gray-800 mb-1",children:e.name}),e.priceModifier>0&&(0,Ue.jsxs)("p",{className:"text-green-600 font-medium text-sm",children:["+RS ",e.priceModifier]}),F.shape===e.id&&(0,Ue.jsx)(tl.div,{className:"absolute -top-2 -right-2 w-8 h-8 bg-sweetbite-500 rounded-full flex items-center justify-center shadow-lg",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{duration:.3},children:(0,Ue.jsx)("span",{className:"text-white text-sm",children:"\u2713"})})]},e.id))})]}),(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,Ue.jsx)("span",{className:"mr-2",children:"\ud83c\udfa8"}),"Select Frosting"]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"bg-pink-50 text-pink-600 px-3 py-1 rounded-full text-sm font-medium",children:(null===(n=jv.frostings.find(e=>e.id===F.frosting))||void 0===n?void 0:n.name)||"Buttercream"}),(0,Ue.jsxs)("button",{onClick:()=>$({isActive:!0,frosting:F.frosting}),className:"bg-gradient-to-r from-pink-500 to-rose-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-pink-600 hover:to-rose-700 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl",children:[(0,Ue.jsx)("span",{children:"\ud83c\udfa8"}),(0,Ue.jsx)("span",{children:"Interactive"})]})]})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-4",children:jv.frostings.map(e=>(0,Ue.jsx)(tl.div,{className:"relative p-6 border-2 rounded-2xl cursor-pointer transition-all ".concat(F.frosting===e.id?"border-sweetbite-500 bg-gradient-to-br from-sweetbite-50 to-pink-50 shadow-lg":"border-gray-200 hover:border-sweetbite-300 hover:shadow-md"),onClick:()=>ge("frosting",e.id),whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 rounded-full border-3 shadow-lg ".concat("Buttercream"===e.name?"bg-gradient-to-br from-yellow-200 to-yellow-300":"Cream Cheese"===e.name?"bg-gradient-to-br from-white to-gray-100":"Chocolate Ganache"===e.name?"bg-gradient-to-br from-amber-700 to-amber-900":"bg-gradient-to-br from-pink-100 to-pink-200")}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h5",{className:"font-bold text-gray-800",children:e.name}),e.priceModifier>0&&(0,Ue.jsxs)("p",{className:"text-green-600 font-semibold text-sm",children:["+RS ",e.priceModifier]})]}),F.frosting===e.id&&(0,Ue.jsx)(tl.div,{className:"w-6 h-6 bg-sweetbite-500 rounded-full flex items-center justify-center",initial:{scale:0},animate:{scale:1},transition:{duration:.2},children:(0,Ue.jsx)("span",{className:"text-white text-xs",children:"\u2713"})})]})},e.id))})]}),(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,Ue.jsx)("span",{className:"mr-2",children:"\ud83c\udf08"}),"Choose Custom Color"]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"bg-gradient-to-r from-pink-50 to-purple-50 text-purple-600 px-3 py-1 rounded-full text-sm font-medium",children:F.color?null===(r=fe().find(e=>e.id===F.color))||void 0===r?void 0:r.name:"Pink"}),(0,Ue.jsxs)("button",{onClick:()=>te({isActive:!0,color:F.color}),className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-indigo-600 hover:to-purple-700 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl",children:[(0,Ue.jsx)("span",{children:"\ud83c\udfa8"}),(0,Ue.jsx)("span",{children:"Interactive"})]})]})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-4 gap-4",children:fe().map(e=>(0,Ue.jsxs)(tl.div,{className:"relative p-4 border-2 rounded-lg cursor-pointer transition-all ".concat(F.color===e.id?"border-sweetbite-500 bg-sweetbite-50 scale-105 shadow-lg":"border-gray-300 hover:border-sweetbite-400 hover:scale-105"),onClick:()=>ge("color",e.id),whileHover:{scale:1.05},whileTap:{scale:.95},title:e.name,children:[(0,Ue.jsx)("div",{className:"w-12 h-12 rounded-full mx-auto mb-2 border-2 border-gray-300",style:{backgroundColor:e.color}}),(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"font-semibold text-gray-800 text-sm",children:e.name}),e.priceModifier>0&&(0,Ue.jsxs)("div",{className:"text-xs text-sweetbite-600",children:["+RS ",e.priceModifier]})]}),F.color===e.id&&(0,Ue.jsx)(tl.div,{className:"absolute -top-2 -right-2 w-6 h-6 bg-sweetbite-500 rounded-full flex items-center justify-center shadow-lg",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{duration:.3},children:(0,Ue.jsx)("span",{className:"text-white text-xs",children:"\u2713"})})]},e.id))})]}),(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,Ue.jsx)("span",{className:"mr-2",children:"\ud83c\udf53"}),"Add Toppings"]}),(0,Ue.jsxs)("div",{className:"bg-green-50 text-green-600 px-3 py-1 rounded-full text-sm font-medium",children:[(null===(s=F.toppings)||void 0===s?void 0:s.length)||0," Selected"]})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-3 gap-4",children:jv.toppings.map(e=>{var t,n;return(0,Ue.jsxs)(tl.div,{className:"relative p-6 border-2 rounded-2xl cursor-pointer text-center transition-all ".concat(null!==(t=F.toppings)&&void 0!==t&&t.includes(e.id)?"border-sweetbite-500 bg-gradient-to-br from-sweetbite-50 to-green-50 shadow-lg":"border-gray-200 hover:border-sweetbite-300 hover:shadow-md"),onClick:()=>{return t=e.id,void O(e=>qe(qe({},e),{},{toppings:e.toppings.includes(t)?e.toppings.filter(e=>e!==t):[...e.toppings,t]}));var t},whileHover:{scale:1.05,y:-3},whileTap:{scale:.95},children:[(0,Ue.jsxs)("div",{className:"text-4xl mb-3",children:["Fresh Berries"===e.name&&"\ud83c\udf53","Chocolate Shavings"===e.name&&"\ufffd\ufffd","Sprinkles"===e.name&&"\u2728","Edible Flowers"===e.name&&"\ud83c\udf38","Nuts"===e.name&&"\ufffd\ufffd"]}),(0,Ue.jsx)("h5",{className:"font-semibold text-gray-800 mb-1",children:e.name}),["Nuts","Edible Flowers","Fresh Berries","Chocolate Chips","Sprinkles"].includes(e.name)&&(0,Ue.jsx)("div",{className:"text-xs text-blue-600 font-medium mb-1",children:"\u2728 3D Preview"}),(0,Ue.jsxs)("p",{className:"text-green-600 font-semibold text-sm",children:["+RS ",e.priceModifier]}),(0,Ue.jsx)("button",{onClick:t=>{t.stopPropagation();const n="Fresh Berries"===e.name?"berries":"Chocolate Shavings"===e.name?"chocolate_chips":"Sprinkles"===e.name?"sprinkles":"Edible Flowers"===e.name?"flowers":"Nuts"===e.name?"nuts":"sprinkles";console.log("\ud83c\udf38 Realistic Preview clicked for:",e.name,"mapped to:",n),ce({isActive:!0,toppingType:n,distribution:"full"})},className:"mt-2 px-3 py-1 bg-sweetbite-500 text-white text-xs rounded-full hover:bg-sweetbite-600 transition-colors",children:"\ud83c\udfa8 Realistic Preview"}),(null===(n=F.toppings)||void 0===n?void 0:n.includes(e.id))&&(0,Ue.jsx)(tl.div,{className:"absolute -top-2 -right-2 w-8 h-8 bg-sweetbite-500 rounded-full flex items-center justify-center shadow-lg",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{duration:.3},children:(0,Ue.jsx)("span",{className:"text-white text-sm",children:"\u2713"})})]},e.id)})})]}),(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[(0,Ue.jsx)("span",{className:"mr-2",children:"\ud83d\udcac"}),"Personal Message"]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsxs)("div",{className:"bg-yellow-50 text-yellow-600 px-3 py-1 rounded-full text-sm font-medium",children:[(null===(a=F.message)||void 0===a?void 0:a.length)||0,"/50"]}),(0,Ue.jsxs)("button",{onClick:()=>se({isActive:!0,message:F.message}),className:"bg-gradient-to-r from-yellow-500 to-orange-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-yellow-600 hover:to-orange-700 transition-all duration-200 flex items-center space-x-2 shadow-lg hover:shadow-xl",children:[(0,Ue.jsx)("span",{children:"\ud83c\udfa8"}),(0,Ue.jsx)("span",{children:"Interactive"})]})]})]}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("textarea",{value:F.message||"",onChange:e=>ge("message",e.target.value),placeholder:"Add a special message to your cake...",maxLength:50,className:"w-full p-4 border-2 border-gray-200 rounded-2xl focus:border-sweetbite-500 focus:outline-none resize-none transition-all text-lg",rows:3}),(0,Ue.jsxs)("div",{className:"absolute bottom-3 right-3 text-sm text-gray-400",children:[50-((null===(o=F.message)||void 0===o?void 0:o.length)||0)," left"]})]})]}),(0,Ue.jsxs)(tl.div,{className:"bg-gradient-to-r from-sweetbite-50 via-pink-50 to-purple-50 rounded-2xl p-6 border-2 border-sweetbite-200 shadow-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h5",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Your Custom Cake"}),(0,Ue.jsxs)("div",{className:"text-3xl font-bold text-sweetbite-600",children:["RS ",D.toFixed(2)]}),D>((null===A||void 0===A?void 0:A.price)||0)&&(0,Ue.jsxs)("div",{className:"text-sm text-green-600 font-medium mt-1",children:["+RS ",(D-((null===A||void 0===A?void 0:A.price)||0)).toFixed(2)," customizations"]})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Base Price"}),(0,Ue.jsxs)("div",{className:"text-xl font-semibold text-gray-800",children:["RS ",(null===A||void 0===A?void 0:A.price)||0]})]})]}),(0,Ue.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,Ue.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Customizations:"}),(0,Ue.jsxs)("div",{className:"flex flex-wrap gap-2",children:[F.size&&(0,Ue.jsx)("span",{className:"bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-xs",children:null===(l=jv.sizes.find(e=>e.id===F.size))||void 0===l?void 0:l.name}),F.shape&&(0,Ue.jsx)("span",{className:"bg-purple-100 text-purple-600 px-2 py-1 rounded-full text-xs",children:null===(c=jv.shapes.find(e=>e.id===F.shape))||void 0===c?void 0:c.name}),F.frosting&&(0,Ue.jsx)("span",{className:"bg-pink-100 text-pink-600 px-2 py-1 rounded-full text-xs",children:null===(d=jv.frostings.find(e=>e.id===F.frosting))||void 0===d?void 0:d.name}),null===(u=F.toppings)||void 0===u?void 0:u.map(e=>{var t;return(0,Ue.jsx)("span",{className:"bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs",children:null===(t=jv.toppings.find(t=>t.id===e))||void 0===t?void 0:t.name},e)})]})]})]})]}),(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[(0,Ue.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-6",children:"Customer Reviews"}),j&&(0,Ue.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),j)if(0!==V.rating)if(V.comment&&0!==V.comment.trim().length)if(V.comment.trim().length<10)alert("Comment must be at least 10 characters long");else if(V.comment.trim().length>500)alert("Comment must be less than 500 characters");else{G(!0);try{const e=localStorage.getItem("token");console.log("Submitting review for cake:",_),console.log("Review data:",{rating:V.rating,comment:V.comment}),console.log("Token:",e?"Present":"Missing");const t=await ow.post("http://localhost:8000/api/cakes/".concat(_,"/reviews/create/"),{rating:V.rating,comment:V.comment.trim()},{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});console.log("Review submission successful:",t.data);const n=t.data;T(e=>[n,...e]),H({rating:0,comment:""});const r=[n,...k],i=r.reduce((e,t)=>e+(t.rating||0),0)/r.length;L(i),alert("Review submitted successfully!")}catch(nU){var t,n,r,i,s,a,o,l,c;console.error("Error submitting review:",nU),console.error("Error response:",null===(t=nU.response)||void 0===t?void 0:t.data),console.error("Error status:",null===(n=nU.response)||void 0===n?void 0:n.status);let h="Error submitting review. Please try again.";if(401===(null===(r=nU.response)||void 0===r?void 0:r.status))h="Please log in to submit a review";else if(400===(null===(i=nU.response)||void 0===i?void 0:i.status)){var d,u;const t=nU.response.data;h=null!==t&&void 0!==t&&null!==(d=t.error)&&void 0!==d&&d.includes("already reviewed")||null!==t&&void 0!==t&&null!==(u=t.detail)&&void 0!==u&&u.includes("already reviewed")?"You have already reviewed this cake. You can only review each cake once.":null!==t&&void 0!==t&&t.rating?"Please select a valid rating (1-5 stars)":null!==t&&void 0!==t&&t.comment?"Please write a comment for your review":"Invalid review data. Please check your rating and comment."}else 404===(null===(s=nU.response)||void 0===s?void 0:s.status)?h="Cake not found. Please try again.":null!==(a=nU.response)&&void 0!==a&&null!==(o=a.data)&&void 0!==o&&o.error?h=nU.response.data.error:null!==(l=nU.response)&&void 0!==l&&null!==(c=l.data)&&void 0!==c&&c.detail&&(h=nU.response.data.detail);alert(h)}finally{G(!1)}}else alert("Please write a comment about your experience");else alert("Please select a rating (1-5 stars)");else alert("Please log in to submit a review")},className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-gray-700 mb-3",children:"Write a Review"}),(0,Ue.jsxs)("div",{className:"mb-3",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),(0,Ue.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>H(t=>qe(qe({},t),{},{rating:e})),className:"w-8 h-8 ".concat(e<=V.rating?"text-yellow-400":"text-gray-300"," hover:text-yellow-400 transition-colors"),children:(0,Ue.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},e))})]}),(0,Ue.jsxs)("div",{className:"mb-3",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comment"}),(0,Ue.jsx)("textarea",{value:V.comment,onChange:e=>H(t=>qe(qe({},t),{},{comment:e.target.value})),placeholder:"Share your experience with this cake...",className:"w-full p-3 border border-gray-300 rounded-lg focus:border-sweetbite-600 focus:outline-none resize-none",rows:3,required:!0})]}),(0,Ue.jsx)("button",{type:"submit",disabled:W,className:"bg-sweetbite-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-sweetbite-700 transition-colors disabled:opacity-50",children:W?"Submitting...":"Submit Review"})]}),(0,Ue.jsx)("div",{className:"space-y-4",children:k.length>0?k.map((e,t)=>{var n,r;const i=(null===(n=e.user)||void 0===n?void 0:n.username)||(null===(r=e.user)||void 0===r?void 0:r.first_name)||e.user||"Anonymous",s=i.charAt(0).toUpperCase(),a=e.rating||0,o=e.comment||e.text||"",l=e.created_at||e.createdAt||e.date;return(0,Ue.jsxs)("div",{className:"border-b border-gray-200 pb-4 last:border-b-0",children:[(0,Ue.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 rounded-full bg-sweetbite-100 flex items-center justify-center mr-3",children:(0,Ue.jsx)("span",{className:"text-sweetbite-600 font-semibold",children:s})}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h5",{className:"font-semibold text-gray-800",children:i}),(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"flex items-center mr-2",children:[...Array(5)].map((e,t)=>(0,Ue.jsx)("svg",{className:"w-4 h-4 ".concat(t<a?"text-yellow-400":"text-gray-300"),fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},t))}),(0,Ue.jsx)("span",{className:"text-sm text-gray-500",children:l?new Date(l).toLocaleDateString():"Recently"})]})]})]}),(0,Ue.jsx)("p",{className:"text-gray-700",children:o})]},e.id||t)}):(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("div",{className:"text-gray-400 text-4xl mb-4",children:"\u2b50"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"No reviews yet"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"Be the first to review this cake!"})]})})]})]})]})]}),(0,Ue.jsx)(TU,{isActive:Y.isActive||J.isActive||Q.isActive||ee.isActive||ie.isActive,customizationType:Y.isActive?"size":J.isActive?"shape":Q.isActive?"frosting":ee.isActive?"color":"message",customizationData:{size:Y.size,shape:J.shape,frosting:Q.frosting,color:ee.color,message:ie.message},onClose:()=>{Z({isActive:!1,size:null}),K({isActive:!1,shape:null}),$({isActive:!1,frosting:null}),te({isActive:!1,color:null}),se({isActive:!1,message:null})}}),le.isActive&&(0,Ue.jsx)(tl.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,Ue.jsxs)(tl.div,{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden",initial:{scale:.8,y:50},animate:{scale:1,y:0},exit:{scale:.8,y:50},transition:{type:"spring",stiffness:300,damping:30},children:[(0,Ue.jsx)("div",{className:"bg-gradient-to-r from-sweetbite-500 to-pink-500 p-6 text-white",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold",children:"\ud83c\udfa8 Realistic Topping Preview"}),(0,Ue.jsxs)("p",{className:"text-sweetbite-100 mt-1",children:["See how ",le.toppingType.replace("_"," ")," look on your cake"]})]}),(0,Ue.jsx)("button",{onClick:()=>ce({isActive:!1,toppingType:"sprinkles",distribution:"full"}),className:"text-white hover:text-gray-200 transition-colors",children:(0,Ue.jsx)(Dv,{className:"h-8 w-8"})})]})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,Ue.jsxs)("div",{className:"lg:col-span-2",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"3D Realistic Preview"}),(0,Ue.jsx)(CU,{toppingType:le.toppingType,distribution:le.distribution,orderId:"SB202509190067"})]}),(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Topping Options"}),(0,Ue.jsx)("div",{className:"space-y-3",children:Object.keys(kU||{}).map(e=>{var t;return(0,Ue.jsxs)("button",{onClick:()=>ce(t=>qe(qe({},t),{},{toppingType:e})),className:"w-full p-3 rounded-lg text-left transition-all ".concat(le.toppingType===e?"bg-sweetbite-100 border-2 border-sweetbite-500":"bg-gray-50 border-2 border-gray-200 hover:border-sweetbite-300"),children:[(0,Ue.jsx)("div",{className:"font-medium capitalize",children:e.replace("_"," ")}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-600",children:[(null===kU||void 0===kU||null===(t=kU[e])||void 0===t?void 0:t.count)||0," pieces"]})]},e)})})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Distribution Style"}),(0,Ue.jsx)("div",{className:"space-y-3",children:["full","border","center","scattered"].map(e=>(0,Ue.jsxs)("button",{onClick:()=>ce(t=>qe(qe({},t),{},{distribution:e})),className:"w-full p-3 rounded-lg text-left transition-all ".concat(le.distribution===e?"bg-sweetbite-100 border-2 border-sweetbite-500":"bg-gray-50 border-2 border-gray-200 hover:border-sweetbite-300"),children:[(0,Ue.jsx)("div",{className:"font-medium capitalize",children:e}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:"full"===e?"Complete coverage":"border"===e?"Edge decoration":"center"===e?"Center design":"Random scattered"})]},e))})]})]})]})})]})}),de.isActive&&(0,Ue.jsx)(tl.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,Ue.jsxs)(tl.div,{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",initial:{scale:.8,y:50},animate:{scale:1,y:0},exit:{scale:.8,y:50},transition:{type:"spring",stiffness:300,damping:30},children:[(0,Ue.jsx)("div",{className:"bg-gradient-to-r from-pink-500 to-purple-500 p-6 text-white",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold",children:"\ud83c\udf82 Beautiful Cake Preview"}),(0,Ue.jsx)("p",{className:"text-pink-100 mt-1",children:"Your dream cake with pink frosting and yellow dollops"})]}),(0,Ue.jsx)("button",{onClick:()=>ue({isActive:!1,tiers:3}),className:"text-white hover:text-gray-200 transition-colors",children:(0,Ue.jsx)(Dv,{className:"h-8 w-8"})})]})}),(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsx)("div",{className:"text-center mb-4",children:(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:"\ud83d\udca1 Scroll down to see all options and controls"})}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,Ue.jsxs)("div",{className:"lg:col-span-3",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Your Beautiful Cake"}),(0,Ue.jsx)(hU,{tiers:de.tiers,toppings:(null===(h=F.toppings)||void 0===h?void 0:h.map(e=>{const t=jv.toppings.find(t=>t.id===e),n={type:"Fresh Berries"===(null===t||void 0===t?void 0:t.name)?"berries":"Chocolate Shavings"===(null===t||void 0===t?void 0:t.name)?"chocolate_chips":"Sprinkles"===(null===t||void 0===t?void 0:t.name)?"sprinkles":"Edible Flowers"===(null===t||void 0===t?void 0:t.name)?"flowers":"Nuts"===(null===t||void 0===t?void 0:t.name)?"nuts":"sprinkles",count:20};return console.log("\ud83c\udfa8 Mapping topping:",null===t||void 0===t?void 0:t.name,"to type:",n.type),n}))||[],orderId:"SB202509190067",onClose:()=>ue({isActive:!1,tiers:3}),customizations:F,customizationOptions:jv,basePrice:(null===A||void 0===A?void 0:A.price)||0,onAddToCart:xe})]}),(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Cake Tiers"}),(0,Ue.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,Ue.jsxs)("button",{onClick:()=>ue(t=>qe(qe({},t),{},{tiers:e})),className:"w-full p-3 rounded-lg text-left transition-all ".concat(de.tiers===e?"bg-pink-100 border-2 border-pink-500":"bg-gray-50 border-2 border-gray-200 hover:border-pink-300"),children:[(0,Ue.jsxs)("div",{className:"font-medium",children:[e," Tier",e>1?"s":""]}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:1===e?"Single layer cake":2===e?"Two-tiered cake":"Three-tiered cake"})]},e))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Cake Features"}),(0,Ue.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("span",{className:"w-4 h-4 bg-pink-500 rounded-full"}),(0,Ue.jsx)("span",{children:"Pink frosting with drip effect"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("span",{className:"w-4 h-4 bg-yellow-400 rounded-full"}),(0,Ue.jsx)("span",{children:"Yellow swirled dollops"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("span",{className:"w-4 h-4 bg-amber-800 rounded-full"}),(0,Ue.jsx)("span",{children:"Dark brown cake layers"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("span",{className:"w-4 h-4 bg-gray-300 rounded-full"}),(0,Ue.jsx)("span",{children:"Elegant cake plate"})]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Your Customizations"}),(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Size:"}),(0,Ue.jsx)("span",{className:"font-medium",children:(null===(p=jv.sizes)||void 0===p||null===(m=p.find(e=>e.id===F.size))||void 0===m?void 0:m.name)||"6 inch"})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Shape:"}),(0,Ue.jsx)("span",{className:"font-medium",children:(null===(f=jv.shapes)||void 0===f||null===(g=f.find(e=>e.id===F.shape))||void 0===g?void 0:g.name)||"Round"})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Frosting:"}),(0,Ue.jsx)("span",{className:"font-medium",children:(null===(x=jv.frostings)||void 0===x||null===(v=x.find(e=>e.id===F.frosting))||void 0===v?void 0:v.name)||"None"})]}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Color:"}),(0,Ue.jsx)("span",{className:"font-medium",children:(null===(y=jv.colors)||void 0===y||null===(b=y.find(e=>e.id===F.color))||void 0===b?void 0:b.name)||"Pink"})]}),(0,Ue.jsxs)("div",{className:"text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Toppings:"}),(0,Ue.jsx)("div",{className:"mt-1 space-y-1",children:(null===(w=F.toppings)||void 0===w?void 0:w.length)>0?F.toppings.map(e=>{const t=jv.toppings.find(t=>t.id===e);return(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,Ue.jsx)("span",{className:"text-xs",children:null===t||void 0===t?void 0:t.name})]},e)}):(0,Ue.jsx)("div",{className:"text-xs text-gray-500",children:"No toppings selected"})})]}),F.message&&(0,Ue.jsxs)("div",{className:"text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Personal Message:"}),(0,Ue.jsx)("div",{className:"mt-1 p-2 bg-pink-50 rounded-lg border border-pink-200",children:(0,Ue.jsxs)("div",{className:"text-xs text-pink-700 italic",children:['\ud83d\udc8c "',F.message,'"']})})]})]})]})]})]})]})]})})]}):(0,Ue.jsx)("div",{className:"min-h-screen gradient-bg flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Cake not found"}),(0,Ue.jsx)("button",{onClick:()=>S("/menu"),className:"btn-primary",children:"Back to Menu"})]})})},RU=["title","titleId"];function IU(e,t){let{title:n,titleId:r}=e,s=Ie(e,RU);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))}const FU=i.forwardRef(IU),OU=["title","titleId"];function DU(e,t){let{title:n,titleId:r}=e,s=Ie(e,OU);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const UU=i.forwardRef(DU),zU=["title","titleId"];function BU(e,t){let{title:n,titleId:r}=e,s=Ie(e,zU);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const VU=i.forwardRef(BU),HU=e=>{var t;let{customer:n,isOpen:r,onClose:s}=e;const[a,o]=(0,i.useState)(null),[l,c]=(0,i.useState)([]),[d,u]=(0,i.useState)(!1),[h,p]=(0,i.useState)("");(0,i.useEffect)(()=>{r&&n&&m()},[r,n]);const m=async()=>{u(!0),p("");try{const e=localStorage.getItem("token");if(!e)return void p("Authentication required");const t=await fetch("http://localhost:8000/api/users/users/".concat(n.id,"/"),{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});if(t.ok){const e=await t.json();o(e),await f(e.id)}else p("Failed to load customer details")}catch(e){console.error("Error loading customer details:",e),p("Network error loading customer details")}finally{u(!1)}},f=async e=>{try{const t=localStorage.getItem("token"),n=await fetch("http://localhost:8000/api/orders/orders/?customer=".concat(e),{headers:{Authorization:"Token ".concat(t),"Content-Type":"application/json"}});if(n.ok){const e=await n.json();c(e.results||e)}}catch(t){console.error("Error loading customer orders:",t)}},g=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",x=e=>"RS ".concat(parseFloat(e||0).toFixed(2)),v=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"completed":case"delivered":return"bg-green-100 text-green-800";case"pending":case"processing":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return r?(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Customer Details"}),(0,Ue.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,Ue.jsx)(Dv,{className:"h-6 w-6"})})]}),(0,Ue.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:d?(0,Ue.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,Ue.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading customer details..."})]}):h?(0,Ue.jsxs)("div",{className:"text-center py-12",children:[(0,Ue.jsx)(jl,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-red-600",children:h})]}):a?(0,Ue.jsxs)("div",{className:"space-y-8",children:[(0,Ue.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,Ue.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Ue.jsx)(ov,{className:"h-5 w-5 mr-2"}),"Personal Information"]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),(0,Ue.jsxs)("p",{className:"text-gray-900",children:[a.first_name," ",a.last_name]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),(0,Ue.jsxs)("p",{className:"text-gray-900",children:["@",a.username]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[(0,Ue.jsx)(FU,{className:"h-4 w-4 mr-1"}),"Email"]}),(0,Ue.jsx)("p",{className:"text-gray-900",children:a.email})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[(0,Ue.jsx)(UU,{className:"h-4 w-4 mr-1"}),"Phone Number"]}),(0,Ue.jsx)("p",{className:"text-gray-900",children:a.phone_number||"N/A"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Type"}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("admin"===a.user_type?"bg-red-100 text-red-800":"staff"===a.user_type?"bg-blue-100 text-blue-800":"inventory_manager"===a.user_type?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"),children:null===(t=a.user_type)||void 0===t?void 0:t.replace("_"," ")})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Status"}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(a.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.is_active?"Active":"Inactive"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[(0,Ue.jsx)(Ol,{className:"h-4 w-4 mr-1"}),"Date Joined"]}),(0,Ue.jsx)("p",{className:"text-gray-900",children:g(a.date_joined)})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Login"}),(0,Ue.jsx)("p",{className:"text-gray-900",children:g(a.last_login)})]})]})]}),a.address&&(0,Ue.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,Ue.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Ue.jsx)(VU,{className:"h-5 w-5 mr-2"}),"Address Information"]}),(0,Ue.jsx)("p",{className:"text-gray-900",children:a.address})]}),(0,Ue.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,Ue.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,Ue.jsx)(iv,{className:"h-5 w-5 mr-2"}),"Order History (",l.length," orders)"]}),l.length>0?(0,Ue.jsx)("div",{className:"space-y-4",children:l.map(e=>{var t;return(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h4",{className:"font-medium text-gray-900",children:["Order #",e.order_number]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:g(e.created_at)})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("p",{className:"font-semibold text-gray-900",children:x(e.total_amount)}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(v(e.order_status)),children:e.order_status})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Payment:"}),(0,Ue.jsx)("span",{className:"ml-2 font-medium",children:e.payment_method||"N/A"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Items:"}),(0,Ue.jsx)("span",{className:"ml-2 font-medium",children:(null===(t=e.items)||void 0===t?void 0:t.length)||0})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("span",{className:"text-gray-500",children:"Type:"}),(0,Ue.jsx)("span",{className:"ml-2 font-medium",children:e.order_type||"N/A"})]})]})]},e.id)})}):(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)(iv,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-500",children:"No orders found for this customer"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Ue.jsxs)("div",{className:"bg-blue-50 rounded-lg p-6 text-center",children:[(0,Ue.jsx)(Rl,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:x(l.reduce((e,t)=>e+parseFloat(t.total_amount||0),0))}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Total Spent"})]}),(0,Ue.jsxs)("div",{className:"bg-green-50 rounded-lg p-6 text-center",children:[(0,Ue.jsx)(iv,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-green-600",children:l.length}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Total Orders"})]}),(0,Ue.jsxs)("div",{className:"bg-purple-50 rounded-lg p-6 text-center",children:[(0,Ue.jsx)(oc,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:l.length>0?x(l.reduce((e,t)=>e+parseFloat(t.total_amount||0),0)/l.length):"RS 0.00"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Average Order"})]})]})]}):(0,Ue.jsxs)("div",{className:"text-center py-12",children:[(0,Ue.jsx)(ov,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-500",children:"No customer data available"})]})}),(0,Ue.jsx)("div",{className:"flex items-center justify-end p-6 border-t border-gray-200 bg-gray-50",children:(0,Ue.jsx)("button",{onClick:s,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})})]})}):null},WU=["title","titleId"];function GU(e,t){let{title:n,titleId:r}=e,s=Ie(e,WU);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const qU=i.forwardRef(GU),XU=e=>{let{customer:t,isOpen:n,onClose:r,onSave:s}=e;const[a,o]=(0,i.useState)({first_name:"",last_name:"",email:"",username:"",user_type:"customer",is_active:!0}),[l,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)("");(0,i.useEffect)(()=>{n&&t&&(o({first_name:t.first_name||"",last_name:t.last_name||"",email:t.email||"",username:t.username||"",user_type:t.user_type||t.role||"customer",is_active:void 0===t.is_active||t.is_active}),u(""))},[n,t]);const h=e=>{const{name:t,value:n,type:r,checked:i}=e.target;o(e=>qe(qe({},e),{},{[t]:"checkbox"===r?i:n}))};return n?(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(ov,{className:"h-6 w-6 text-blue-600 mr-2"}),(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Customer"})]}),(0,Ue.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,Ue.jsx)(Dv,{className:"h-6 w-6"})})]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),c(!0),u("");try{const e=localStorage.getItem("token");if(!e)return u("Authentication required"),void c(!1);console.log("Updating customer:",t.id,"with data:",a);const n=await fetch("http://localhost:8000/api/users/users/".concat(t.id,"/"),{method:"PATCH",headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(a)});if(n.ok){const e=await n.json();console.log("Customer updated successfully:",e),alert("Customer updated successfully!"),s&&s(e),r()}else{const e=await n.json();console.error("Update failed:",e),u(e.message||"Failed to update customer")}}catch(d){console.error("Error updating customer:",d),u("An error occurred while updating the customer")}finally{c(!1)}},className:"p-6 space-y-4",children:[d&&(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:d}),(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),(0,Ue.jsx)("input",{type:"text",name:"first_name",value:a.first_name,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),(0,Ue.jsx)("input",{type:"text",name:"last_name",value:a.last_name,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),(0,Ue.jsx)("input",{type:"text",name:"username",value:a.username,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,Ue.jsx)("input",{type:"email",name:"email",value:a.email,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"User Type"}),(0,Ue.jsxs)("select",{name:"user_type",value:a.user_type,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,Ue.jsx)("option",{value:"customer",children:"Customer"}),(0,Ue.jsx)("option",{value:"admin",children:"Admin"}),(0,Ue.jsx)("option",{value:"inventory_manager",children:"Inventory Manager"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",name:"is_active",checked:a.is_active,onChange:h,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,Ue.jsx)("label",{className:"ml-2 block text-sm text-gray-900",children:"Active Account"})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,Ue.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 transition-colors",disabled:l,children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:l?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)(qU,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})]})}):null},YU=()=>{const e=ne(),[t]=Re(),{user:n,isAuthenticated:r}=Be(),[s,a]=(0,i.useState)([]),[o,l]=(0,i.useState)([]),[c,d]=(0,i.useState)(!0),[u,h]=(0,i.useState)(""),[p,m]=(0,i.useState)(""),[f,g]=(0,i.useState)("overview"),[x,v]=(0,i.useState)(null),[y,b]=(0,i.useState)(!1),[w,_]=(0,i.useState)(!1),[S,N]=(0,i.useState)(!1);(0,i.useEffect)(()=>(console.log("CustomerDashboard auth check:",{isAuthenticated:r,user:n}),r?!n||"admin"!==n.user_type&&"inventory_manager"!==n.user_type?(console.log("User not admin or inventory manager, redirecting to home. User:",n),void e("/")):void console.log("Admin/Inventory Manager access granted"):(console.log("Not authenticated, redirecting to home"),void e("/"))),[r,n,e]),(0,i.useEffect)(()=>{if(console.log("CustomerDashboard useEffect triggered"),r&&n&&("admin"===n.user_type||"inventory_manager"===n.user_type)){const e=setTimeout(()=>{console.log("Timeout reached, forcing loading to false"),d(!1)},1e4);return j(),()=>clearTimeout(e)}(!r||n&&"admin"!==n.user_type&&"inventory_manager"!==n.user_type)&&d(!1);const e=t.get("tab");e&&["overview","customers","analytics","communications"].includes(e)&&g(e)},[t,r,n]);const j=async()=>{console.log("\ud83d\udd04 loadCustomerData called");try{d(!0),console.log("\ud83d\udd04 Loading customer data...");const e=await fetch("http://localhost:8000/api/users/users/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("\ud83d\udce1 Customers API response status:",e.status),e.ok){const t=await e.json();console.log("\ud83d\udcca Raw customers data from API:",t);const n=t.results||t,r=Array.isArray(n)?n:[];console.log("\ud83d\udc65 All users array length:",r.length),console.log("\ud83d\udc65 All users:",r.map(e=>({id:e.id,username:e.username,email:e.email,user_type:e.user_type})));const i=r.map(e=>qe(qe({},e),{},{role:e.user_type||"customer"}));a(i),console.log("\u2705 Loaded customers from backend:",i.length),console.log("\u2705 Customer data sample:",i.slice(0,2))}else console.error("\u274c Failed to load customers:",e.status),a(A());const t=await fetch("http://localhost:8000/api/orders/orders/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(t.ok){const e=await t.json();console.log("Raw orders data from API:",e);const n=e.results||e,r=Array.isArray(n)?n:[];l(r),console.log("Loaded orders from backend:",r.length),console.log("Orders data sample:",r.slice(0,2))}else console.error("Failed to load orders:",t.status),l(M())}catch(nU){console.error("Error loading customer data:",nU),a(A()),l(M())}finally{console.log("Setting loading to false"),d(!1)}},A=()=>[{id:1,username:"john_doe",email:"john@example.com",first_name:"John",last_name:"Doe",role:"customer",is_active:!0,date_joined:"2024-01-15T10:30:00Z"},{id:2,username:"jane_smith",email:"jane@example.com",first_name:"Jane",last_name:"Smith",role:"customer",is_active:!0,date_joined:"2024-01-20T14:45:00Z"},{id:3,username:"admin_user",email:"admin@example.com",first_name:"Admin",last_name:"User",role:"admin",is_active:!0,date_joined:"2024-01-01T09:00:00Z"},{id:4,username:"inactive_customer",email:"inactive@example.com",first_name:"Inactive",last_name:"Customer",role:"customer",is_active:!1,date_joined:"2024-01-10T16:20:00Z"}],M=()=>[{id:1,customer_id:1,total_amount:45.99,status:"completed",created_at:"2024-01-25T10:30:00Z"},{id:2,customer_id:2,total_amount:38.99,status:"pending",created_at:"2024-01-26T14:45:00Z"}],E=(Array.isArray(s)?s:[]).filter(e=>{var t,n,r,i;const s=(null===(t=e.username)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase()))||(null===(n=e.email)||void 0===n?void 0:n.toLowerCase().includes(u.toLowerCase()))||(null===(r=e.first_name)||void 0===r?void 0:r.toLowerCase().includes(u.toLowerCase()))||(null===(i=e.last_name)||void 0===i?void 0:i.toLowerCase().includes(u.toLowerCase())),a=!p||e.role===p||e.user_type===p;return s&&a}),C=e=>{const t=parseFloat(e);return isNaN(t)||null===e||void 0===e?"RS 0.00":"RS ".concat(t.toFixed(2))},k=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=e=>{const t=e.email,n="SweetBites - Customer Support",r=e.first_name||e.username||"Valued Customer",i="Dear ".concat(r,",\n\nThank you for being a valued customer at SweetBites.\n\nWe hope you're enjoying our delicious cakes and excellent service. If you have any questions, concerns, or feedback, please don't hesitate to reach out to us.\n\nBest regards,\nSweetBites Customer Support Team\n\nPhone: (555) 123-CAKE\nWebsite: https://sweetbites.com");console.log("\ud83d\udce7 Preparing email for:",{customerName:r,email:t,subject:n});try{const e="mailto:".concat(t,"?subject=").concat(encodeURIComponent(n),"&body=").concat(encodeURIComponent(i));console.log("\ud83d\udce7 Opening email client with link:",e),window.open(e,"_blank"),alert("\u2705 Email client opened successfully!\n\nRecipient: ".concat(r,"\nEmail: ").concat(t,"\n\nPlease send your message from your default email application."))}catch(nU){console.error("\u274c Error opening email client:",nU),alert("\u274c Failed to open email client. Please try again or contact the customer manually.")}},P=e=>{const t=e.phone_number,n=e.first_name||e.username||"Valued Customer";console.log("\ud83d\udcde Preparing phone call for:",{customerName:n,phone:t});try{const e="tel:".concat(t);console.log("\ud83d\udcde Opening phone dialer with link:",e),window.open(e,"_self"),alert("\u2705 Phone dialer opened successfully!\n\nCalling: ".concat(n,"\nPhone: ").concat(t,"\n\nPlease complete the call from your device."))}catch(nU){console.error("\u274c Error opening phone dialer:",nU),alert("\u274c Failed to open phone dialer. Please try again or call the customer manually.")}};if(c||!r||!n||"admin"!==n.user_type&&"inventory_manager"!==n.user_type)return(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading customer data..."})]})});const L=(()=>{const e=(Array.isArray(s)?s:[]).filter(e=>"customer"===e.role||"customer"===e.user_type).length,t=(Array.isArray(s)?s:[]).filter(e=>"customer"!==e.role&&"customer"!==e.user_type||"admin"===e.user_type||"staff"===e.user_type).length,n=(Array.isArray(s)?s:[]).filter(e=>("customer"===e.role||"customer"===e.user_type)&&e.is_active).length;return{totalCustomers:e,totalStaff:t,activeCustomers:n,totalRevenue:Array.isArray(o)?o.reduce((e,t)=>e+parseFloat(t.total_amount||0),0):0}})(),R=(()=>{const e={};return Array.isArray(o)&&0!==o.length?(o.forEach(t=>{if(!t||!t.customer||!t.customer.id)return;const n=t.customer.id;e[n]||(e[n]={customer:t.customer,totalSpent:0,orderCount:0}),e[n].totalSpent+=parseFloat(t.total_amount||0),e[n].orderCount+=1}),Object.values(e).sort((e,t)=>t.totalSpent-e.totalSpent).slice(0,5)):[]})();return console.log("CustomerDashboard render - loading:",c,"customers:",s.length),(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Customer Management"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Manage customer accounts, view analytics, and track customer behavior"}),(0,Ue.jsxs)("p",{className:"text-sm text-blue-600 mt-1",children:["Total Customers: ",s.length," | Loading: ",c?"Yes":"No"]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsx)("button",{onClick:()=>{console.log("Debug - Current state:",{loading:c,isAuthenticated:r,user:n,userType:null===n||void 0===n?void 0:n.user_type,customersCount:s.length,ordersCount:o.length})},className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Debug Info"}),(0,Ue.jsxs)("button",{onClick:()=>{console.log("Refreshing customer data..."),d(!0),j()},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center",children:[(0,Ue.jsx)("svg",{className:"h-5 w-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]}),(0,Ue.jsxs)("button",{onClick:()=>{console.log("Add customer clicked"),N(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center",children:[(0,Ue.jsx)(Zl,{className:"h-5 w-5 mr-2"}),"Add Customer"]})]})]})})}),(0,Ue.jsx)("div",{className:"bg-white border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsx)("nav",{className:"flex space-x-8",children:[{id:"overview",name:"Overview",icon:Ql},{id:"customers",name:"Customers",icon:Zl},{id:"analytics",name:"Analytics",icon:Ql},{id:"communications",name:"Communications",icon:FU}].map(e=>(0,Ue.jsx)("button",{onClick:()=>g(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat(f===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.name},e.id))})})}),(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["overview"===f&&(0,Ue.jsxs)("div",{className:"space-y-8",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,Ue.jsx)(Zl,{className:"h-6 w-6 text-blue-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Customers"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:L.totalCustomers})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,Ue.jsx)(Zl,{className:"h-6 w-6 text-green-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Customers"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:L.activeCustomers})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,Ue.jsx)(Zl,{className:"h-6 w-6 text-purple-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Staff Members"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:L.totalStaff})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg",children:(0,Ue.jsx)(Rl,{className:"h-6 w-6 text-yellow-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:C(L.totalRevenue)})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Top Customers by Spending"})}),(0,Ue.jsxs)("div",{className:"p-6",children:[R.length>0?(0,Ue.jsx)("div",{className:"space-y-4",children:R.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-4",children:(0,Ue.jsx)("span",{className:"text-blue-600 font-medium",children:t+1})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("p",{className:"font-medium text-gray-900",children:[e.customer.first_name," ",e.customer.last_name]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:e.customer.email})]})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:C(e.totalSpent)}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:[e.orderCount," orders"]})]})]},e.customer.id))}):(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)(Zl,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"No customer data available"})]}),(0,Ue.jsx)("div",{className:"mt-6 text-center",children:(0,Ue.jsx)("button",{onClick:()=>g("customers"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"View All Customers"})})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Customer Activity"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsx)("div",{className:"space-y-4",children:o.slice(0,5).map(e=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(iv,{className:"h-5 w-5 text-blue-600 mr-3"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("p",{className:"font-medium text-gray-900",children:[e.customer.first_name," ",e.customer.last_name]}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["Order #",e.order_number]})]})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:C(e.total_amount)}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:k(e.created_at)})]})]},e.id))})})]})]}),"customers"===f&&(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,Ue.jsx)("div",{className:"flex-1",children:(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)(dv,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,Ue.jsx)("input",{type:"text",placeholder:"Search customers...",value:u,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,Ue.jsx)("div",{className:"flex gap-4",children:(0,Ue.jsxs)("select",{value:p,onChange:e=>m(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Ue.jsx)("option",{value:"",children:"All Roles"}),(0,Ue.jsx)("option",{value:"customer",children:"Customer"}),(0,Ue.jsx)("option",{value:"admin",children:"Admin"}),(0,Ue.jsx)("option",{value:"staff",children:"Staff"}),(0,Ue.jsx)("option",{value:"inventory_manager",children:"Inventory Manager"})]})})]})}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Customers (",E.length,")"]})}),(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map(e=>(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center",children:(0,Ue.jsx)(Zl,{className:"h-6 w-6 text-gray-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:["@",e.username]})]})]})}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,Ue.jsx)("div",{className:"text-sm text-gray-900",children:e.email}),e.phone_number&&(0,Ue.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[(0,Ue.jsx)(UU,{className:"h-4 w-4 mr-1"}),e.phone_number]})]}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("admin"===e.role||"admin"===e.user_type?"bg-red-100 text-red-800":"staff"===e.role||"staff"===e.user_type?"bg-blue-100 text-blue-800":"inventory_manager"===e.role||"inventory_manager"===e.user_type?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"),children:(e.role||e.user_type||"customer").replace("_"," ")})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Active":"Inactive"})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.date_joined?k(e.date_joined):"N/A"}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,Ue.jsx)("button",{onClick:()=>(e=>{v(e),b(!0)})(e),className:"text-blue-600 hover:text-blue-900 mr-3",children:"View"}),(0,Ue.jsx)("button",{onClick:()=>(e=>{console.log("\u2705 Edit button clicked for customer:",e),console.log("Customer data:",{id:e.id,username:e.username,email:e.email,first_name:e.first_name,last_name:e.last_name}),v(e),_(!0)})(e),className:"text-green-600 hover:text-green-900 mr-3",children:"Edit"}),(0,Ue.jsx)("button",{onClick:()=>(e=>{console.log("\u2705 Contact button clicked for customer:",e),console.log("Customer email:",e.email),console.log("Customer phone:",e.phone_number),e.first_name||e.username;const t=e.email,n=e.phone_number;if(!t&&!n)return alert("\u274c No contact information available!\n\nThis customer does not have an email address or phone number on file."),void console.log("\u274c No contact info available for customer:",e);let r="How would you like to contact this customer?\n\n",i=[];t&&(r+="\ud83d\udce7 Email: ".concat(t,"\n"),i.push("email")),n&&(r+="\ud83d\udcde Phone: ".concat(n,"\n"),i.push("phone")),r+="\nPlease choose an option:",1===i.length?"email"===i[0]?T(e):P(e):window.confirm("".concat(r,"\n\nClick OK for Email, Cancel for Phone Call"))?T(e):P(e)})(e),className:"text-purple-600 hover:text-purple-900 mr-3",children:"Contact"}),(0,Ue.jsx)("button",{onClick:()=>(async e=>{if(window.confirm('Are you sure you want to delete customer "'.concat(e.username,'"? This action cannot be undone.')))try{(await fetch("http://localhost:8000/api/users/users/".concat(e.id,"/"),{method:"DELETE",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}})).ok?(a(s.filter(t=>t.id!==e.id)),alert("Customer deleted successfully!")):alert("Failed to delete customer. Please try again.")}catch(nU){console.error("Error deleting customer:",nU),alert("An error occurred while deleting the customer.")}})(e),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},e.id))})]})})]})]}),"analytics"===f&&(0,Ue.jsxs)("div",{className:"space-y-8",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Customer Demographics"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(Zl,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"New Customers"}),(0,Ue.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:(Array.isArray(s)?s:[]).filter(e=>{if(!e.date_joined)return!1;const t=new Date(e.date_joined),n=new Date;return n.setDate(n.getDate()-30),t>=n}).length}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Last 30 days"})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(Ql,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Average Order Value"}),(0,Ue.jsx)("p",{className:"text-3xl font-bold text-green-600",children:o.length>0?C(o.reduce((e,t)=>e+parseFloat(t.total_amount||0),0)/o.length):"RS 0.00"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Per order"})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(Ol,{className:"h-16 w-16 text-purple-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Repeat Customers"}),(0,Ue.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:R.filter(e=>e.orderCount>1).length}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Multiple orders"})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Customer Behavior Analysis"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsx)("div",{className:"space-y-6",children:(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Customer Segments"}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,Ue.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,Ue.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(Array.isArray(s)?s:[]).filter(e=>"customer"===e.role).length}),(0,Ue.jsx)("p",{className:"text-sm text-blue-600",children:"Regular Customers"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,Ue.jsx)("p",{className:"text-2xl font-bold text-green-600",children:R.filter(e=>e.totalSpent>100).length}),(0,Ue.jsx)("p",{className:"text-sm text-green-600",children:"High-Value Customers"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[(0,Ue.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:(Array.isArray(s)?s:[]).filter(e=>"customer"===e.role&&!e.is_active).length}),(0,Ue.jsx)("p",{className:"text-sm text-yellow-600",children:"Inactive Customers"})]}),(0,Ue.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,Ue.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:(Array.isArray(s)?s:[]).filter(e=>"customer"!==e.role).length}),(0,Ue.jsx)("p",{className:"text-sm text-purple-600",children:"Staff Members"})]})]})]})})})]})]}),"communications"===f&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Customer Communications"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(FU,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Email Campaigns"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Send promotional emails and newsletters to customers"}),(0,Ue.jsx)("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create Campaign"})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(UU,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"SMS Notifications"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Send order updates and delivery notifications"}),(0,Ue.jsx)("button",{className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Send SMS"})]})]})})]})]}),(0,Ue.jsx)(HU,{customer:x,isOpen:y,onClose:()=>{b(!1),v(null)}}),(0,Ue.jsx)(XU,{customer:x,isOpen:w,onClose:()=>_(!1),onSave:e=>{console.log("Customer saved:",e),j()}}),(0,Ue.jsx)(pl,{isOpen:S,onClose:()=>{N(!1),j()},forceRegistration:!0})]})},ZU=["title","titleId"];function JU(e,t){let{title:n,titleId:r}=e,s=Ie(e,ZU);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{fillRule:"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z",clipRule:"evenodd"}))}const KU=i.forwardRef(JU),QU=e=>{let{onSubmit:t,onCancel:n,onDelete:r,isSubmitting:s=!1,showCancel:a=!0,initialData:o=null,isEditing:l=!1}=e;const[c,d]=(0,i.useState)((null===o||void 0===o?void 0:o.message)||""),[u,h]=(0,i.useState)((null===o||void 0===o?void 0:o.rating)||0),[p,m]=(0,i.useState)(0),[f,g]=(0,i.useState)({}),x=e=>{h(e),f.rating&&g(e=>qe(qe({},e),{},{rating:""}))},v=e=>{m(e)},y=()=>{m(0)};return(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 max-w-md mx-auto",children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold mb-4 text-gray-900",children:l?"Edit Your Feedback":"Share Your Feedback"}),(0,Ue.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),console.log("\ud83d\ude80 Form submission attempt:",{rating:u,message:c.trim()}),!(()=>{const e={},t=c.trim();return 0===u&&(e.rating="Please select a rating"),t?t.length<10?e.message="Feedback must be at least 10 characters long":t.length>1e3?e.message="Feedback cannot exceed 1000 characters":u<=2&&t.length<20&&(e.message="For low ratings, please provide at least 20 characters explaining your experience"):e.message="Feedback message is required",t&&/(.)\1{6,}/.test(t)&&(e.message="Please provide meaningful feedback without repetitive characters"),t&&["spam","fake","scam","hate"].some(e=>t.toLowerCase().includes(e))&&(e.message="Please provide constructive feedback without inappropriate language"),g(e),0===Object.keys(e).length})())return void console.log("\u274c Form validation failed:",f);const n={message:c.trim(),rating:u};console.log("\u2705 Validation passed, submitting feedback data:",n),t&&"function"===typeof t?t(n):console.error("\u274c onSubmit is not a function or is undefined:",t)},className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"How would you rate your experience? *"}),(0,Ue.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>e<=(p||u)?(0,Ue.jsx)(KU,{className:"h-8 w-8 text-yellow-400 cursor-pointer transition-colors",onClick:()=>x(e),onMouseEnter:()=>v(e),onMouseLeave:y},e):(0,Ue.jsx)(dc,{className:"h-8 w-8 text-gray-300 cursor-pointer transition-colors hover:text-yellow-400",onClick:()=>x(e),onMouseEnter:()=>v(e),onMouseLeave:y},e))}),u>0&&(0,Ue.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[1===u&&"Poor",2===u&&"Fair",3===u&&"Good",4===u&&"Very Good",5===u&&"Excellent"]}),f.rating&&(0,Ue.jsx)("p",{className:"text-sm text-red-600 mt-1",children:f.rating})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tell us more about your experience *"}),(0,Ue.jsx)("textarea",{id:"message",value:c,onChange:e=>{d(e.target.value),f.message&&g(e=>qe(qe({},e),{},{message:""}))},rows:4,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ".concat(f.message?"border-red-300":"border-gray-300"),placeholder:"Please share your thoughts about our service, products, or any suggestions for improvement...",required:!0}),(0,Ue.jsx)("div",{className:"flex justify-between mt-1",children:(0,Ue.jsxs)("p",{className:"text-xs ".concat(c.length>1e3?"text-red-500":c.length<10?"text-orange-500":"text-gray-500"),children:[c.length,"/1000 characters",u<=2?" (minimum 20 for low ratings)":" (minimum 10)"]})}),f.message&&(0,Ue.jsx)("p",{className:"text-sm text-red-600 mt-1",children:f.message})]}),(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsx)("button",{type:"submit",disabled:s,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:s?"Submitting...":l?"Update Feedback":"Submit Feedback"}),a&&n&&(0,Ue.jsx)("button",{type:"button",onClick:n,disabled:s,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 disabled:bg-gray-200 disabled:cursor-not-allowed transition-colors",children:"Cancel"})]}),l&&r&&(0,Ue.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,Ue.jsx)("button",{type:"button",onClick:r,disabled:s,className:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Delete Feedback"})})]})]})},$U=()=>{const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(!1),[s,a]=(0,i.useState)(""),[o,l]=(0,i.useState)(!1),{isAuthenticated:c}=Be();(0,i.useEffect)(()=>{if(!c)return alert("Please sign up to submit feedback!"),void l(!0)},[c]);const d=()=>{t(!1),a("")};return e?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsx)("div",{className:"max-w-md mx-auto px-4",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[(0,Ue.jsx)(_l,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,Ue.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Thank You!"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-6",children:"Your feedback has been submitted successfully. We appreciate you taking the time to share your thoughts with us."}),(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsx)("button",{onClick:d,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Submit Another Feedback"}),(0,Ue.jsx)("button",{onClick:()=>window.location.href="/",className:"w-full bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 transition-colors",children:"Go Home"})]})]})})}):(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[(0,Ue.jsxs)("div",{className:"max-w-2xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"text-center mb-8",children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"We Value Your Feedback"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Help us improve our service by sharing your experience with us."})]}),s&&(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-6",children:(0,Ue.jsx)("p",{className:"text-red-800",children:s})}),(0,Ue.jsx)(QU,{onSubmit:async e=>{if(!c)return alert("Please sign up to submit feedback!"),void l(!0);console.log("\ud83c\udfaf FeedbackPage handleSubmit called with:",e),r(!0),a("");try{console.log("\ud83d\udce4 Starting feedback submission process...",e),console.log("Testing backend connection...");try{const e=await ow.get("http://localhost:8000/api/feedback/");console.log("Backend connection test successful:",e.status)}catch(i){var n;console.log("Backend connection test failed (this is expected for GET):",null===(n=i.response)||void 0===n?void 0:n.status)}const r=localStorage.getItem("token"),s={headers:{"Content-Type":"application/json",Accept:"application/json"}};r?(s.headers.Authorization="Token ".concat(r),console.log("Using authentication token")):console.log("No authentication token, submitting as anonymous");const o=qe(qe({},e),{},{is_featured:!1,is_verified:!1});console.log("Request config:",s),console.log("Request URL: /api/feedback/"),console.log("Request data:",o);const l=await ow.post("http://localhost:8000/api/feedback/",o,s);console.log("Response status:",l.status),console.log("Response data:",l.data),200===l.status||201===l.status?(console.log("\u2705 Feedback submitted successfully!"),t(!0),a("")):(console.log("\u274c Unexpected response status:",l.status),a("Unexpected response from server. Please try again."))}catch(s){if(console.error("Error details:",s),console.error("Error message:",s.message),console.error("Error code:",s.code),s.response){console.error("Error response status:",s.response.status),console.error("Error response data:",s.response.data),console.error("Error response headers:",s.response.headers);const e=s.response.data;if("DUPLICATE_FEEDBACK"===e.code)a("You have already submitted feedback for this order. Each customer can only submit one feedback per order.");else if(e.message&&Array.isArray(e.message))a(e.message.join(", "));else if("object"!==typeof e||e.error||e.message)a(e.error||e.message||e.detail||"Failed to submit feedback. Please try again.");else{const t=Object.values(e).flat();a(t.join(", "))}}else s.request?(console.error("No response received:",s.request),a("Network error. Please check your connection and try again.")):(console.error("Error:",s.message),a("An unexpected error occurred. Please try again."))}finally{r(!1)}},isSubmitting:n,showCancel:!1}),(0,Ue.jsxs)("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-md p-4",children:[(0,Ue.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Why Your Feedback Matters"}),(0,Ue.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,Ue.jsx)("li",{children:"\u2022 Helps us improve our products and services"}),(0,Ue.jsx)("li",{children:"\u2022 Enables us to better serve our customers"}),(0,Ue.jsx)("li",{children:"\u2022 Guides our future development and improvements"}),(0,Ue.jsx)("li",{children:"\u2022 Your feedback is anonymous and confidential"})]})]})]}),(0,Ue.jsx)(pl,{isOpen:o,onClose:()=>l(!1)})]})},ez=e=>{let{isOpen:t,onClose:n,token:r,userEmail:s}=e;const[a,o]=(0,i.useState)({password:"",confirmPassword:""}),[l,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(!0),[h,p]=(0,i.useState)(""),[m,f]=(0,i.useState)(""),[g,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(!r)return p("Invalid reset link. Please request a new password reset."),void u(!1);(async()=>{try{const e=await fetch("http://localhost:8000/api/users/auth/verify-reset-token/".concat(r,"/"),{method:"GET",headers:{Accept:"application/json"}}),t=await e.json();e.ok&&t.valid?x(!0):p(t.message||"Invalid or expired reset link. Please request a new password reset.")}catch(h){console.error("Token verification error:",h),p("Failed to verify reset link. Please try again.")}finally{u(!1)}})()},[r]);const v=e=>{o(qe(qe({},a),{},{[e.target.name]:e.target.value}))};return t?(0,Ue.jsx)(ll,{children:(0,Ue.jsx)(tl.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:n,children:(0,Ue.jsxs)(tl.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Reset Your Password"}),(0,Ue.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),d?(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sweetbite-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Verifying reset link..."})]}):g?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"mb-4",children:(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["Enter your new password for ",(0,Ue.jsx)("span",{className:"font-medium",children:s})]})}),h&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:h}),m&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:m}),(0,Ue.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p(""),f(""),a.password===a.confirmPassword)if(a.password.length<8)p("Password must be at least 8 characters long");else{c(!0);try{const e=await fetch("http://localhost:8000/api/users/auth/reset-password/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({token:r,password:a.password,confirm_password:a.confirmPassword})}),t=await e.json();e.ok?(f("Password reset successfully! You can now log in with your new password."),o({password:"",confirmPassword:""}),setTimeout(()=>{n()},3e3)):p(t.message||"Failed to reset password. Please try again.")}catch(h){console.error("Reset password error:",h),p("Network error occurred. Please check your connection.")}finally{c(!1)}}else p("Passwords do not match")},className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,Ue.jsx)("input",{type:"password",name:"password",value:a.password,onChange:v,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent",placeholder:"Enter your new password"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),(0,Ue.jsx)("input",{type:"password",name:"confirmPassword",value:a.confirmPassword,onChange:v,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-transparent",placeholder:"Confirm your new password"})]}),(0,Ue.jsx)("button",{type:"submit",disabled:l,className:"w-full bg-sweetbite-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-sweetbite-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?(0,Ue.jsxs)("div",{className:"flex items-center justify-center",children:[(0,Ue.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Resetting..."]}):"Reset Password"})]})]}):(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("div",{className:"mx-auto h-16 w-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,Ue.jsx)("svg",{className:"h-8 w-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Invalid Reset Link"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:h}),(0,Ue.jsx)("button",{onClick:n,className:"w-full bg-sweetbite-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-sweetbite-700 transition-colors",children:"Close"})]})]})})}):null},tz=()=>{const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(!1),[s,a]=(0,i.useState)(""),[o,l]=(0,i.useState)(""),[c,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(""),[p,m]=(0,i.useState)("");ne();return(0,Ue.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:[(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md w-full space-y-8",children:[(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)(tl.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mx-auto h-16 w-16 bg-sweetbite-600 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("svg",{className:"h-8 w-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),(0,Ue.jsx)(tl.h2,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Forgot Password?"}),(0,Ue.jsx)(tl.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mt-2 text-sm text-gray-600",children:"No worries! Enter your email address and we'll send you a link to reset your password."})]}),(0,Ue.jsxs)(tl.form,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"mt-8 space-y-6",onSubmit:async n=>{n.preventDefault(),a(""),l(""),r(!0);try{const n=await fetch("http://localhost:8000/api/users/auth/forgot-password/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:e})}),r=await n.json();n.ok?(l("Password reset email sent successfully! Please check your inbox. If you remember your password, you can also sign in directly."),t("")):a(r.message||"Failed to send reset email. Please try again.")}catch(s){console.error("Forgot password error:",s),a("Network error occurred. Please check your connection.")}finally{r(!1)}},children:[(0,Ue.jsx)("div",{className:"rounded-md shadow-sm -space-y-px",children:(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),(0,Ue.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"appearance-none rounded-lg relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-sweetbite-500 focus:border-sweetbite-500 focus:z-10 sm:text-sm",placeholder:"Enter your email address"})]})}),s&&(0,Ue.jsx)(tl.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"rounded-md bg-red-50 p-4",children:(0,Ue.jsxs)("div",{className:"flex",children:[(0,Ue.jsx)("div",{className:"flex-shrink-0",children:(0,Ue.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,Ue.jsx)("div",{className:"ml-3",children:(0,Ue.jsx)("h3",{className:"text-sm font-medium text-red-800",children:s})})]})}),o&&(0,Ue.jsx)(tl.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"rounded-md bg-green-50 p-4",children:(0,Ue.jsxs)("div",{className:"flex",children:[(0,Ue.jsx)("div",{className:"flex-shrink-0",children:(0,Ue.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ue.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,Ue.jsx)("div",{className:"ml-3",children:(0,Ue.jsx)("h3",{className:"text-sm font-medium text-green-800",children:o})})]})}),(0,Ue.jsx)("div",{children:(0,Ue.jsx)(tl.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:n,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-sweetbite-600 hover:bg-sweetbite-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sweetbite-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:n?(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Ue.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ue.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending..."]}):"Send Reset Link"})}),(0,Ue.jsxs)("div",{className:"text-center space-y-3",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Already have an account? "}),(0,Ue.jsx)(Te,{to:"/",className:"font-medium text-sweetbite-600 hover:text-sweetbite-500 transition-colors",children:"Sign in here"})]}),(0,Ue.jsx)("div",{children:(0,Ue.jsx)(Te,{to:"/",className:"text-sm text-gray-500 hover:text-gray-700 transition-colors",children:"\u2190 Back to Home"})})]})]})]}),(0,Ue.jsx)(ez,{isOpen:c,onClose:()=>{d(!1),h(""),m("")},token:u,userEmail:p})]})};const nz=new class{constructor(){this.apiKey=null,this.fallbackEnabled=!0}async getHuggingFaceResponse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{const n=await fetch("https://api-inference.huggingface.co/models/microsoft/DialoGPT-medium",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inputs:{past_user_inputs:t.filter(e=>"user"===e.type).slice(-3).map(e=>e.text),generated_responses:t.filter(e=>"bot"===e.type).slice(-3).map(e=>e.text),text:e},parameters:{max_length:150,temperature:.7,do_sample:!0}})});if(n.ok){const e=await n.json();if(e&&e.generated_text)return{text:e.generated_text,source:"huggingface"}}}catch(nU){console.log("Hugging Face API failed:",nU)}return null}async getCohereResponse(e){try{const t=await fetch("https://api.cohere.ai/v1/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer YOUR_COHERE_API_KEY"},body:JSON.stringify({message:e,model:"command",max_tokens:150,temperature:.7})});if(t.ok){const e=await t.json();if(e&&e.text)return{text:e.text,source:"cohere"}}}catch(nU){console.log("Cohere API failed:",nU)}return null}async getGroqResponse(e){try{const t=await fetch("https://api.groq.com/openai/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer YOUR_GROQ_API_KEY"},body:JSON.stringify({messages:[{role:"system",content:"You are SweetBite's AI assistant, a helpful virtual assistant for a cake shop. Help customers with cake recommendations, customization, pricing, delivery, and general inquiries about cakes and pastries. Be friendly, helpful, and knowledgeable about cakes."},{role:"user",content:e}],model:"llama3-8b-8192",max_tokens:150,temperature:.7})});if(t.ok){const e=await t.json();if(e&&e.choices&&e.choices[0]&&e.choices[0].message)return{text:e.choices[0].message.content,source:"groq"}}}catch(nU){console.log("Groq API failed:",nU)}return null}async getLocalAIResponse(e){try{const t=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"llama2",prompt:"You are SweetBite's AI assistant for a cake shop. Help the customer with: ".concat(e),stream:!1})});if(t.ok){const e=await t.json();if(e&&e.response)return{text:e.response,source:"ollama"}}}catch(nU){console.log("Local Ollama API failed:",nU)}return null}async getAIResponse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[()=>this.getHuggingFaceResponse(e,t),()=>this.getGroqResponse(e),()=>this.getCohereResponse(e),()=>this.getLocalAIResponse(e)];for(const r of n)try{const e=await r();if(e&&e.text)return e}catch(nU){console.log("AI service failed, trying next...",nU);continue}return null}getRuleBasedResponse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=e.toLowerCase();t.filter(e=>"bot"===e.type).slice(-1)[0],t.filter(e=>"user"===e.type).slice(-1)[0];return n.includes("recommend")||n.includes("suggest")||n.includes("best")||n.includes("popular")?{text:"I'd love to recommend some amazing cakes! \ud83c\udf70\n\nOur top-rated options include:\n\u2022 Chocolate Fudge Delight - RS 450 (4.8\u2b50)\n\u2022 Vanilla Dream Cake - RS 380 (4.7\u2b50)\n\u2022 Strawberry Shortcake - RS 420 (4.9\u2b50)\n\nWhat type of occasion are you celebrating?",suggestions:["Birthday cake","Wedding cake","Anniversary special","Just for fun"]}:n.includes("price")||n.includes("cost")||n.includes("expensive")?{text:"Great question about pricing! \ud83d\udcb0\n\nOur cakes range from RS 300 to RS 800:\n\u2022 Basic cakes: RS 300-400\n\u2022 Premium cakes: RS 500-600\n\u2022 Custom designs: RS 600-800\n\u2022 Size upgrades: +RS 15-45\n\u2022 Customization: +RS 2-12 per option\n\nWould you like a specific price quote?",suggestions:["Get price quote","Show me budget options","What's included?"]}:n.includes("delivery")||n.includes("shipping")||n.includes("time")?{text:"We offer excellent delivery options! \ud83d\ude9a\n\n\u2022 Same-day delivery (orders before 2 PM)\n\u2022 Next-day delivery (orders after 2 PM)\n\u2022 Free delivery on orders over RS 100\n\u2022 Preparation time: 2-4 hours\n\u2022 Delivery areas: All major cities\n\nWhat's your delivery address?",suggestions:["Check my area","Delivery cost?","Track my order"]}:n.includes("customize")||n.includes("custom")||n.includes("personalize")?{text:'Customization is our specialty! \ud83c\udfa8\n\nYou can customize:\n\u2022 Size: 6", 8", 10", 12"\n\u2022 Shape: Round, Square, Heart, Rectangle\n\u2022 Frosting: Buttercream, Cream Cheese, Chocolate\n\u2022 Toppings: Berries, Chocolate, Sprinkles, Flowers\n\u2022 Personal messages (up to 30 characters)\n\nWhich cake would you like to customize?',suggestions:["Start customizing","Show options","See examples"]}:{text:"I'm here to help you find the perfect cake! \ud83c\udf70\n\nI can assist with:\n\u2022 Cake recommendations\n\u2022 Customization options\n\u2022 Pricing and delivery\n\u2022 Special occasions\n\u2022 Dietary requirements\n\nWhat would you like to know?",suggestions:["Show me cakes","Help me customize","Tell me about pricing","What can you help with?"]}}},rz=()=>{const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)([]),[s,a]=(0,i.useState)(""),[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!0),[u,h]=(0,i.useState)([]),[p,m]=(0,i.useState)([]),f=(0,i.useRef)(null);(0,i.useEffect)(()=>{(async()=>{try{const[e,t]=await Promise.all([_v(),Sv()]);h(e),m(t)}catch(nU){console.error("Error loading data for chatbot:",nU),h([]),m([])}})()},[]),(0,i.useEffect)(()=>{(()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[n]),(0,i.useEffect)(()=>{0===n.length&&r([{id:1,type:"bot",text:"Hi! I'm SweetBite's AI-powered virtual assistant! \ud83c\udf70\ud83e\udd16 I can help you with cake information, customization options, recommendations, and more. What would you like to know?",timestamp:new Date}])},[]);const g=e=>nz.getRuleBasedResponse(e,n),x=async function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||s.trim();if(!e)return;const t={id:Date.now(),type:"user",text:e,timestamp:new Date};r(e=>[...e,t]),a(""),l(!0);try{let t;c&&(t=await(async e=>{try{const t=await nz.getAIResponse(e,n);if(t&&t.text)return{text:t.text,suggestions:["Tell me more","What else can you help with?","Show me cakes"],source:t.source}}catch(nU){console.log("AI service failed, falling back to rule-based responses")}return null})(e)),t||(t=g(e));const i={id:Date.now()+1,type:"bot",text:t.text,suggestions:t.suggestions||[],timestamp:new Date};r(e=>[...e,i])}catch(nU){console.error("Error getting bot response:",nU);const n=g(e),i={id:Date.now()+1,type:"bot",text:n.text,suggestions:n.suggestions||[],timestamp:new Date};r(e=>[...e,i])}finally{l(!1)}};return(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)(tl.button,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>t(!e),className:"fixed bottom-6 right-6 w-16 h-16 bg-sweetbite-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 z-50 flex items-center justify-center",children:e?(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,Ue.jsx)(ll,{children:e&&(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},transition:{duration:.3},className:"fixed bottom-24 right-6 w-96 h-[500px] bg-white rounded-2xl shadow-2xl border border-gray-200 z-50 flex flex-col overflow-hidden",children:[(0,Ue.jsxs)("div",{className:"bg-sweetbite-600 text-white p-4 flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-lg",children:"\ud83c\udf70"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"font-semibold",children:"SweetBite AI Assistant"}),(0,Ue.jsx)("p",{className:"text-xs text-sweetbite-100",children:c?"\ud83e\udd16 AI Powered":"\ud83d\udcdd Rule-based"})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("button",{onClick:()=>{d(!c)},className:"px-2 py-1 rounded text-xs transition-colors ".concat(c?"bg-green-500 text-white":"bg-gray-500 text-white"),title:c?"AI Enabled":"AI Disabled",children:c?"AI ON":"AI OFF"}),(0,Ue.jsx)("button",{onClick:()=>t(!1),className:"text-white hover:text-sweetbite-200 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,Ue.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.map(e=>(0,Ue.jsx)("div",{className:"flex ".concat("user"===e.type?"justify-end":"justify-start"),children:(0,Ue.jsxs)("div",{className:"max-w-[80%] p-3 rounded-2xl ".concat("user"===e.type?"bg-sweetbite-600 text-white":"bg-gray-100 text-gray-800"),children:[(0,Ue.jsx)("p",{className:"text-sm whitespace-pre-line",children:e.text}),e.suggestions&&e.suggestions.length>0&&(0,Ue.jsx)("div",{className:"mt-2 space-y-1",children:e.suggestions.map((e,t)=>(0,Ue.jsx)("button",{onClick:()=>(e=>{x(e)})(e),className:"block w-full text-left text-xs bg-white bg-opacity-20 hover:bg-opacity-30 p-2 rounded-lg transition-colors",children:e},t))})]})},e.id)),o&&(0,Ue.jsx)("div",{className:"flex justify-start",children:(0,Ue.jsx)("div",{className:"bg-gray-100 text-gray-800 p-3 rounded-2xl",children:(0,Ue.jsxs)("div",{className:"flex space-x-1",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,Ue.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),(0,Ue.jsx)("div",{ref:f})]}),(0,Ue.jsx)("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:(0,Ue.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[(0,Ue.jsx)("button",{onClick:()=>x("Show me popular cakes"),className:"px-3 py-1 bg-sweetbite-100 text-sweetbite-700 rounded-full text-xs hover:bg-sweetbite-200 transition-colors",children:"\ud83c\udf70 Popular"}),(0,Ue.jsx)("button",{onClick:()=>x("Help me customize"),className:"px-3 py-1 bg-sweetbite-100 text-sweetbite-700 rounded-full text-xs hover:bg-sweetbite-200 transition-colors",children:"\ud83c\udfa8 Customize"}),(0,Ue.jsx)("button",{onClick:()=>x("Tell me about pricing"),className:"px-3 py-1 bg-sweetbite-100 text-sweetbite-700 rounded-full text-xs hover:bg-sweetbite-200 transition-colors",children:"\ud83d\udcb0 Pricing"}),(0,Ue.jsx)("button",{onClick:()=>x("What's your delivery?"),className:"px-3 py-1 bg-sweetbite-100 text-sweetbite-700 rounded-full text-xs hover:bg-sweetbite-200 transition-colors",children:"\ud83d\ude9a Delivery"})]})}),(0,Ue.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("input",{type:"text",value:s,onChange:e=>a(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),x())},placeholder:"Type your message...",className:"flex-1 p-3 border border-gray-300 rounded-lg focus:border-sweetbite-600 focus:outline-none text-sm"}),(0,Ue.jsx)("button",{onClick:()=>x(),disabled:!s.trim(),className:"px-4 py-3 bg-sweetbite-600 text-white rounded-lg hover:bg-sweetbite-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,Ue.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})})]})})]})},iz=["title","titleId"];function sz(e,t){let{title:n,titleId:r}=e,s=Ie(e,iz);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const az=i.forwardRef(sz),oz=e=>{let{offer:t,onClose:n,isPopup:r=!1}=e;const[s,a]=(0,i.useState)("");if((0,i.useEffect)(()=>{if(null!==t&&void 0!==t&&t.end_date){const e=()=>{const e=(new Date).getTime(),n=new Date(t.end_date).getTime()-e;if(n>0){const e=Math.floor(n/864e5),t=Math.floor(n%864e5/36e5),r=Math.floor(n%36e5/6e4);a(e>0?"".concat(e,"d ").concat(t,"h ").concat(r,"m"):t>0?"".concat(t,"h ").concat(r,"m"):"".concat(r,"m"))}else a("Expired")};e();const n=setInterval(e,6e4);return()=>clearInterval(n)}},[null===t||void 0===t?void 0:t.end_date]),!t)return null;const o={backgroundColor:t.background_color||"#FF6B6B",color:t.text_color||"#FFFFFF"};return r?(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Ue.jsxs)("div",{className:"relative max-w-md w-full rounded-lg shadow-xl overflow-hidden",style:o,children:[(0,Ue.jsx)("button",{onClick:n,className:"absolute top-4 right-4 text-white hover:text-gray-200 z-10",children:(0,Ue.jsx)(Dv,{className:"h-6 w-6"})}),t.banner_image&&(0,Ue.jsx)("img",{src:t.banner_image,alt:t.title,className:"w-full h-48 object-cover"}),(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Ue.jsx)(az,{className:"h-6 w-6 mr-2"}),(0,Ue.jsx)("h3",{className:"text-xl font-bold",children:t.title})]}),(0,Ue.jsx)("p",{className:"text-sm mb-4 opacity-90",children:t.description}),(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsx)("span",{className:"text-lg font-semibold",children:t.discount_display}),s&&"Expired"!==s&&(0,Ue.jsxs)("div",{className:"flex items-center text-sm",children:[(0,Ue.jsx)(oc,{className:"h-4 w-4 mr-1"}),(0,Ue.jsx)("span",{children:s})]})]})]})]})}):(0,Ue.jsxs)("div",{className:"relative rounded-lg overflow-hidden shadow-lg",style:o,children:[(0,Ue.jsx)("button",{onClick:n,className:"absolute top-2 right-2 text-white hover:text-gray-200 z-10",children:(0,Ue.jsx)(Dv,{className:"h-5 w-5"})}),(0,Ue.jsx)("div",{className:"p-4",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsxs)("div",{className:"flex items-center mb-1",children:[(0,Ue.jsx)(az,{className:"h-5 w-5 mr-2"}),(0,Ue.jsx)("h3",{className:"text-lg font-bold",children:t.title})]}),(0,Ue.jsx)("p",{className:"text-sm opacity-90 mb-2",children:t.description}),(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("span",{className:"text-lg font-semibold mr-4",children:t.discount_display}),s&&"Expired"!==s&&(0,Ue.jsxs)("div",{className:"flex items-center text-sm",children:[(0,Ue.jsx)(oc,{className:"h-4 w-4 mr-1"}),(0,Ue.jsxs)("span",{children:[s," left"]})]})]})]}),t.banner_image&&(0,Ue.jsx)("img",{src:t.banner_image,alt:t.title,className:"w-20 h-20 object-cover rounded-lg ml-4"})]})})]})},lz=e=>{let{isAuthenticated:t,onShowLogin:n,setShowLoginModal:r}=e;return(0,Ue.jsxs)("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden",children:[(0,Ue.jsxs)("div",{className:"absolute inset-0",children:[(0,Ue.jsx)("div",{className:"absolute top-20 left-20 w-72 h-72 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"}),(0,Ue.jsx)("div",{className:"absolute top-40 right-20 w-72 h-72 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"}),(0,Ue.jsx)("div",{className:"absolute -bottom-8 left-40 w-72 h-72 bg-orange-300 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"})]}),(0,Ue.jsxs)("div",{className:"hero-content text-center max-w-4xl mx-auto px-4",children:[(0,Ue.jsxs)(tl.h1,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-6xl md:text-7xl font-bold text-gray-800 mb-6",children:["SweetBite",(0,Ue.jsx)("span",{className:"block text-4xl md:text-5xl text-sweetbite-600 mt-2",children:"Where Dreams Become Cakes"})]}),(0,Ue.jsx)(tl.p,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-xl text-gray-600 mb-8 max-w-2xl mx-auto",children:"Discover our handcrafted cakes, customize them to your heart's desire, and experience the sweetest moments delivered to your doorstep."}),(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,Ue.jsx)(Te,{to:"/menu",className:"btn-primary",children:"Explore Our Cakes"}),t?(0,Ue.jsx)(Te,{to:"/customize",className:"btn-secondary",children:"Customize Your Cake"}):(0,Ue.jsx)("button",{onClick:()=>{alert("Please sign up to customize cakes!"),r(!0)},className:"btn-secondary",children:"Customize Your Cake"})]}),!t&&(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},className:"auth-section mt-12 p-6 bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl max-w-md mx-auto",children:[(0,Ue.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-3",children:"Join SweetBite"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Create an account to save your favorite cakes, track orders, and get exclusive offers!"}),(0,Ue.jsx)("button",{onClick:n,className:"w-full bg-sweetbite-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-sweetbite-700 transition-colors shadow-lg hover:shadow-xl transform hover:scale-105",children:"Sign In / Sign Up"})]})]}),(0,Ue.jsx)("div",{className:"floating-element absolute bottom-10 left-10 animate-bounce",children:(0,Ue.jsx)("span",{className:"text-4xl",children:"\ud83c\udf70"})}),(0,Ue.jsx)("div",{className:"floating-element absolute top-20 right-10 animate-bounce animation-delay-1000",children:(0,Ue.jsx)("span",{className:"text-3xl",children:"\ud83c\udf82"})})]})},cz=e=>{let{categories:t,selectedCategory:n,onCategoryChange:r}=e;return(0,Ue.jsx)("section",{className:"py-16 bg-white",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,Ue.jsx)("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Cake Categories"}),(0,Ue.jsx)("p",{className:"text-gray-600 text-lg",children:"Choose from our wide variety of delicious cake categories"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:t.map((e,t)=>(0,Ue.jsxs)(tl.button,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1*t},onClick:()=>r(e.id),className:"p-4 rounded-lg text-center transition-all transform hover:scale-105 ".concat(n===e.id?"bg-sweetbite-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-sweetbite-100"),children:[(0,Ue.jsx)("div",{className:"text-2xl mb-2",children:e.icon}),(0,Ue.jsx)("span",{className:"text-sm font-semibold",children:e.name})]},e.id))})]})})},dz=e=>{let{cakes:t,loading:n,onAddToCart:r,onReview:i}=e;return console.log("FeaturedCakesSection - cakes:",t,"loading:",n),(0,Ue.jsx)("section",{className:"py-16 gradient-bg",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,Ue.jsx)("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Featured Cakes"}),(0,Ue.jsx)("p",{className:"text-gray-600 text-lg",children:"Handcrafted with love and the finest ingredients"})]}),n?(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-8",children:[1,2,3,4].map(e=>(0,Ue.jsxs)("div",{className:"card min-h-[500px] animate-pulse",children:[(0,Ue.jsx)("div",{className:"h-72 bg-gray-300 rounded-t-lg"}),(0,Ue.jsxs)("div",{className:"p-6 pb-8",children:[(0,Ue.jsx)("div",{className:"h-6 bg-gray-300 rounded mb-2"}),(0,Ue.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-4"}),(0,Ue.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-4"}),(0,Ue.jsx)("div",{className:"flex justify-between mb-4",children:(0,Ue.jsx)("div",{className:"flex space-x-1",children:[...Array(5)].map((e,t)=>(0,Ue.jsx)("div",{className:"w-4 h-4 bg-gray-300 rounded"},t))})}),(0,Ue.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Ue.jsx)("div",{className:"h-8 bg-gray-300 rounded"}),(0,Ue.jsx)("div",{className:"h-8 bg-gray-300 rounded"}),(0,Ue.jsx)("div",{className:"h-8 bg-gray-300 rounded"})]})]})]},e))}):(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-8",children:(Array.isArray(t)?t:[]).map((e,t)=>(console.log("Rendering cake:",e),(0,Ue.jsx)(uz,{cake:e,onAddToCart:r,onReview:i,index:t},e.id)))}),(0,Ue.jsx)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"text-center mt-12",children:(0,Ue.jsx)(Te,{to:"/menu",className:"btn-primary",children:"View All Cakes"})})]})})},uz=e=>{let{cake:t,onAddToCart:n,onReview:r,index:s}=e;const[a,o]=(0,i.useState)(!1);return console.log("CakeCard rendering for:",t.name),(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1*s},onHoverStart:()=>o(!0),onHoverEnd:()=>o(!1),className:"card cursor-pointer min-h-[500px]",onClick:()=>window.location.href="/cake/".concat(t.id),children:[(0,Ue.jsxs)("div",{className:"relative h-72 overflow-hidden",children:[(0,Ue.jsx)("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover transition-transform duration-300 hover:scale-110",onError:e=>{e.target.src="https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400&h=300&fit=crop"}}),(0,Ue.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center transition-opacity duration-300 ".concat(a?"opacity-100":"opacity-0"),children:(0,Ue.jsxs)("div",{className:"flex gap-3",children:[(0,Ue.jsx)("button",{onClick:e=>{e.stopPropagation(),console.log("Quick Add clicked for cake:",t),n(t)},className:"bg-sweetbite-600 text-white px-6 py-2 rounded-full font-semibold hover:bg-sweetbite-700 transition-colors",children:"Quick Add"}),(0,Ue.jsx)(Te,{to:"/cake/".concat(t.id),className:"bg-white text-sweetbite-600 px-6 py-2 rounded-full font-semibold hover:bg-gray-100 transition-colors",children:"View Details"})]})}),(0,Ue.jsxs)("div",{className:"absolute top-4 right-4 bg-sweetbite-600 text-white px-3 py-1 rounded-full font-semibold",children:["RS ",t.price]})]}),(0,Ue.jsxs)("div",{className:"p-6 pb-8",children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:t.name}),(0,Ue.jsx)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:t.description}),(0,Ue.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ue.jsx)("div",{className:"flex items-center",children:[...Array(5)].map((e,n)=>{const r=t.rating||0,i=n+1,s=i<=Math.floor(r),a=i===Math.ceil(r)&&r%1!==0;return(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),(s||a)&&(0,Ue.jsx)("svg",{className:"w-4 h-4 text-yellow-400 absolute top-0 left-0 ".concat(a?"clip-path-half":""),fill:"currentColor",viewBox:"0 0 20 20",style:a?{clipPath:"polygon(0 0, 50% 0, 50% 100%, 0% 100%)"}:{},children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})]},n)})}),(0,Ue.jsxs)("span",{className:"text-sm text-gray-600 ml-1",children:[t.rating?t.rating.toFixed(1):"0.0"," (",t.review_count||t.reviewCount||0,")"]})]}),(0,Ue.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,Ue.jsx)("button",{onClick:e=>{e.stopPropagation(),console.log("Add to cart clicked for cake:",t),n(t)},className:"bg-sweetbite-600 text-white px-3 py-2 rounded-lg font-semibold hover:bg-sweetbite-700 transition-colors text-xs sm:text-sm flex-1",children:"Add to Cart"}),(0,Ue.jsx)("button",{onClick:e=>{e.stopPropagation(),r(t)},className:"bg-yellow-500 text-white px-3 py-2 rounded-lg font-semibold hover:bg-yellow-600 transition-colors text-xs sm:text-sm flex-1",children:"\u2b50 Review"}),(0,Ue.jsx)(Te,{to:"/cake/".concat(t.id),className:"border border-sweetbite-600 text-sweetbite-600 px-3 py-2 rounded-lg font-semibold hover:bg-sweetbite-50 transition-colors text-xs sm:text-sm flex-1 text-center",children:"View Details"})]})]})]})]})},hz=e=>{let{customizationOptions:t,isAuthenticated:n,setShowLoginModal:r}=e;return(0,Ue.jsx)("section",{className:"py-16 bg-white",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,Ue.jsx)("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Customize Your Dream Cake"}),(0,Ue.jsx)("p",{className:"text-gray-600 text-lg",children:"Make it uniquely yours with our easy customization options"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:t.map((e,t)=>(0,Ue.jsx)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1*t},className:"text-center",children:(0,Ue.jsxs)("div",{className:"bg-gradient-to-br from-sweetbite-100 to-pink-100 rounded-2xl p-8 mb-4",children:[(0,Ue.jsx)("div",{className:"text-4xl mb-4",children:e.icon}),(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e.name}),(0,Ue.jsx)("p",{className:"text-gray-600 text-sm",children:e.description})]})},e.id))}),(0,Ue.jsx)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"text-center mt-12",children:n?(0,Ue.jsx)(Te,{to:"/customize",className:"btn-primary",children:"Start Customizing"}):(0,Ue.jsx)("button",{onClick:()=>{alert("Please sign up to customize cakes!"),r(!0)},className:"btn-primary",children:"Start Customizing"})})]})})},pz=e=>{let{features:t}=e;return(0,Ue.jsx)("section",{className:"py-16 gradient-bg",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,Ue.jsx)("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Why Choose SweetBite?"}),(0,Ue.jsx)("p",{className:"text-gray-600 text-lg",children:"We're committed to delivering the sweetest experiences"})]}),(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:t.map((e,t)=>(0,Ue.jsx)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1*t},className:"text-center",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-2xl p-8 shadow-lg",children:[(0,Ue.jsx)("div",{className:"text-4xl mb-4",children:e.icon}),(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e.name}),(0,Ue.jsx)("p",{className:"text-gray-600",children:e.description})]})},e.id))})]})})},mz=e=>{let{testimonials:t,loading:n,navigate:r}=e;return(0,Ue.jsx)("section",{className:"py-16 bg-white",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12",children:[(0,Ue.jsx)("h2",{className:"text-4xl font-bold text-gray-800 mb-4",children:t.length>0?"What Our Customers Say":"Customer Feedback"}),(0,Ue.jsx)("p",{className:"text-gray-600 text-lg",children:t.length>0?"Real feedback with photos from verified customers who ordered with us":"Share your sweet experience with us!"})]}),n?(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[1,2,3].map(e=>(0,Ue.jsxs)("div",{className:"bg-gradient-to-br from-sweetbite-50 to-pink-50 rounded-2xl p-6 animate-pulse",children:[(0,Ue.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ue.jsx)("div",{className:"w-12 h-12 bg-gray-300 rounded-full mr-4"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"h-4 bg-gray-300 rounded w-24 mb-2"}),(0,Ue.jsx)("div",{className:"flex space-x-1",children:[...Array(5)].map((e,t)=>(0,Ue.jsx)("div",{className:"w-4 h-4 bg-gray-300 rounded"},t))})]})]}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsx)("div",{className:"h-3 bg-gray-300 rounded w-full"}),(0,Ue.jsx)("div",{className:"h-3 bg-gray-300 rounded w-3/4"})]})]},e))}):t.length>0?(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:t.map((e,t)=>(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1*t},className:"bg-gradient-to-br from-sweetbite-50 to-pink-50 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow",children:[e.images&&e.images.length>0&&(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("div",{className:"grid grid-cols-2 gap-2",children:e.images.slice(0,2).map((e,t)=>(0,Ue.jsx)("img",{src:e.image||e.url||e,alt:"Customer photo ".concat(t+1),className:"w-full h-24 object-cover rounded-lg border-2 border-white shadow-sm",onError:e=>{e.target.style.display="none"}},t))}),e.images.length>2&&(0,Ue.jsxs)("p",{className:"text-xs text-gray-500 mt-1 text-center",children:["+",e.images.length-2," more photos"]})]}),(0,Ue.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ue.jsx)("img",{src:e.avatar,alt:e.name,className:"w-12 h-12 rounded-full mr-4 border-2 border-white shadow-sm",onError:t=>{t.target.src="https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e.name),"&background=f3e8ff&color=8b5cf6&size=100")}}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsx)("h4",{className:"font-semibold text-gray-800",children:e.name}),e.isRealCustomer&&(0,Ue.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:"\u2713 Verified"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("div",{className:"flex text-yellow-400",children:[...Array(5)].map((t,n)=>(0,Ue.jsx)("svg",{className:"w-4 h-4 ".concat(n<e.rating?"text-yellow-400":"text-gray-300"),fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},n))}),(0,Ue.jsxs)("span",{className:"text-sm text-gray-500",children:[e.rating,"/5"]})]}),e.order_id&&(0,Ue.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Order #",e.order_id]})]})]}),(0,Ue.jsxs)("p",{className:"text-gray-600 italic leading-relaxed",children:['"',e.comment,'"']}),e.detailed_ratings&&Object.keys(e.detailed_ratings).some(t=>e.detailed_ratings[t]>0)&&(0,Ue.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.detailed_ratings.taste>0&&(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"text-gray-500",children:"Taste"}),(0,Ue.jsxs)("div",{className:"font-semibold text-sweetbite-600",children:[e.detailed_ratings.taste,"/5"]})]}),e.detailed_ratings.presentation>0&&(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"text-gray-500",children:"Design"}),(0,Ue.jsxs)("div",{className:"font-semibold text-sweetbite-600",children:[e.detailed_ratings.presentation,"/5"]})]}),e.detailed_ratings.delivery>0&&(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"text-gray-500",children:"Service"}),(0,Ue.jsxs)("div",{className:"font-semibold text-sweetbite-600",children:[e.detailed_ratings.delivery,"/5"]})]})]})}),e.created_at&&(0,Ue.jsx)("p",{className:"text-xs text-gray-400 mt-3 text-right",children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]},e.id))}):(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[(0,Ue.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udf70"}),(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Be Our First Reviewer!"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"We're excited to hear from our customers! Order a cake and share your experience with photos to help others discover our delicious treats."}),(0,Ue.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,Ue.jsx)("button",{onClick:()=>r("/cakes"),className:"px-6 py-3 bg-sweetbite-600 text-white rounded-lg font-semibold hover:bg-sweetbite-700 transition-colors",children:"Browse Our Cakes"}),(0,Ue.jsx)("button",{onClick:()=>r("/feedback"),className:"px-6 py-3 border-2 border-sweetbite-600 text-sweetbite-600 rounded-lg font-semibold hover:bg-sweetbite-50 transition-colors",children:"Leave Feedback"})]})]})]})})},fz=e=>{let{cake:t,isOpen:n,onClose:r,onSubmit:i,review:s,setReview:a,submitting:o}=e;return n?(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ue.jsxs)("h3",{className:"text-xl font-bold text-gray-800",children:["Review ",t.name]}),(0,Ue.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ue.jsxs)("form",{onSubmit:i,className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),(0,Ue.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>a(t=>qe(qe({},t),{},{rating:e})),className:"w-8 h-8 ".concat(e<=s.rating?"text-yellow-400":"text-gray-300"," hover:text-yellow-400 transition-colors"),children:(0,Ue.jsx)("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},e))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comment"}),(0,Ue.jsx)("textarea",{value:s.comment,onChange:e=>a(t=>qe(qe({},t),{},{comment:e.target.value})),placeholder:"Share your experience with this cake... (minimum 10 characters)",className:"w-full p-3 border border-gray-300 rounded-lg focus:border-sweetbite-600 focus:outline-none resize-none",rows:3,required:!0}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[s.comment.length,"/500 characters",s.comment.length<10&&(0,Ue.jsxs)("span",{className:"text-red-500 ml-2",children:["(Need at least ",10-s.comment.length," more characters)"]})]})]}),(0,Ue.jsxs)("div",{className:"flex gap-3",children:[(0,Ue.jsx)("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:o||0===s.rating||!s.comment||s.comment.trim().length<10,className:"flex-1 bg-sweetbite-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-sweetbite-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Submitting...":"Submit Review"})]})]})]})}):null},gz=()=>{const e=ne(),[t,n]=(0,i.useState)("all"),[r,s]=(0,i.useState)(!1),[a,o]=(0,i.useState)(!1),[l,c]=(0,i.useState)(null),[d,u]=(0,i.useState)({rating:0,comment:""}),[h,p]=(0,i.useState)(!1),[m,f]=(0,i.useState)([]),[g,x]=(0,i.useState)(!0),[v,y]=(0,i.useState)([]),[b,w]=(0,i.useState)([]),[_,S]=(0,i.useState)(!0),[N,j]=(0,i.useState)([]),[A,M]=(0,i.useState)([]),[E,C]=(0,i.useState)(!0),[k,T]=(0,i.useState)(new Set),[P,L]=(0,i.useState)(new Set),[R,I]=(0,i.useState)(!1),{addItem:F}=hl(),{isAuthenticated:O,user:D}=Be(),U="all"===t?Array.isArray(v)?v.slice(0,6):[]:Array.isArray(v)?v.filter(e=>{var n;const r="string"===typeof e.category?e.category:null===(n=e.category)||void 0===n?void 0:n.name;return console.log("Filtering cake: ".concat(e.name,", category: ").concat(r,", selected: ").concat(t,", match: ").concat(r===t)),r===t}).slice(0,4):[];(0,i.useEffect)(()=>{(async()=>{try{S(!0);const[e,t]=await Promise.all([_v(),Sv()]);y(e),w(t),console.log("Loaded cakes:",e),console.log("Loaded categories:",t)}catch(nU){console.error("Error loading data:",nU),y([]),w([])}finally{S(!1)}})()},[]),(0,i.useEffect)(()=>{(async()=>{try{x(!0);const e=await ow.get("http://localhost:8000/api/feedback/");console.log("Fetched customer feedback:",e.data);const t=(Array.isArray(e.data)?e.data:[]).filter(e=>e.message&&e.message.trim().length>0).sort((e,t)=>(t.rating||0)-(e.rating||0)).slice(0,3).map(e=>{var t,n;return{id:e.id,name:(null===(t=e.user)||void 0===t?void 0:t.username)||"Verified Customer",avatar:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent((null===(n=e.user)||void 0===n?void 0:n.username)||"Customer"),"&background=f3e8ff&color=8b5cf6&size=100"),comment:e.message,rating:e.rating||5,isRealCustomer:!0}});f(t)}catch(nU){console.error("Error fetching customer feedback:",nU),f([])}finally{x(!1)}})()},[]);(0,i.useEffect)(()=>{(async()=>{try{C(!0);const[e,t]=await Promise.all([ow.get("http://localhost:8000/api/offers/homepage/"),ow.get("http://localhost:8000/api/offers/popup/")]);j(e.data),M(t.data),console.log("Loaded homepage offers:",e.data),console.log("Loaded popup offers:",t.data)}catch(nU){console.error("Error loading offers:",nU)}finally{C(!1)}})()},[]),(0,i.useEffect)(()=>{D&&"admin"===D.user_type||!E&&(N.length>0||A.length>0)&&I(!0)},[E,N.length,A.length,D]);return(0,Ue.jsxs)("div",{className:"min-h-screen gradient-bg",children:[(0,Ue.jsx)(lz,{isAuthenticated:O,onShowLogin:()=>s(!0),setShowLoginModal:s}),(0,Ue.jsx)(cz,{categories:b,selectedCategory:t,onCategoryChange:n}),(0,Ue.jsx)(dz,{cakes:U,loading:_,onAddToCart:e=>{if(!O)return alert("Please sign up to add items to your cart!"),void s(!0);F(e)},onReview:e=>{if(console.log("Opening review modal - isAuthenticated:",O),!O)return alert("Please log in to submit a review"),void s(!0);c(e),o(!0)}}),(0,Ue.jsx)(hz,{customizationOptions:[{id:1,name:"Choose Flavor",description:"Select from our premium cake flavors",icon:"\ud83c\udf70"},{id:2,name:"Pick Shape",description:"Round, square, heart, or custom shapes",icon:"\u2b50"},{id:3,name:"Select Size",description:"Perfect size for your celebration (eg 1 inch, 2inch, 3inch ....)",icon:"\ud83d\udccf"},{id:4,name:"Add Message",description:"Personalize with your special message",icon:"\ud83d\udc9d"}],isAuthenticated:O,setShowLoginModal:s}),(0,Ue.jsx)(pz,{features:[{id:1,name:"Fresh Ingredients",description:"We use only the finest, freshest ingredients for every cake.",icon:"\ud83c\udf31"},{id:2,name:"Fast Delivery",description:"Same-day delivery available for orders placed before 2 PM.",icon:"\ud83d\ude9a"},{id:3,name:"Custom Designs",description:"Create your dream cake with our easy customization tool.",icon:"\ud83c\udfa8"}]}),(0,Ue.jsx)(mz,{testimonials:m,loading:g,navigate:e}),(0,Ue.jsx)(pl,{isOpen:r,onClose:()=>s(!1)}),a&&l&&(0,Ue.jsx)(fz,{cake:l,isOpen:a,onClose:()=>{o(!1),c(null),u({rating:0,comment:""})},onSubmit:async e=>{if(e.preventDefault(),O)if(0!==d.rating)if(d.comment&&0!==d.comment.trim().length)if(d.comment.trim().length<10)alert("Comment must be at least 10 characters long");else if(d.comment.trim().length>500)alert("Comment must be less than 500 characters");else{p(!0);try{const e=localStorage.getItem("token");if(console.log("Submitting review for cake:",l.id),console.log("Review data:",{rating:d.rating,comment:d.comment}),console.log("Token:",e?"Present":"Missing"),console.log("Token value:",e),console.log("isAuthenticated:",O),!e||!O)return alert("Please log in to submit a review"),s(!0),void p(!1);console.log("Making request with headers:",{Authorization:"Token ".concat(e),"Content-Type":"application/json"});const t=await ow.post("http://localhost:8000/api/cakes/".concat(l.id,"/reviews/create/"),{rating:d.rating,comment:d.comment},{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});console.log("Review submission successful:",t.data);U.map(e=>e.id===l.id?qe(qe({},e),{},{rating:(e.rating+d.rating)/2,reviewCount:e.reviewCount+1}):e);u({rating:0,comment:""}),o(!1),c(null),alert("Review submitted successfully!")}catch(nU){var t,n,r,i,a,h,m,f,g,x;if(console.error("Error submitting review:",nU),console.error("Error response:",null===(t=nU.response)||void 0===t?void 0:t.data),console.error("Error status:",null===(n=nU.response)||void 0===n?void 0:n.status),console.error("Error headers:",null===(r=nU.response)||void 0===r?void 0:r.headers),console.error("Full error object:",nU),null!==(i=nU.response)&&void 0!==i&&null!==(a=i.data)&&void 0!==a&&a.error)alert(nU.response.data.error);else if(null!==(h=nU.response)&&void 0!==h&&null!==(m=h.data)&&void 0!==m&&m.detail)alert(nU.response.data.detail);else if(401===(null===(f=nU.response)||void 0===f?void 0:f.status))alert("Authentication failed. Please log in again."),s(!0),localStorage.removeItem("token");else if(400===(null===(g=nU.response)||void 0===g?void 0:g.status)){var v,y;null!==(v=nU.response.data)&&void 0!==v&&null!==(y=v.error)&&void 0!==y&&y.includes("already reviewed")?alert("You have already reviewed this cake. You can only review each cake once."):alert("Invalid review data. Please check your rating and comment.")}else 404===(null===(x=nU.response)||void 0===x?void 0:x.status)?alert("Cake not found. Please try again."):alert("Error submitting review. Please try again.")}finally{p(!1)}}else alert("Please write a comment about your experience");else alert("Please select a rating (1-5 stars)");else s(!0)},review:d,setReview:u,submitting:h}),R&&(N.length>0||A.length>0)&&(!D||"admin"!==D.user_type)&&(0,Ue.jsxs)(Ue.Fragment,{children:[N.filter(e=>!k.has(e.id)).map(e=>(0,Ue.jsx)(oz,{offer:e,onClose:()=>{return t=e.id,void T(e=>new Set([...e,t]));var t},isPopup:!0},"popup-".concat(e.id))),A.filter(e=>!P.has(e.id)).map(e=>(0,Ue.jsx)(oz,{offer:e,onClose:()=>{return t=e.id,void L(e=>new Set([...e,t]));var t},isPopup:!0},"popup-popup-".concat(e.id)))]}),(0,Ue.jsx)("div",{className:"bg-gray-50 py-16 px-4 sm:px-6 lg:px-8",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("h2",{className:"text-3xl font-extrabold text-gray-900 sm:text-4xl",children:"Contact Us"}),(0,Ue.jsx)("p",{className:"mt-4 text-lg text-gray-600",children:"Get in touch with us for orders, inquiries, or just to say hello!"}),(0,Ue.jsxs)("div",{className:"mt-8 flex flex-col sm:flex-row gap-4 justify-center items-center",children:[(0,Ue.jsxs)("a",{href:"https://www.facebook.com/profile.php?id=61575974396933",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors duration-200 shadow-lg hover:shadow-xl",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Visit Our Facebook"]}),(0,Ue.jsxs)("a",{href:"tel:+94758549382",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 transition-colors duration-200 shadow-lg hover:shadow-xl",children:[(0,Ue.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Call Us: +94 758 549 382"]})]}),(0,Ue.jsxs)("div",{className:"mt-8 text-sm text-gray-500",children:[(0,Ue.jsx)("p",{children:"\ud83d\udcf1 Available 24/7 for your sweet cravings!"}),(0,Ue.jsx)("p",{className:"mt-1",children:"\ud83c\udf70 Fresh cakes made daily \u2022 \ud83d\ude9a Free delivery on orders over Rs. 2000"})]})]})})}),(0,Ue.jsx)(rz,{})]})},xz=()=>{const e=ne(),[t,n]=Re(),{user:r,isAuthenticated:s}=Be(),[a,o]=(0,i.useState)([]),[l,c]=(0,i.useState)([]),[d,u]=(0,i.useState)([]),[h,p]=(0,i.useState)(!0),[m,f]=(0,i.useState)(""),[g,x]=(0,i.useState)(""),[v,y]=(0,i.useState)(""),[b,w]=(0,i.useState)(!1),[_,S]=(0,i.useState)("overview"),[N,j]=(0,i.useState)([]),[A,M]=(0,i.useState)(!1),[E,C]=(0,i.useState)(null),[k,T]=(0,i.useState)(!1);(0,i.useEffect)(()=>{s?(!r||"admin"!==r.user_type&&"inventory_manager"!==r.user_type)&&e("/"):e("/")},[s,r,e]),(0,i.useEffect)(()=>{I()},[]),(0,i.useEffect)(()=>{"purchase-orders"===_&&L()},[_]),(0,i.useEffect)(()=>{"true"===t.get("refresh")&&(console.log("Refresh parameter detected, reloading inventory data..."),I(),n({}))},[t,n]);const P=()=>{console.log("Using quick load fallback...");const e=[{id:1,name:"Sugar (White)",category:{id:6,name:"Fats & Oils"},current_stock:10,minimum_stock:5,unit:"kg",unit_cost:50,is_low_stock:!1,total_value:500,description:"White sugar for baking"},{id:2,name:"Sugar (Brown)",category:{id:6,name:"Fats & Oils"},current_stock:12,minimum_stock:5,unit:"kg",unit_cost:55,is_low_stock:!1,total_value:660,description:"Brown sugar for special recipes"},{id:3,name:"Wheat Flour",category:{id:2,name:"Flour & Grains"},current_stock:5,minimum_stock:3,unit:"kg",unit_cost:30,is_low_stock:!1,total_value:150,description:"All-purpose wheat flour"},{id:4,name:"Heavy Cream",category:{id:1,name:"Dairy & Eggs"},current_stock:42,minimum_stock:10,unit:"liters",unit_cost:25,is_low_stock:!1,total_value:1050,description:"Fresh heavy cream for whipping"},{id:5,name:"Vanilla Extract",category:{id:8,name:"Flavorings & Extracts"},current_stock:10,minimum_stock:5,unit:"bottles",unit_cost:15,is_low_stock:!1,total_value:150,description:"Pure vanilla extract"},{id:6,name:"Chocolate Chips",category:{id:11,name:"Chocolate & Cocoa"},current_stock:10,minimum_stock:5,unit:"kg",unit_cost:40,is_low_stock:!1,total_value:400,description:"Semi-sweet chocolate chips"},{id:7,name:"Butter",category:{id:1,name:"Dairy & Eggs"},current_stock:8,minimum_stock:3,unit:"kg",unit_cost:120,is_low_stock:!1,total_value:960,description:"Unsalted butter"},{id:8,name:"Eggs",category:{id:1,name:"Dairy & Eggs"},current_stock:50,minimum_stock:20,unit:"dozen",unit_cost:8,is_low_stock:!1,total_value:400,description:"Fresh grade A eggs"},{id:9,name:"Baking Powder",category:{id:7,name:"Leavening Agents"},current_stock:5,minimum_stock:2,unit:"kg",unit_cost:35,is_low_stock:!1,total_value:175,description:"Double-acting baking powder"},{id:10,name:"Cocoa Powder",category:{id:11,name:"Chocolate & Cocoa"},current_stock:6,minimum_stock:3,unit:"kg",unit_cost:60,is_low_stock:!1,total_value:360,description:"Unsweetened cocoa powder"}];o(e),console.log("Loaded fallback ingredients:",e.length);c([{id:1,name:"Dairy & Eggs"},{id:2,name:"Flour & Grains"},{id:3,name:"Sweeteners"},{id:4,name:"Nuts & Seeds"},{id:5,name:"Fruits & Vegetables"},{id:6,name:"Fats & Oils"},{id:7,name:"Leavening Agents"},{id:8,name:"Flavorings & Extracts"},{id:9,name:"Spices & Seasonings"},{id:10,name:"Preservatives"},{id:11,name:"Chocolate & Cocoa"},{id:12,name:"Decorating Supplies"}]),u([{id:1,name:"Fresh Farm Dairy"},{id:2,name:"Premium Flour Mills"},{id:3,name:"Sweet & Pure"},{id:4,name:"Nutty Delights"},{id:5,name:"Garden Fresh"},{id:6,name:"Golden Oils Co."},{id:7,name:"Rise & Shine Bakery Supply"},{id:8,name:"Flavor Masters"}]),console.log("Loaded fallback categories and suppliers")},L=async()=>{try{T(!0),console.log("Loading purchase orders...");const e=await fetch("http://localhost:8000/api/inventory/purchase-orders/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(e.ok){const t=await e.json();console.log("Purchase orders loaded:",t),t.results&&Array.isArray(t.results)?j(t.results):Array.isArray(t)?j(t):j([])}else console.error("Failed to load purchase orders:",e.status),j([])}catch(m){console.error("Error loading purchase orders:",m),j([])}finally{T(!1)}},R=async(e,t)=>{try{const n=await fetch("http://localhost:8000/api/inventory/purchase-orders/".concat(e,"/"),{method:"PATCH",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({status:t})});if(n.ok){const t=await n.json();j(n=>n.map(n=>n.id===e?t:n)),alert("Purchase order status updated successfully!")}else alert("Failed to update purchase order status")}catch(m){console.error("Error updating PO status:",m),alert("Error updating purchase order status")}},I=async()=>{try{f(""),p(!0),console.log("Loading inventory data..."),console.log("Loading fallback data first..."),P();try{console.log("Fetching inventory dashboard data...");const e=await fetch("http://localhost:8000/api/inventory/dashboard/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("Dashboard response status:",e.status),e.ok){const t=await e.json();console.log("Dashboard data received:",t);const n=t.ingredients||{},r=t.categories||{},i=t.suppliers||{},s=[];return n.low_stock_items&&s.push(...n.low_stock_items.map(e=>qe(qe({},e),{},{is_low_stock:!0,total_value:e.current_stock*e.unit_cost}))),o(s),c(r.list||[]),void u(i.list||[])}{const t=await e.text();console.error("Failed to load dashboard data:",e.status,t),f("Dashboard API error: ".concat(e.status," - ").concat(t))}}catch(e){console.error("Dashboard API error:",e),f("Dashboard API error: ".concat(e.message))}console.log("Falling back to individual API calls...");try{const e=localStorage.getItem("token");console.log("=== INGREDIENTS API DEBUG ==="),console.log("Token available:",!!e),console.log("Token value:",e?"".concat(e.substring(0,10),"..."):"null"),console.log("Fetching from:","http://localhost:8000/api/inventory/ingredients/");const t=await fetch("http://localhost:8000/api/inventory/ingredients/",{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});if(console.log("Ingredients response status:",t.status),t.ok){const e=await t.json();console.log("Ingredients data received:",e);let n=[];Array.isArray(e)?n=e:e.results&&Array.isArray(e.results)?n=e.results:(console.warn("Ingredients data is not in expected format:",e),n=[]);const r=n.map(e=>qe(qe({},e),{},{is_low_stock:e.current_stock<=e.minimum_stock,total_value:(parseFloat(e.current_stock)||0)*(parseFloat(e.unit_cost)||0)}));console.log("Processed ingredients:",r),o(r)}else{const e=await t.text();console.error("=== INGREDIENTS API ERROR ==="),console.error("Status:",t.status),console.error("Status Text:",t.statusText),console.error("Response:",e),console.error("Headers:",Object.fromEntries(t.headers)),f("Failed to load ingredients: ".concat(t.status," - ").concat(e))}}catch(t){console.error("Ingredients API error:",t),console.log("API failed, using fallback data..."),P()}try{console.log("Fetching categories...");const e=await fetch("http://localhost:8000/api/inventory/categories/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("Categories response status:",e.status),e.ok){const t=await e.json();console.log("Categories data received:",t),Array.isArray(t)?c(t):t.results&&Array.isArray(t.results)?c(t.results):c([])}else{const t=await e.text();console.error("Failed to load categories:",e.status,t)}}catch(n){console.error("Categories API error:",n)}try{console.log("Fetching suppliers...");const e=await fetch("http://localhost:8000/api/inventory/suppliers/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("Suppliers response status:",e.status),e.ok){const t=await e.json();console.log("Suppliers data received:",t),Array.isArray(t)?u(t):t.results&&Array.isArray(t.results)?u(t.results):u([])}else{const t=await e.text();console.error("Failed to load suppliers:",e.status,t)}}catch(r){console.error("Suppliers API error:",r)}}catch(m){console.error("Error loading inventory data:",m),console.log("All API calls failed, using fallback data..."),P(),f("Using cached data - some features may be limited")}finally{p(!1)}},F=(a||[]).filter(e=>{var t;const n=e.name.toLowerCase().includes(g.toLowerCase())||(null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(g.toLowerCase())),r=!v||e.category&&e.category.id&&e.category.id.toString()===v,i=!b||e.is_low_stock;return n&&r&&i}),O=e=>e.is_low_stock?"text-red-600 bg-red-100":e.current_stock<=1.5*e.minimum_stock?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100",D=e=>e.is_low_stock?"Low Stock":e.current_stock<=1.5*e.minimum_stock?"Medium Stock":"Well Stocked",U=e=>"RS ".concat(e.toFixed(2)),z=e=>{let{suppliers:t,ingredients:n,onClose:r,onCreate:s,loading:a}=e;console.log("CreatePurchaseOrderModal props:",{suppliers:null===t||void 0===t?void 0:t.length,ingredients:null===n||void 0===n?void 0:n.length,loading:a});const[o,l]=(0,i.useState)({supplier:"",order_date:(new Date).toISOString().split("T")[0],expected_delivery:"",notes:"",items:[{ingredient:"",quantity:"",unit_cost:""}]}),c=(e,t,n)=>{l(r=>qe(qe({},r),{},{items:r.items.map((r,i)=>i===e?qe(qe({},r),{},{[t]:n}):r)}))};return(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-bold",children:"Create Purchase Order"}),(0,Ue.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:"\u2715"})]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!o.supplier||!o.order_date)return void alert("Please fill in supplier and order date");const t=o.items.filter(e=>e.ingredient&&e.quantity&&e.unit_cost);if(0===t.length)return void alert("Please add at least one item");const n={supplier:parseInt(o.supplier),order_date:o.order_date,expected_delivery:o.expected_delivery||null,notes:o.notes,items:t.map(e=>({ingredient:parseInt(e.ingredient),quantity:parseFloat(e.quantity),unit_cost:parseFloat(e.unit_cost)}))};await s(n)},className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier *"}),(0,Ue.jsxs)("select",{value:o.supplier,onChange:e=>l(t=>qe(qe({},t),{},{supplier:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0,children:[(0,Ue.jsx)("option",{value:"",children:"Select Supplier"}),t.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Order Date *"}),(0,Ue.jsx)("input",{type:"date",value:o.order_date,onChange:e=>l(t=>qe(qe({},t),{},{order_date:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",required:!0})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expected Delivery"}),(0,Ue.jsx)("input",{type:"date",value:o.expected_delivery,onChange:e=>l(t=>qe(qe({},t),{},{expected_delivery:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,Ue.jsx)("textarea",{value:o.notes,onChange:e=>l(t=>qe(qe({},t),{},{notes:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",rows:"3"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium",children:"Items"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{l(e=>qe(qe({},e),{},{items:[...e.items,{ingredient:"",quantity:"",unit_cost:""}]}))},className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Add Item"})]}),o.items.map((e,t)=>(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 p-4 border rounded",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ingredient"}),(0,Ue.jsxs)("select",{value:e.ingredient,onChange:e=>c(t,"ingredient",e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",children:[(0,Ue.jsxs)("option",{value:"",children:["Select Ingredient (",n.length," available)"]}),n.map(e=>(0,Ue.jsxs)("option",{value:e.id,children:[e.name," - ",e.unit]},e.id))]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity"}),(0,Ue.jsx)("input",{type:"number",step:"0.001",value:e.quantity,onChange:e=>c(t,"quantity",e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Cost"}),(0,Ue.jsx)("input",{type:"number",step:"0.01",value:e.unit_cost,onChange:e=>c(t,"unit_cost",e.target.value),className:"w-full border border-gray-300 rounded px-3 py-2"})]}),(0,Ue.jsx)("div",{className:"flex items-end",children:o.items.length>1&&(0,Ue.jsx)("button",{type:"button",onClick:()=>(e=>{l(t=>qe(qe({},t),{},{items:t.items.filter((t,n)=>n!==e)}))})(t),className:"bg-red-600 text-white px-3 py-2 rounded hover:bg-red-700",children:"Remove"})})]},t))]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:r,className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:a,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:a?"Creating...":"Create Purchase Order"})]})]})]})})},B=e=>{var t;let{purchaseOrder:n,onClose:r,onUpdateStatus:i}=e;return(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Ue.jsxs)("h2",{className:"text-xl font-bold",children:["Purchase Order #",n.po_number]}),(0,Ue.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:"\u2715"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Order Details"}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("strong",{children:"Supplier:"})," ",null===(t=n.supplier)||void 0===t?void 0:t.name]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("strong",{children:"Status:"}),(0,Ue.jsx)("span",{className:"ml-2 px-2 py-1 text-xs rounded ".concat("draft"===n.status?"bg-gray-100 text-gray-800":"sent"===n.status?"bg-blue-100 text-blue-800":"confirmed"===n.status?"bg-yellow-100 text-yellow-800":"received"===n.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:n.status.charAt(0).toUpperCase()+n.status.slice(1)})]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("strong",{children:"Order Date:"})," ",new Date(n.order_date).toLocaleDateString()]}),n.expected_delivery&&(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("strong",{children:"Expected Delivery:"})," ",new Date(n.expected_delivery).toLocaleDateString()]}),n.delivery_date&&(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("strong",{children:"Delivery Date:"})," ",new Date(n.delivery_date).toLocaleDateString()]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Totals"}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("strong",{children:"Subtotal:"})," $",parseFloat(n.subtotal||0).toFixed(2)]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("strong",{children:"Tax:"})," $",parseFloat(n.tax||0).toFixed(2)]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("strong",{children:"Total Amount:"})," $",parseFloat(n.total_amount||0).toFixed(2)]})]})]})]}),n.notes&&(0,Ue.jsxs)("div",{className:"mb-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Notes"}),(0,Ue.jsx)("p",{className:"text-gray-700",children:n.notes})]}),n.items&&n.items.length>0&&(0,Ue.jsxs)("div",{className:"mb-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Items"}),(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Ingredient"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Quantity"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit Cost"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Cost"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Received"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n.items.map((e,t)=>{var n;return(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(null===(n=e.ingredient)||void 0===n?void 0:n.name)||"Unknown"}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.quantity}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",parseFloat(e.unit_cost).toFixed(2)]}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",parseFloat(e.total_cost).toFixed(2)]}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.received_quantity||0})]},t)})})]})})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-4",children:["draft"===n.status&&(0,Ue.jsx)("button",{onClick:()=>{i(n.id,"sent"),r()},className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Send to Supplier"}),"confirmed"===n.status&&(0,Ue.jsx)("button",{onClick:()=>{i(n.id,"received"),r()},className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Mark as Received"}),(0,Ue.jsx)("button",{onClick:r,className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})};return h||!s||!r||"admin"!==r.user_type&&"inventory_manager"!==r.user_type?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading inventory..."})]})}):m?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Error Loading Inventory"}),(0,Ue.jsx)("p",{className:"text-red-600 mb-4",children:m}),(0,Ue.jsx)("button",{onClick:()=>{f(""),p(!0),I()},className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Try Again"})]})})}):(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Inventory Management"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Manage ingredients, track stock levels, and monitor suppliers"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsxs)("button",{onClick:()=>{p(!0),I()},disabled:h,className:"bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded-lg transition-colors disabled:opacity-50 flex items-center",children:[h?(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600 mr-2"}):(0,Ue.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Data"]}),(0,Ue.jsxs)("button",{onClick:()=>e("/inventory/add-ingredient"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center",children:[(0,Ue.jsx)(zl,{className:"h-5 w-5 mr-2"}),"Add Ingredient"]})]})]})})}),(0,Ue.jsx)("div",{className:"bg-white border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsx)("nav",{className:"flex space-x-8",children:[{id:"overview",name:"Overview",icon:El},{id:"ingredients",name:"Ingredients",icon:El},{id:"suppliers",name:"Suppliers",icon:El},{id:"purchase-orders",name:"Purchase Orders",icon:El},{id:"reports",name:"Reports",icon:El}].map(e=>(0,Ue.jsx)("button",{onClick:()=>S(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat(_===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.name},e.id))})})}),(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["overview"===_&&(0,Ue.jsxs)("div",{className:"space-y-8",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,Ue.jsx)(El,{className:"h-6 w-6 text-blue-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Ingredients"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(a||[]).length})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,Ue.jsx)(jl,{className:"h-6 w-6 text-red-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Low Stock Items"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(a||[]).filter(e=>e.is_low_stock).length})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,Ue.jsx)(Rl,{className:"h-6 w-6 text-green-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:U((a||[]).reduce((e,t)=>e+t.current_stock*t.unit_cost,0))})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,Ue.jsx)(oc,{className:"h-6 w-6 text-purple-600"})}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Expiring Soon"}),(0,Ue.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(a||[]).filter(e=>{if(!e.expiry_date)return!1;const t=new Date(e.expiry_date),n=new Date;return n.setDate(n.getDate()+30),t<=n}).length})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Low Stock Alerts"})}),(0,Ue.jsx)("div",{className:"p-6",children:(a||[]).filter(e=>e.is_low_stock).length>0?(0,Ue.jsx)("div",{className:"space-y-3",children:(a||[]).filter(e=>e.is_low_stock).slice(0,5).map(e=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 bg-red-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(jl,{className:"h-6 w-6 text-red-600 mr-3"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,Ue.jsxs)("p",{className:"text-sm text-red-600",children:["Current: ",e.current_stock," ",e.unit," | Minimum: ",e.minimum_stock," ",e.unit]})]})]}),(0,Ue.jsx)("button",{className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm",children:"Reorder"})]},e.id))}):(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)(_l,{className:"h-12 w-12 text-green-500 mx-auto mb-3"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"All items are well stocked!"})]})})]})]}),"ingredients"===_&&(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,Ue.jsx)("div",{className:"flex-1",children:(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)(dv,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,Ue.jsx)("input",{type:"text",placeholder:"Search ingredients...",value:g,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,Ue.jsxs)("div",{className:"flex gap-4",children:[(0,Ue.jsxs)("select",{value:v,onChange:e=>y(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Ue.jsx)("option",{value:"",children:"All Categories"}),(l||[]).map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,Ue.jsxs)("label",{className:"flex items-center",children:[(0,Ue.jsx)("input",{type:"checkbox",checked:b,onChange:e=>w(e.target.checked),className:"mr-2"}),"Low Stock Only"]}),(0,Ue.jsx)("button",{onClick:I,disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-2",children:h?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,Ue.jsx)("span",{children:"Loading..."})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)(Ql,{className:"h-4 w-4"}),(0,Ue.jsx)("span",{children:"Refresh"})]})})]})]})}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,Ue.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,Ue.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Ingredients (",F.length,")"]}),(0,Ue.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Total loaded: ",a.length," | Filtered: ",F.length,' | Search: "',g,'" | Category: ',v||"All"," | Low Stock Only: ",b?"Yes":"No"]}),0===a.length&&(0,Ue.jsxs)("div",{className:"text-sm text-red-600 mt-2",children:["No ingredients loaded from API. Check browser console for errors.",(0,Ue.jsx)("br",{}),(0,Ue.jsxs)("span",{className:"text-xs",children:["Token available: ",localStorage.getItem("token")?"Yes":"No"," | User type: ",(null===r||void 0===r?void 0:r.user_type)||"Unknown"," | Authenticated: ",s?"Yes":"No"]})]})]}),(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ingredient"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock Level"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Cost"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Value"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(e=>{var t;return(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,Ue.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"text-sm text-gray-900",children:(null===(t=e.category)||void 0===t?void 0:t.name)||"N/A"})}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,Ue.jsxs)("div",{className:"text-sm text-gray-900",children:[e.current_stock," ",e.unit]}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-500",children:["Min: ",e.minimum_stock," ",e.unit]})]}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"text-sm text-gray-900",children:U(e.unit_cost)})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"text-sm text-gray-900",children:U(e.current_stock*e.unit_cost)})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(O(e)),children:D(e)})}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,Ue.jsx)("button",{className:"text-blue-600 hover:text-blue-900 mr-3",children:"Edit"}),(0,Ue.jsx)("button",{className:"text-green-600 hover:text-green-900",children:"Reorder"})]})]},e.id)})})]})})]})]}),"suppliers"===_&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Suppliers"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(d||[]).map(e=>(0,Ue.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,Ue.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:e.name}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.contact_person}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.email}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.phone}),(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("button",{className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors",children:"Edit"}),(0,Ue.jsx)("button",{className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors",children:"Contact"})]})]},e.id))})})]}),"purchase-orders"===_&&(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Purchase Orders"}),(0,Ue.jsxs)("button",{onClick:()=>{0===a.length&&P(),M(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[(0,Ue.jsx)(zl,{className:"h-5 w-5 mr-2"}),"Create Purchase Order"]})]}),(0,Ue.jsx)("div",{className:"p-6",children:k?(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading purchase orders..."})]}):0===N.length?(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)(El,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Purchase Orders"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Create your first purchase order to get started"}),(0,Ue.jsx)("button",{onClick:()=>{0===a.length&&P(),M(!0)},className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Create Purchase Order"})]}):(0,Ue.jsx)("div",{className:"overflow-x-auto",children:(0,Ue.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,Ue.jsx)("thead",{className:"bg-gray-50",children:(0,Ue.jsxs)("tr",{children:[(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PO Number"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Supplier"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Date"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),(0,Ue.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,Ue.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(e=>{var t;return(0,Ue.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.po_number})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("div",{className:"text-sm text-gray-900",children:(null===(t=e.supplier)||void 0===t?void 0:t.name)||"Unknown Supplier"})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Ue.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("draft"===e.status?"bg-gray-100 text-gray-800":"sent"===e.status?"bg-blue-100 text-blue-800":"confirmed"===e.status?"bg-yellow-100 text-yellow-800":"received"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),(0,Ue.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.order_date).toLocaleDateString()}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",parseFloat(e.total_amount||0).toFixed(2)]}),(0,Ue.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[(0,Ue.jsx)("button",{onClick:()=>C(e),className:"text-blue-600 hover:text-blue-900",children:"View"}),"draft"===e.status&&(0,Ue.jsx)("button",{onClick:()=>R(e.id,"sent"),className:"text-green-600 hover:text-green-900",children:"Send"}),"confirmed"===e.status&&(0,Ue.jsx)("button",{onClick:()=>R(e.id,"received"),className:"text-purple-600 hover:text-purple-900",children:"Mark Received"})]})]},e.id)})})]})})})]}),A&&(0,Ue.jsx)(z,{suppliers:d,ingredients:a,onClose:()=>M(!1),onCreate:async e=>{try{T(!0),console.log("Creating purchase order:",e);const t=await fetch("http://localhost:8000/api/inventory/purchase-orders/",{method:"POST",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){const e=await t.json();return console.log("Purchase order created:",e),j(t=>[e,...t]),M(!1),alert("Purchase order created successfully!"),!0}{const e=await t.json();return console.error("Failed to create purchase order:",e),alert("Failed to create purchase order: ".concat(JSON.stringify(e))),!1}}catch(m){return console.error("Error creating purchase order:",m),alert("Error creating purchase order: ".concat(m.message)),!1}finally{T(!1)}},loading:k}),E&&(0,Ue.jsx)(B,{purchaseOrder:E,onClose:()=>C(null),onUpdateStatus:R})]}),"reports"===_&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,Ue.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,Ue.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Inventory Reports"})}),(0,Ue.jsx)("div",{className:"p-6",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(Ql,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Stock Movement Report"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Track ingredient movements and usage patterns"}),(0,Ue.jsx)("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Generate Report"})]}),(0,Ue.jsxs)("div",{className:"text-center p-6 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)(Rl,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),(0,Ue.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Cost Analysis Report"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Analyze ingredient costs and profitability"}),(0,Ue.jsx)("button",{className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Generate Report"})]})]})})]})]})]})},vz=()=>{const e=ne(),[t,n]=(0,i.useState)({username:"feedback_test_user",password:"testpass123"}),[r,s]=(0,i.useState)(!1),[a,o]=(0,i.useState)(""),l=async e=>{try{console.log("\ud83d\udd0d Testing orders API with token...");const t=await fetch("http://localhost:8000/api/orders/orders/",{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});if(console.log("\ud83d\udce1 Orders API response:",t.status),t.ok){const e=await t.json();console.log("\u2705 Orders API successful:",e),o(t=>{var n;return t+"\n\u2705 Orders API works! Found ".concat((null===(n=e.results)||void 0===n?void 0:n.length)||e.length||0," orders")})}else{const e=await t.text();console.log("\u274c Orders API failed:",e),o(e=>e+"\n\u274c Orders API failed: ".concat(t.status," ").concat(t.statusText))}}catch(nU){console.error("\ud83d\udca5 Orders API error:",nU),o(t=>t+"\n\ud83d\udca5 Orders API error: ".concat(nU.message))}};return(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsx)("div",{className:"max-w-2xl mx-auto px-4",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"\ud83d\udd10 Login & API Test"}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),s(!0),o("");try{console.log("\ud83d\udd10 Attempting login with:",t.username);const e=await fetch("http://localhost:8000/api/auth/login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(console.log("\ud83d\udce1 Login response status:",e.status),e.ok){const t=await e.json();console.log("\u2705 Login successful:",t),localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),o("\u2705 Login successful! Token: ".concat(t.token.substring(0,20),"...")),setTimeout(()=>{l(t.token)},1e3)}else{const t=await e.json();console.log("\u274c Login failed:",t),o("\u274c Login failed: ".concat(t.message||e.statusText))}}catch(nU){console.error("\ud83d\udca5 Login error:",nU),o("\ud83d\udca5 Network error: ".concat(nU.message))}finally{s(!1)}},className:"mb-6",children:[(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username:"}),(0,Ue.jsx)("input",{type:"text",value:t.username,onChange:e=>n(qe(qe({},t),{},{username:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password:"}),(0,Ue.jsx)("input",{type:"password",value:t.password,onChange:e=>n(qe(qe({},t),{},{password:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{className:"flex space-x-4",children:[(0,Ue.jsx)("button",{type:"submit",disabled:r,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:r?"Logging in...":"\ud83d\udd10 Login & Test API"}),(0,Ue.jsx)("button",{type:"button",onClick:async()=>{try{const e=localStorage.getItem("token");if(!e)return void o("\u274c No token found. Please login first.");console.log("\ud83d\udd0d Testing order 65...");const t=await fetch("http://localhost:8000/api/orders/orders/65/",{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});if(console.log("\ud83d\udce1 Order 65 response:",t.status),t.ok){const e=await t.json();console.log("\u2705 Order 65 successful:",e),o(t=>t+"\n\u2705 Order 65 works! Status: ".concat(e.order_status))}else{const e=await t.text();console.log("\u274c Order 65 failed:",e),o(e=>e+"\n\u274c Order 65 failed: ".concat(t.status," ").concat(t.statusText))}}catch(nU){console.error("\ud83d\udca5 Order 65 error:",nU),o(t=>t+"\n\ud83d\udca5 Order 65 error: ".concat(nU.message))}},className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700",children:"\ud83e\uddea Test Order 65"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),o("\ud83d\uddd1\ufe0f Storage cleared")},className:"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700",children:"\ud83d\uddd1\ufe0f Clear Storage"})]})]}),a&&(0,Ue.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[(0,Ue.jsx)("h3",{className:"font-semibold mb-2",children:"Results:"}),(0,Ue.jsx)("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:a})]}),(0,Ue.jsxs)("div",{className:"mb-6",children:[(0,Ue.jsx)("h3",{className:"font-semibold mb-2",children:"Current Storage:"}),(0,Ue.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,Ue.jsxs)("p",{children:["Token: ",localStorage.getItem("token")?"\u2705 Present":"\u274c Missing"]}),(0,Ue.jsxs)("p",{children:["User: ",localStorage.getItem("user")?"\u2705 Present":"\u274c Missing"]})]})]}),(0,Ue.jsxs)("div",{className:"flex space-x-4",children:[(0,Ue.jsx)("button",{onClick:()=>e("/orders"),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700",children:"\ud83d\udccb Go to My Orders"}),(0,Ue.jsx)("button",{onClick:()=>e("/auth-test"),className:"bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700",children:"\ud83d\udd27 Go to Auth Test"})]}),(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,Ue.jsx)("h3",{className:"font-semibold mb-2",children:"Instructions:"}),(0,Ue.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[(0,Ue.jsx)("li",{children:'Click "Login & Test API" to authenticate and test the orders API'}),(0,Ue.jsx)("li",{children:'If login works, click "Test Order 65" to test specific order access'}),(0,Ue.jsx)("li",{children:"Check browser console for detailed logs"}),(0,Ue.jsx)("li",{children:'If everything works, go to "My Orders" page'})]})]})]})})})},yz=e=>{let{cake:t,onAddToCart:n,index:r}=e;const[s,a]=(0,i.useState)(!1);return(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1*r},onHoverStart:()=>a(!0),onHoverEnd:()=>a(!1),className:"card cursor-pointer min-h-[500px]",onClick:()=>window.location.href="/cake/".concat(t.id),children:[(0,Ue.jsxs)("div",{className:"relative h-72 overflow-hidden",children:[(0,Ue.jsx)("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover transition-transform duration-300 hover:scale-110",onError:e=>{e.target.src="https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400&h=300&fit=crop"}}),(0,Ue.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center transition-opacity duration-300 ".concat(s?"opacity-100":"opacity-0"),children:(0,Ue.jsxs)("div",{className:"flex gap-3",children:[(0,Ue.jsx)("button",{onClick:e=>{e.stopPropagation(),console.log("Quick Add clicked for cake:",t),n(t)},className:"bg-sweetbite-600 text-white px-6 py-2 rounded-full font-semibold hover:bg-sweetbite-700 transition-colors",children:"Quick Add"}),(0,Ue.jsx)(Te,{to:"/cake/".concat(t.id),className:"bg-white text-sweetbite-600 px-6 py-2 rounded-full font-semibold hover:bg-gray-100 transition-colors",children:"View Details"})]})}),(0,Ue.jsxs)("div",{className:"absolute top-4 right-4 bg-sweetbite-600 text-white px-3 py-1 rounded-full font-semibold",children:["RS ",t.price]})]}),(0,Ue.jsxs)("div",{className:"p-6 pb-8",children:[(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:t.name}),(0,Ue.jsx)("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:t.description}),(0,Ue.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4",children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ue.jsx)("div",{className:"flex items-center",children:[...Array(5)].map((e,n)=>{const r=t.rating||0,i=n+1,s=i<=Math.floor(r),a=i===Math.ceil(r)&&r%1!==0;return(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("svg",{className:"w-4 h-4 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),(s||a)&&(0,Ue.jsx)("svg",{className:"w-4 h-4 text-yellow-400 absolute top-0 left-0 ".concat(a?"clip-path-half":""),fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ue.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})]},n)})}),(0,Ue.jsxs)("span",{className:"text-sm text-gray-600",children:["(",t.reviewCount||0,")"]})]})}),(0,Ue.jsx)("div",{className:"mb-4",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,Ue.jsxs)("span",{children:["Preparation: ",t.preparationTime||"2-3 hours"]}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat(t.isCustomizable?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:t.isCustomizable?"Customizable":"Standard"})]})}),(0,Ue.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Ue.jsx)("button",{onClick:e=>{e.stopPropagation(),console.log("Add to cart clicked for cake:",t),n(t)},className:"w-full bg-sweetbite-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-sweetbite-700 transition-colors",children:"Add to Cart"}),(0,Ue.jsx)(Te,{to:"/cake/".concat(t.id),className:"w-full bg-gray-100 text-sweetbite-600 py-2 px-4 rounded-lg font-semibold hover:bg-gray-200 transition-colors text-center",children:"View Details"})]})]})]})},bz=()=>{const[e,t]=(0,i.useState)("all"),[n,r]=(0,i.useState)(""),[s,a]=(0,i.useState)("name"),[o,l]=(0,i.useState)([]),[c,d]=(0,i.useState)([]),[u,h]=(0,i.useState)(!0),[p,m]=(0,i.useState)(""),[f,g]=(0,i.useState)(!1),{addItem:x}=hl(),{isAuthenticated:v}=Be(),y=e=>{if(!v)return alert("Please sign up to add items to your cart!"),void g(!0);x(e)};(0,i.useEffect)(()=>{(async()=>{try{h(!0),m("");const[e,t]=await Promise.all([_v(),Sv()]);l(e),d(t),console.log("MenuPage - Loaded cakes:",e.length),console.log("MenuPage - Loaded categories:",t.length)}catch(p){console.error("Error loading data:",p),m("Failed to load menu data"),l([]),d([])}finally{h(!1)}})()},[]);const b=[...o.filter(t=>{var r;const i="string"===typeof t.category?t.category:null===(r=t.category)||void 0===r?void 0:r.name,s="all"===e||i===e,a=t.name.toLowerCase().includes(n.toLowerCase())||t.description.toLowerCase().includes(n.toLowerCase());return s&&a})].sort((e,t)=>{switch(s){case"price-low":return e.price-t.price;case"price-high":return t.price-e.price;case"rating":return t.rating-e.rating;default:return e.name.localeCompare(t.name)}});return u?(0,Ue.jsx)("div",{className:"min-h-screen gradient-bg py-8",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading menu..."})]})})}):(0,Ue.jsxs)("div",{className:"min-h-screen gradient-bg py-8",children:[(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"text-center mb-8",children:[(0,Ue.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"Our Cake Menu"}),(0,Ue.jsx)("p",{className:"text-gray-600 text-lg",children:"Discover our handcrafted cakes, each made with love and the finest ingredients"}),p&&(0,Ue.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,Ue.jsx)("p",{className:"text-yellow-800 text-sm",children:p})})]}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Cakes"}),(0,Ue.jsx)("input",{type:"text",placeholder:"Search by name or description...",value:n,onChange:e=>r(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-sweetbite-600 focus:outline-none"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,Ue.jsx)("select",{value:e,onChange:e=>t(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-sweetbite-600 focus:outline-none",children:c.map(e=>(0,Ue.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),(0,Ue.jsxs)("select",{value:s,onChange:e=>a(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:border-sweetbite-600 focus:outline-none",children:[(0,Ue.jsx)("option",{value:"name",children:"Name"}),(0,Ue.jsx)("option",{value:"price-low",children:"Price: Low to High"}),(0,Ue.jsx)("option",{value:"price-high",children:"Price: High to Low"}),(0,Ue.jsx)("option",{value:"rating",children:"Rating"})]})]})]})}),(0,Ue.jsx)("div",{className:"mb-6",children:(0,Ue.jsxs)("p",{className:"text-gray-600",children:["Showing ",b.length," of ",o.length," cakes"]})}),b.length>0?(0,Ue.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:b.map((e,t)=>(0,Ue.jsx)(yz,{cake:e,onAddToCart:y,index:t},e.id))}):(0,Ue.jsxs)("div",{className:"text-center py-16",children:[(0,Ue.jsx)("div",{className:"text-6xl mb-4",children:"\ud83c\udf70"}),(0,Ue.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No cakes found"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria"})]})]}),(0,Ue.jsx)(pl,{isOpen:f,onClose:()=>g(!1)})]})},wz=["title","titleId"];function _z(e,t){let{title:n,titleId:r}=e,s=Ie(e,wz);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const Sz=i.forwardRef(_z),Nz=["title","titleId"];function jz(e,t){let{title:n,titleId:r}=e,s=Ie(e,Nz);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const Az=i.forwardRef(jz),Mz=["title","titleId"];function Ez(e,t){let{title:n,titleId:r}=e,s=Ie(e,Mz);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const Cz=i.forwardRef(Ez),kz=e=>{let{isOpen:t,onClose:n,order:r,onSubmitFeedback:s}=e;const[a,o]=(0,i.useState)(0),[l,c]=(0,i.useState)(""),[d,u]=(0,i.useState)(!1);return t?(0,Ue.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4",children:[(0,Ue.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75",onClick:n}),(0,Ue.jsxs)("div",{className:"relative bg-white rounded-lg max-w-md w-full p-6",children:[(0,Ue.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Give Feedback for Order #",null===r||void 0===r?void 0:r.id]}),(0,Ue.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),0!==a)if(l.trim()){u(!0);try{const e={order:r.id,rating:a,message:l.trim()};await s(e),o(0),c(""),n()}catch(nU){console.error("Error submitting feedback:",nU),alert("Failed to submit feedback. Please try again.")}finally{u(!1)}}else alert("Please write a message");else alert("Please select a rating")},className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),(0,Ue.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,Ue.jsx)("button",{type:"button",onClick:()=>o(e),className:"text-2xl ".concat(e<=a?"text-yellow-400":"text-gray-300"),children:"\u2605"},e))})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Feedback"}),(0,Ue.jsx)("textarea",{value:l,onChange:e=>c(e.target.value),placeholder:"Tell us about your experience...",rows:4,className:"block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,Ue.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),(0,Ue.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:d?"Submitting...":"Submit Feedback"})]})]})]})]})}):null},Tz=()=>{const e=ne(),[t,n]=(0,i.useState)([]),[r,s]=(0,i.useState)([]),[a,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(null),[h,p]=(0,i.useState)("all"),[m,f]=(0,i.useState)(!1),[g,x]=(0,i.useState)(!1),[v,y]=(0,i.useState)(null),[b,w]=(0,i.useState)({search:"",status:"",dateFrom:"",dateTo:"",minAmount:"",maxAmount:""}),[_,S]=(0,i.useState)({totalOrders:0,totalSpent:0,averageOrderValue:0,favoriteItems:[],orderFrequency:0});(0,i.useEffect)(()=>{N();const e=setInterval(()=>{console.log("\ud83d\udd04 Auto-refreshing orders..."),N()},3e4);return()=>clearInterval(e)},[]),(0,i.useEffect)(()=>{A()},[t,b,h]);const N=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?c(!0):o(!0),console.log("\ud83d\udd04 Loading orders...");const t=await fetch("http://localhost:8000/api/orders/orders/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("\ud83d\udce1 Orders API response status:",t.status),t.ok){const e=await t.json();console.log("\ud83d\udccb Orders data received:",e);let r=[];Array.isArray(e)?r=e:e.results&&Array.isArray(e.results)?r=e.results:(console.error("API response format not recognized:",e),r=[]),console.log("\u2705 Loaded ".concat(r.length," orders"));const i=r.map(e=>qe(qe({},e),{},{has_feedback:e.has_feedback||!1}));n(i),j(i)}else{console.error("\u274c Failed to load orders:",t.status,t.statusText);const e=await t.text();console.error("Error details:",e),n([])}}catch(nU){console.error("\ud83d\udca5 Error loading orders:",nU),n([])}finally{o(!1),c(!1)}},j=e=>{const t=e.length,n=e.reduce((e,t)=>e+parseFloat(t.total_amount),0),r=t>0?n/t:0,i={};e.forEach(e=>{e.items.forEach(e=>{const t=e.cake.name;i[t]||(i[t]={name:t,count:0,totalSpent:0}),i[t].count+=e.quantity,i[t].totalSpent+=parseFloat(e.total_price)})});const s=Object.values(i).sort((e,t)=>t.count-e.count).slice(0,5),a=e.length>0?new Date(e[e.length-1].created_at):new Date,o=e.length>0?new Date(e[0].created_at):new Date,l=Math.max(1,(o-a)/2592e6);S({totalOrders:t,totalSpent:n,averageOrderValue:r,favoriteItems:s,orderFrequency:t/l})},A=()=>{let e=[...t];if("all"!==h&&("active"===h?e=e.filter(e=>!["delivered","cancelled"].includes(e.order_status)):"completed"===h?e=e.filter(e=>"delivered"===e.order_status):"cancelled"===h&&(e=e.filter(e=>"cancelled"===e.order_status))),b.search){const t=b.search.toLowerCase();e=e.filter(e=>e.order_number.toLowerCase().includes(t)||e.items.some(e=>e.cake.name.toLowerCase().includes(t)))}b.status&&(e=e.filter(e=>e.order_status===b.status)),b.dateFrom&&(e=e.filter(e=>new Date(e.created_at)>=new Date(b.dateFrom))),b.dateTo&&(e=e.filter(e=>new Date(e.created_at)<=new Date(b.dateTo))),b.minAmount&&(e=e.filter(e=>parseFloat(e.total_amount)>=parseFloat(b.minAmount))),b.maxAmount&&(e=e.filter(e=>parseFloat(e.total_amount)<=parseFloat(b.maxAmount))),s(e)},M=(e,t)=>{w(n=>qe(qe({},n),{},{[e]:t}))},E=e=>{switch(e){case"pending":return(0,Ue.jsx)(oc,{className:"h-5 w-5 text-yellow-500"});case"confirmed":case"preparing":return(0,Ue.jsx)(oc,{className:"h-5 w-5 text-blue-500"});case"ready":case"out_for_delivery":return(0,Ue.jsx)(pc,{className:"h-5 w-5 text-purple-500"});case"delivered":return(0,Ue.jsx)(_l,{className:"h-5 w-5 text-green-500"});case"cancelled":return(0,Ue.jsx)(jl,{className:"h-5 w-5 text-red-500"});default:return(0,Ue.jsx)(oc,{className:"h-5 w-5 text-gray-500"})}},C=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":case"preparing":return"bg-blue-100 text-blue-800";case"ready":case"out_for_delivery":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},k=e=>{switch(e){case"pending":return"Order placed, being reviewed";case"confirmed":return"Order confirmed, preparing to bake";case"preparing":return"Baking in progress";case"ready":return"Ready for delivery";case"out_for_delivery":return"On the way to you";case"delivered":return"Delivered successfully";case"cancelled":return"Order cancelled";default:return"Processing"}},T=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return a?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading your orders..."})]})}):(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"My Orders"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Track your orders and view order history"})]}),Array.isArray(t)&&0!==t.length?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(iv,{className:"h-8 w-8 text-blue-600"}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),(0,Ue.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:_.totalOrders})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Rl,{className:"h-8 w-8 text-green-600"}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Spent"}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["RS ",_.totalSpent.toFixed(2)]})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Ql,{className:"h-8 w-8 text-purple-600"}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["RS ",_.averageOrderValue.toFixed(2)]})]})]})}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(dc,{className:"h-8 w-8 text-orange-600"}),(0,Ue.jsxs)("div",{className:"ml-4",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Order Frequency"}),(0,Ue.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[_.orderFrequency.toFixed(1),"/month"]})]})]})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[(0,Ue.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-4",children:[(0,Ue.jsxs)("div",{className:"flex space-x-1 mb-4 lg:mb-0",children:[(0,Ue.jsxs)("button",{onClick:()=>p("all"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("all"===h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["All Orders (",t.length,")"]}),(0,Ue.jsxs)("button",{onClick:()=>p("active"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("active"===h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Active (",t.filter(e=>!["delivered","cancelled"].includes(e.order_status)).length,")"]}),(0,Ue.jsxs)("button",{onClick:()=>p("completed"),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat("completed"===h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Completed (",t.filter(e=>"delivered"===e.order_status).length,")"]})]}),(0,Ue.jsxs)("div",{className:"flex space-x-3",children:[(0,Ue.jsxs)("button",{onClick:()=>f(!m),className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[(0,Ue.jsx)(Sz,{className:"h-5 w-5 mr-2"}),"Filters"]}),(0,Ue.jsxs)("button",{onClick:()=>N(!0),disabled:l,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors ".concat(l?"opacity-50 cursor-not-allowed":""),children:[(0,Ue.jsx)(Az,{className:"h-5 w-5 mr-2 ".concat(l?"animate-spin":"")}),l?"Refreshing...":"Refresh"]})]})]}),m&&(0,Ue.jsxs)("div",{className:"border-t pt-4",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)(dv,{className:"h-5 w-5 absolute left-3 top-3 text-gray-400"}),(0,Ue.jsx)("input",{type:"text",placeholder:"Order number, item name...",value:b.search,onChange:e=>M("search",e.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,Ue.jsxs)("select",{value:b.status,onChange:e=>M("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,Ue.jsx)("option",{value:"",children:"All Statuses"}),(0,Ue.jsx)("option",{value:"pending",children:"Pending"}),(0,Ue.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,Ue.jsx)("option",{value:"preparing",children:"Preparing"}),(0,Ue.jsx)("option",{value:"ready",children:"Ready"}),(0,Ue.jsx)("option",{value:"out_for_delivery",children:"Out for Delivery"}),(0,Ue.jsx)("option",{value:"delivered",children:"Delivered"}),(0,Ue.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),(0,Ue.jsx)("input",{type:"date",value:b.dateFrom,onChange:e=>M("dateFrom",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),(0,Ue.jsx)("input",{type:"date",value:b.dateTo,onChange:e=>M("dateTo",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Amount"}),(0,Ue.jsx)("input",{type:"number",placeholder:"0.00",value:b.minAmount,onChange:e=>M("minAmount",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,Ue.jsx)("div",{className:"flex items-end",children:(0,Ue.jsx)("button",{onClick:()=>{w({search:"",status:"",dateFrom:"",dateTo:"",minAmount:"",maxAmount:""})},className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Clear Filters"})})]})]})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ue.jsxs)("div",{className:"lg:col-span-2",children:[l&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Az,{className:"h-5 w-5 text-blue-600 animate-spin mr-2"}),(0,Ue.jsx)("span",{className:"text-blue-800 text-sm",children:"Refreshing orders..."})]})}),(0,Ue.jsx)("div",{className:"space-y-4",children:Array.isArray(r)&&r.map(n=>(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>u((null===d||void 0===d?void 0:d.id)===n.id?null:n),children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h3",{className:"font-semibold text-lg",children:["Order #",n.order_number]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:T(n.created_at)})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsxs)("p",{className:"font-semibold text-lg",children:["RS ",n.total_amount]}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(C(n.order_status)),children:n.order_status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())})]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[E(n.order_status),(0,Ue.jsx)("span",{className:"text-sm text-gray-600",children:k(n.order_status)})]}),(0,Ue.jsxs)("div",{className:"space-y-2 mb-4",children:[n.items.slice(0,2).map(e=>(0,Ue.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ue.jsxs)("span",{className:"text-gray-600",children:[e.quantity,"x ",e.cake.name]}),(0,Ue.jsxs)("span",{className:"font-medium",children:["RS ",e.total_price]})]},e.id)),n.items.length>2&&(0,Ue.jsxs)("p",{className:"text-sm text-gray-500",children:["+",n.items.length-2," more items"]})]}),(null===d||void 0===d?void 0:d.id)===n.id&&(0,Ue.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,Ue.jsx)("h4",{className:"font-medium mb-3",children:"Order Details"}),(0,Ue.jsx)("div",{className:"space-y-2 mb-4",children:n.items.map(r=>(0,Ue.jsxs)("div",{className:"flex justify-between items-center text-sm p-2 bg-gray-50 rounded",children:[(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("span",{className:"font-medium",children:r.cake.name}),r.customization_notes&&(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:r.customization_notes})]}),(0,Ue.jsxs)("div",{className:"text-right flex items-center space-x-3",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("p",{className:"font-medium",children:["RS ",r.total_price]}),(0,Ue.jsxs)("p",{className:"text-xs text-gray-500",children:["Qty: ",r.quantity]})]}),(0,Ue.jsx)("button",{onClick:i=>{i.stopPropagation(),((n,r)=>{const i=t.find(e=>e.id===n);if(!i)return;const s=i.items.find(e=>e.id===r);s&&e("/cart",{state:{reorderItem:{cakeId:s.cake.id,quantity:s.quantity,customization:s.customization_notes}}})})(n.id,r.id)},className:"px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors",children:"Reorder"})]})]},r.id))}),n.shipping_address&&(0,Ue.jsxs)("div",{className:"mb-4",children:[(0,Ue.jsx)("h5",{className:"font-medium mb-2",children:"Shipping Address"}),(0,Ue.jsxs)("div",{className:"p-3 bg-gray-50 rounded text-sm",children:[(0,Ue.jsxs)("p",{children:[n.shipping_address.first_name," ",n.shipping_address.last_name]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.address_line1}),n.shipping_address.address_line2&&(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.address_line2}),(0,Ue.jsxs)("p",{className:"text-gray-600",children:[n.shipping_address.city,", ",n.shipping_address.state," ",n.shipping_address.postal_code]})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h5",{className:"font-medium mb-2",children:"Order Timeline"}),(0,Ue.jsx)("div",{className:"space-y-2",children:n.status_history.map(e=>(0,Ue.jsxs)("div",{className:"flex items-start space-x-3 text-sm",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("p",{className:"font-medium",children:e.status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500",children:T(e.created_at)}),e.notes&&(0,Ue.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.notes})]})]},e.id))})]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsx)("button",{onClick:e=>{e.stopPropagation(),u((null===d||void 0===d?void 0:d.id)===n.id?null:n)},className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:(null===d||void 0===d?void 0:d.id)===n.id?"Show Less":"Show Details"}),(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("button",{onClick:t=>{t.stopPropagation(),console.log("\ud83d\udd0d View Order clicked for order:",n.id),console.log("\ud83c\udf10 Navigating to:","/order-confirmation/".concat(n.id)),e("/order-confirmation/".concat(n.id))},className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"View Order"}),"out_for_delivery"===n.order_status&&(0,Ue.jsxs)("button",{onClick:t=>{t.stopPropagation(),e("/track-order/".concat(n.id))},className:"text-green-600 hover:text-green-700 text-sm font-medium flex items-center",children:[(0,Ue.jsx)(pc,{className:"h-4 w-4 mr-1"}),"Track"]}),"delivered"===n.order_status&&!n.has_feedback&&(0,Ue.jsxs)("button",{onClick:e=>{e.stopPropagation(),(e=>{y(e),x(!0)})(n)},className:"text-sweetbite-600 hover:text-sweetbite-700 text-sm font-medium flex items-center bg-sweetbite-50 px-3 py-1 rounded-lg hover:bg-sweetbite-100 transition-colors",children:[(0,Ue.jsx)(Cz,{className:"h-4 w-4 mr-1"}),"Give Feedback"]}),"delivered"===n.order_status&&n.has_feedback&&(0,Ue.jsxs)("span",{className:"text-green-600 text-sm font-medium flex items-center bg-green-50 px-3 py-1 rounded-lg",children:[(0,Ue.jsx)(_l,{className:"h-4 w-4 mr-1"}),"Feedback Given"]})]})]})]},n.id))})]}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Your Stats"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Total Orders"}),(0,Ue.jsx)("span",{className:"font-medium",children:_.totalOrders})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Active Orders"}),(0,Ue.jsx)("span",{className:"font-medium",children:t.filter(e=>!["delivered","cancelled"].includes(e.order_status)).length})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Completed"}),(0,Ue.jsx)("span",{className:"font-medium",children:t.filter(e=>"delivered"===e.order_status).length})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Total Spent"}),(0,Ue.jsxs)("span",{className:"font-medium",children:["RS ",_.totalSpent.toFixed(2)]})]})]}),_.favoriteItems.length>0&&(0,Ue.jsxs)("div",{className:"mt-6",children:[(0,Ue.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Your Favorites"}),(0,Ue.jsx)("div",{className:"space-y-2",children:_.favoriteItems.slice(0,3).map((e,t)=>(0,Ue.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,Ue.jsx)("span",{className:"text-gray-600 truncate",children:e.name}),(0,Ue.jsxs)("span",{className:"font-medium",children:[e.count,"x"]})]},t))})]}),(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,Ue.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Need Help?"}),(0,Ue.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"If you have questions about your order, contact our customer support."}),(0,Ue.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Contact Support"})]})]})})]})]}):(0,Ue.jsxs)("div",{className:"text-center py-12",children:[(0,Ue.jsx)("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ue.jsx)(oc,{className:"h-12 w-12 text-gray-400"})}),(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Orders Yet"}),(0,Ue.jsx)("p",{className:"text-gray-600 mb-6",children:"Start shopping to see your orders here"}),(0,Ue.jsx)("button",{onClick:()=>e("/menu"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Browse Menu"})]})]}),(0,Ue.jsx)(kz,{isOpen:g,onClose:()=>{x(!1),y(null)},order:v,onSubmitFeedback:async e=>{try{const t=localStorage.getItem("token"),r={"Content-Type":"application/json",Accept:"application/json"};t&&(r.Authorization="Token ".concat(t));const i=await fetch("http://localhost:8000/api/feedback/",{method:"POST",headers:r,body:JSON.stringify(e)});if(!i.ok){const e=await i.json();throw new Error(e.detail||"Failed to submit feedback")}const s=await i.json();console.log("Feedback submitted successfully:",s),n(e=>e.map(e=>e.id===v.id?qe(qe({},e),{},{has_feedback:!0}):e)),alert("Thank you for your feedback!"),x(!1),y(null)}catch(nU){console.error("Error submitting feedback:",nU),alert(nU.message||"Failed to submit feedback. Please try again.")}}})]})},Pz=["title","titleId"];function Lz(e,t){let{title:n,titleId:r}=e,s=Ie(e,Pz);return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},s),n?i.createElement("title",{id:r},n):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"}))}const Rz=i.forwardRef(Lz),Iz=()=>{var e,t,n,r,s,a,o,l,c;const d=ne(),u=ee(),{orderId:h}=re(),{cartItems:p,clearCart:m,getCartTotal:f}=hl(),{user:g}=Be(),[x,v]=(0,i.useState)(null),[y,b]=(0,i.useState)(!1),[w,_]=(0,i.useState)(!1),[S,N]=(0,i.useState)(""),[j,A]=(0,i.useState)(null),M=(0,i.useCallback)(async()=>{try{console.log("\ud83d\udd0d Loading existing order with ID:",h);const e=localStorage.getItem("token");if(!e)return console.log("\u274c No token found, redirecting to login"),void d("/login");console.log("\ud83c\udf10 Making API call to:","http://localhost:8000/api/orders/orders/".concat(h,"/"));const t=await fetch("http://localhost:8000/api/orders/orders/".concat(h,"/"),{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});if(console.log("\ud83d\udce1 API Response Status:",t.status),t.ok){const e=await t.json();console.log("\u2705 Order data loaded:",e),A(e),v({order_type:e.order_type,shipping_address:e.shipping_address,delivery_instructions:e.delivery_instructions,items:e.items,subtotal:e.subtotal||0,tax:e.tax||0,delivery_fee:e.delivery_fee||0,total_amount:e.total_amount||0}),b(!0)}else{const e=await t.text();console.log("\u274c API Error:",t.status,e),N("Failed to load order details: ".concat(t.status," ").concat(e))}}catch(e){console.error("\u274c Network error loading order:",e),N("Network error loading order details")}},[h,d]);(0,i.useEffect)(()=>{var e;console.log("\ud83d\udd04 OrderConfirmationPage useEffect triggered"),console.log("\ud83d\udccb orderId:",h),console.log("\ud83d\udccd location.state:",u.state),h?(console.log("\u2705 OrderId found, loading existing order"),M()):null!==(e=u.state)&&void 0!==e&&e.orderPreview?(console.log("\u2705 OrderPreview found in location state"),v(u.state.orderPreview),b(u.state.isPreview||!1)):(console.log("\u274c No orderId or orderPreview, redirecting to shipping address"),d("/shipping-address"))},[h,u.state,d,M]);return x?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:h?"Order #".concat(h):"Order Confirmation"}),(0,Ue.jsx)("p",{className:"text-gray-600 mt-1",children:h?"View your order details":"Review your order details before placing"})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2 text-green-600",children:[(0,Ue.jsx)(_l,{className:"h-6 w-6"}),(0,Ue.jsx)("span",{className:"font-medium",children:h?"Order Details":"Step 2 of 3"})]})]})}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,Ue.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Items"}),(0,Ue.jsx)("div",{className:"space-y-4",children:(h?(null===x||void 0===x?void 0:x.items)||[]:p).map((e,t)=>{var n,r,i;return(0,Ue.jsxs)("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("img",{src:e.previewImage||(null===(n=e.cake)||void 0===n?void 0:n.image)||e.image,alt:(null===(r=e.cake)||void 0===r?void 0:r.name)||e.name||"Cake",className:"w-16 h-16 object-cover rounded-lg",title:e.previewImage?"Your customized cake preview":"Standard cake image"}),e.previewImage&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1 bg-sweetbite-500 text-white text-xs px-1 py-0.5 rounded-full",children:"\u2728"})]}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h3",{className:"font-medium text-gray-900",children:(null===(i=e.cake)||void 0===i?void 0:i.name)||e.name||"Unknown Item"}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["Quantity: ",e.quantity]}),e.customizations&&Object.keys(e.customizations).length>0&&(0,Ue.jsxs)("div",{className:"mt-2",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Customizations:"}),(0,Ue.jsx)("div",{className:"text-sm text-gray-600",children:Object.entries(e.customizations).map(e=>{let[t,n]=e;return(0,Ue.jsxs)("span",{className:"mr-2",children:[t,": ",Array.isArray(n)?n.join(", "):n]},t)})})]})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsxs)("p",{className:"font-medium",children:["RS ",Number(e.unit_price||e.price||0).toFixed(2)]}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["\xd7 ",e.quantity]}),(0,Ue.jsxs)("p",{className:"text-xs text-gray-500",children:["Total: RS ",Number(e.total_price||(e.unit_price||e.price||0)*e.quantity).toFixed(2)]})]})]},t)})})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,Ue.jsx)(pc,{className:"h-5 w-5 mr-2"}),"Delivery Address"]}),(0,Ue.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Ue.jsxs)("p",{className:"font-medium text-gray-900",children:[(null===x||void 0===x||null===(e=x.shipping_address)||void 0===e?void 0:e.first_name)||"N/A"," ",(null===x||void 0===x||null===(t=x.shipping_address)||void 0===t?void 0:t.last_name)||""]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:(null===x||void 0===x||null===(n=x.shipping_address)||void 0===n?void 0:n.address_line1)||"N/A"}),(null===x||void 0===x||null===(r=x.shipping_address)||void 0===r?void 0:r.address_line2)&&(0,Ue.jsx)("p",{className:"text-gray-600",children:x.shipping_address.address_line2}),(0,Ue.jsxs)("p",{className:"text-gray-600",children:[(null===x||void 0===x||null===(s=x.shipping_address)||void 0===s?void 0:s.city)||"N/A",", ",(null===x||void 0===x||null===(a=x.shipping_address)||void 0===a?void 0:a.state)||"N/A"," ",(null===x||void 0===x||null===(o=x.shipping_address)||void 0===o?void 0:o.postal_code)||"N/A"]}),(null===x||void 0===x||null===(l=x.shipping_address)||void 0===l?void 0:l.country)&&(0,Ue.jsx)("p",{className:"text-gray-600",children:x.shipping_address.country}),(0,Ue.jsxs)("p",{className:"text-gray-600",children:["Phone: ",(null===x||void 0===x||null===(c=x.shipping_address)||void 0===c?void 0:c.phone)||"N/A"]})]})]}),S&&(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(Dv,{className:"h-5 w-5 text-red-400 mr-2"}),(0,Ue.jsx)("p",{className:"text-red-800",children:S})]})})]}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-4",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),(0,Ue.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Subtotal:"}),(0,Ue.jsxs)("span",{children:["RS ",Number((null===x||void 0===x?void 0:x.subtotal)||0).toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Tax (10%):"}),(0,Ue.jsxs)("span",{children:["RS ",Number((null===x||void 0===x?void 0:x.tax)||0).toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Delivery Fee:"}),(0,Ue.jsxs)("span",{children:["RS ",Number((null===x||void 0===x?void 0:x.delivery_fee)||0).toFixed(2)]})]}),(0,Ue.jsx)("hr",{className:"my-2"}),(0,Ue.jsxs)("div",{className:"flex justify-between font-semibold text-lg",children:[(0,Ue.jsx)("span",{children:"Total:"}),(0,Ue.jsxs)("span",{children:["RS ",Number((null===x||void 0===x?void 0:x.total_amount)||0).toFixed(2)]})]})]}),(0,Ue.jsx)("div",{className:"space-y-3",children:h?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)(_l,{className:"h-5 w-5 text-green-400 mr-2"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("p",{className:"text-green-800 font-medium",children:["Order #",h]}),(0,Ue.jsxs)("p",{className:"text-green-600 text-sm",children:["Status: ",(null===j||void 0===j?void 0:j.order_status)||"Unknown"]})]})]})}),(0,Ue.jsxs)("button",{onClick:()=>d("/orders"),className:"w-full py-3 px-4 rounded-lg font-medium transition-colors bg-blue-600 text-white hover:bg-blue-700 flex items-center justify-center",children:[(0,Ue.jsx)(pc,{className:"h-5 w-5 mr-2"}),"Back to My Orders"]}),"out_for_delivery"===(null===j||void 0===j?void 0:j.order_status)&&(0,Ue.jsxs)("button",{onClick:()=>d("/track-order/".concat(h)),className:"w-full py-3 px-4 rounded-lg font-medium transition-colors bg-green-600 text-white hover:bg-green-700 flex items-center justify-center",children:[(0,Ue.jsx)(pc,{className:"h-5 w-5 mr-2"}),"Track Order"]})]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("button",{onClick:async()=>{if(x){_(!0),N("");try{var e;const t=localStorage.getItem("token");if(!t)throw new Error("Please log in to place an order.");const n={order_type:x.order_type,shipping_address_id:null===(e=x.shipping_address)||void 0===e?void 0:e.id,delivery_instructions:x.delivery_instructions||"",payment_method:"cash",items:p.map(e=>({cake_id:e.id,quantity:e.quantity,unit_price:e.price,total_price:e.price*e.quantity,customizations:e.customizations||{}}))};console.log("Submitting order:",n);const r=await fetch("http://localhost:8000/api/orders/orders/",{method:"POST",headers:{Authorization:"Token ".concat(t),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(n)});if(!r.ok){const e=await r.json();throw new Error(e.detail||"Failed to place order. Please try again.")}const i=await r.json();console.log("Order created successfully:",i),A(i),m(),d("/order-success",{state:{order:i,fromConfirmation:!0}})}catch(t){console.error("Error placing order:",t),N(t.message||"Failed to place order. Please try again.")}finally{_(!1)}}else N("No order data available. Please try again.")},disabled:w,className:"w-full py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center ".concat(w?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:w?(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Placing Order..."]}):(0,Ue.jsxs)(Ue.Fragment,{children:[(0,Ue.jsx)(_l,{className:"h-5 w-5 mr-2"}),"Place Order"]})}),(0,Ue.jsxs)("button",{onClick:()=>{d("/payment",{state:{orderPreview:x,isPreview:!0}})},className:"w-full py-3 px-4 rounded-lg font-medium transition-colors bg-blue-600 text-white hover:bg-blue-700 flex items-center justify-center",children:[(0,Ue.jsx)(Rz,{className:"h-5 w-5 mr-2"}),"Proceed to Payment"]}),(0,Ue.jsx)("button",{onClick:()=>{d("/shipping-address")},className:"w-full py-2 px-4 rounded-lg font-medium transition-colors bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Back to Shipping"})]})}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mt-4 text-center",children:"Payment will be collected upon delivery"})]})})]})]})}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500 mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Loading order details..."})]})})},Fz=i.createContext(null);function Oz(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Oz(e[n],t[n]))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n){if(!t.hasOwnProperty(i))return!1;if(!Oz(e[i],t[i]))return!1}return!0}return!1}function Dz(e,t){if(!e.getProjection)return;const n=e.getProjection();Oz(n,t.getProjection())||t.setProjection(n)}function Uz(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function zz(e,t){const n=t.viewState||t;let r=!1;if("zoom"in n){const t=e.zoom;e.zoom=n.zoom,r=r||t!==e.zoom}if("bearing"in n){const t=e.bearing;e.bearing=n.bearing,r=r||t!==e.bearing}if("pitch"in n){const t=e.pitch;e.pitch=n.pitch,r=r||t!==e.pitch}if(n.padding&&!e.isPaddingEqual(n.padding)&&(r=!0,e.padding=n.padding),"longitude"in n&&"latitude"in n){const t=e.center;e.center=new t.constructor(n.longitude,n.latitude),r=r||t!==e.center}return r}const Bz=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Vz(e){if(!e)return null;if("string"===typeof e)return e;if("toJS"in e&&(e=e.toJS()),!e.layers)return e;const t={};for(const r of e.layers)t[r.id]=r;const n=e.layers.map(e=>{let n=null;"interactive"in e&&(n=Object.assign({},e),delete n.interactive);const r=t[e.ref];if(r){n=n||Object.assign({},e),delete n.ref;for(const e of Bz)e in r&&(n[e]=r[e])}return n||e});return qe(qe({},e),{},{layers:n})}const Hz={version:8,sources:{},layers:[]},Wz={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Gz={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},qz={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Xz=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Yz=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Zz{constructor(e,t,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=e=>{const t=this.props[qz[e.type]];t?t(e):"error"===e.type&&console.error(e.error)},this._onPointerEvent=e=>{"mousemove"!==e.type&&"mouseout"!==e.type||this._updateHover(e);const t=this.props[Wz[e.type]];t&&(this.props.interactiveLayerIds&&"mouseover"!==e.type&&"mouseout"!==e.type&&(e.features=this._hoveredFeatures||this._queryRenderedFeatures(e.point)),t(e),delete e.features)},this._onCameraEvent=e=>{if(!this._internalUpdate){const t=this.props[Gz[e.type]];t&&t(e)}e.type in this._deferredEvents&&(this._deferredEvents[e.type]=!1)},this._MapClass=e,this.props=t,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const t=this.props;this.props=e;const n=this._updateSettings(e,t);n&&this._createShadowTransform(this._map);const r=this._updateSize(e),i=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(n||r||i&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){const n=Zz.savedMaps.pop();if(!n)return null;const r=n.map,i=r.getContainer();for(t.className=i.className;i.childNodes.length>0;)t.appendChild(i.childNodes[0]);r._container=t;const s=r._resizeObserver;s&&(s.disconnect(),s.observe(t)),n.setProps(qe(qe({},e),{},{styleDiffing:!1})),r.resize();const{initialViewState:a}=e;return a&&(a.bounds?r.fitBounds(a.bounds,qe(qe({},a.fitBoundsOptions),{},{duration:0})):n._updateViewState(a,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),n}_initialize(e){const{props:t}=this,{mapStyle:n=Hz}=t,r=qe(qe(qe({},t),t.initialViewState),{},{accessToken:t.mapboxAccessToken||Jz()||null,container:e,style:Vz(n)}),i=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),t.gl){const e=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=e,t.gl)}const s=new this._MapClass(r);i.padding&&s.setPadding(i.padding),t.cursor&&(s.getCanvas().style.cursor=t.cursor),this._createShadowTransform(s);const a=s._render;s._render=e=>{this._inRender=!0,a.call(s,e),this._inRender=!1};const o=s._renderTaskQueue.run;s._renderTaskQueue.run=e=>{o.call(s._renderTaskQueue,e),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const l=s.fire;s.fire=this._fireEvent.bind(this,l),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>{this._updateStyleComponents(this.props,{}),Dz(s.transform,this._renderTransform)}),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const c in Wz)s.on(c,this._onPointerEvent);for(const c in Gz)s.on(c,this._onCameraEvent);for(const c in qz)s.on(c,this._onEvent);this._map=s}recycle(){const e=this.map.getContainer().querySelector("[mapboxgl-children]");null===e||void 0===e||e.remove(),Zz.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const t=function(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){const{viewState:t}=e;if(t){const e=this._map;if(t.width!==e.transform.width||t.height!==e.transform.height)return e.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;const n=this._map,r=this._renderTransform,{zoom:i,pitch:s,bearing:a}=r,o=n.isMoving();o&&(r.cameraElevationReference="sea");const l=zz(r,qe(qe({},Uz(n.transform)),e));if(o&&(r.cameraElevationReference="ground"),l&&t){const e=this._deferredEvents;e.move=!0,e.zoom||(e.zoom=i!==r.zoom),e.rotate||(e.rotate=a!==r.bearing),e.pitch||(e.pitch=s!==r.pitch)}return o||zz(n.transform,e),l}_updateSettings(e,t){const n=this._map;let r=!1;for(const i of Xz)if(i in e&&!Oz(e[i],t[i])){r=!0;const t=n["set".concat(i[0].toUpperCase()).concat(i.slice(1))];null===t||void 0===t||t.call(n,e[i])}return r}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==t.mapStyle){const{mapStyle:t=Hz,styleDiffing:n=!0}=e,r={diff:n};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(Vz(t),r),!0}return!1}_updateStyleComponents(e,t){const n=this._map;let r=!1;return n.isStyleLoaded()&&("light"in e&&n.setLight&&!Oz(e.light,t.light)&&(r=!0,n.setLight(e.light)),"fog"in e&&n.setFog&&!Oz(e.fog,t.fog)&&(r=!0,n.setFog(e.fog)),"terrain"in e&&n.setTerrain&&!Oz(e.terrain,t.terrain)&&(e.terrain&&!n.getSource(e.terrain.source)||(r=!0,n.setTerrain(e.terrain)))),r}_updateHandlers(e,t){var n,r;const i=this._map;let s=!1;for(const a of Yz){const o=null===(n=e[a])||void 0===n||n;Oz(o,null===(r=t[a])||void 0===r||r)||(s=!0,o?i[a].enable(o):i[a].disable())}return s}_queryRenderedFeatures(e){const t=this._map,n=t.transform,{interactiveLayerIds:r=[]}=this.props;try{return t.transform=this._renderTransform,t.queryRenderedFeatures(e,{layers:r.filter(t.getLayer.bind(t))})}catch(jc){return[]}finally{t.transform=n}}_updateHover(e){var t;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const n=e.type,r=(null===(t=this._hoveredFeatures)||void 0===t?void 0:t.length)>0,i=this._queryRenderedFeatures(e.point),s=i.length>0;!s&&r&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=i,s&&!r&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=n}else this._hoveredFeatures=null}_fireEvent(e,t,n){const r=this._map,i=r.transform,s="string"===typeof t?t:t.type;return"move"===s&&this._updateViewState(this.props,!1),s in Gz&&("object"===typeof t&&(t.viewState=Uz(i)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,t,n),r.transform=i,r):(e.call(r,t,n),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const n in this._deferredEvents)this._deferredEvents[n]&&e.fire(n);this._internalUpdate=!1;const t=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{Dz(this._renderTransform,t),e.transform=t}}}function Jz(){let e=null;if("undefined"!==typeof location){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.MapboxAccessToken}catch(jc){}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(Ec){}return e}Zz.savedMaps=[];const Kz=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Qz(e){if(!e)return null;const t=e.map,n={getMap:()=>t,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:n=>{const r=t.transform;t.transform=e.transform;const i=t.project(n);return t.transform=r,i},unproject:n=>{const r=t.transform;t.transform=e.transform;const i=t.unproject(n);return t.transform=r,i},queryTerrainElevation:(n,r)=>{const i=t.transform;t.transform=e.transform;const s=t.queryTerrainElevation(n,r);return t.transform=i,s},queryRenderedFeatures:(n,r)=>{const i=t.transform;t.transform=e.transform;const s=t.queryRenderedFeatures(n,r);return t.transform=i,s}};for(const r of function(e){const t=new Set;let n=e;for(;n;){for(const r of Object.getOwnPropertyNames(n))"_"!==r[0]&&"function"===typeof e[r]&&"fire"!==r&&"setEventedParent"!==r&&t.add(r);n=Object.getPrototypeOf(n)}return Array.from(t)}(t))r in n||Kz.includes(r)||(n[r]=t[r].bind(t));return n}const $z="undefined"!==typeof document?i.useLayoutEffect:i.useEffect,eB=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];const tB=i.createContext(null);function nB(e,t,n){const r=(0,i.useContext)(Fz),[s,a]=(0,i.useState)(null),o=(0,i.useRef)(),{current:l}=(0,i.useRef)({mapLib:null,map:null});(0,i.useEffect)(()=>{const t=e.mapLib;let i,s=!0;return Promise.resolve(t||n).then(t=>{if(!s)return;if(!t)throw new Error("Invalid mapLib");const n="Map"in t?t:t.default;if(!n.Map)throw new Error("Invalid mapLib");if(function(e,t){for(const r of eB)r in t&&(e[r]=t[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=t;n&&e.getRTLTextPluginStatus&&"unavailable"===e.getRTLTextPluginStatus()&&e.setRTLTextPlugin(n,e=>{e&&console.error(e)},!0)}(n,e),n.supported&&!n.supported(e))throw new Error("Map is not supported by this browser");e.reuseMaps&&(i=Zz.reuse(e,o.current)),i||(i=new Zz(n.Map,e,o.current)),l.map=Qz(i),l.mapLib=n,a(i),null===r||void 0===r||r.onMapMount(l.map,e.id)}).catch(t=>{const{onError:n}=e;n?n({type:"error",target:null,originalEvent:null,error:t}):console.error(t)}),()=>{s=!1,i&&(null===r||void 0===r||r.onMapUnmount(e.id),e.reuseMaps?i.recycle():i.destroy())}},[]),$z(()=>{s&&s.setProps(e)}),(0,i.useImperativeHandle)(t,()=>l.map,[s]);const c=(0,i.useMemo)(()=>qe({position:"relative",width:"100%",height:"100%"},e.style),[e.style]);return i.createElement("div",{id:e.id,ref:o,style:c},s&&i.createElement(tB.Provider,{value:l},i.createElement("div",{"mapboxgl-children":"",style:{height:"100%"}},e.children)))}const rB=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function iB(e,t){if(!e||!t)return;const n=e.style;for(const r in t){const e=t[r];Number.isFinite(e)&&!rB.test(r)?n[r]="".concat(e,"px"):n[r]=e}}const sB=(0,i.memo)((0,i.forwardRef)(function(e,t){const{map:n,mapLib:r}=(0,i.useContext)(tB),s=(0,i.useRef)({props:e});s.current.props=e;const a=(0,i.useMemo)(()=>{let t=!1;i.Children.forEach(e.children,e=>{e&&(t=!0)});const n=qe(qe({},e),{},{element:t?document.createElement("div"):null}),o=new r.Marker(n);return o.setLngLat([e.longitude,e.latitude]),o.getElement().addEventListener("click",e=>{var t,n;null===(n=(t=s.current.props).onClick)||void 0===n||n.call(t,{type:"click",target:o,originalEvent:e})}),o.on("dragstart",e=>{var t,n;const r=e;r.lngLat=a.getLngLat(),null===(n=(t=s.current.props).onDragStart)||void 0===n||n.call(t,r)}),o.on("drag",e=>{var t,n;const r=e;r.lngLat=a.getLngLat(),null===(n=(t=s.current.props).onDrag)||void 0===n||n.call(t,r)}),o.on("dragend",e=>{var t,n;const r=e;r.lngLat=a.getLngLat(),null===(n=(t=s.current.props).onDragEnd)||void 0===n||n.call(t,r)}),o},[]);(0,i.useEffect)(()=>(a.addTo(n.getMap()),()=>{a.remove()}),[]);const{longitude:l,latitude:c,offset:d,style:u,draggable:h=!1,popup:p=null,rotation:m=0,rotationAlignment:f="auto",pitchAlignment:g="auto"}=e;return(0,i.useEffect)(()=>{iB(a.getElement(),u)},[u]),(0,i.useImperativeHandle)(t,()=>a,[]),a.getLngLat().lng===l&&a.getLngLat().lat===c||a.setLngLat([l,c]),d&&!function(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,r=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(t)?t[0]:t?t.x:0,s=Array.isArray(t)?t[1]:t?t.y:0;return n===i&&r===s}(a.getOffset(),d)&&a.setOffset(d),a.isDraggable()!==h&&a.setDraggable(h),a.getRotation()!==m&&a.setRotation(m),a.getRotationAlignment()!==f&&a.setRotationAlignment(f),a.getPitchAlignment()!==g&&a.setPitchAlignment(g),a.getPopup()!==p&&a.setPopup(p),(0,o.createPortal)(e.children,a.getElement())}));function aB(e){return new Set(e?e.trim().split(/\s+/):[])}const oB=(0,i.memo)((0,i.forwardRef)(function(e,t){const{map:n,mapLib:r}=(0,i.useContext)(tB),s=(0,i.useMemo)(()=>document.createElement("div"),[]),a=(0,i.useRef)({props:e});a.current.props=e;const l=(0,i.useMemo)(()=>{const t=qe({},e),n=new r.Popup(t);return n.setLngLat([e.longitude,e.latitude]),n.once("open",e=>{var t,n;null===(n=(t=a.current.props).onOpen)||void 0===n||n.call(t,e)}),n},[]);if((0,i.useEffect)(()=>{const e=e=>{var t,n;null===(n=(t=a.current.props).onClose)||void 0===n||n.call(t,e)};return l.on("close",e),l.setDOMContent(s).addTo(n.getMap()),()=>{l.off("close",e),l.isOpen()&&l.remove()}},[]),(0,i.useEffect)(()=>{iB(l.getElement(),e.style)},[e.style]),(0,i.useImperativeHandle)(t,()=>l,[]),l.isOpen()&&(l.getLngLat().lng===e.longitude&&l.getLngLat().lat===e.latitude||l.setLngLat([e.longitude,e.latitude]),e.offset&&!Oz(l.options.offset,e.offset)&&l.setOffset(e.offset),l.options.anchor===e.anchor&&l.options.maxWidth===e.maxWidth||(l.options.anchor=e.anchor,l.setMaxWidth(e.maxWidth)),l.options.className!==e.className)){const t=aB(l.options.className),n=aB(e.className);for(const e of t)n.has(e)||l.removeClassName(e);for(const e of n)t.has(e)||l.addClassName(e);l.options.className=e.className}return(0,o.createPortal)(e.children,s)}));const lB=function(e,t,n,r){const s=(0,i.useContext)(tB),a=(0,i.useMemo)(()=>e(s),[]);return(0,i.useEffect)(()=>{const e=r||n||t,i="function"===typeof t&&"function"===typeof n?t:null,o="function"===typeof n?n:"function"===typeof t?t:null,{map:l}=s;return l.hasControl(a)||(l.addControl(a,null===e||void 0===e?void 0:e.position),i&&i(s)),()=>{o&&o(s),l.hasControl(a)&&l.removeControl(a)}},[]),a};(0,i.memo)(function(e){const t=lB(t=>{let{mapLib:n}=t;return new n.AttributionControl(e)},{position:e.position});return(0,i.useEffect)(()=>{iB(t._container,e.style)},[e.style]),null});(0,i.memo)(function(e){const t=lB(t=>{let{mapLib:n}=t;return new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)})},{position:e.position});return(0,i.useEffect)(()=>{iB(t._controlContainer,e.style)},[e.style]),null});(0,i.memo)((0,i.forwardRef)(function(e,t){const n=(0,i.useRef)({props:e}),r=lB(t=>{let{mapLib:r}=t;const i=new r.GeolocateControl(e),s=i._setupUI;return i._setupUI=e=>{i._container.hasChildNodes()||s(e)},i.on("geolocate",e=>{var t,r;null===(r=(t=n.current.props).onGeolocate)||void 0===r||r.call(t,e)}),i.on("error",e=>{var t,r;null===(r=(t=n.current.props).onError)||void 0===r||r.call(t,e)}),i.on("outofmaxbounds",e=>{var t,r;null===(r=(t=n.current.props).onOutOfMaxBounds)||void 0===r||r.call(t,e)}),i.on("trackuserlocationstart",e=>{var t,r;null===(r=(t=n.current.props).onTrackUserLocationStart)||void 0===r||r.call(t,e)}),i.on("trackuserlocationend",e=>{var t,r;null===(r=(t=n.current.props).onTrackUserLocationEnd)||void 0===r||r.call(t,e)}),i},{position:e.position});return n.current.props=e,(0,i.useImperativeHandle)(t,()=>r,[]),(0,i.useEffect)(()=>{iB(r._container,e.style)},[e.style]),null}));(0,i.memo)(function(e){const t=lB(t=>{let{mapLib:n}=t;return new n.NavigationControl(e)},{position:e.position});return(0,i.useEffect)(()=>{iB(t._container,e.style)},[e.style]),null});(0,i.memo)(function(e){const t=lB(t=>{let{mapLib:n}=t;return new n.ScaleControl(e)},{position:e.position}),n=(0,i.useRef)(e),r=n.current;n.current=e;const{style:s}=e;return void 0!==e.maxWidth&&e.maxWidth!==r.maxWidth&&(t.options.maxWidth=e.maxWidth),void 0!==e.unit&&e.unit!==r.unit&&t.setUnit(e.unit),(0,i.useEffect)(()=>{iB(t._container,s)},[s]),null});const cB=n.e(879).then(n.t.bind(n,879,23)),dB=i.forwardRef(function(e,t){return nB(e,t,cB)}),uB=sB,hB=oB,pB=e=>{let{orderId:t}=e;const[n,r]=(0,i.useState)({longitude:77.209,latitude:28.6139,zoom:12}),[s,a]=(0,i.useState)(null),[o,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(null),[u,h]=(0,i.useState)([]),[p,m]=(0,i.useState)(!0),[f,g]=(0,i.useState)(null),[x,v]=(0,i.useState)(null),y=(0,i.useRef)();(0,i.useEffect)(()=>{b();const e=setInterval(b,1e4);return()=>clearInterval(e)},[t]);const b=async()=>{try{const e=await fetch("/api/orders/orders/".concat(t,"/tracking/")),n=await e.json();e.ok?(a(n.order),l(n.delivery_location),d(n.customer_location),h(n.location_history||[]),n.delivery_location&&r({longitude:parseFloat(n.delivery_location.longitude),latitude:parseFloat(n.delivery_location.latitude),zoom:14})):g(n.error||"Failed to fetch order details")}catch(e){g("Network error: "+e.message)}finally{m(!1)}};if(p)return(0,Ue.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(f)return(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,Ue.jsx)("p",{className:"text-red-800",children:f})});if(!s)return(0,Ue.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,Ue.jsx)("p",{className:"text-gray-800",children:"Order not found"})});const w=o&&c?((e,t,n,r)=>{const i=(n-e)*Math.PI/180,s=(r-t)*Math.PI/180,a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))})(parseFloat(o.latitude),parseFloat(o.longitude),parseFloat(c.latitude),parseFloat(c.longitude)):null;return(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ue.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["Order #",s.order_number]}),(0,Ue.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((_=s.order_status,{pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",preparing:"bg-orange-100 text-orange-800",ready:"bg-purple-100 text-purple-800",out_for_delivery:"bg-green-100 text-green-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[_]||"bg-gray-100 text-gray-800")),children:s.order_status.replace("_"," ").toUpperCase()})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(e=>"out_for_delivery"===e?(0,Ue.jsx)(pc,{className:"w-5 h-5"}):(0,Ue.jsx)(oc,{className:"w-5 h-5"}))(s.order_status),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Status"}),(0,Ue.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:s.order_status.replace("_"," ").toUpperCase()})]})]}),s.delivery_person&&(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)(pc,{className:"w-6 h-6 text-blue-600"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Delivery Person"}),(0,Ue.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[s.delivery_person.first_name," ",s.delivery_person.last_name]})]})]}),w&&(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)(VU,{className:"w-6 h-6 text-green-600"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Distance"}),(0,Ue.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[w.toFixed(1)," km"]})]})]})]})]}),(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,Ue.jsx)("div",{className:"h-96",children:(0,Ue.jsxs)(dB,qe(qe({ref:y},n),{},{onMove:e=>r(e.viewState),mapboxAccessToken:"pk.eyJ1IjoiZ2FheWE5OSIsImEiOiJjbWZxY2U3bWcwcHM0MmluNTkxaHEzcDd1In0.nlgLV43KSw1e_AgyBVFuMQ",style:{width:"100%",height:"100%"},mapStyle:"mapbox://styles/mapbox/streets-v11",children:[c&&(0,Ue.jsx)(uB,{longitude:parseFloat(c.longitude),latitude:parseFloat(c.latitude),anchor:"bottom",children:(0,Ue.jsx)("div",{className:"bg-blue-600 text-white p-2 rounded-full shadow-lg",children:(0,Ue.jsx)(VU,{className:"w-6 h-6"})})}),o&&(0,Ue.jsx)(uB,{longitude:parseFloat(o.longitude),latitude:parseFloat(o.latitude),anchor:"bottom",children:(0,Ue.jsx)("div",{className:"bg-green-600 text-white p-2 rounded-full shadow-lg",children:(0,Ue.jsx)(pc,{className:"w-6 h-6"})})}),u.map((e,t)=>(0,Ue.jsx)(uB,{longitude:parseFloat(e.longitude),latitude:parseFloat(e.latitude),anchor:"bottom",children:(0,Ue.jsx)("div",{className:"bg-gray-400 text-white p-1 rounded-full shadow-lg cursor-pointer",onClick:()=>v(e),children:(0,Ue.jsx)("div",{className:"w-3 h-3"})})},t)),x&&(0,Ue.jsx)(hB,{longitude:parseFloat(x.longitude),latitude:parseFloat(x.latitude),anchor:"top",onClose:()=>v(null),children:(0,Ue.jsxs)("div",{className:"p-2",children:[(0,Ue.jsx)("p",{className:"font-semibold",children:"Location Update"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:new Date(x.timestamp).toLocaleString()}),x.speed&&(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["Speed: ",x.speed.toFixed(1)," km/h"]})]})})]}))})}),u.length>0&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Location History"}),(0,Ue.jsx)("div",{className:"space-y-3",children:u.slice(0,10).map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"text-sm font-medium text-gray-900",children:new Date(e.timestamp).toLocaleString()}),(0,Ue.jsxs)("p",{className:"text-xs text-gray-500",children:[e.latitude,", ",e.longitude]})]})]}),e.speed&&(0,Ue.jsxs)("div",{className:"text-sm text-gray-600",children:[e.speed.toFixed(1)," km/h"]})]},t))})]})]});var _},mB=()=>{const e=ne(),t=ee(),[n,r]=(0,i.useState)(null),[s,a]=(0,i.useState)(!0),[o,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),[u,h]=(0,i.useState)(!1),[p,m]=(0,i.useState)(""),[f,g]=(0,i.useState)(null),[x,v]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(console.log("OrderSuccessPage useEffect - location.state:",t.state),!t.state)return console.log("No location.state found, redirecting to home"),void e("/");t.state.order?(console.log("Order data found in location.state:",t.state.order),r(t.state.order),a(!1)):t.state.orderId?(console.log("OrderId found, fetching order details:",t.state.orderId),y(),(async e=>{try{const t=localStorage.getItem("token");if(!t)return;const n=await fetch("http://localhost:8000/api/feedback/order/".concat(e,"/"),{headers:{Authorization:"Token ".concat(t),"Content-Type":"application/json",Accept:"application/json"}});if(n.ok){const e=await n.json();g(e),d(!0)}else 404===n.status&&(g(null),d(!1))}catch(nU){console.error("Error loading existing feedback:",nU),g(null)}})(t.state.orderId)):(console.log("No order or orderId found, redirecting to home"),e("/"))},[t.state,e]);const y=async()=>{try{const e=await fetch("http://localhost:8000/api/orders/orders/".concat(t.state.orderId,"/"),{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(e.ok){const t=await e.json();r(t)}}catch(nU){console.error("Error loading order details:",nU)}finally{a(!1)}},b=async()=>{if(f&&window.confirm("Are you sure you want to delete your feedback? This action cannot be undone."))try{h(!0),m("");const e=localStorage.getItem("token");if(!e)return void m("Authentication required. Please log in again.");console.log("\ud83d\uddd1\ufe0f Deleting feedback:",f.id),console.log("\ud83d\udd17 Delete URL:","http://localhost:8000/api/feedback/".concat(f.id,"/"));const t=await fetch("http://localhost:8000/api/feedback/".concat(f.id,"/"),{method:"DELETE",headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json",Accept:"application/json"}});if(console.log("\ud83d\udce1 Delete response status:",t.status),console.log("\ud83d\udce1 Delete response headers:",t.headers),t.ok)console.log("\u2705 Feedback deleted successfully"),d(!1),l(!1),v(!1),g(null);else{const e=await t.json().catch(()=>({}));console.error("\u274c Delete failed:",t.status,e),m(e.message||"Failed to delete feedback. Status: ".concat(t.status))}}catch(nU){console.error("\u274c Error deleting feedback:",nU),m("Network error. Please try again.")}finally{h(!1)}};return s?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading order details..."})]})}):n?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"text-center mb-8",children:[(0,Ue.jsx)(_l,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Order Placed Successfully!"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Thank you for your order. We'll start preparing your delicious cakes right away."})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ue.jsxs)("div",{className:"lg:col-span-2",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Details"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Order Number:"}),(0,Ue.jsx)("span",{className:"font-medium",children:n.order_number||"N/A"})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Order Date:"}),(0,Ue.jsx)("span",{className:"font-medium",children:n.created_at?new Date(n.created_at).toLocaleDateString():"N/A"})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Total Amount:"}),(0,Ue.jsxs)("span",{className:"font-medium text-lg",children:["RS ",n.total_amount||"0.00"]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Payment Status:"}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("paid"===n.payment_status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:n.payment_status?n.payment_status.charAt(0).toUpperCase()+n.payment_status.slice(1):"Pending"})]})]})]}),(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Items"}),(0,Ue.jsx)("div",{className:"space-y-4",children:n.items&&n.items.length>0?n.items.map(e=>{var t;return(0,Ue.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ue.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-gray-500 text-sm",children:"\ud83c\udf70"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("h3",{className:"font-medium",children:(null===(t=e.cake)||void 0===t?void 0:t.name)||"Custom Cake"}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["Quantity: ",e.quantity||1]}),e.customization_notes&&(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:e.customization_notes})]})]}),(0,Ue.jsx)("div",{className:"text-right",children:(0,Ue.jsxs)("p",{className:"font-medium",children:["RS ",e.total_price||"0.00"]})})]},e.id)}):(0,Ue.jsx)("p",{className:"text-gray-500",children:"No items found"})})]}),n.shipping_address&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Shipping Address"}),(0,Ue.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,Ue.jsxs)("p",{className:"font-medium",children:[n.shipping_address.first_name," ",n.shipping_address.last_name]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.phone}),(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.address_line1}),n.shipping_address.address_line2&&(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.address_line2}),(0,Ue.jsxs)("p",{className:"text-gray-600",children:[n.shipping_address.city,", ",n.shipping_address.state," ",n.shipping_address.postal_code]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.country})]})]}),"out_for_delivery"===(null===n||void 0===n?void 0:n.order_status)&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\ud83d\uddfa\ufe0f Track Your Order"}),(0,Ue.jsx)("div",{className:"h-96 rounded-lg overflow-hidden",children:(0,Ue.jsx)(pB,{orderId:n.id})}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Real-time tracking updates every 10 seconds"})]})]}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Status"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(e=>{switch(e){case"pending":return(0,Ue.jsx)(oc,{className:"h-6 w-6 text-yellow-500"});case"confirmed":case"preparing":return(0,Ue.jsx)(oc,{className:"h-6 w-6 text-blue-500"});case"ready":case"out_for_delivery":return(0,Ue.jsx)(pc,{className:"h-6 w-6 text-purple-500"});case"delivered":return(0,Ue.jsx)(_l,{className:"h-6 w-6 text-green-500"});default:return(0,Ue.jsx)(oc,{className:"h-6 w-6 text-gray-500"})}})(n.order_status),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":case"preparing":return"bg-blue-100 text-blue-800";case"ready":case"out_for_delivery":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(n.order_status)),children:n.order_status?n.order_status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()):"Unknown"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:(e=>{switch(e){case"pending":return"Your order has been placed and is being reviewed.";case"confirmed":return"Your order has been confirmed and is being prepared.";case"preparing":return"Our bakers are working on your delicious cakes!";case"ready":return"Your order is ready and will be delivered soon.";case"out_for_delivery":return"Your order is on its way to you!";case"delivered":return"Your order has been delivered. Enjoy your cakes!";default:return"Your order is being processed."}})(n.order_status)})]})]}),(0,Ue.jsxs)("div",{className:"mt-6",children:[(0,Ue.jsx)("h3",{className:"font-medium mb-3",children:"Order Timeline"}),(0,Ue.jsx)("div",{className:"space-y-3",children:n.status_history&&n.status_history.length>0?n.status_history.map((e,t)=>(0,Ue.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Ue.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("p",{className:"text-sm font-medium",children:e.status?e.status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()):"Status Update"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500",children:e.created_at?new Date(e.created_at).toLocaleString():"Unknown time"}),e.notes&&(0,Ue.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.notes})]})]},e.id||t)):(0,Ue.jsx)("p",{className:"text-sm text-gray-500",children:"No status history available"})})]})]}),(0,Ue.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,Ue.jsx)("button",{onClick:()=>e("/orders"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"View My Orders"}),(0,Ue.jsx)("button",{onClick:()=>e("/"),className:"w-full bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Continue Shopping"})]}),f?(0,Ue.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,Ue.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,Ue.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,Ue.jsx)("h3",{className:"font-medium text-green-900",children:"Your Feedback"})}),(0,Ue.jsx)("div",{className:"flex items-center space-x-1 mb-2",children:[...Array(5)].map((e,t)=>(0,Ue.jsx)("span",{className:"text-sm ".concat(t<f.rating?"text-yellow-400":"text-gray-300"),children:"\u2605"},t))}),(0,Ue.jsx)("p",{className:"text-sm text-green-800 line-clamp-2",children:f.message})]}),(0,Ue.jsxs)("div",{className:"flex space-x-2",children:[(0,Ue.jsx)("button",{onClick:()=>{v(!0),l(!0)},className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors text-sm",children:"Edit Feedback"}),(0,Ue.jsx)("button",{onClick:b,className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 transition-colors text-sm",children:"Delete"})]})]}):(0,Ue.jsx)(Ue.Fragment,{children:!o&&(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,Ue.jsx)("h3",{className:"font-medium text-yellow-900 mb-2",children:"How was your experience?"}),(0,Ue.jsx)("p",{className:"text-sm text-yellow-800 mb-3",children:"We'd love to hear about your order experience. Your feedback helps us improve!"}),(0,Ue.jsx)("button",{onClick:()=>l(!0),className:"bg-yellow-600 text-white py-2 px-4 rounded-md hover:bg-yellow-700 transition-colors text-sm",children:"Leave Feedback"})]})})]})})]}),o&&(0,Ue.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Ue.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,Ue.jsxs)("div",{className:"p-6",children:[(0,Ue.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold",children:"Share Your Experience"}),(0,Ue.jsx)("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:"\u2715"})]}),p&&(0,Ue.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:(0,Ue.jsx)("p",{className:"text-red-800 text-sm",children:p})}),(0,Ue.jsx)(QU,{onSubmit:async e=>{h(!0),m("");try{const t=await fetch("http://localhost:8000/api/feedback/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))},body:JSON.stringify(qe(qe({},e),{},{order_id:null===n||void 0===n?void 0:n.id}))});if(t.ok){const e=await t.json();d(!0),l(!1),g(e.data),v(!1)}else{const e=await t.json();m(e.message||"Failed to submit feedback. Please try again.")}}catch(t){m("Network error. Please check your connection and try again.")}finally{h(!1)}},onCancel:()=>{l(!1),v(!1)},onDelete:b,isSubmitting:u,initialData:x?f:null,isEditing:x})]})})})]})}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("p",{className:"text-gray-600",children:"Order not found."}),(0,Ue.jsx)("button",{onClick:()=>e("/"),className:"mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Go Home"})]})})},fB=()=>{const{orderId:e}=re(),t=ne(),[n,r]=(0,i.useState)(null),[s,a]=(0,i.useState)(!0),[o,l]=(0,i.useState)(null);(0,i.useEffect)(()=>{e&&c()},[e]);const c=async()=>{try{a(!0);const t=await fetch("http://localhost:8000/api/orders/orders/".concat(e,"/"),{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(t.ok){const e=await t.json();r(e)}else l("Failed to load order details")}catch(t){l("Network error loading order details")}finally{a(!1)}};return s?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading order details..."})]})}):o||!n?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:o||"Order not found"}),(0,Ue.jsx)("button",{onClick:()=>t("/orders"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Back to Orders"})]})}):(0,Ue.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,Ue.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,Ue.jsxs)("div",{className:"flex items-center",children:[(0,Ue.jsx)("button",{onClick:()=>t("/orders"),className:"mr-4 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,Ue.jsx)(yl,{className:"h-6 w-6 text-gray-600"})}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("h1",{className:"text-xl font-semibold text-gray-900",children:["Track Order #",n.order_number]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Real-time delivery tracking"})]})]}),(0,Ue.jsx)("div",{className:"flex items-center space-x-4",children:(0,Ue.jsx)("div",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"out_for_delivery":return"bg-blue-100 text-blue-800";case"delivered":return"bg-green-100 text-green-800";default:return"bg-yellow-100 text-yellow-800"}})(n.order_status)),children:(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e){case"out_for_delivery":return(0,Ue.jsx)(pc,{className:"h-6 w-6 text-blue-500"});case"delivered":return(0,Ue.jsx)(_l,{className:"h-6 w-6 text-green-500"});default:return(0,Ue.jsx)(oc,{className:"h-6 w-6 text-yellow-500"})}})(n.order_status),(0,Ue.jsx)("span",{children:n.order_status.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())})]})})})]})})}),(0,Ue.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ue.jsx)("div",{className:"lg:col-span-2",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Ue.jsxs)("div",{className:"p-6 border-b",children:[(0,Ue.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,Ue.jsx)(VU,{className:"h-5 w-5 mr-2 text-blue-500"}),"Live Tracking Map"]}),(0,Ue.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Real-time location updates every 10 seconds"})]}),(0,Ue.jsx)("div",{className:"h-96 bg-gray-100 flex items-center justify-center rounded-lg",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)(VU,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Mapbox tracking will be available here"}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Order ID: ",e]})]})})]})}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Order Number:"}),(0,Ue.jsx)("span",{className:"font-medium",children:n.order_number})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Order Date:"}),(0,Ue.jsx)("span",{className:"font-medium",children:new Date(n.created_at).toLocaleDateString()})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Total Amount:"}),(0,Ue.jsxs)("span",{className:"font-medium text-lg",children:["RS ",n.total_amount]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Payment Status:"}),(0,Ue.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("paid"===n.payment_status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:"paid"===n.payment_status?"Paid":"Pending"})]})]})]}),n.shipping_address&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delivery Address"}),(0,Ue.jsxs)("div",{className:"space-y-2",children:[(0,Ue.jsxs)("p",{className:"font-medium",children:[n.shipping_address.first_name," ",n.shipping_address.last_name]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.phone}),(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.address_line1}),n.shipping_address.address_line2&&(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.address_line2}),(0,Ue.jsxs)("p",{className:"text-gray-600",children:[n.shipping_address.city,", ",n.shipping_address.state," ",n.shipping_address.postal_code]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:n.shipping_address.country})]})]}),n.items&&n.items.length>0&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Items"}),(0,Ue.jsx)("div",{className:"space-y-3",children:n.items.map(e=>{var t;return(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("p",{className:"font-medium",children:(null===(t=e.cake)||void 0===t?void 0:t.name)||"Custom Cake"}),(0,Ue.jsxs)("p",{className:"text-sm text-gray-600",children:["Qty: ",e.quantity]})]}),(0,Ue.jsxs)("p",{className:"font-medium",children:["RS ",e.total_price]})]},e.id)})})]}),(0,Ue.jsxs)("div",{className:"bg-blue-50 rounded-lg p-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Tracking Information"}),(0,Ue.jsxs)("div",{className:"space-y-2 text-sm text-blue-800",children:[(0,Ue.jsx)("p",{children:"\u2022 Map updates every 10 seconds"}),(0,Ue.jsx)("p",{children:"\u2022 Blue marker shows delivery person location"}),(0,Ue.jsx)("p",{children:"\u2022 Red marker shows your delivery address"}),(0,Ue.jsx)("p",{children:"\u2022 Estimated delivery time based on traffic"})]})]})]})})]})})]})},gB=()=>{const e=ne(),t=ee(),{cartItems:n,getCartTotal:r,clearCart:s}=hl(),[a,o]=(0,i.useState)("card"),[l,c]=(0,i.useState)({cardNumber:"",expiryDate:"",cvv:"",cardholderName:""}),[d,u]=(0,i.useState)(!1),[h,p]=(0,i.useState)(null);(0,i.useEffect)(()=>{t.state&&0!==n.length?p(t.state):e("/cart")},[t.state,n,e]);const m=()=>{const e=r(),t=.1*e;return{subtotal:e,tax:t,deliveryFee:5,total:e+t+5}},f=async t=>{t.preventDefault(),u(!0);try{const t=await fetch("http://localhost:8000/api/orders/orders/",{method:"POST",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({order_type:"online",shipping_address_id:h.shippingAddressId,items:n.map(e=>({cake_id:e.id,quantity:e.quantity,unit_price:e.price,total_price:e.price*e.quantity,customization_notes:e.customizations?JSON.stringify(e.customizations):""}))})});if(!t.ok)throw new Error("Failed to create order");const r=await t.json(),i=await fetch("http://localhost:8000/api/orders/payments/",{method:"POST",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({order:r.id,payment_method:a,amount:m().total})});if(!i.ok)throw new Error("Failed to create payment");const o=await i.json();if(!(await fetch("http://localhost:8000/api/orders/payments/".concat(o.id,"/process_payment/"),{method:"POST",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({payment_method:a})})).ok)throw new Error("Payment processing failed");s(),e("/order-success",{state:{orderNumber:r.order_number,orderId:r.id}})}catch(nU){console.error("Error processing payment:",nU),alert("Payment failed. Please try again.")}finally{u(!1)}},g=m();return h?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Payment"}),(0,Ue.jsx)("p",{className:"text-gray-600",children:"Complete your order with secure payment"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ue.jsx)("div",{className:"lg:col-span-2",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Payment Method"}),(0,Ue.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,Ue.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer",children:[(0,Ue.jsx)("input",{type:"radio",name:"paymentMethod",value:"card",checked:"card"===a,onChange:e=>o(e.target.value),className:"text-blue-600 focus:ring-blue-500"}),(0,Ue.jsx)("span",{className:"font-medium",children:"Credit/Debit Card"})]}),(0,Ue.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer",children:[(0,Ue.jsx)("input",{type:"radio",name:"paymentMethod",value:"paypal",checked:"paypal"===a,onChange:e=>o(e.target.value),className:"text-blue-600 focus:ring-blue-500"}),(0,Ue.jsx)("span",{className:"font-medium",children:"PayPal"})]}),(0,Ue.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer",children:[(0,Ue.jsx)("input",{type:"radio",name:"paymentMethod",value:"cash",checked:"cash"===a,onChange:e=>o(e.target.value),className:"text-blue-600 focus:ring-blue-500"}),(0,Ue.jsx)("span",{className:"font-medium",children:"Cash on Delivery"})]})]}),"card"===a&&(0,Ue.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Number"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:l.cardNumber,onChange:e=>c(qe(qe({},l),{},{cardNumber:e.target.value})),placeholder:"1234 5678 9012 3456",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:l.expiryDate,onChange:e=>c(qe(qe({},l),{},{expiryDate:e.target.value})),placeholder:"MM/YY",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CVV"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:l.cvv,onChange:e=>c(qe(qe({},l),{},{cvv:e.target.value})),placeholder:"123",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cardholder Name"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:l.cardholderName,onChange:e=>c(qe(qe({},l),{},{cardholderName:e.target.value})),placeholder:"John Doe",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,Ue.jsx)("button",{type:"submit",disabled:d,className:"w-full py-3 px-4 rounded-lg font-medium transition-colors ".concat(d?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:d?"Processing...":"Pay Now"})]}),"paypal"===a&&(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"You will be redirected to PayPal to complete your payment."}),(0,Ue.jsx)("button",{onClick:f,disabled:d,className:"px-6 py-3 rounded-lg font-medium transition-colors ".concat(d?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:d?"Processing...":"Continue to PayPal"})]}),"cash"===a&&(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("p",{className:"text-gray-600 mb-4",children:"Pay with cash when your order is delivered."}),(0,Ue.jsx)("button",{onClick:f,disabled:d,className:"px-6 py-3 rounded-lg font-medium transition-colors ".concat(d?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:d?"Processing...":"Place Order"})]})]})}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-8",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),(0,Ue.jsx)("div",{className:"space-y-3 mb-6",children:n.map(e=>(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("img",{src:e.previewImage||e.image,alt:e.name,className:"w-12 h-12 object-cover rounded-lg",title:e.previewImage?"Your customized cake preview":"Standard cake image"}),e.previewImage&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1 bg-sweetbite-500 text-white text-xs px-1 py-0.5 rounded-full",children:"\u2728"})]}),(0,Ue.jsxs)("span",{className:"text-gray-600",children:[e.quantity,"x ",e.name]})]}),(0,Ue.jsxs)("span",{className:"font-medium",children:["RS ",(e.price*e.quantity).toFixed(2)]})]},e.cartItemId))}),(0,Ue.jsxs)("div",{className:"border-t pt-4 space-y-2",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,Ue.jsxs)("span",{children:["RS ",g.subtotal.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Tax (10%)"}),(0,Ue.jsxs)("span",{children:["RS ",g.tax.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Delivery Fee"}),(0,Ue.jsxs)("span",{children:["RS ",g.deliveryFee.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between text-lg font-semibold border-t pt-2",children:[(0,Ue.jsx)("span",{children:"Total"}),(0,Ue.jsxs)("span",{children:["RS ",g.total.toFixed(2)]})]})]}),(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,Ue.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"Secure Payment"}),(0,Ue.jsx)("p",{className:"text-sm text-blue-700",children:"Your payment information is encrypted and secure. We never store your card details."})]})]})})]})]})}):(0,Ue.jsx)("div",{children:"Loading..."})},xB=()=>{const{user:e,updateProfile:t}=Be(),[n,r]=(0,i.useState)(!1),[s,a]=(0,i.useState)(!1),[o,l]=(0,i.useState)(""),[c,d]=(0,i.useState)(""),[u,h]=(0,i.useState)({first_name:(null===e||void 0===e?void 0:e.first_name)||"",last_name:(null===e||void 0===e?void 0:e.last_name)||"",email:(null===e||void 0===e?void 0:e.email)||"",phone_number:(null===e||void 0===e?void 0:e.phone_number)||""});(0,i.useEffect)(()=>{console.log("\ud83d\udc64 User data changed:",e),h({first_name:(null===e||void 0===e?void 0:e.first_name)||"",last_name:(null===e||void 0===e?void 0:e.last_name)||"",email:(null===e||void 0===e?void 0:e.email)||"",phone_number:(null===e||void 0===e?void 0:e.phone_number)||""})},[e]);const p=e=>{h(qe(qe({},u),{},{[e.target.name]:e.target.value}))};return e?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsx)("div",{className:"max-w-2xl mx-auto px-4",children:(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-lg shadow-lg p-6",children:[(0,Ue.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile"}),!n&&(0,Ue.jsx)("button",{onClick:()=>r(!0),className:"bg-sweetbite-600 text-white px-4 py-2 rounded-lg hover:bg-sweetbite-700 transition-colors",children:"Edit Profile"})]}),o&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:o}),c&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-green-100 border border-green-400 text-green-700 rounded",children:c}),(0,Ue.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),a(!0),l(""),d(""),console.log("\ud83d\udd04 Submitting profile update with data:",u);try{const e=await t(u);console.log("\ud83d\udccb Update result:",e),e.success?(d("Profile updated successfully!"),r(!1),console.log("\u2705 Profile update successful!")):(l(e.error),console.log("\u274c Profile update failed:",e.error))}catch(o){console.error("\ud83d\udca5 Profile update error:",o),l("An unexpected error occurred")}finally{a(!1)}},className:"space-y-6",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),(0,Ue.jsx)("input",{type:"text",name:"first_name",value:u.first_name,onChange:p,disabled:!n,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 ".concat(n?"border-gray-300":"border-gray-200 bg-gray-50")})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),(0,Ue.jsx)("input",{type:"text",name:"last_name",value:u.last_name,onChange:p,disabled:!n,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 ".concat(n?"border-gray-300":"border-gray-200 bg-gray-50")})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,Ue.jsx)("input",{type:"email",name:"email",value:u.email,onChange:p,disabled:!n,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 ".concat(n?"border-gray-300":"border-gray-200 bg-gray-50")})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),(0,Ue.jsx)("input",{type:"tel",name:"phone_number",value:u.phone_number,onChange:p,disabled:!n,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sweetbite-500 ".concat(n?"border-gray-300":"border-gray-200 bg-gray-50")})]}),n&&(0,Ue.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,Ue.jsx)("button",{type:"submit",disabled:s,className:"flex-1 bg-sweetbite-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-sweetbite-700 transition-colors disabled:opacity-50",children:s?"Saving...":"Save Changes"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>{h({first_name:(null===e||void 0===e?void 0:e.first_name)||"",last_name:(null===e||void 0===e?void 0:e.last_name)||"",email:(null===e||void 0===e?void 0:e.email)||"",phone_number:(null===e||void 0===e?void 0:e.phone_number)||""}),r(!1),l(""),d("")},className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-400 transition-colors",children:"Cancel"})]})]}),(0,Ue.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Information"}),(0,Ue.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Member since:"})," ",new Date(e.date_joined||Date.now()).toLocaleDateString()]}),(0,Ue.jsxs)("p",{children:[(0,Ue.jsx)("span",{className:"font-medium",children:"Account type:"})," ",e.is_staff?"Staff Member":"Customer"]})]})]})]})})}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Please sign in to view your profile"})})})},vB=()=>{const[e]=Re(),t=ne(),[n,r]=(0,i.useState)(!1),[s,a]=(0,i.useState)(""),[o,l]=(0,i.useState)(!0),[c,d]=(0,i.useState)(""),u=e.get("token");(0,i.useEffect)(()=>{if(console.log("Reset password page loaded with token:",u),u){r(!0),l(!1);const e=async()=>{try{console.log("Verifying token:",u);const e=await fetch("http://localhost:8000/api/users/auth/verify-reset-token/".concat(u,"/"),{method:"GET",headers:{Accept:"application/json"}});console.log("Token verification response:",e.status);const t=await e.json();console.log("Token verification data:",t),e.ok&&t.valid?(a(t.email),console.log("Token verified, user email:",t.email)):(console.log("Token verification failed:",t.message),d(t.message||"Invalid or expired reset link"))}catch(c){console.error("Token verification error:",c),d("Failed to verify reset link")}};e()}else console.log("No token provided, redirecting to home"),d("No reset token provided"),setTimeout(()=>t("/"),2e3)},[u,t]);return o?(0,Ue.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sweetbite-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading password reset..."})]})}):c&&!n?(0,Ue.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,Ue.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[(0,Ue.jsx)("h3",{className:"font-bold",children:"Error"}),(0,Ue.jsx)("p",{children:c})]}),(0,Ue.jsx)("button",{onClick:()=>t("/"),className:"bg-sweetbite-600 text-white px-4 py-2 rounded hover:bg-sweetbite-700",children:"Go to Home"})]})}):(0,Ue.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 flex items-center justify-center",children:[!n&&(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sweetbite-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Opening password reset..."})]}),(0,Ue.jsx)(ez,{isOpen:n,onClose:()=>{r(!1),t("/")},token:u,userEmail:s})]})},yB=()=>{const e=ne(),{cartItems:t,getCartTotal:n,clearCart:r}=hl(),{user:s}=Be(),[a,o]=(0,i.useState)([]),[l,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(!1),[h,p]=(0,i.useState)(!1),[m,f]=(0,i.useState)(!1),[g,x]=(0,i.useState)(""),[v,y]=(0,i.useState)(""),[b,w]=(0,i.useState)({first_name:"",last_name:"",phone:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:""});(0,i.useEffect)(()=>{if(console.log("\ud83d\uded2 ShippingAddressPage - Cart Debug Info:"),console.log("cartItems:",t),console.log("cartItems.length:",t.length),console.log("cartItems type:",typeof t),console.log("cartItems isArray:",Array.isArray(t)),0===t.length)return console.log("\u26a0\ufe0f Cart is empty, redirecting to cart page"),void e("/cart");S(),_()},[t,e]);const _=async()=>{try{const e=localStorage.getItem("token");console.log("Testing database connection with token:",e);const t=await fetch("http://localhost:8000/api/orders/shipping-addresses/test_db/",{headers:{Authorization:"Token ".concat(e),"Content-Type":"application/json"}});if(console.log("Database test response status:",t.status),t.ok){const e=await t.json();console.log("Database test result:",e),y("Database test passed: ".concat(e.user_addresses," addresses found for user ").concat(e.user_id))}else{const e=await t.text();console.error("Database test failed:",t.status,e),x("Database test failed: ".concat(t.status," - ").concat(e))}}catch(g){console.error("Database test error:",g),x("Database test error: ".concat(g.message))}},S=async()=>{try{p(!0),console.log("Loading addresses from backend..."),console.log("User token:",localStorage.getItem("token"));const e=await fetch("http://localhost:8000/api/orders/shipping-addresses/",{headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(console.log("Address load response status:",e.status),console.log("Address load response headers:",e.headers),e.ok){const t=await e.json();console.log("Addresses loaded from backend:",t);let n=[];if(t.results&&Array.isArray(t.results)?(n=t.results,console.log("Number of addresses from paginated response:",n.length),console.log("Total count:",t.count)):Array.isArray(t)?(n=t,console.log("Number of addresses from direct array:",n.length)):(console.log("Unexpected response format:",t),n=[]),console.log("Address list after validation:",n),o(n),n.length>0){const e=n.find(e=>e.is_default),t=e?e.id:n[0].id;console.log("Selected address ID:",t),c(t)}else console.log("No addresses found in response")}else{const t=await e.text();console.error("Error loading addresses:",t),console.error("Response status:",e.status),x("Failed to load addresses (".concat(e.status,"): ").concat(t))}}catch(g){console.error("Error loading addresses:",g),x("Network error loading addresses: ".concat(g.message))}finally{p(!1)}},N=(()=>{const e=n(),t=.1*e;return{subtotal:e,tax:t,deliveryFee:5,total:e+t+5}})();return h&&0===a.length?(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center",children:[(0,Ue.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,Ue.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading addresses..."})]})}):(0,Ue.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,Ue.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,Ue.jsxs)("div",{className:"mb-8",children:[(0,Ue.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Shipping Address"}),(0,Ue.jsx)("p",{className:"text-gray-600 mt-2",children:"Please select or add a shipping address for your order"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ue.jsxs)("div",{className:"lg:col-span-2",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Select Address"}),v&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsx)("p",{className:"text-green-800 text-sm",children:v}),(0,Ue.jsx)("button",{onClick:()=>y(""),className:"text-green-600 hover:text-green-800 text-sm font-medium",children:"\u2715"})]})}),g&&(0,Ue.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,Ue.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ue.jsx)("p",{className:"text-red-800 text-sm",children:g}),(0,Ue.jsx)("button",{onClick:()=>x(""),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"\u2715"})]})}),a.length>0?(0,Ue.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,Ue.jsx)("div",{className:"border rounded-lg p-4 cursor-pointer transition-colors ".concat(l===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>c(e.id),children:(0,Ue.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,Ue.jsxs)("h3",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),e.is_default&&(0,Ue.jsx)("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:"Default"})]}),(0,Ue.jsx)("p",{className:"text-gray-600",children:e.phone}),(0,Ue.jsx)("p",{className:"text-gray-600",children:e.address_line1}),e.address_line2&&(0,Ue.jsx)("p",{className:"text-gray-600",children:e.address_line2}),(0,Ue.jsxs)("p",{className:"text-gray-600",children:[e.city,", ",e.state," ",e.postal_code]})]}),(0,Ue.jsx)("div",{className:"ml-4",children:(0,Ue.jsx)("input",{type:"radio",checked:l===e.id,onChange:()=>c(e.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"})})]})},e.id))}):(0,Ue.jsxs)("div",{className:"text-center py-8",children:[(0,Ue.jsx)("p",{className:"text-gray-500 mb-4",children:"No addresses found"}),(0,Ue.jsx)("p",{className:"text-sm text-gray-400",children:"Please add a shipping address to continue with your order."})]}),(0,Ue.jsx)("button",{onClick:()=>u(!0),className:"mt-6 w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Add New Address"})]}),d&&(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add New Address"}),(0,Ue.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),b.first_name&&b.last_name&&b.phone&&b.address_line1&&b.city&&b.state&&b.postal_code)try{p(!0),x(""),console.log("Submitting address:",b),console.log("User token:",localStorage.getItem("token"));const e=await fetch("http://localhost:8000/api/orders/shipping-addresses/",{method:"POST",headers:{Authorization:"Token ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify(b)});if(console.log("Address response status:",e.status),console.log("Address response headers:",e.headers),e.ok){const t=await e.json();console.log("Address created successfully:",t),o(e=>[...Array.isArray(e)?e:[],t]),setTimeout(async()=>{await S()},1e3),c(t.id),y("Address saved successfully!"),x(""),u(!1),w({first_name:"",last_name:"",phone:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:""}),setTimeout(()=>y(""),5e3)}else{const t=e.headers.get("content-type");let n;if(t&&t.includes("application/json"))n=await e.json();else{const t=await e.text();console.error("Non-JSON error response:",t),n={detail:"Server error (".concat(e.status,"): ").concat(t.substring(0,200),"...")}}console.error("Error creating address:",n),x("Failed to save address: ".concat(n.detail||"Unknown error"))}}catch(g){console.error("Error creating address:",g),x("Network error: ".concat(g.message))}finally{p(!1)}else x("Please fill in all required fields")},className:"space-y-4",children:[(0,Ue.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:b.first_name,onChange:e=>w(qe(qe({},b),{},{first_name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:b.last_name,onChange:e=>w(qe(qe({},b),{},{last_name:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),(0,Ue.jsx)("input",{type:"tel",required:!0,value:b.phone,onChange:e=>w(qe(qe({},b),{},{phone:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Line 1 *"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:b.address_line1,onChange:e=>w(qe(qe({},b),{},{address_line1:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Line 2"}),(0,Ue.jsx)("input",{type:"text",value:b.address_line2,onChange:e=>w(qe(qe({},b),{},{address_line2:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City *"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:b.city,onChange:e=>w(qe(qe({},b),{},{city:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State *"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:b.state,onChange:e=>w(qe(qe({},b),{},{state:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Ue.jsxs)("div",{children:[(0,Ue.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code *"}),(0,Ue.jsx)("input",{type:"text",required:!0,value:b.postal_code,onChange:e=>w(qe(qe({},b),{},{postal_code:e.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,Ue.jsxs)("div",{className:"flex space-x-4",children:[(0,Ue.jsx)("button",{type:"submit",disabled:h,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:h?"Saving...":"Save Address"}),(0,Ue.jsx)("button",{type:"button",onClick:()=>u(!1),className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})]}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-4",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),(0,Ue.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Subtotal:"}),(0,Ue.jsxs)("span",{children:["RS ",N.subtotal.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Tax (10%):"}),(0,Ue.jsxs)("span",{children:["RS ",N.tax.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{children:"Delivery Fee:"}),(0,Ue.jsxs)("span",{children:["RS ",N.deliveryFee.toFixed(2)]})]}),(0,Ue.jsx)("hr",{className:"my-2"}),(0,Ue.jsxs)("div",{className:"flex justify-between font-semibold text-lg",children:[(0,Ue.jsx)("span",{children:"Total:"}),(0,Ue.jsxs)("span",{children:["RS ",N.total.toFixed(2)]})]})]}),(0,Ue.jsx)("button",{onClick:()=>{if(console.log("\ud83d\ude80 handleProceedToConfirmation - Debug Info:"),console.log("user:",s),console.log("cartItems:",t),console.log("cartItems.length:",t.length),!s)return void x("Please log in to place an order.");if(0===t.length){console.log("\u274c Cart validation failed - cart is empty"),console.log("\u274c But checking localStorage for cart data...");const e=localStorage.getItem("sweetbite-cart");return console.log("\u274c localStorage cart:",e),void x("Your cart is empty. Please add items to your cart first.")}if(console.log("\u2705 Cart validation passed - cart has items:",t.length),0===a.length)return void x("Please add a shipping address first.");if(!l)return void x("Please select a shipping address");const r=t.filter(e=>e.id&&e.quantity>0);if(0===r.length)return void x("No valid items in cart. Please refresh and try again.");const i={order_type:"online",delivery_instructions:"Cash on delivery order",shipping_address:a.find(e=>e.id===l),items:r.map(e=>({cake_id:parseInt(e.id),quantity:parseInt(e.quantity),customization_notes:e.customization_notes||"",cake:e})),subtotal:n(),tax:.1*n(),delivery_fee:5,total_amount:n()+.1*n()+5};console.log("Proceeding to confirmation with order data:",i),e("/order-confirmation",{state:{orderPreview:i,isPreview:!0}})},disabled:!l||0===a.length,className:"w-full py-3 px-4 rounded-lg font-medium transition-colors ".concat(l&&0!==a.length?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Review Order"}),(0,Ue.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Payment will be collected upon delivery"})]})})]})]})})},bB=e=>{let{item:t,onQuantityChange:n,onRemove:r}=e;return(0,Ue.jsxs)(tl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[(0,Ue.jsxs)("div",{className:"relative",children:[(0,Ue.jsx)("img",{src:t.previewImage||t.image,alt:t.name,className:"w-20 h-20 object-cover rounded-lg",title:t.previewImage?"Your customized cake preview":"Standard cake image"}),t.previewImage&&(0,Ue.jsx)("div",{className:"absolute -top-1 -right-1 bg-sweetbite-500 text-white text-xs px-1 py-0.5 rounded-full",children:"\u2728"})]}),(0,Ue.jsxs)("div",{className:"flex-1",children:[(0,Ue.jsx)("h3",{className:"font-semibold text-gray-800",children:t.name}),t.customizations&&Object.keys(t.customizations).length>0&&(0,Ue.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:Object.entries(t.customizations).map(e=>{let[t,n]=e;return(0,Ue.jsxs)("span",{className:"inline-block bg-sweetbite-100 text-sweetbite-700 px-2 py-1 rounded mr-2 mb-1",children:[t,": ",n]},t)})}),(0,Ue.jsxs)("p",{className:"text-lg font-semibold text-sweetbite-600",children:["RS ",t.price.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ue.jsx)("button",{onClick:()=>n(t.cartItemId,t.quantity-1),className:"w-8 h-8 rounded-full bg-sweetbite-100 text-sweetbite-600 hover:bg-sweetbite-200 flex items-center justify-center transition-colors",children:"-"}),(0,Ue.jsx)("span",{className:"w-12 text-center font-semibold",children:t.quantity}),(0,Ue.jsx)("button",{onClick:()=>n(t.cartItemId,t.quantity+1),className:"w-8 h-8 rounded-full bg-sweetbite-100 text-sweetbite-600 hover:bg-sweetbite-200 flex items-center justify-center transition-colors",children:"+"})]}),(0,Ue.jsx)("button",{onClick:()=>r(t.cartItemId),className:"text-red-500 hover:text-red-700 p-2 transition-colors",children:(0,Ue.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ue.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},wB=e=>{let{subtotal:t,deliveryFee:n,taxAmount:r,total:i,itemCount:s}=e;return(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-4",children:[(0,Ue.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Order Summary"}),(0,Ue.jsxs)("div",{className:"space-y-3",children:[(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsxs)("span",{className:"text-gray-600",children:["Subtotal (",s," items)"]}),(0,Ue.jsxs)("span",{className:"font-semibold",children:["RS ",t.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Delivery Fee"}),(0,Ue.jsxs)("span",{className:"font-semibold",children:["RS ",n.toFixed(2)]})]}),(0,Ue.jsxs)("div",{className:"flex justify-between",children:[(0,Ue.jsx)("span",{className:"text-gray-600",children:"Tax (8%)"}),(0,Ue.jsxs)("span",{className:"font-semibold",children:["RS ",r.toFixed(2)]})]}),(0,Ue.jsx)("hr",{className:"border-gray-200"}),(0,Ue.jsxs)("div",{className:"flex justify-between text-lg font-bold",children:[(0,Ue.jsx)("span",{children:"Total"}),(0,Ue.jsxs)("span",{className:"text-sweetbite-600",children:["RS ",i.toFixed(2)]})]})]}),(0,Ue.jsx)(Te,{to:"/shipping-address",className:"w-full bg-sweetbite-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-sweetbite-700 transition-colors mt-6 block text-center",children:"Proceed to Checkout"}),(0,Ue.jsx)(Te,{to:"/menu",className:"w-full border border-sweetbite-600 text-sweetbite-600 py-3 px-4 rounded-lg font-semibold hover:bg-sweetbite-50 transition-colors mt-3 block text-center",children:"Continue Shopping"})]})},_B=()=>(0,Ue.jsx)("div",{className:"min-h-screen gradient-bg flex items-center justify-center",children:(0,Ue.jsxs)("div",{className:"text-center py-16",children:[(0,Ue.jsx)(tl.div,{initial:{scale:0},animate:{scale:1},transition:{duration:.5},className:"w-32 h-32 mx-auto mb-6 bg-white rounded-full flex items-center justify-center shadow-lg",children:(0,Ue.jsx)("span",{className:"text-6xl",children:"\ud83d\uded2"})}),(0,Ue.jsx)(tl.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"text-2xl font-bold text-gray-800 mb-4",children:"Your cart is empty"}),(0,Ue.jsx)(tl.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"text-gray-600 mb-8",children:"Start adding some delicious SweetBite cakes to your cart!"}),(0,Ue.jsx)(tl.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},children:(0,Ue.jsx)(Te,{to:"/menu",className:"btn-primary",children:"Browse Our Menu"})})]})}),SB=()=>{const{cartItems:e,updateQuantity:t,removeItem:n,clearCart:r,getCartTotal:s}=hl(),[a]=(0,i.useState)(5.99),[o]=(0,i.useState)(.08),l=()=>e.reduce((e,t)=>e+t.price*t.quantity,0),c=()=>l()*o,d=(e,r)=>{r>0?t(e,r):n(e)};return 0===e.length?(0,Ue.jsx)(_B,{}):(0,Ue.jsx)("div",{className:"min-h-screen gradient-bg py-8",children:(0,Ue.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,Ue.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:(0,Ue.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ue.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ue.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-sweetbite-500 to-sweetbite-600 rounded-full flex items-center justify-center",children:(0,Ue.jsx)("span",{className:"text-white font-bold text-xl",children:"S"})}),(0,Ue.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"SweetBite Cart"})]}),(0,Ue.jsxs)("div",{className:"text-right",children:[(0,Ue.jsx)("p",{className:"text-sm text-gray-600",children:"Your Cart"}),(0,Ue.jsxs)("p",{className:"text-lg font-semibold text-sweetbite-600",children:[e.length," ",1===e.length?"item":"items"]})]})]})}),(0,Ue.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,Ue.jsx)("div",{className:"lg:col-span-2",children:(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Ue.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Your SweetBite Cart"}),(0,Ue.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,Ue.jsx)(bB,{item:e,onQuantityChange:d,onRemove:n},e.cartItemId))})]})}),(0,Ue.jsx)("div",{className:"lg:col-span-1",children:(0,Ue.jsx)(wB,{subtotal:l(),deliveryFee:a,taxAmount:c(),total:(()=>{const e=l(),t=c();return e+a+t})(),itemCount:e.length})})]})]})})},NB=()=>{const[e,t]=(0,i.useState)(!1),[n,r]=(0,i.useState)(""),s=ne();return(0,Ue.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 flex items-center justify-center p-4",children:[(0,Ue.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,Ue.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Test Password Reset Modal"}),(0,Ue.jsxs)("div",{className:"space-y-4",children:[(0,Ue.jsx)("button",{onClick:()=>{r("test-token-123"),t(!0)},className:"w-full bg-sweetbite-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-sweetbite-700 transition-colors",children:"Test Modal Popup (Demo)"}),(0,Ue.jsx)("button",{onClick:async()=>{try{const e=await fetch("http://localhost:8000/api/users/auth/register/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"testuser_modal",email:"testuser_modal@example.com",password:"testpassword123",confirmPassword:"testpassword123",first_name:"Test",last_name:"User"})});if(e.ok){alert("Test user created! Now request password reset...");(await fetch("http://localhost:8000/api/users/auth/forgot-password/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:"testuser_modal@example.com"})})).ok?alert("Password reset requested! Check Django console for the reset link."):alert("Failed to request password reset")}else{const t=await e.json();alert("Failed to create test user: ".concat(JSON.stringify(t)))}}catch(nU){alert("Error: ".concat(nU.message))}},className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Create Test User & Request Reset"}),(0,Ue.jsx)("div",{className:"text-center",children:(0,Ue.jsx)("button",{onClick:()=>s("/"),className:"text-sweetbite-600 hover:text-sweetbite-700 font-medium",children:"\u2190 Back to Home"})})]}),(0,Ue.jsxs)("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg text-sm",children:[(0,Ue.jsx)("h3",{className:"font-bold mb-2",children:"Instructions:"}),(0,Ue.jsxs)("ol",{className:"list-decimal list-inside space-y-1",children:[(0,Ue.jsx)("li",{children:'Click "Test Modal Popup" to see the modal'}),(0,Ue.jsx)("li",{children:'Click "Create Test User" to create a test user and request reset'}),(0,Ue.jsx)("li",{children:"Check Django console for the actual reset link"}),(0,Ue.jsx)("li",{children:"Copy the reset link and paste in browser address bar"})]})]})]}),(0,Ue.jsx)(ez,{isOpen:e,onClose:()=>{t(!1),s("/")},token:n,userEmail:"test@example.com"})]})};const jB=function(){return(0,Ue.jsx)(Ve,{children:(0,Ue.jsx)(ul,{children:(0,Ue.jsx)(Ee,{children:(0,Ue.jsxs)("div",{className:"App",children:[(0,Ue.jsx)(fl,{}),(0,Ue.jsxs)(we,{children:[(0,Ue.jsx)(ye,{path:"/",element:(0,Ue.jsx)(gz,{})}),(0,Ue.jsx)(ye,{path:"/cart",element:(0,Ue.jsx)(SB,{})}),(0,Ue.jsx)(ye,{path:"/customize",element:(0,Ue.jsx)(Iv,{})}),(0,Ue.jsx)(ye,{path:"/customize/:cakeId",element:(0,Ue.jsx)(Iv,{})}),(0,Ue.jsx)(ye,{path:"/cake/:cakeId",element:(0,Ue.jsx)(LU,{})}),(0,Ue.jsx)(ye,{path:"/menu",element:(0,Ue.jsx)(bz,{})}),(0,Ue.jsx)(ye,{path:"/shipping-address",element:(0,Ue.jsx)(yB,{})}),(0,Ue.jsx)(ye,{path:"/payment",element:(0,Ue.jsx)(gB,{})}),(0,Ue.jsx)(ye,{path:"/order-success",element:(0,Ue.jsx)(mB,{})}),(0,Ue.jsx)(ye,{path:"/order-confirmation",element:(0,Ue.jsx)(Iz,{})}),(0,Ue.jsx)(ye,{path:"/order-confirmation/:orderId",element:(0,Ue.jsx)(Iz,{})}),(0,Ue.jsx)(ye,{path:"/track-order/:orderId",element:(0,Ue.jsx)(fB,{})}),(0,Ue.jsx)(ye,{path:"/orders",element:(0,Ue.jsx)(Tz,{})}),(0,Ue.jsx)(ye,{path:"/admin",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(Zx,{})})}),(0,Ue.jsx)(ye,{path:"/admin/orders",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(Qx,{})})}),(0,Ue.jsx)(ye,{path:"/admin/reports",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(fv,{})})}),(0,Ue.jsx)(ye,{path:"/admin/purchase-history",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(mv,{})})}),(0,Ue.jsx)(ye,{path:"/admin/catalog",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(Wl,{})})}),(0,Ue.jsx)(ye,{path:"/admin/offers",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(Kx,{})})}),(0,Ue.jsx)(ye,{path:"/admin/inventory",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(xz,{})})}),(0,Ue.jsx)(ye,{path:"/inventory",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(xz,{})})}),(0,Ue.jsx)(ye,{path:"/inventory/add-ingredient",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(Bl,{})})}),(0,Ue.jsx)(ye,{path:"/admin/customers",element:(0,Ue.jsx)(gl,{children:(0,Ue.jsx)(YU,{})})}),(0,Ue.jsx)(ye,{path:"/profile",element:(0,Ue.jsx)(xB,{})}),(0,Ue.jsx)(ye,{path:"/feedback",element:(0,Ue.jsx)($U,{})}),(0,Ue.jsx)(ye,{path:"/forgot-password",element:(0,Ue.jsx)(tz,{})}),(0,Ue.jsx)(ye,{path:"/reset-password",element:(0,Ue.jsx)(vB,{})}),(0,Ue.jsx)(ye,{path:"/test-reset",element:(0,Ue.jsx)(NB,{})}),(0,Ue.jsx)(ye,{path:"/auth-test",element:(0,Ue.jsx)(gv,{})}),(0,Ue.jsx)(ye,{path:"/login-test",element:(0,Ue.jsx)(vz,{})})]}),(0,Ue.jsx)(He,{})]})})})})};a.createRoot(document.getElementById("root")).render((0,Ue.jsx)(i.StrictMode,{children:(0,Ue.jsx)(jB,{})}))})()})();
//# sourceMappingURL=main.ad326599.js.map